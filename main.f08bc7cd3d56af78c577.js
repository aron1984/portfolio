(self.webpackChunkportalejo=self.webpackChunkportalejo||[]).push([[179],{255:qu=>{function ss(st){return Promise.resolve().then(()=>{var Go=new Error("Cannot find module '"+st+"'");throw Go.code="MODULE_NOT_FOUND",Go})}ss.keys=()=>[],ss.resolve=ss,ss.id=255,qu.exports=ss},216:function(qu,ss){!function(st){"use strict";function Hn(c){var v,T,P,V;for(T=1,P=arguments.length;T<P;T++)for(v in V=arguments[T])c[v]=V[v];return c}var Io=Object.create||function(){function c(){}return function(v){return c.prototype=v,new c}}();function p(c,v){var T=Array.prototype.slice;if(c.bind)return c.bind.apply(c,T.call(arguments,1));var P=T.call(arguments,2);return function(){return c.apply(v,P.length?P.concat(T.call(arguments)):arguments)}}var zr=0;function Qt(c){return c._leaflet_id=c._leaflet_id||++zr,c._leaflet_id}function Cr(c,v,T){var P,V,J,me;return me=function(){P=!1,V&&(J.apply(T,V),V=!1)},J=function(){P?V=arguments:(c.apply(T,arguments),setTimeout(me,v),P=!0)}}function Qe(c,v,T){var P=v[1],V=v[0],J=P-V;return c===P&&T?c:((c-V)%J+J)%J+V}function $e(){return!1}function at(c,v){var T=Math.pow(10,void 0===v?6:v);return Math.round(c*T)/T}function po(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function mo(c){return po(c).split(/\s+/)}function Yn(c,v){for(var T in Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?Io(c.options):{}),v)c.options[T]=v[T];return c.options}function In(c,v,T){var P=[];for(var V in c)P.push(encodeURIComponent(T?V.toUpperCase():V)+"="+encodeURIComponent(c[V]));return(v&&-1!==v.indexOf("?")?"&":"?")+P.join("&")}var Ol=/\{ *([\w_-]+) *\}/g;function sl(c,v){return c.replace(Ol,function(T,P){var V=v[P];if(void 0===V)throw new Error("No value provided for variable "+T);return"function"==typeof V&&(V=V(v)),V})}var ar=Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)};function Po(c,v){for(var T=0;T<c.length;T++)if(c[T]===v)return T;return-1}var gi="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function as(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var al=0;function Pn(c){var v=+new Date,T=Math.max(0,16-(v-al));return al=v+T,window.setTimeout(c,T)}var Ci=window.requestAnimationFrame||as("RequestAnimationFrame")||Pn,uu=window.cancelAnimationFrame||as("CancelAnimationFrame")||as("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function si(c,v,T){if(!T||Ci!==Pn)return Ci.call(window,p(c,v));c.call(v)}function Zi(c){c&&uu.call(window,c)}var ka={extend:Hn,create:Io,bind:p,lastId:zr,stamp:Qt,throttle:Cr,wrapNum:Qe,falseFn:$e,formatNum:at,trim:po,splitWords:mo,setOptions:Yn,getParamString:In,template:sl,isArray:ar,indexOf:Po,emptyImageUrl:gi,requestFn:Ci,cancelFn:uu,requestAnimFrame:si,cancelAnimFrame:Zi};function Pi(){}Pi.extend=function(c){var v=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=v.__super__=this.prototype,P=Io(T);for(var V in P.constructor=v,v.prototype=P,this)Object.prototype.hasOwnProperty.call(this,V)&&"prototype"!==V&&"__super__"!==V&&(v[V]=this[V]);return c.statics&&(Hn(v,c.statics),delete c.statics),c.includes&&(function(c){if("undefined"!=typeof L&&L&&L.Mixin){c=ar(c)?c:[c];for(var v=0;v<c.length;v++)c[v]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(c.includes),Hn.apply(null,[P].concat(c.includes)),delete c.includes),P.options&&(c.options=Hn(Io(P.options),c.options)),Hn(P,c),P._initHooks=[],P.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var J=0,me=P._initHooks.length;J<me;J++)P._initHooks[J].call(this)}},v},Pi.include=function(c){return Hn(this.prototype,c),this},Pi.mergeOptions=function(c){return Hn(this.prototype.options,c),this},Pi.addInitHook=function(c){var v=Array.prototype.slice.call(arguments,1),T="function"==typeof c?c:function(){this[c].apply(this,v)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};var _i={on:function(c,v,T){if("object"==typeof c)for(var P in c)this._on(P,c[P],v);else for(var V=0,J=(c=mo(c)).length;V<J;V++)this._on(c[V],v,T);return this},off:function(c,v,T){if(c)if("object"==typeof c)for(var P in c)this._off(P,c[P],v);else for(var V=0,J=(c=mo(c)).length;V<J;V++)this._off(c[V],v,T);else delete this._events;return this},_on:function(c,v,T){this._events=this._events||{};var P=this._events[c];P||(this._events[c]=P=[]),T===this&&(T=void 0);for(var V={fn:v,ctx:T},J=P,me=0,Le=J.length;me<Le;me++)if(J[me].fn===v&&J[me].ctx===T)return;J.push(V)},_off:function(c,v,T){var P,V,J;if(this._events&&(P=this._events[c])){if(!v){for(V=0,J=P.length;V<J;V++)P[V].fn=$e;return void delete this._events[c]}if(T===this&&(T=void 0),P)for(V=0,J=P.length;V<J;V++){var me=P[V];if(me.ctx===T&&me.fn===v)return me.fn=$e,this._firingCount&&(this._events[c]=P=P.slice()),void P.splice(V,1)}}},fire:function(c,v,T){if(!this.listens(c,T))return this;var P=Hn({},v,{type:c,target:this,sourceTarget:v&&v.sourceTarget||this});if(this._events){var V=this._events[c];if(V){this._firingCount=this._firingCount+1||1;for(var J=0,me=V.length;J<me;J++){var Le=V[J];Le.fn.call(Le.ctx||this,P)}this._firingCount--}}return T&&this._propagateEvent(P),this},listens:function(c,v){var T=this._events&&this._events[c];if(T&&T.length)return!0;if(v)for(var P in this._eventParents)if(this._eventParents[P].listens(c,v))return!0;return!1},once:function(c,v,T){if("object"==typeof c){for(var P in c)this.once(P,c[P],v);return this}var V=p(function(){this.off(c,v,T).off(c,V,T)},this);return this.on(c,v,T).on(c,V,T)},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[Qt(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[Qt(c)],this},_propagateEvent:function(c){for(var v in this._eventParents)this._eventParents[v].fire(c.type,Hn({layer:c.target,propagatedFrom:c.target},c),!0)}};_i.addEventListener=_i.on,_i.removeEventListener=_i.clearAllEventListeners=_i.off,_i.addOneTimeEventListener=_i.once,_i.fireEvent=_i.fire,_i.hasEventListeners=_i.listens;var tn=Pi.extend(_i);function Dt(c,v,T){this.x=T?Math.round(c):c,this.y=T?Math.round(v):v}var ni=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};function nn(c,v,T){return c instanceof Dt?c:ar(c)?new Dt(c[0],c[1]):null==c?c:"object"==typeof c&&"x"in c&&"y"in c?new Dt(c.x,c.y):new Dt(c,v,T)}function zt(c,v){if(c)for(var T=v?[c,v]:c,P=0,V=T.length;P<V;P++)this.extend(T[P])}function ki(c,v){return!c||c instanceof zt?c:new zt(c,v)}function Ri(c,v){if(c)for(var T=v?[c,v]:c,P=0,V=T.length;P<V;P++)this.extend(T[P])}function li(c,v){return c instanceof Ri?c:new Ri(c,v)}function Sn(c,v,T){if(isNaN(c)||isNaN(v))throw new Error("Invalid LatLng object: ("+c+", "+v+")");this.lat=+c,this.lng=+v,void 0!==T&&(this.alt=+T)}function Gn(c,v,T){return c instanceof Sn?c:ar(c)&&"object"!=typeof c[0]?3===c.length?new Sn(c[0],c[1],c[2]):2===c.length?new Sn(c[0],c[1]):null:null==c?c:"object"==typeof c&&"lat"in c?new Sn(c.lat,"lng"in c?c.lng:c.lon,c.alt):void 0===v?null:new Sn(c,v,T)}Dt.prototype={clone:function(){return new Dt(this.x,this.y)},add:function(c){return this.clone()._add(nn(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(nn(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new Dt(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new Dt(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ni(this.x),this.y=ni(this.y),this},distanceTo:function(c){var v=(c=nn(c)).x-this.x,T=c.y-this.y;return Math.sqrt(v*v+T*T)},equals:function(c){return(c=nn(c)).x===this.x&&c.y===this.y},contains:function(c){return c=nn(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+at(this.x)+", "+at(this.y)+")"}},zt.prototype={extend:function(c){return c=nn(c),this.min||this.max?(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)):(this.min=c.clone(),this.max=c.clone()),this},getCenter:function(c){return new Dt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return new Dt(this.min.x,this.max.y)},getTopRight:function(){return new Dt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var v,T;return(c="number"==typeof c[0]||c instanceof Dt?nn(c):ki(c))instanceof zt?(v=c.min,T=c.max):v=T=c,v.x>=this.min.x&&T.x<=this.max.x&&v.y>=this.min.y&&T.y<=this.max.y},intersects:function(c){c=ki(c);var v=this.min,T=this.max,P=c.min,V=c.max;return V.x>=v.x&&P.x<=T.x&&V.y>=v.y&&P.y<=T.y},overlaps:function(c){c=ki(c);var v=this.min,T=this.max,P=c.min,V=c.max;return V.x>v.x&&P.x<T.x&&V.y>v.y&&P.y<T.y},isValid:function(){return!(!this.min||!this.max)}},Ri.prototype={extend:function(c){var P,V,v=this._southWest,T=this._northEast;if(c instanceof Sn)P=c,V=c;else{if(!(c instanceof Ri))return c?this.extend(Gn(c)||li(c)):this;if(V=c._northEast,!(P=c._southWest)||!V)return this}return v||T?(v.lat=Math.min(P.lat,v.lat),v.lng=Math.min(P.lng,v.lng),T.lat=Math.max(V.lat,T.lat),T.lng=Math.max(V.lng,T.lng)):(this._southWest=new Sn(P.lat,P.lng),this._northEast=new Sn(V.lat,V.lng)),this},pad:function(c){var v=this._southWest,T=this._northEast,P=Math.abs(v.lat-T.lat)*c,V=Math.abs(v.lng-T.lng)*c;return new Ri(new Sn(v.lat-P,v.lng-V),new Sn(T.lat+P,T.lng+V))},getCenter:function(){return new Sn((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Sn(this.getNorth(),this.getWest())},getSouthEast:function(){return new Sn(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){c="number"==typeof c[0]||c instanceof Sn||"lat"in c?Gn(c):li(c);var P,V,v=this._southWest,T=this._northEast;return c instanceof Ri?(P=c.getSouthWest(),V=c.getNorthEast()):P=V=c,P.lat>=v.lat&&V.lat<=T.lat&&P.lng>=v.lng&&V.lng<=T.lng},intersects:function(c){c=li(c);var v=this._southWest,T=this._northEast,P=c.getSouthWest(),V=c.getNorthEast();return V.lat>=v.lat&&P.lat<=T.lat&&V.lng>=v.lng&&P.lng<=T.lng},overlaps:function(c){c=li(c);var v=this._southWest,T=this._northEast,P=c.getSouthWest(),V=c.getNorthEast();return V.lat>v.lat&&P.lat<T.lat&&V.lng>v.lng&&P.lng<T.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,v){return!!c&&(c=li(c),this._southWest.equals(c.getSouthWest(),v)&&this._northEast.equals(c.getNorthEast(),v))},isValid:function(){return!(!this._southWest||!this._northEast)}},Sn.prototype={equals:function(c,v){return!!c&&(c=Gn(c),Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng))<=(void 0===v?1e-9:v))},toString:function(c){return"LatLng("+at(this.lat,c)+", "+at(this.lng,c)+")"},distanceTo:function(c){return Wr.distance(this,Gn(c))},wrap:function(){return Wr.wrapLatLng(this)},toBounds:function(c){var v=180*c/40075017,T=v/Math.cos(Math.PI/180*this.lat);return li([this.lat-v,this.lng-T],[this.lat+v,this.lng+T])},clone:function(){return new Sn(this.lat,this.lng,this.alt)}};var c,jt={latLngToPoint:function(c,v){var T=this.projection.project(c),P=this.scale(v);return this.transformation._transform(T,P)},pointToLatLng:function(c,v){var T=this.scale(v),P=this.transformation.untransform(c,T);return this.projection.unproject(P)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var v=this.projection.bounds,T=this.scale(c);return new zt(this.transformation.transform(v.min,T),this.transformation.transform(v.max,T))},infinite:!1,wrapLatLng:function(c){var v=this.wrapLng?Qe(c.lng,this.wrapLng,!0):c.lng;return new Sn(this.wrapLat?Qe(c.lat,this.wrapLat,!0):c.lat,v,c.alt)},wrapLatLngBounds:function(c){var v=c.getCenter(),T=this.wrapLatLng(v),P=v.lat-T.lat,V=v.lng-T.lng;if(0===P&&0===V)return c;var J=c.getSouthWest(),me=c.getNorthEast();return new Ri(new Sn(J.lat-P,J.lng-V),new Sn(me.lat-P,me.lng-V))}},Wr=Hn({},jt,{wrapLng:[-180,180],R:6371e3,distance:function(c,v){var T=Math.PI/180,P=c.lat*T,V=v.lat*T,J=Math.sin((v.lat-c.lat)*T/2),me=Math.sin((v.lng-c.lng)*T/2),Le=J*J+Math.cos(P)*Math.cos(V)*me*me,Be=2*Math.atan2(Math.sqrt(Le),Math.sqrt(1-Le));return this.R*Be}}),Ra={R:6378137,MAX_LATITUDE:85.0511287798,project:function(c){var v=Math.PI/180,T=this.MAX_LATITUDE,P=Math.max(Math.min(T,c.lat),-T),V=Math.sin(P*v);return new Dt(this.R*c.lng*v,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(c){var v=180/Math.PI;return new Sn((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*v,c.x*v/this.R)},bounds:(c=6378137*Math.PI,new zt([-c,-c],[c,c]))};function La(c,v,T,P){if(ar(c))return this._a=c[0],this._b=c[1],this._c=c[2],void(this._d=c[3]);this._a=c,this._b=v,this._c=T,this._d=P}function qi(c,v,T,P){return new La(c,v,T,P)}La.prototype={transform:function(c,v){return this._transform(c.clone(),v)},_transform:function(c,v){return c.x=(v=v||1)*(this._a*c.x+this._b),c.y=v*(this._c*c.y+this._d),c},untransform:function(c,v){return new Dt((c.x/(v=v||1)-this._b)/this._a,(c.y/v-this._d)/this._c)}};var Zo=Hn({},Wr,{code:"EPSG:3857",projection:Ra,transformation:function(){var c=.5/(Math.PI*Ra.R);return qi(c,.5,-c,.5)}()}),Mn=Hn({},Zo,{code:"EPSG:900913"});function qo(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function As(c,v){var P,V,J,me,Le,Be,T="";for(P=0,J=c.length;P<J;P++){for(V=0,me=(Le=c[P]).length;V<me;V++)T+=(V?"L":"M")+(Be=Le[V]).x+" "+Be.y;T+=v?Q?"z":"x":""}return T||"M0 0"}var Jn=document.documentElement.style,ko="ActiveXObject"in window,ta=ko&&!document.addEventListener,go="msLaunchUri"in navigator&&!("documentMode"in document),Oa=W("webkit"),_o=W("android"),Nn=W("android 2")||W("android 3"),na=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),cl=_o&&W("Google")&&na<537&&!("AudioNode"in window),yo=!!window.opera,Xr=!go&&W("chrome"),Er=W("gecko")&&!Oa&&!yo&&!ko,ia=!Xr&&W("safari"),ra=W("phantom"),Fl="OTransition"in Jn,Fa=0===navigator.platform.indexOf("Win"),oa=ko&&"transition"in Jn,ul="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Nn,bc="MozPerspective"in Jn,lr=!window.L_DISABLE_3D&&(oa||ul||bc)&&!Fl&&!ra,Wo="undefined"!=typeof orientation||W("mobile"),Ro=Wo&&Oa,sa=Wo&&ul,Xo=!window.PointerEvent&&window.MSPointerEvent,Kr=!(!window.PointerEvent&&!Xo),Ft=!window.L_NO_TOUCH&&(Kr||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),ls=Wo&&yo,Bt=Wo&&Er,Tr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ko=function(){var c=!1;try{var v=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",$e,v),window.removeEventListener("testPassiveEventSupport",$e,v)}catch(T){}return c}(),yn=!!document.createElement("canvas").getContext,Q=!(!document.createElementNS||!qo("svg").createSVGRect),$=!Q&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var v=c.firstChild;return v.style.behavior="url(#default#VML)",v&&"object"==typeof v.adj}catch(T){return!1}}();function W(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var re={ie:ko,ielt9:ta,edge:go,webkit:Oa,android:_o,android23:Nn,androidStock:cl,opera:yo,chrome:Xr,gecko:Er,safari:ia,phantom:ra,opera12:Fl,win:Fa,ie3d:oa,webkit3d:ul,gecko3d:bc,any3d:lr,mobile:Wo,mobileWebkit:Ro,mobileWebkit3d:sa,msPointer:Xo,pointer:Kr,touch:Ft,mobileOpera:ls,mobileGecko:Bt,retina:Tr,passiveEvents:Ko,canvas:yn,svg:Q,vml:$},le=Xo?"MSPointerDown":"pointerdown",ge=Xo?"MSPointerMove":"pointermove",ve=Xo?"MSPointerUp":"pointerup",Ee=Xo?"MSPointerCancel":"pointercancel",be={},Ae=!1;function Ge(c,v,T,P){return"touchstart"===v?function(c,v,T){var P=p(function(V){V.MSPOINTER_TYPE_TOUCH&&V.pointerType===V.MSPOINTER_TYPE_TOUCH&&zi(V),vt(V,v)});c["_leaflet_touchstart"+T]=P,c.addEventListener(le,P,!1),Ae||(document.addEventListener(le,xt,!0),document.addEventListener(ge,xe,!0),document.addEventListener(ve,Ne,!0),document.addEventListener(Ee,Ne,!0),Ae=!0)}(c,T,P):"touchmove"===v?function(c,v,T){var P=function(V){V.pointerType===(V.MSPOINTER_TYPE_MOUSE||"mouse")&&0===V.buttons||vt(V,v)};c["_leaflet_touchmove"+T]=P,c.addEventListener(ge,P,!1)}(c,T,P):"touchend"===v&&function(c,v,T){var P=function(V){vt(V,v)};c["_leaflet_touchend"+T]=P,c.addEventListener(ve,P,!1),c.addEventListener(Ee,P,!1)}(c,T,P),this}function xt(c){be[c.pointerId]=c}function xe(c){be[c.pointerId]&&(be[c.pointerId]=c)}function Ne(c){delete be[c.pointerId]}function vt(c,v){for(var T in c.touches=[],be)c.touches.push(be[T]);c.changedTouches=[c],v(c)}var vn=Xo?"MSPointerDown":Kr?"pointerdown":"touchstart",rn=Xo?"MSPointerUp":Kr?"pointerup":"touchend",kn="_leaflet_";var vo,Is,Li,ua,zn,Gt=hl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ct=hl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xn="webkitTransition"===Ct||"OTransition"===Ct?Ct+"End":"transitionend";function cr(c){return"string"==typeof c?document.getElementById(c):c}function Vt(c,v){var T=c.style[v]||c.currentStyle&&c.currentStyle[v];if((!T||"auto"===T)&&document.defaultView){var P=document.defaultView.getComputedStyle(c,null);T=P?P[v]:null}return"auto"===T?null:T}function An(c,v,T){var P=document.createElement(c);return P.className=v||"",T&&T.appendChild(P),P}function mt(c){var v=c.parentNode;v&&v.removeChild(c)}function la(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Rn(c){var v=c.parentNode;v&&v.lastChild!==c&&v.appendChild(c)}function fn(c){var v=c.parentNode;v&&v.firstChild!==c&&v.insertBefore(c,v.firstChild)}function Nl(c,v){if(void 0!==c.classList)return c.classList.contains(v);var T=Br(c);return T.length>0&&new RegExp("(^|\\s)"+v+"(\\s|$)").test(T)}function Ut(c,v){if(void 0!==c.classList)for(var T=mo(v),P=0,V=T.length;P<V;P++)c.classList.add(T[P]);else if(!Nl(c,v)){var J=Br(c);ca(c,(J?J+" ":"")+v)}}function Qn(c,v){void 0!==c.classList?c.classList.remove(v):ca(c,po((" "+Br(c)+" ").replace(" "+v+" "," ")))}function ca(c,v){void 0===c.className.baseVal?c.className=v:c.className.baseVal=v}function Br(c){return c.correspondingElement&&(c=c.correspondingElement),void 0===c.className.baseVal?c.className:c.className.baseVal}function Dr(c,v){"opacity"in c.style?c.style.opacity=v:"filter"in c.style&&function(c,v){var T=!1,P="DXImageTransform.Microsoft.Alpha";try{T=c.filters.item(P)}catch(V){if(1===v)return}v=Math.round(100*v),T?(T.Enabled=100!==v,T.Opacity=v):c.style.filter+=" progid:"+P+"(opacity="+v+")"}(c,v)}function hl(c){for(var v=document.documentElement.style,T=0;T<c.length;T++)if(c[T]in v)return c[T];return!1}function wt(c,v,T){var P=v||new Dt(0,0);c.style[Gt]=(oa?"translate("+P.x+"px,"+P.y+"px)":"translate3d("+P.x+"px,"+P.y+"px,0)")+(T?" scale("+T+")":"")}function cn(c,v){c._leaflet_pos=v,lr?wt(c,v):(c.style.left=v.x+"px",c.style.top=v.y+"px")}function Ni(c){return c._leaflet_pos||new Dt(0,0)}if("onselectstart"in document)vo=function(){mn(window,"selectstart",zi)},Is=function(){On(window,"selectstart",zi)};else{var ur=hl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);vo=function(){if(ur){var c=document.documentElement.style;Li=c[ur],c[ur]="none"}},Is=function(){ur&&(document.documentElement.style[ur]=Li,Li=void 0)}}function Ei(){mn(window,"dragstart",zi)}function Ji(){On(window,"dragstart",zi)}function Na(c){for(;-1===c.tabIndex;)c=c.parentNode;!c.style||(za(),ua=c,zn=c.style.outline,c.style.outline="none",mn(window,"keydown",za))}function za(){!ua||(ua.style.outline=zn,ua=void 0,zn=void 0,On(window,"keydown",za))}function Wu(c){do{c=c.parentNode}while(!(c.offsetWidth&&c.offsetHeight||c===document.body));return c}function cs(c){var v=c.getBoundingClientRect();return{x:v.width/c.offsetWidth||1,y:v.height/c.offsetHeight||1,boundingClientRect:v}}var Un={TRANSFORM:Gt,TRANSITION:Ct,TRANSITION_END:xn,get:cr,getStyle:Vt,create:An,remove:mt,empty:la,toFront:Rn,toBack:fn,hasClass:Nl,addClass:Ut,removeClass:Qn,setClass:ca,getClass:Br,setOpacity:Dr,testProp:hl,setTransform:wt,setPosition:cn,getPosition:Ni,disableTextSelection:vo,enableTextSelection:Is,disableImageDrag:Ei,enableImageDrag:Ji,preventOutline:Na,restoreOutline:za,getSizedParentNode:Wu,getScale:cs};function mn(c,v,T,P){if("object"==typeof v)for(var V in v)Ps(c,V,v[V],T);else for(var J=0,me=(v=mo(v)).length;J<me;J++)Ps(c,v[J],T,P);return this}var Ti="_leaflet_events";function On(c,v,T,P){if("object"==typeof v)for(var V in v)zl(c,V,v[V],T);else if(v)for(var J=0,me=(v=mo(v)).length;J<me;J++)zl(c,v[J],T,P);else{for(var Le in c[Ti])zl(c,Le,c[Ti][Le]);delete c[Ti]}return this}function bn(){if(Kr)return!(go||ia)}var ha={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ps(c,v,T,P){var V=v+Qt(T)+(P?"_"+Qt(P):"");if(c[Ti]&&c[Ti][V])return this;var J=function(Le){return T.call(P||c,Le||window.event)},me=J;Kr&&0===v.indexOf("touch")?Ge(c,v,J,V):Ft&&"dblclick"===v&&!bn()?function(c,v,T){var P,V,J=!1;function Le(Me){if(Kr){if(!Me.isPrimary||"mouse"===Me.pointerType)return}else if(Me.touches.length>1)return;var gt=Date.now(),Tt=gt-(P||gt);V=Me.touches?Me.touches[0]:Me,J=Tt>0&&Tt<=250,P=gt}function Be(Me){if(J&&!V.cancelBubble){if(Kr){if("mouse"===Me.pointerType)return;var Tt,un,gt={};for(un in V)gt[un]=(Tt=V[un])&&Tt.bind?Tt.bind(V):Tt;V=gt}V.type="dblclick",V.button=0,v(V),P=null}}c[kn+vn+T]=Le,c[kn+rn+T]=Be,c[kn+"dblclick"+T]=v,c.addEventListener(vn,Le,!!Ko&&{passive:!1}),c.addEventListener(rn,Be,!!Ko&&{passive:!1}),c.addEventListener("dblclick",v,!1)}(c,J,V):"addEventListener"in c?"touchstart"===v||"touchmove"===v||"wheel"===v||"mousewheel"===v?c.addEventListener(ha[v]||v,J,!!Ko&&{passive:!1}):"mouseenter"===v||"mouseleave"===v?c.addEventListener(ha[v],J=function(Le){Le=Le||window.event,fa(c,Le)&&me(Le)},!1):c.addEventListener(v,me,!1):"attachEvent"in c&&c.attachEvent("on"+v,J),c[Ti]=c[Ti]||{},c[Ti][V]=J}function zl(c,v,T,P){var V=v+Qt(T)+(P?"_"+Qt(P):""),J=c[Ti]&&c[Ti][V];if(!J)return this;Kr&&0===v.indexOf("touch")?function(c,v,T){var P=c["_leaflet_"+v+T];"touchstart"===v?c.removeEventListener(le,P,!1):"touchmove"===v?c.removeEventListener(ge,P,!1):"touchend"===v&&(c.removeEventListener(ve,P,!1),c.removeEventListener(Ee,P,!1))}(c,v,V):Ft&&"dblclick"===v&&!bn()?function(c,v){var P=c[kn+rn+v],V=c[kn+"dblclick"+v];c.removeEventListener(vn,c[kn+vn+v],!!Ko&&{passive:!1}),c.removeEventListener(rn,P,!!Ko&&{passive:!1}),c.removeEventListener("dblclick",V,!1)}(c,V):"removeEventListener"in c?c.removeEventListener(ha[v]||v,J,!1):"detachEvent"in c&&c.detachEvent("on"+v,J),c[Ti][V]=null}function da(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,er(c),this}function Bl(c){return Ps(c,"wheel",da),this}function Yr(c){return mn(c,"mousedown touchstart dblclick",da),Ps(c,"click",dl),this}function zi(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function ks(c){return zi(c),da(c),this}function Qi(c,v){if(!v)return new Dt(c.clientX,c.clientY);var T=cs(v),P=T.boundingClientRect;return new Dt((c.clientX-P.left)/T.x-v.clientLeft,(c.clientY-P.top)/T.y-v.clientTop)}var Ih=Fa&&Xr?2*window.devicePixelRatio:Er?window.devicePixelRatio:1;function Vl(c){return go?c.wheelDeltaY/2:c.deltaY&&0===c.deltaMode?-c.deltaY/Ih:c.deltaY&&1===c.deltaMode?20*-c.deltaY:c.deltaY&&2===c.deltaMode?60*-c.deltaY:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?20*-c.detail:c.detail?c.detail/-32765*60:0}var Jr={};function dl(c){Jr[c.type]=!0}function er(c){var v=Jr[c.type];return Jr[c.type]=!1,v}function fa(c,v){var T=v.relatedTarget;if(!T)return!0;try{for(;T&&T!==c;)T=T.parentNode}catch(P){return!1}return T!==c}var Lo={on:mn,off:On,stopPropagation:da,disableScrollPropagation:Bl,disableClickPropagation:Yr,preventDefault:zi,stop:ks,getMousePosition:Qi,getWheelDelta:Vl,fakeStop:dl,skipped:er,isExternalTarget:fa,addListener:mn,removeListener:On},Et=tn.extend({run:function(c,v,T,P){this.stop(),this._el=c,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(P||.5,.2),this._startPos=Ni(c),this._offset=v.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=si(this._animate,this),this._step()},_step:function(c){var v=+new Date-this._startTime,T=1e3*this._duration;v<T?this._runFrame(this._easeOut(v/T),c):(this._runFrame(1),this._complete())},_runFrame:function(c,v){var T=this._startPos.add(this._offset.multiplyBy(c));v&&T._round(),cn(this._el,T),this.fire("step")},_complete:function(){Zi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),It=tn.extend({options:{crs:Zo,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,v){v=Yn(this,v),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=p(this._onResize,this),this._initEvents(),v.maxBounds&&this.setMaxBounds(v.maxBounds),void 0!==v.zoom&&(this._zoom=this._limitZoom(v.zoom)),v.center&&void 0!==v.zoom&&this.setView(Gn(v.center),v.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ct&&lr&&!ls&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),mn(this._proxy,xn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,v,T){return v=void 0===v?this._zoom:this._limitZoom(v),c=this._limitCenter(Gn(c),v,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&!0!==T&&(void 0!==T.animate&&(T.zoom=Hn({animate:T.animate},T.zoom),T.pan=Hn({animate:T.animate,duration:T.duration},T.pan)),this._zoom!==v?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,v,T.zoom):this._tryAnimatedPan(c,T.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(c,v),this)},setZoom:function(c,v){return this._loaded?this.setView(this.getCenter(),c,{zoom:v}):(this._zoom=c,this)},zoomIn:function(c,v){return this.setZoom(this._zoom+(c=c||(lr?this.options.zoomDelta:1)),v)},zoomOut:function(c,v){return this.setZoom(this._zoom-(c=c||(lr?this.options.zoomDelta:1)),v)},setZoomAround:function(c,v,T){var P=this.getZoomScale(v),V=this.getSize().divideBy(2),me=(c instanceof Dt?c:this.latLngToContainerPoint(c)).subtract(V).multiplyBy(1-1/P),Le=this.containerPointToLatLng(V.add(me));return this.setView(Le,v,{zoom:T})},_getBoundsCenterZoom:function(c,v){v=v||{},c=c.getBounds?c.getBounds():li(c);var T=nn(v.paddingTopLeft||v.padding||[0,0]),P=nn(v.paddingBottomRight||v.padding||[0,0]),V=this.getBoundsZoom(c,!1,T.add(P));if((V="number"==typeof v.maxZoom?Math.min(v.maxZoom,V):V)===1/0)return{center:c.getCenter(),zoom:V};var J=P.subtract(T).divideBy(2),me=this.project(c.getSouthWest(),V),Le=this.project(c.getNorthEast(),V);return{center:this.unproject(me.add(Le).divideBy(2).add(J),V),zoom:V}},fitBounds:function(c,v){if(!(c=li(c)).isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(c,v);return this.setView(T.center,T.zoom,v)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,v){return this.setView(c,this._zoom,{pan:v})},panBy:function(c,v){if(v=v||{},!(c=nn(c).round()).x&&!c.y)return this.fire("moveend");if(!0!==v.animate&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Et,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),v.noMoveStart||this.fire("movestart"),!1!==v.animate){Ut(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,T,v.duration||.25,v.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,v,T){if(!1===(T=T||{}).animate||!lr)return this.setView(c,v,T);this._stop();var P=this.project(this.getCenter()),V=this.project(c),J=this.getSize(),me=this._zoom;c=Gn(c),v=void 0===v?me:v;var Le=Math.max(J.x,J.y),Be=Le*this.getZoomScale(me,v),Me=V.distanceTo(P)||1,gt=1.42,Tt=gt*gt;function un(xi){var Ka=(Be*Be-Le*Le+(xi?-1:1)*Tt*Tt*Me*Me)/(2*(xi?Be:Le)*Tt*Me),Ic=Math.sqrt(Ka*Ka+1)-Ka;return Ic<1e-9?-18:Math.log(Ic)}function ei(xi){return(Math.exp(xi)-Math.exp(-xi))/2}function pr(xi){return(Math.exp(xi)+Math.exp(-xi))/2}var no=un(0);function Yl(xi){return Le*(pr(no)*function(xi){return ei(xi)/pr(xi)}(no+gt*xi)-ei(no))/Tt}var Qu=Date.now(),va=(un(1)-no)/gt,Jl=T.duration?1e3*T.duration:1e3*va*.8;return this._moveStart(!0,T.noMoveStart),function Wa(){var xi=(Date.now()-Qu)/Jl,xa=function(xi){return 1-Math.pow(1-xi,1.5)}(xi)*va;xi<=1?(this._flyToFrame=si(Wa,this),this._move(this.unproject(P.add(V.subtract(P).multiplyBy(Yl(xa)/Me)),me),this.getScaleZoom(Le/function(xi){return Le*(pr(no)/pr(no+gt*xi))}(xa),me),{flyTo:!0})):this._move(c,v)._moveEnd(!0)}.call(this),this},flyToBounds:function(c,v){var T=this._getBoundsCenterZoom(c,v);return this.flyTo(T.center,T.zoom,v)},setMaxBounds:function(c){return(c=li(c)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(c){var v=this.options.minZoom;return this.options.minZoom=c,this._loaded&&v!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var v=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&v!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,v){this._enforcingBounds=!0;var T=this.getCenter(),P=this._limitCenter(T,this._zoom,li(c));return T.equals(P)||this.panTo(P,v),this._enforcingBounds=!1,this},panInside:function(c,v){var T=nn((v=v||{}).paddingTopLeft||v.padding||[0,0]),P=nn(v.paddingBottomRight||v.padding||[0,0]),V=this.getCenter(),J=this.project(V),me=this.project(c),Le=this.getPixelBounds(),Be=Le.getSize().divideBy(2),Me=ki([Le.min.add(T),Le.max.subtract(P)]);if(!Me.contains(me)){this._enforcingBounds=!0;var gt=J.subtract(me),Tt=nn(me.x+gt.x,me.y+gt.y);(me.x<Me.min.x||me.x>Me.max.x)&&(Tt.x=J.x-gt.x,gt.x>0?Tt.x+=Be.x-T.x:Tt.x-=Be.x-P.x),(me.y<Me.min.y||me.y>Me.max.y)&&(Tt.y=J.y-gt.y,gt.y>0?Tt.y+=Be.y-T.y:Tt.y-=Be.y-P.y),this.panTo(this.unproject(Tt),v),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=Hn({animate:!1,pan:!0},!0===c?{animate:!0}:c);var v=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),P=v.divideBy(2).round(),V=T.divideBy(2).round(),J=P.subtract(V);return J.x||J.y?(c.animate&&c.pan?this.panBy(J):(c.pan&&this._rawPanBy(J),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(p(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:v,newSize:T})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=Hn({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var v=p(this._handleGeolocationResponse,this),T=p(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(v,T,c):navigator.geolocation.getCurrentPosition(v,T,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){var v=c.code,T=c.message||(1===v?"permission denied":2===v?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:v,message:"Geolocation error: "+T+"."})},_handleGeolocationResponse:function(c){var P=new Sn(c.coords.latitude,c.coords.longitude),V=P.toBounds(2*c.coords.accuracy),J=this._locateOptions;if(J.setView){var me=this.getBoundsZoom(V);this.setView(P,J.maxZoom?Math.min(me,J.maxZoom):me)}var Le={latlng:P,bounds:V,timestamp:c.timestamp};for(var Be in c.coords)"number"==typeof c.coords[Be]&&(Le[Be]=c.coords[Be]);this.fire("locationfound",Le)},addHandler:function(c,v){if(!v)return this;var T=this[c]=new v(this);return this._handlers.push(T),this.options[c]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(v){this._container._leaflet_id=void 0,this._containerId=void 0}var c;for(c in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Zi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[c].remove();for(c in this._panes)mt(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,v){var P=An("div","leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),v||this._mapPane);return c&&(this._panes[c]=P),P},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds();return new Ri(this.unproject(c.getBottomLeft()),this.unproject(c.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,v,T){c=li(c),T=nn(T||[0,0]);var P=this.getZoom()||0,V=this.getMinZoom(),J=this.getMaxZoom(),me=c.getNorthWest(),Le=c.getSouthEast(),Be=this.getSize().subtract(T),Me=ki(this.project(Le,P),this.project(me,P)).getSize(),gt=lr?this.options.zoomSnap:1,Tt=Be.x/Me.x,un=Be.y/Me.y,ei=v?Math.max(Tt,un):Math.min(Tt,un);return P=this.getScaleZoom(ei,P),gt&&(P=Math.round(P/(gt/100))*(gt/100),P=v?Math.ceil(P/gt)*gt:Math.floor(P/gt)*gt),Math.max(V,Math.min(J,P))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Dt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,v){var T=this._getTopLeftPoint(c,v);return new zt(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(void 0===c?this.getZoom():c)},getPane:function(c){return"string"==typeof c?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,v){var T=this.options.crs;return v=void 0===v?this._zoom:v,T.scale(c)/T.scale(v)},getScaleZoom:function(c,v){var T=this.options.crs,P=T.zoom(c*T.scale(v=void 0===v?this._zoom:v));return isNaN(P)?1/0:P},project:function(c,v){return v=void 0===v?this._zoom:v,this.options.crs.latLngToPoint(Gn(c),v)},unproject:function(c,v){return v=void 0===v?this._zoom:v,this.options.crs.pointToLatLng(nn(c),v)},layerPointToLatLng:function(c){var v=nn(c).add(this.getPixelOrigin());return this.unproject(v)},latLngToLayerPoint:function(c){return this.project(Gn(c))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(Gn(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(li(c))},distance:function(c,v){return this.options.crs.distance(Gn(c),Gn(v))},containerPointToLayerPoint:function(c){return nn(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return nn(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var v=this.containerPointToLayerPoint(nn(c));return this.layerPointToLatLng(v)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Gn(c)))},mouseEventToContainerPoint:function(c){return Qi(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var v=this._container=cr(c);if(!v)throw new Error("Map container not found.");if(v._leaflet_id)throw new Error("Map container is already initialized.");mn(v,"scroll",this._onScroll,this),this._containerId=Qt(v)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&lr,Ut(c,"leaflet-container"+(Ft?" leaflet-touch":"")+(Tr?" leaflet-retina":"")+(ta?" leaflet-oldie":"")+(ia?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var v=Vt(c,"position");"absolute"!==v&&"relative"!==v&&"fixed"!==v&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),cn(this._mapPane,new Dt(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ut(c.markerPane,"leaflet-zoom-hide"),Ut(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,v){cn(this._mapPane,new Dt(0,0));var T=!this._loaded;this._loaded=!0,v=this._limitZoom(v),this.fire("viewprereset");var P=this._zoom!==v;this._moveStart(P,!1)._move(c,v)._moveEnd(P),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(c,v){return c&&this.fire("zoomstart"),v||this.fire("movestart"),this},_move:function(c,v,T){void 0===v&&(v=this._zoom);var P=this._zoom!==v;return this._zoom=v,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),(P||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Zi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){cn(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[Qt(this._container)]=this;var v=c?On:mn;v(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&v(window,"resize",this._onResize,this),lr&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Zi(this._resizeRequest),this._resizeRequest=si(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,v){for(var P,T=[],V="mouseout"===v||"mouseover"===v,J=c.target||c.srcElement,me=!1;J;){if((P=this._targets[Qt(J)])&&("click"===v||"preclick"===v)&&!c._simulated&&this._draggableMoved(P)){me=!0;break}if(P&&P.listens(v,!0)&&(V&&!fa(J,c)||(T.push(P),V))||J===this._container)break;J=J.parentNode}return!T.length&&!me&&!V&&fa(J,c)&&(T=[this]),T},_handleDOMEvent:function(c){if(this._loaded&&!er(c)){var v=c.type;("mousedown"===v||"keypress"===v||"keyup"===v||"keydown"===v)&&Na(c.target||c.srcElement),this._fireDOMEvent(c,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,v,T){if("click"===c.type){var P=Hn({},c);P.type="preclick",this._fireDOMEvent(P,P.type,T)}if(!c._stopped&&(T=(T||[]).concat(this._findEventTargets(c,v))).length){var V=T[0];"contextmenu"===v&&V.listens(v,!0)&&zi(c);var J={originalEvent:c};if("keypress"!==c.type&&"keydown"!==c.type&&"keyup"!==c.type){var me=V.getLatLng&&(!V._radius||V._radius<=10);J.containerPoint=me?this.latLngToContainerPoint(V.getLatLng()):this.mouseEventToContainerPoint(c),J.layerPoint=this.containerPointToLayerPoint(J.containerPoint),J.latlng=me?V.getLatLng():this.layerPointToLatLng(J.layerPoint)}for(var Le=0;Le<T.length;Le++)if(T[Le].fire(v,J,!0),J.originalEvent._stopped||!1===T[Le].options.bubblingMouseEvents&&-1!==Po(this._mouseEvents,v))return}},_draggableMoved:function(c){return(c=c.dragging&&c.dragging.enabled()?c:this).dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,v=this._handlers.length;c<v;c++)this._handlers[c].disable()},whenReady:function(c,v){return this._loaded?c.call(v||this,{target:this}):this.on("load",c,v),this},_getMapPanePos:function(){return Ni(this._mapPane)||new Dt(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,v){return(c&&void 0!==v?this._getNewPixelOrigin(c,v):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,v){var T=this.getSize()._divideBy(2);return this.project(c,v)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,v,T){var P=this._getNewPixelOrigin(T,v);return this.project(c,v)._subtract(P)},_latLngBoundsToNewLayerBounds:function(c,v,T){var P=this._getNewPixelOrigin(T,v);return ki([this.project(c.getSouthWest(),v)._subtract(P),this.project(c.getNorthWest(),v)._subtract(P),this.project(c.getSouthEast(),v)._subtract(P),this.project(c.getNorthEast(),v)._subtract(P)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,v,T){if(!T)return c;var P=this.project(c,v),V=this.getSize().divideBy(2),J=new zt(P.subtract(V),P.add(V)),me=this._getBoundsOffset(J,T,v);return me.round().equals([0,0])?c:this.unproject(P.add(me),v)},_limitOffset:function(c,v){if(!v)return c;var T=this.getPixelBounds(),P=new zt(T.min.add(c),T.max.add(c));return c.add(this._getBoundsOffset(P,v))},_getBoundsOffset:function(c,v,T){var P=ki(this.project(v.getNorthEast(),T),this.project(v.getSouthWest(),T)),V=P.min.subtract(c.min),J=P.max.subtract(c.max);return new Dt(this._rebound(V.x,-J.x),this._rebound(V.y,-J.y))},_rebound:function(c,v){return c+v>0?Math.round(c-v)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(v))},_limitZoom:function(c){var v=this.getMinZoom(),T=this.getMaxZoom(),P=lr?this.options.zoomSnap:1;return P&&(c=Math.round(c/P)*P),Math.max(v,Math.min(T,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Qn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,v){var T=this._getCenterOffset(c)._trunc();return!(!0!==(v&&v.animate)&&!this.getSize().contains(T)||(this.panBy(T,v),0))},_createAnimProxy:function(){var c=this._proxy=An("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(v){var T=Gt,P=this._proxy.style[T];wt(this._proxy,this.project(v.center,v.zoom),this.getZoomScale(v.zoom,1)),P===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),v=this.getZoom();wt(this._proxy,this.project(c,v),this.getZoomScale(v,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,v,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||!1===T.animate||this._nothingToAnimate()||Math.abs(v-this._zoom)>this.options.zoomAnimationThreshold)return!1;var P=this.getZoomScale(v),V=this._getCenterOffset(c)._divideBy(1-1/P);return!(!0!==T.animate&&!this.getSize().contains(V)||(si(function(){this._moveStart(!0,!1)._animateZoom(c,v,!0)},this),0))},_animateZoom:function(c,v,T,P){!this._mapPane||(T&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=v,Ut(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:v,noUpdate:P}),setTimeout(p(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&Qn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),si(function(){this._moveEnd(!0)},this))}});var Mt=Pi.extend({options:{position:"topright"},initialize:function(c){Yn(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var v=this._map;return v&&v.removeControl(this),this.options.position=c,v&&v.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var v=this._container=this.onAdd(c),T=this.getPosition(),P=c._controlCorners[T];return Ut(v,"leaflet-control"),-1!==T.indexOf("bottom")?P.insertBefore(v,P.firstChild):P.appendChild(v),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),Qr=function(c){return new Mt(c)};It.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},v="leaflet-",T=this._controlContainer=An("div",v+"control-container",this._container);function P(V,J){c[V+J]=An("div",v+V+" "+v+J,T)}P("top","left"),P("top","right"),P("bottom","left"),P("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)mt(this._controlCorners[c]);mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Vr=Mt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,v,T,P){return T<P?-1:P<T?1:0}},initialize:function(c,v,T){for(var P in Yn(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,c)this._addLayer(c[P],P);for(P in v)this._addLayer(v[P],P,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var v=0;v<this._layers.length;v++)this._layers[v].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return Mt.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,v){return this._addLayer(c,v),this._map?this._update():this},addOverlay:function(c,v){return this._addLayer(c,v,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var v=this._getLayer(Qt(c));return v&&this._layers.splice(this._layers.indexOf(v),1),this._map?this._update():this},expand:function(){Ut(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(Ut(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):Qn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Qn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",v=this._container=An("div",c),T=this.options.collapsed;v.setAttribute("aria-haspopup",!0),Yr(v),Bl(v);var P=this._section=An("section",c+"-list");T&&(this._map.on("click",this.collapse,this),_o||mn(v,{mouseenter:this.expand,mouseleave:this.collapse},this));var V=this._layersLink=An("a",c+"-toggle",v);V.href="#",V.title="Layers",Ft?(mn(V,"click",ks),mn(V,"click",this.expand,this)):mn(V,"focus",this.expand,this),T||this.expand(),this._baseLayersList=An("div",c+"-base",P),this._separator=An("div",c+"-separator",P),this._overlaysList=An("div",c+"-overlays",P),v.appendChild(P)},_getLayer:function(c){for(var v=0;v<this._layers.length;v++)if(this._layers[v]&&Qt(this._layers[v].layer)===c)return this._layers[v]},_addLayer:function(c,v,T){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:v,overlay:T}),this.options.sortLayers&&this._layers.sort(p(function(P,V){return this.options.sortFunction(P.layer,V.layer,P.name,V.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;la(this._baseLayersList),la(this._overlaysList),this._layerControlInputs=[];var c,v,T,P,V=0;for(T=0;T<this._layers.length;T++)this._addItem(P=this._layers[T]),v=v||P.overlay,c=c||!P.overlay,V+=P.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(c=c&&V>1)?"":"none"),this._separator.style.display=v&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var v=this._getLayer(Qt(c.target)),T=v.overlay?"add"===c.type?"overlayadd":"overlayremove":"add"===c.type?"baselayerchange":null;T&&this._map.fire(T,v)},_createRadioElement:function(c,v){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(v?' checked="checked"':"")+"/>",P=document.createElement("div");return P.innerHTML=T,P.firstChild},_addItem:function(c){var P,v=document.createElement("label"),T=this._map.hasLayer(c.layer);c.overlay?((P=document.createElement("input")).type="checkbox",P.className="leaflet-control-layers-selector",P.defaultChecked=T):P=this._createRadioElement("leaflet-base-layers_"+Qt(this),T),this._layerControlInputs.push(P),P.layerId=Qt(c.layer),mn(P,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+c.name;var J=document.createElement("div");return v.appendChild(J),J.appendChild(P),J.appendChild(V),(c.overlay?this._overlaysList:this._baseLayersList).appendChild(v),this._checkDisabledLayers(),v},_onInputClick:function(){var v,T,c=this._layerControlInputs,P=[],V=[];this._handlingClick=!0;for(var J=c.length-1;J>=0;J--)T=this._getLayer((v=c[J]).layerId).layer,v.checked?P.push(T):v.checked||V.push(T);for(J=0;J<V.length;J++)this._map.hasLayer(V[J])&&this._map.removeLayer(V[J]);for(J=0;J<P.length;J++)this._map.hasLayer(P[J])||this._map.addLayer(P[J]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var v,T,c=this._layerControlInputs,P=this._map.getZoom(),V=c.length-1;V>=0;V--)T=this._getLayer((v=c[V]).layerId).layer,v.disabled=void 0!==T.options.minZoom&&P<T.options.minZoom||void 0!==T.options.maxZoom&&P>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Wi=Mt.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(c){var v="leaflet-control-zoom",T=An("div",v+" leaflet-bar"),P=this.options;return this._zoomInButton=this._createButton(P.zoomInText,P.zoomInTitle,v+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(P.zoomOutText,P.zoomOutTitle,v+"-out",T,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,v,T,P,V){var J=An("a",T,P);return J.innerHTML=c,J.href="#",J.title=v,J.setAttribute("role","button"),J.setAttribute("aria-label",v),Yr(J),mn(J,"click",ks),mn(J,"click",V,this),mn(J,"click",this._refocusOnMap,this),J},_updateDisabled:function(){var c=this._map,v="leaflet-disabled";Qn(this._zoomInButton,v),Qn(this._zoomOutButton,v),(this._disabled||c._zoom===c.getMinZoom())&&Ut(this._zoomOutButton,v),(this._disabled||c._zoom===c.getMaxZoom())&&Ut(this._zoomInButton,v)}});It.mergeOptions({zoomControl:!0}),It.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Wi,this.addControl(this.zoomControl))});var Wt=Mt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var v="leaflet-control-scale",T=An("div",v),P=this.options;return this._addScales(P,v+"-line",T),c.on(P.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),T},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,v,T){c.metric&&(this._mScale=An("div",v,T)),c.imperial&&(this._iScale=An("div",v,T))},_update:function(){var c=this._map,v=c.getSize().y/2,T=c.distance(c.containerPointToLatLng([0,v]),c.containerPointToLatLng([this.options.maxWidth,v]));this._updateScales(T)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var v=this._getRoundNum(c);this._updateScale(this._mScale,v<1e3?v+" m":v/1e3+" km",v/c)},_updateImperial:function(c){var T,P,V,v=3.2808399*c;v>5280?(P=this._getRoundNum(T=v/5280),this._updateScale(this._iScale,P+" mi",P/T)):(V=this._getRoundNum(v),this._updateScale(this._iScale,V+" ft",V/v))},_updateScale:function(c,v,T){c.style.width=Math.round(this.options.maxWidth*T)+"px",c.innerHTML=v},_getRoundNum:function(c){var v=Math.pow(10,(Math.floor(c)+"").length-1),T=c/v;return v*(T>=10?10:T>=5?5:T>=3?3:T>=2?2:1)}}),nr=Mt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(c){Yn(this,c),this._attributions={}},onAdd:function(c){for(var v in c.attributionControl=this,this._container=An("div","leaflet-control-attribution"),Yr(this._container),c._layers)c._layers[v].getAttribution&&this.addAttribution(c._layers[v].getAttribution());return this._update(),this._container},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var v in this._attributions)this._attributions[v]&&c.push(v);var T=[];this.options.prefix&&T.push(this.options.prefix),c.length&&T.push(c.join(", ")),this._container.innerHTML=T.join(" | ")}}});It.mergeOptions({attributionControl:!0}),It.addInitHook(function(){this.options.attributionControl&&(new nr).addTo(this)});Mt.Layers=Vr,Mt.Zoom=Wi,Mt.Scale=Wt,Mt.Attribution=nr,Qr.layers=function(c,v,T){return new Vr(c,v,T)},Qr.zoom=function(c){return new Wi(c)},Qr.scale=function(c){return new Wt(c)},Qr.attribution=function(c){return new nr(c)};var Zn=Pi.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Zn.addTo=function(c,v){return c.addHandler(v,this),this};var Oo,us={Events:_i},yi=Ft?"touchstart mousedown":"mousedown",fl={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Yo={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Lt=tn.extend({options:{clickTolerance:3},initialize:function(c,v,T,P){Yn(this,P),this._element=c,this._dragStartTarget=v||c,this._preventOutline=T},enable:function(){this._enabled||(mn(this._dragStartTarget,yi,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(Lt._dragging===this&&this.finishDrag(),On(this._dragStartTarget,yi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(!c._simulated&&this._enabled&&(this._moved=!1,!Nl(this._element,"leaflet-zoom-anim")&&!(Lt._dragging||c.shiftKey||1!==c.which&&1!==c.button&&!c.touches)&&(Lt._dragging=this,this._preventOutline&&Na(this._element),Ei(),vo(),!this._moving))){this.fire("down");var v=c.touches?c.touches[0]:c,T=Wu(this._element);this._startPoint=new Dt(v.clientX,v.clientY),this._parentScale=cs(T),mn(document,Yo[c.type],this._onMove,this),mn(document,fl[c.type],this._onUp,this)}},_onMove:function(c){if(!c._simulated&&this._enabled){if(c.touches&&c.touches.length>1)return void(this._moved=!0);var v=c.touches&&1===c.touches.length?c.touches[0]:c,T=new Dt(v.clientX,v.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,zi(c),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Ni(this._element).subtract(T),Ut(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ut(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,Zi(this._animRequest),this._lastEvent=c,this._animRequest=si(this._updatePosition,this,!0))}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),cn(this._element,this._newPos),this.fire("drag",c)},_onUp:function(c){c._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){for(var c in Qn(document.body,"leaflet-dragging"),this._lastTarget&&(Qn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Yo)On(document,Yo[c],this._onMove,this),On(document,fl[c],this._onUp,this);Ji(),Is(),this._moved&&this._moving&&(Zi(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Lt._dragging=!1}});function pa(c,v){if(!v||!c.length)return c.slice();var T=v*v;return function(c,v){var T=c.length,V=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(T);V[0]=V[T-1]=1,Sr(c,V,v,0,T-1);var J,me=[];for(J=0;J<T;J++)V[J]&&me.push(c[J]);return me}(c=function(c,v){for(var T=[c[0]],P=1,V=0,J=c.length;P<J;P++)Cc(c[P],c[V])>v&&(T.push(c[P]),V=P);return V<J-1&&T.push(c[J-1]),T}(c,T),T)}function hs(c,v,T){return Math.sqrt(Jo(c,v,T,!0))}function Sr(c,v,T,P,V){var me,Le,Be,J=0;for(Le=P+1;Le<=V-1;Le++)(Be=Jo(c[Le],c[P],c[V],!0))>J&&(me=Le,J=Be);J>T&&(v[me]=1,Sr(c,v,T,P,me),Sr(c,v,T,me,V))}function xo(c,v,T,P,V){var Le,Be,Me,J=P?Oo:Ls(c,T),me=Ls(v,T);for(Oo=me;;){if(!(J|me))return[c,v];if(J&me)return!1;Me=Ls(Be=en(c,v,Le=J||me,T,V),T),Le===J?(c=Be,J=Me):(v=Be,me=Me)}}function en(c,v,T,P,V){var Me,gt,J=v.x-c.x,me=v.y-c.y,Le=P.min,Be=P.max;return 8&T?(Me=c.x+J*(Be.y-c.y)/me,gt=Be.y):4&T?(Me=c.x+J*(Le.y-c.y)/me,gt=Le.y):2&T?(Me=Be.x,gt=c.y+me*(Be.x-c.x)/J):1&T&&(Me=Le.x,gt=c.y+me*(Le.x-c.x)/J),new Dt(Me,gt,V)}function Ls(c,v){var T=0;return c.x<v.min.x?T|=1:c.x>v.max.x&&(T|=2),c.y<v.min.y?T|=4:c.y>v.max.y&&(T|=8),T}function Cc(c,v){var T=v.x-c.x,P=v.y-c.y;return T*T+P*P}function Jo(c,v,T,P){var Me,V=v.x,J=v.y,me=T.x-V,Le=T.y-J,Be=me*me+Le*Le;return Be>0&&((Me=((c.x-V)*me+(c.y-J)*Le)/Be)>1?(V=T.x,J=T.y):Me>0&&(V+=me*Me,J+=Le*Me)),me=c.x-V,Le=c.y-J,P?me*me+Le*Le:new Dt(V,J)}function eo(c){return!ar(c[0])||"object"!=typeof c[0][0]&&void 0!==c[0][0]}function ga(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),eo(c)}var Ba={simplify:pa,pointToSegmentDistance:hs,closestPointOnSegment:function(c,v,T){return Jo(c,v,T)},clipSegment:xo,_getEdgeIntersection:en,_getBitCode:Ls,_sqClosestPointOnSegment:Jo,isFlat:eo,_flat:ga};function fs(c,v,T){var P,J,me,Le,Be,Me,gt,Tt,un,V=[1,4,2,8];for(J=0,gt=c.length;J<gt;J++)c[J]._code=Ls(c[J],v);for(Le=0;Le<4;Le++){for(Tt=V[Le],P=[],J=0,me=(gt=c.length)-1;J<gt;me=J++)Me=c[me],(Be=c[J])._code&Tt?Me._code&Tt||((un=en(Me,Be,Tt,v,T))._code=Ls(un,v),P.push(un)):(Me._code&Tt&&((un=en(Me,Be,Tt,v,T))._code=Ls(un,v),P.push(un)),P.push(Be));c=P}return c}var Xi={clipPolygon:fs},Va={project:function(c){return new Dt(c.lng,c.lat)},unproject:function(c){return new Sn(c.y,c.x)},bounds:new zt([-180,-90],[180,90])},bo={R:6378137,R_MINOR:6356752.314245179,bounds:new zt([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(c){var v=Math.PI/180,T=this.R,P=c.lat*v,V=this.R_MINOR/T,J=Math.sqrt(1-V*V),me=J*Math.sin(P),Le=Math.tan(Math.PI/4-P/2)/Math.pow((1-me)/(1+me),J/2);return P=-T*Math.log(Math.max(Le,1e-10)),new Dt(c.lng*v*T,P)},unproject:function(c){for(var Me,v=180/Math.PI,T=this.R,P=this.R_MINOR/T,V=Math.sqrt(1-P*P),J=Math.exp(-c.y/T),me=Math.PI/2-2*Math.atan(J),Le=0,Be=.1;Le<15&&Math.abs(Be)>1e-7;Le++)Me=V*Math.sin(me),Me=Math.pow((1-Me)/(1+Me),V/2),me+=Be=Math.PI/2-2*Math.atan(J*Me)-me;return new Sn(me*v,c.x*v/T)}},wo={LonLat:Va,Mercator:bo,SphericalMercator:Ra},_a=Hn({},Wr,{code:"EPSG:3395",projection:bo,transformation:function(){var c=.5/(Math.PI*bo.R);return qi(c,.5,-c,.5)}()}),jl=Hn({},Wr,{code:"EPSG:4326",projection:Va,transformation:qi(1/180,1,-1/180,.5)}),$l=Hn({},jt,{projection:Va,transformation:qi(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,v){var T=v.lng-c.lng,P=v.lat-c.lat;return Math.sqrt(T*T+P*P)},infinite:!0});jt.Earth=Wr,jt.EPSG3395=_a,jt.EPSG3857=Zo,jt.EPSG900913=Mn,jt.EPSG4326=jl,jt.Simple=$l;var Di=tn.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[Qt(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[Qt(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var v=c.target;if(v.hasLayer(this)){if(this._map=v,this._zoomAnimated=v._zoomAnimated,this.getEvents){var T=this.getEvents();v.on(T,this),this.once("remove",function(){v.off(T,this)},this)}this.onAdd(v),this.getAttribution&&v.attributionControl&&v.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),v.fire("layeradd",{layer:this})}}});It.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var v=Qt(c);return this._layers[v]||(this._layers[v]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c)),this},removeLayer:function(c){var v=Qt(c);return this._layers[v]?(this._loaded&&c.onRemove(this),c.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(c.getAttribution()),delete this._layers[v],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return!!c&&Qt(c)in this._layers},eachLayer:function(c,v){for(var T in this._layers)c.call(v,this._layers[T]);return this},_addLayers:function(c){for(var v=0,T=(c=c?ar(c)?c:[c]:[]).length;v<T;v++)this.addLayer(c[v])},_addZoomLimit:function(c){(isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[Qt(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var v=Qt(c);this._zoomBoundLayers[v]&&(delete this._zoomBoundLayers[v],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,v=-1/0,T=this._getZoomSpan();for(var P in this._zoomBoundLayers){var V=this._zoomBoundLayers[P].options;c=void 0===V.minZoom?c:Math.min(c,V.minZoom),v=void 0===V.maxZoom?v:Math.max(v,V.maxZoom)}this._layersMaxZoom=v===-1/0?void 0:v,this._layersMinZoom=c===1/0?void 0:c,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var pl=Di.extend({initialize:function(c,v){var T,P;if(Yn(this,v),this._layers={},c)for(T=0,P=c.length;T<P;T++)this.addLayer(c[T])},addLayer:function(c){var v=this.getLayerId(c);return this._layers[v]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var v=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[v]&&this._map.removeLayer(this._layers[v]),delete this._layers[v],this},hasLayer:function(c){return!!c&&("number"==typeof c?c:this.getLayerId(c))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var T,P,v=Array.prototype.slice.call(arguments,1);for(T in this._layers)(P=this._layers[T])[c]&&P[c].apply(P,v);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,v){for(var T in this._layers)c.call(v,this._layers[T]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return Qt(c)}}),ml=pl.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),pl.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),pl.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new Ri;for(var v in this._layers){var T=this._layers[v];c.extend(T.getBounds?T.getBounds():T.getLatLng())}return c}}),ps=Pi.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(c){Yn(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,v){var T=this._getIconUrl(c);if(!T){if("icon"===c)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var P=this._createImg(T,v&&"IMG"===v.tagName?v:null);return this._setIconStyles(P,c),P},_setIconStyles:function(c,v){var T=this.options,P=T[v+"Size"];"number"==typeof P&&(P=[P,P]);var V=nn(P),J=nn("shadow"===v&&T.shadowAnchor||T.iconAnchor||V&&V.divideBy(2,!0));c.className="leaflet-marker-"+v+" "+(T.className||""),J&&(c.style.marginLeft=-J.x+"px",c.style.marginTop=-J.y+"px"),V&&(c.style.width=V.x+"px",c.style.height=V.y+"px")},_createImg:function(c,v){return(v=v||document.createElement("img")).src=c,v},_getIconUrl:function(c){return Tr&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});var _l=ps.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return _l.imagePath||(_l.imagePath=this._detectIconPath()),(this.options.imagePath||_l.imagePath)+ps.prototype._getIconUrl.call(this,c)},_detectIconPath:function(){var c=An("div","leaflet-default-icon-path",document.body),v=Vt(c,"background-image")||Vt(c,"backgroundImage");return document.body.removeChild(c),null===v||0!==v.indexOf("url")?"":v.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Xu=Zn.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new Lt(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ut(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Qn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var v=this._marker,T=v._map,P=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,J=Ni(v._icon),me=T.getPixelBounds(),Le=T.getPixelOrigin(),Be=ki(me.min._subtract(Le).add(V),me.max._subtract(Le).subtract(V));if(!Be.contains(J)){var Me=nn((Math.max(Be.max.x,J.x)-Be.max.x)/(me.max.x-Be.max.x)-(Math.min(Be.min.x,J.x)-Be.min.x)/(me.min.x-Be.min.x),(Math.max(Be.max.y,J.y)-Be.max.y)/(me.max.y-Be.max.y)-(Math.min(Be.min.y,J.y)-Be.min.y)/(me.min.y-Be.min.y)).multiplyBy(P);T.panBy(Me,{animate:!1}),this._draggable._newPos._add(Me),this._draggable._startPos._add(Me),cn(v._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=si(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(Zi(this._panRequest),this._panRequest=si(this._adjustPan.bind(this,c)))},_onDrag:function(c){var v=this._marker,T=v._shadow,P=Ni(v._icon),V=v._map.layerPointToLatLng(P);T&&cn(T,P),v._latlng=V,c.latlng=V,c.oldLatLng=this._oldLatLng,v.fire("move",c).fire("drag",c)},_onDragEnd:function(c){Zi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Hl=Di.extend({options:{icon:new _l,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,v){Yn(this,v),this._latlng=Gn(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var v=this._latlng;return this._latlng=Gn(c),this.update(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,v="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=c.icon.createIcon(this._icon),P=!1;T!==this._icon&&(this._icon&&this._removeIcon(),P=!0,c.title&&(T.title=c.title),"IMG"===T.tagName&&(T.alt=c.alt||"")),Ut(T,v),c.keyboard&&(T.tabIndex="0"),this._icon=T,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var V=c.icon.createShadow(this._shadow),J=!1;V!==this._shadow&&(this._removeShadow(),J=!0),V&&(Ut(V,v),V.alt=""),this._shadow=V,c.opacity<1&&this._updateOpacity(),P&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&J&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mt(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&cn(this._icon,c),this._shadow&&cn(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(v)},_initInteraction:function(){if(this.options.interactive&&(Ut(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Xu)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Xu(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&Dr(this._icon,c),this._shadow&&Dr(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Os=Di.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return Yn(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Fs=Os.extend({options:{fill:!0,radius:10},initialize:function(c,v){Yn(this,v),this._latlng=Gn(c),this._radius=this.options.radius},setLatLng:function(c){var v=this._latlng;return this._latlng=Gn(c),this.redraw(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var v=c&&c.radius||this._radius;return Os.prototype.setStyle.call(this,c),this.setRadius(v),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,v=this._radiusY||c,T=this._clickTolerance(),P=[c+T,v+T];this._pxBounds=new zt(this._point.subtract(P),this._point.add(P))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Gl=Fs.extend({initialize:function(c,v,T){if("number"==typeof v&&(v=Hn({},T,{radius:v})),Yn(this,v),this._latlng=Gn(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new Ri(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:Os.prototype.setStyle,_project:function(){var c=this._latlng.lng,v=this._latlng.lat,T=this._map,P=T.options.crs;if(P.distance===Wr.distance){var V=Math.PI/180,J=this._mRadius/Wr.R/V,me=T.project([v+J,c]),Le=T.project([v-J,c]),Be=me.add(Le).divideBy(2),Me=T.unproject(Be).lat,gt=Math.acos((Math.cos(J*V)-Math.sin(v*V)*Math.sin(Me*V))/(Math.cos(v*V)*Math.cos(Me*V)))/V;(isNaN(gt)||0===gt)&&(gt=J/Math.cos(Math.PI/180*v)),this._point=Be.subtract(T.getPixelOrigin()),this._radius=isNaN(gt)?0:Be.x-T.project([Me,c-gt]).x,this._radiusY=Be.y-me.y}else{var Tt=P.unproject(P.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(Tt).x}this._updateBounds()}});var on=Os.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,v){Yn(this,v),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var V,J,v=1/0,T=null,P=Jo,me=0,Le=this._parts.length;me<Le;me++)for(var Be=this._parts[me],Me=1,gt=Be.length;Me<gt;Me++){var Tt=P(c,V=Be[Me-1],J=Be[Me],!0);Tt<v&&(v=Tt,T=P(c,V,J))}return T&&(T.distance=Math.sqrt(v)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var c,v,T,P,V,J,me,Le=this._rings[0],Be=Le.length;if(!Be)return null;for(c=0,v=0;c<Be-1;c++)v+=Le[c].distanceTo(Le[c+1])/2;if(0===v)return this._map.layerPointToLatLng(Le[0]);for(c=0,P=0;c<Be-1;c++)if((P+=T=(V=Le[c]).distanceTo(J=Le[c+1]))>v)return this._map.layerPointToLatLng([J.x-(me=(P-v)/T)*(J.x-V.x),J.y-me*(J.y-V.y)])},getBounds:function(){return this._bounds},addLatLng:function(c,v){return v=v||this._defaultShape(),c=Gn(c),v.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new Ri,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return eo(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var v=[],T=eo(c),P=0,V=c.length;P<V;P++)T?(v[P]=Gn(c[P]),this._bounds.extend(v[P])):v[P]=this._convertLatLngs(c[P]);return v},_project:function(){var c=new zt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),v=new Dt(c,c);this._pxBounds=new zt([this._rawPxBounds.min.subtract(v),this._rawPxBounds.max.add(v)])},_projectLatlngs:function(c,v,T){var J,me,V=c.length;if(c[0]instanceof Sn){for(me=[],J=0;J<V;J++)me[J]=this._map.latLngToLayerPoint(c[J]),T.extend(me[J]);v.push(me)}else for(J=0;J<V;J++)this._projectLatlngs(c[J],v,T)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);var T,P,V,J,me,Le,Be,v=this._parts;for(T=0,V=0,J=this._rings.length;T<J;T++)for(P=0,me=(Be=this._rings[T]).length;P<me-1;P++)(Le=xo(Be[P],Be[P+1],c,P,!0))&&(v[V]=v[V]||[],v[V].push(Le[0]),(Le[1]!==Be[P+1]||P===me-2)&&(v[V].push(Le[1]),V++))}},_simplifyPoints:function(){for(var c=this._parts,v=this.options.smoothFactor,T=0,P=c.length;T<P;T++)c[T]=pa(c[T],v)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,v){var T,P,V,J,me,Le,Be=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(T=0,J=this._parts.length;T<J;T++)for(P=0,V=(me=(Le=this._parts[T]).length)-1;P<me;V=P++)if((v||0!==P)&&hs(c,Le[V],Le[P])<=Be)return!0;return!1}});on._flat=ga;var Zl=on.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var c,v,T,P,V,J,me,Le,Me=this._rings[0],gt=Me.length;if(!gt)return null;for(J=me=Le=0,c=0,v=gt-1;c<gt;v=c++)me+=((T=Me[c]).x+(P=Me[v]).x)*(V=T.y*P.x-P.y*T.x),Le+=(T.y+P.y)*V,J+=3*V;return this._map.layerPointToLatLng(0===J?Me[0]:[me/J,Le/J])},_convertLatLngs:function(c){var v=on.prototype._convertLatLngs.call(this,c),T=v.length;return T>=2&&v[0]instanceof Sn&&v[0].equals(v[T-1])&&v.pop(),v},_setLatLngs:function(c){on.prototype._setLatLngs.call(this,c),eo(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return eo(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,v=this.options.weight,T=new Dt(v,v);if(c=new zt(c.min.subtract(T),c.max.add(T)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);for(var J,P=0,V=this._rings.length;P<V;P++)(J=fs(this._rings[P],c,!0)).length&&this._parts.push(J)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var T,P,V,J,me,Le,Be,Me,v=!1;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(J=0,Be=this._parts.length;J<Be;J++)for(me=0,Le=(Me=(T=this._parts[J]).length)-1;me<Me;Le=me++)(P=T[me]).y>c.y!=(V=T[Le]).y>c.y&&c.x<(V.x-P.x)*(c.y-P.y)/(V.y-P.y)+P.x&&(v=!v);return v||on.prototype._containsPoint.call(this,c,!0)}});var Ur=ml.extend({initialize:function(c,v){Yn(this,v),this._layers={},c&&this.addData(c)},addData:function(c){var T,P,V,v=ar(c)?c:c.features;if(v){for(T=0,P=v.length;T<P;T++)((V=v[T]).geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var J=this.options;if(J.filter&&!J.filter(c))return this;var me=pu(c,J);return me?(me.feature=Ua(c),me.defaultOptions=me.options,this.resetStyle(me),J.onEachFeature&&J.onEachFeature(c,me),this.addLayer(me)):this},resetStyle:function(c){return void 0===c?this.eachLayer(this.resetStyle,this):(c.options=Hn({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(v){this._setLayerStyle(v,c)},this)},_setLayerStyle:function(c,v){c.setStyle&&("function"==typeof v&&(v=v(c.feature)),c.setStyle(v))}});function pu(c,v){var Le,Be,Me,gt,T="Feature"===c.type?c.geometry:c,P=T?T.coordinates:null,V=[],J=v&&v.pointToLayer,me=v&&v.coordsToLatLng||xl;if(!P&&!T)return null;switch(T.type){case"Point":return Yu(J,c,Le=me(P),v);case"MultiPoint":for(Me=0,gt=P.length;Me<gt;Me++)Le=me(P[Me]),V.push(Yu(J,c,Le,v));return new ml(V);case"LineString":case"MultiLineString":return Be=ms(P,"LineString"===T.type?0:1,me),new on(Be,v);case"Polygon":case"MultiPolygon":return Be=ms(P,"Polygon"===T.type?1:2,me),new Zl(Be,v);case"GeometryCollection":for(Me=0,gt=T.geometries.length;Me<gt;Me++){var Tt=pu({geometry:T.geometries[Me],type:"Feature",properties:c.properties},v);Tt&&V.push(Tt)}return new ml(V);default:throw new Error("Invalid GeoJSON object.")}}function Yu(c,v,T,P){return c?c(v,T):new Hl(T,P&&P.markersInheritOptions&&P)}function xl(c){return new Sn(c[1],c[0],c[2])}function ms(c,v,T){for(var me,P=[],V=0,J=c.length;V<J;V++)me=v?ms(c[V],v-1,T):(T||xl)(c[V]),P.push(me);return P}function bl(c,v){return v="number"==typeof v?v:6,void 0!==c.alt?[at(c.lng,v),at(c.lat,v),at(c.alt,v)]:[at(c.lng,v),at(c.lat,v)]}function ci(c,v,T,P){for(var V=[],J=0,me=c.length;J<me;J++)V.push(v?ci(c[J],v-1,T,P):bl(c[J],P));return!v&&T&&V.push(V[0]),V}function hr(c,v){return c.feature?Hn({},c.feature,{geometry:v}):Ua(v)}function Ua(c){return"Feature"===c.type||"FeatureCollection"===c.type?c:{type:"Feature",properties:{},geometry:c}}var gs={toGeoJSON:function(c){return hr(this,{type:"Point",coordinates:bl(this.getLatLng(),c)})}};function ql(c,v){return new Ur(c,v)}Hl.include(gs),Gl.include(gs),Fs.include(gs),on.include({toGeoJSON:function(c){var v=!eo(this._latlngs);return hr(this,{type:(v?"Multi":"")+"LineString",coordinates:ci(this._latlngs,v?1:0,!1,c)})}}),Zl.include({toGeoJSON:function(c){var v=!eo(this._latlngs),T=v&&!eo(this._latlngs[0]),P=ci(this._latlngs,T?2:v?1:0,!0,c);return v||(P=[P]),hr(this,{type:(T?"Multi":"")+"Polygon",coordinates:P})}}),pl.include({toMultiPoint:function(c){var v=[];return this.eachLayer(function(T){v.push(T.toGeoJSON(c).geometry.coordinates)}),hr(this,{type:"MultiPoint",coordinates:v})},toGeoJSON:function(c){var v=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===v)return this.toMultiPoint(c);var T="GeometryCollection"===v,P=[];return this.eachLayer(function(V){if(V.toGeoJSON){var J=V.toGeoJSON(c);if(T)P.push(J.geometry);else{var me=Ua(J);"FeatureCollection"===me.type?P.push.apply(P,me.features):P.push(me)}}}),T?hr(this,{geometries:P,type:"GeometryCollection"}):{type:"FeatureCollection",features:P}}});var Wl=ql,Ns=Di.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,v,T){this._url=c,this._bounds=li(v),Yn(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ut(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&Rn(this._image),this},bringToBack:function(){return this._map&&fn(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=li(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c="IMG"===this._url.tagName,v=this._image=c?this._url:An("img");Ut(v,"leaflet-image-layer"),this._zoomAnimated&&Ut(v,"leaflet-zoom-animated"),this.options.className&&Ut(v,this.options.className),v.onselectstart=$e,v.onmousemove=$e,v.onload=p(this.fire,this,"load"),v.onerror=p(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(v.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c?this._url=v.src:(v.src=this._url,v.alt=this.options.alt)},_animateZoom:function(c){var v=this._map.getZoomScale(c.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;wt(this._image,T,v)},_reset:function(){var c=this._image,v=new zt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=v.getSize();cn(c,v.min),c.style.width=T.x+"px",c.style.height=T.y+"px"},_updateOpacity:function(){Dr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)}}),Ec=Ns.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var c="VIDEO"===this._url.tagName,v=this._image=c?this._url:An("video");if(Ut(v,"leaflet-image-layer"),this._zoomAnimated&&Ut(v,"leaflet-zoom-animated"),this.options.className&&Ut(v,this.options.className),v.onselectstart=$e,v.onmousemove=$e,v.onloadeddata=p(this.fire,this,"load"),c){for(var T=v.getElementsByTagName("source"),P=[],V=0;V<T.length;V++)P.push(T[V].src);this._url=T.length>0?P:[v.src]}else{ar(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(v.style,"objectFit")&&(v.style.objectFit="fill"),v.autoplay=!!this.options.autoplay,v.loop=!!this.options.loop,v.muted=!!this.options.muted;for(var J=0;J<this._url.length;J++){var me=An("source");me.src=this._url[J],v.appendChild(me)}}}});var Xl=Ns.extend({_initImage:function(){var c=this._image=this._url;Ut(c,"leaflet-image-layer"),this._zoomAnimated&&Ut(c,"leaflet-zoom-animated"),this.options.className&&Ut(c,this.options.className),c.onselectstart=$e,c.onmousemove=$e}});var Mr=Di.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(c,v){Yn(this,c),this._source=v},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&Dr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&Dr(this._container,1),this.bringToFront()},onRemove:function(c){c._fadeAnimated?(Dr(this._container,0),this._removeTimeout=setTimeout(p(mt,void 0,this._container),200)):mt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=Gn(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Rn(this._container),this},bringToBack:function(){return this._map&&fn(this._container),this},_prepareOpen:function(c,v,T){if(v instanceof Di||(T=v,v=c),v instanceof ml)for(var P in c._layers){v=c._layers[P];break}if(!T)if(v.getCenter)T=v.getCenter();else{if(!v.getLatLng)throw new Error("Unable to get source layer LatLng.");T=v.getLatLng()}return this._source=v,this.update(),T},_updateContent:function(){if(this._content){var c=this._contentNode,v="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof v)c.innerHTML=v;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(v)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),v=nn(this.options.offset),T=this._getAnchor();this._zoomAnimated?cn(this._container,c.add(T)):v=v.add(c).add(T);var P=this._containerBottom=-v.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+v.x;this._container.style.bottom=P+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}}),Bs=Mr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c.openPopup(this),this},onAdd:function(c){Mr.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Os||this._source.on("preclick",da))},onRemove:function(c){Mr.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Os||this._source.off("preclick",da))},getEvents:function(){var c=Mr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this._close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var c="leaflet-popup",v=this._container=An("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=An("div",c+"-content-wrapper",v);if(this._contentNode=An("div",c+"-content",T),Yr(v),Bl(this._contentNode),mn(v,"contextmenu",da),this._tipContainer=An("div",c+"-tip-container",v),this._tip=An("div",c+"-tip",this._tipContainer),this.options.closeButton){var P=this._closeButton=An("a",c+"-close-button",v);P.href="#close",P.innerHTML="&#215;",mn(P,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var c=this._contentNode,v=c.style;v.width="",v.whiteSpace="nowrap";var T=c.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),v.width=T+1+"px",v.whiteSpace="",v.height="";var V=this.options.maxHeight,J="leaflet-popup-scrolled";V&&c.offsetHeight>V?(v.height=V+"px",Ut(c,J)):Qn(c,J),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),T=this._getAnchor();cn(this._container,v.add(T))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var c=this._map,v=parseInt(Vt(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+v,P=this._containerWidth,V=new Dt(this._containerLeft,-T-this._containerBottom);V._add(Ni(this._container));var J=c.layerPointToContainerPoint(V),me=nn(this.options.autoPanPadding),Le=nn(this.options.autoPanPaddingTopLeft||me),Be=nn(this.options.autoPanPaddingBottomRight||me),Me=c.getSize(),gt=0,Tt=0;J.x+P+Be.x>Me.x&&(gt=J.x+P-Me.x+Be.x),J.x-gt-Le.x<0&&(gt=J.x-Le.x),J.y+T+Be.y>Me.y&&(Tt=J.y+T-Me.y+Be.y),J.y-Tt-Le.y<0&&(Tt=J.y-Le.y),(gt||Tt)&&c.fire("autopanstart").panBy([gt,Tt])}},_onCloseButtonClick:function(c){this._close(),ks(c)},_getAnchor:function(){return nn(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});It.mergeOptions({closePopupOnClick:!0}),It.include({openPopup:function(c,v,T){return c instanceof Bs||(c=new Bs(T).setContent(c)),v&&c.setLatLng(v),this.hasLayer(c)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=c,this.addLayer(c))},closePopup:function(c){return(!c||c===this._popup)&&(c=this._popup,this._popup=null),c&&this.removeLayer(c),this}}),Di.include({bindPopup:function(c,v){return c instanceof Bs?(Yn(c,v),this._popup=c,c._source=this):((!this._popup||v)&&(this._popup=new Bs(v,this)),this._popup.setContent(c)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c,v){return this._popup&&this._map&&(v=this._popup._prepareOpen(this,c,v),this._map.openPopup(this._popup,v)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(c){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(c)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){var v=c.layer||c.target;if(this._popup&&this._map){if(ks(c),v instanceof Os)return void this.openPopup(c.layer||c.target,c.latlng);this._map.hasLayer(this._popup)&&this._popup._source===v?this.closePopup():this.openPopup(v,c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){13===c.originalEvent.keyCode&&this._openPopup(c)}});var _s=Mr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(c){Mr.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(c){Mr.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var c=Mr.prototype.getEvents.call(this);return Ft&&!this.options.permanent&&(c.preclick=this._close),c},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=An("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var v,T,P=this._map,V=this._container,J=P.latLngToContainerPoint(P.getCenter()),me=P.layerPointToContainerPoint(c),Le=this.options.direction,Be=V.offsetWidth,Me=V.offsetHeight,gt=nn(this.options.offset),Tt=this._getAnchor();"top"===Le?(v=Be/2,T=Me):"bottom"===Le?(v=Be/2,T=0):"center"===Le?(v=Be/2,T=Me/2):"right"===Le?(v=0,T=Me/2):"left"===Le?(v=Be,T=Me/2):me.x<J.x?(Le="right",v=0,T=Me/2):(Le="left",v=Be+2*(gt.x+Tt.x),T=Me/2),c=c.subtract(nn(v,T,!0)).add(gt).add(Tt),Qn(V,"leaflet-tooltip-right"),Qn(V,"leaflet-tooltip-left"),Qn(V,"leaflet-tooltip-top"),Qn(V,"leaflet-tooltip-bottom"),Ut(V,"leaflet-tooltip-"+Le),cn(V,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&Dr(this._container,c)},_animateZoom:function(c){var v=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(v)},_getAnchor:function(){return nn(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});It.include({openTooltip:function(c,v,T){return c instanceof _s||(c=new _s(T).setContent(c)),v&&c.setLatLng(v),this.hasLayer(c)?this:this.addLayer(c)},closeTooltip:function(c){return c&&this.removeLayer(c),this}}),Di.include({bindTooltip:function(c,v){return c instanceof _s?(Yn(c,v),this._tooltip=c,c._source=this):((!this._tooltip||v)&&(this._tooltip=new _s(v,this)),this._tooltip.setContent(c)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(c||!this._tooltipHandlersAdded){var v=c?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),Ft&&(T.click=this._openTooltip)),this[v](T),this._tooltipHandlersAdded=!c}},openTooltip:function(c,v){return this._tooltip&&this._map&&(v=this._tooltip._prepareOpen(this,c,v),this._map.openTooltip(this._tooltip,v),this._tooltip.options.interactive&&this._tooltip._container&&(Ut(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Qn(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(c){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(c)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_openTooltip:function(c){!this._tooltip||!this._map||this.openTooltip(c.layer||c.target,this._tooltip.options.sticky?c.latlng:void 0)},_moveTooltip:function(c){var T,P,v=c.latlng;this._tooltip.options.sticky&&c.originalEvent&&(T=this._map.mouseEventToContainerPoint(c.originalEvent),P=this._map.containerPointToLayerPoint(T),v=this._map.layerPointToLatLng(P)),this._tooltip.setLatLng(v)}});var Ju=ps.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var v=c&&"DIV"===c.tagName?c:document.createElement("div"),T=this.options;if(T.html instanceof Element?(la(v),v.appendChild(T.html)):v.innerHTML=!1!==T.html?T.html:"",T.bgPos){var P=nn(T.bgPos);v.style.backgroundPosition=-P.x+"px "+-P.y+"px"}return this._setIconStyles(v,"icon"),v},createShadow:function(){return null}});ps.Default=_l;var ja=Di.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Wo,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){Yn(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),mt(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Rn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(fn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Cr(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof Dt?c:new Dt(c,c)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var J,v=this.getPane().children,T=-c(-1/0,1/0),P=0,V=v.length;P<V;P++)J=v[P].style.zIndex,v[P]!==this._container&&J&&(T=c(T,+J));isFinite(T)&&(this.options.zIndex=T+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ta){Dr(this._container,this.options.opacity);var c=+new Date,v=!1,T=!1;for(var P in this._tiles){var V=this._tiles[P];if(V.current&&V.loaded){var J=Math.min(1,(c-V.loaded)/200);Dr(V.el,J),J<1?v=!0:(V.active?T=!0:this._onOpaqueTile(V),V.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),v&&(Zi(this._fadeFrame),this._fadeFrame=si(this._updateOpacity,this))}},_onOpaqueTile:$e,_initContainer:function(){this._container||(this._container=An("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,v=this.options.maxZoom;if(void 0!==c){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===c?(this._levels[T].el.style.zIndex=v-Math.abs(c-T),this._onUpdateLevel(T)):(mt(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var P=this._levels[c],V=this._map;return P||((P=this._levels[c]={}).el=An("div","leaflet-tile-container leaflet-zoom-animated",this._container),P.el.style.zIndex=v,P.origin=V.project(V.unproject(V.getPixelOrigin()),c).round(),P.zoom=c,this._setZoomTransform(P,V.getCenter(),V.getZoom()),this._onCreateLevel(P)),this._level=P,P}},_onUpdateLevel:$e,_onRemoveLevel:$e,_onCreateLevel:$e,_pruneTiles:function(){if(this._map){var c,v,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom)return void this._removeAllTiles();for(c in this._tiles)(v=this._tiles[c]).retain=v.current;for(c in this._tiles)if((v=this._tiles[c]).current&&!v.active){var P=v.coords;this._retainParent(P.x,P.y,P.z,P.z-5)||this._retainChildren(P.x,P.y,P.z,P.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var v in this._tiles)this._tiles[v].coords.z===c&&this._removeTile(v)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)mt(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,v,T,P){var V=Math.floor(c/2),J=Math.floor(v/2),me=T-1,Le=new Dt(+V,+J);Le.z=+me;var Be=this._tileCoordsToKey(Le),Me=this._tiles[Be];return Me&&Me.active?(Me.retain=!0,!0):(Me&&Me.loaded&&(Me.retain=!0),me>P&&this._retainParent(V,J,me,P))},_retainChildren:function(c,v,T,P){for(var V=2*c;V<2*c+2;V++)for(var J=2*v;J<2*v+2;J++){var me=new Dt(V,J);me.z=T+1;var Le=this._tileCoordsToKey(me),Be=this._tiles[Le];Be&&Be.active?Be.retain=!0:(Be&&Be.loaded&&(Be.retain=!0),T+1<P&&this._retainChildren(V,J,T+1,P))}},_resetView:function(c){var v=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),v,v)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var v=this.options;return void 0!==v.minNativeZoom&&c<v.minNativeZoom?v.minNativeZoom:void 0!==v.maxNativeZoom&&v.maxNativeZoom<c?v.maxNativeZoom:c},_setView:function(c,v,T,P){var V=Math.round(v);V=void 0!==this.options.maxZoom&&V>this.options.maxZoom||void 0!==this.options.minZoom&&V<this.options.minZoom?void 0:this._clampZoom(V),(!P||this.options.updateWhenZooming&&V!==this._tileZoom)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==V&&this._update(c),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(c,v)},_setZoomTransforms:function(c,v){for(var T in this._levels)this._setZoomTransform(this._levels[T],c,v)},_setZoomTransform:function(c,v,T){var P=this._map.getZoomScale(T,c.zoom),V=c.origin.multiplyBy(P).subtract(this._map._getNewPixelOrigin(v,T)).round();lr?wt(c.el,V,P):cn(c.el,V)},_resetGrid:function(){var c=this._map,v=c.options.crs,T=this._tileSize=this.getTileSize(),P=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=v.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,v.wrapLng[0]],P).x/T.x),Math.ceil(c.project([0,v.wrapLng[1]],P).x/T.y)],this._wrapY=v.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([v.wrapLat[0],0],P).y/T.x),Math.ceil(c.project([v.wrapLat[1],0],P).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var v=this._map,T=v._animatingZoom?Math.max(v._animateToZoom,v.getZoom()):v.getZoom(),P=v.getZoomScale(T,this._tileZoom),V=v.project(c,this._tileZoom).floor(),J=v.getSize().divideBy(2*P);return new zt(V.subtract(J),V.add(J))},_update:function(c){var v=this._map;if(v){var T=this._clampZoom(v.getZoom());if(void 0===c&&(c=v.getCenter()),void 0!==this._tileZoom){var P=this._getTiledPixelBounds(c),V=this._pxBoundsToTileRange(P),J=V.getCenter(),me=[],Le=this.options.keepBuffer,Be=new zt(V.getBottomLeft().subtract([Le,-Le]),V.getTopRight().add([Le,-Le]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Me in this._tiles){var gt=this._tiles[Me].coords;(gt.z!==this._tileZoom||!Be.contains(new Dt(gt.x,gt.y)))&&(this._tiles[Me].current=!1)}if(Math.abs(T-this._tileZoom)>1)return void this._setView(c,T);for(var Tt=V.min.y;Tt<=V.max.y;Tt++)for(var un=V.min.x;un<=V.max.x;un++){var ei=new Dt(un,Tt);if(ei.z=this._tileZoom,this._isValidTile(ei)){var pr=this._tiles[this._tileCoordsToKey(ei)];pr?pr.current=!0:me.push(ei)}}if(me.sort(function(no,No){return no.distanceTo(J)-No.distanceTo(J)}),0!==me.length){this._loading||(this._loading=!0,this.fire("loading"));var El=document.createDocumentFragment();for(un=0;un<me.length;un++)this._addTile(me[un],El);this._level.el.appendChild(El)}}}},_isValidTile:function(c){var v=this._map.options.crs;if(!v.infinite){var T=this._globalTileRange;if(!v.wrapLng&&(c.x<T.min.x||c.x>T.max.x)||!v.wrapLat&&(c.y<T.min.y||c.y>T.max.y))return!1}if(!this.options.bounds)return!0;var P=this._tileCoordsToBounds(c);return li(this.options.bounds).overlaps(P)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var v=this._map,T=this.getTileSize(),P=c.scaleBy(T),V=P.add(T);return[v.unproject(P,c.z),v.unproject(V,c.z)]},_tileCoordsToBounds:function(c){var v=this._tileCoordsToNwSe(c),T=new Ri(v[0],v[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var v=c.split(":"),T=new Dt(+v[0],+v[1]);return T.z=+v[2],T},_removeTile:function(c){var v=this._tiles[c];!v||(mt(v.el),delete this._tiles[c],this.fire("tileunload",{tile:v.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){Ut(c,"leaflet-tile");var v=this.getTileSize();c.style.width=v.x+"px",c.style.height=v.y+"px",c.onselectstart=$e,c.onmousemove=$e,ta&&this.options.opacity<1&&Dr(c,this.options.opacity),_o&&!Nn&&(c.style.WebkitBackfaceVisibility="hidden")},_addTile:function(c,v){var T=this._getTilePos(c),P=this._tileCoordsToKey(c),V=this.createTile(this._wrapCoords(c),p(this._tileReady,this,c));this._initTile(V),this.createTile.length<2&&si(p(this._tileReady,this,c,null,V)),cn(V,T),this._tiles[P]={el:V,coords:c,current:!0},v.appendChild(V),this.fire("tileloadstart",{tile:V,coords:c})},_tileReady:function(c,v,T){v&&this.fire("tileerror",{error:v,tile:T,coords:c});var P=this._tileCoordsToKey(c);(T=this._tiles[P])&&(T.loaded=+new Date,this._map._fadeAnimated?(Dr(T.el,0),Zi(this._fadeFrame),this._fadeFrame=si(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),v||(Ut(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ta||!this._map._fadeAnimated?si(this._pruneTiles,this):setTimeout(p(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var v=new Dt(this._wrapX?Qe(c.x,this._wrapX):c.x,this._wrapY?Qe(c.y,this._wrapY):c.y);return v.z=c.z,v},_pxBoundsToTileRange:function(c){var v=this.getTileSize();return new zt(c.min.unscaleBy(v).floor(),c.max.unscaleBy(v).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});var $a=ja.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(c,v){this._url=c,(v=Yn(this,v)).detectRetina&&Tr&&v.maxZoom>0&&(v.tileSize=Math.floor(v.tileSize/2),v.zoomReverse?(v.zoomOffset--,v.minZoom++):(v.zoomOffset++,v.maxZoom--),v.minZoom=Math.max(0,v.minZoom)),"string"==typeof v.subdomains&&(v.subdomains=v.subdomains.split("")),_o||this.on("tileunload",this._onTileRemove)},setUrl:function(c,v){return this._url===c&&void 0===v&&(v=!0),this._url=c,v||this.redraw(),this},createTile:function(c,v){var T=document.createElement("img");return mn(T,"load",p(this._tileOnLoad,this,v,T)),mn(T,"error",p(this._tileOnError,this,v,T)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(T.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),T.alt="",T.setAttribute("role","presentation"),T.src=this.getTileUrl(c),T},getTileUrl:function(c){var v={r:Tr?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-c.y;this.options.tms&&(v.y=T),v["-y"]=T}return sl(this._url,Hn(v,this.options))},_tileOnLoad:function(c,v){ta?setTimeout(p(c,this,null,v),0):c(null,v)},_tileOnError:function(c,v,T){var P=this.options.errorTileUrl;P&&v.getAttribute("src")!==P&&(v.src=P),c(T,v)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom;return this.options.zoomReverse&&(c=this.options.maxZoom-c),c+this.options.zoomOffset},_getSubdomain:function(c){var v=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[v]},_abortLoading:function(){var c,v;for(c in this._tiles)this._tiles[c].coords.z!==this._tileZoom&&((v=this._tiles[c].el).onload=$e,v.onerror=$e,v.complete||(v.src=gi,mt(v),delete this._tiles[c]))},_removeTile:function(c){var v=this._tiles[c];if(v)return cl||v.el.setAttribute("src",gi),ja.prototype._removeTile.call(this,c)},_tileReady:function(c,v,T){if(this._map&&(!T||T.getAttribute("src")!==gi))return ja.prototype._tileReady.call(this,c,v,T)}});function Tc(c,v){return new $a(c,v)}var Ha=$a.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,v){this._url=c;var T=Hn({},this.defaultWmsParams);for(var P in v)P in this.options||(T[P]=v[P]);var V=(v=Yn(this,v)).detectRetina&&Tr?2:1,J=this.getTileSize();T.width=J.x*V,T.height=J.y*V,this.wmsParams=T},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,$a.prototype.onAdd.call(this,c)},getTileUrl:function(c){var v=this._tileCoordsToNwSe(c),T=this._crs,P=ki(T.project(v[0]),T.project(v[1])),V=P.min,J=P.max,me=(this._wmsVersion>=1.3&&this._crs===jl?[V.y,V.x,J.y,J.x]:[V.x,V.y,J.x,J.y]).join(","),Le=$a.prototype.getTileUrl.call(this,c);return Le+In(this.wmsParams,Le,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+me},setParams:function(c,v){return Hn(this.wmsParams,c),v||this.redraw(),this}});$a.WMS=Ha,Tc.wms=function(c,v){return new Ha(c,v)};var to=Di.extend({options:{padding:.1,tolerance:0},initialize:function(c){Yn(this,c),Qt(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Ut(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,v){var T=this._map.getZoomScale(v,this._zoom),P=Ni(this._container),V=this._map.getSize().multiplyBy(.5+this.options.padding),J=this._map.project(this._center,v),Le=this._map.project(c,v).subtract(J),Be=V.multiplyBy(-T).add(P).add(V).subtract(Le);lr?wt(this._container,Be,T):cn(this._container,Be)},_reset:function(){for(var c in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,v=this._map.getSize(),T=this._map.containerPointToLayerPoint(v.multiplyBy(-c)).round();this._bounds=new zt(T,T.add(v.multiplyBy(1+2*c)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),fr=to.extend({getEvents:function(){var c=to.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){to.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");mn(c,"mousemove",this._onMouseMove,this),mn(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),mn(c,"mouseout",this._handleMouseOut,this),this._ctx=c.getContext("2d")},_destroyContainer:function(){Zi(this._redrawRequest),delete this._ctx,mt(this._container),On(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var v in this._redrawBounds=null,this._layers)this._layers[v]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){to.prototype._update.call(this);var c=this._bounds,v=this._container,T=c.getSize(),P=Tr?2:1;cn(v,c.min),v.width=P*T.x,v.height=P*T.y,v.style.width=T.x+"px",v.style.height=T.y+"px",Tr&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){to.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[Qt(c)]=c;var v=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=v),this._drawLast=v,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var v=c._order,T=v.next,P=v.prev;T?T.prev=P:this._drawLast=P,P?P.next=T:this._drawFirst=T,delete c._order,delete this._layers[Qt(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if("string"==typeof c.options.dashArray){var P,V,v=c.options.dashArray.split(/[, ]+/),T=[];for(V=0;V<v.length;V++){if(P=Number(v[V]),isNaN(P))return;T.push(P)}c.options._dashArray=T}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){!this._map||(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||si(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var v=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new zt,this._redrawBounds.extend(c._pxBounds.min.subtract([v,v])),this._redrawBounds.extend(c._pxBounds.max.add([v,v]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var v=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,v.x,v.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,v=this._redrawBounds;if(this._ctx.save(),v){var T=v.getSize();this._ctx.beginPath(),this._ctx.rect(v.min.x,v.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var P=this._drawFirst;P;P=P.next)c=P.layer,(!v||c._pxBounds&&c._pxBounds.intersects(v))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,v){if(this._drawing){var T,P,V,J,me=c._parts,Le=me.length,Be=this._ctx;if(Le){for(Be.beginPath(),T=0;T<Le;T++){for(P=0,V=me[T].length;P<V;P++)Be[P?"lineTo":"moveTo"]((J=me[T][P]).x,J.y);v&&Be.closePath()}this._fillStroke(Be,c)}}},_updateCircle:function(c){if(this._drawing&&!c._empty()){var v=c._point,T=this._ctx,P=Math.max(Math.round(c._radius),1),V=(Math.max(Math.round(c._radiusY),1)||P)/P;1!==V&&(T.save(),T.scale(1,V)),T.beginPath(),T.arc(v.x,v.y/V,P,0,2*Math.PI,!1),1!==V&&T.restore(),this._fillStroke(T,c)}},_fillStroke:function(c,v){var T=v.options;T.fill&&(c.globalAlpha=T.fillOpacity,c.fillStyle=T.fillColor||T.color,c.fill(T.fillRule||"evenodd")),T.stroke&&0!==T.weight&&(c.setLineDash&&c.setLineDash(v.options&&v.options._dashArray||[]),c.globalAlpha=T.opacity,c.lineWidth=T.weight,c.strokeStyle=T.color,c.lineCap=T.lineCap,c.lineJoin=T.lineJoin,c.stroke())},_onClick:function(c){for(var T,P,v=this._map.mouseEventToLayerPoint(c),V=this._drawFirst;V;V=V.next)(T=V.layer).options.interactive&&T._containsPoint(v)&&("click"!==c.type&&"preclick"===c.type||!this._map._draggableMoved(T))&&(P=T);P&&(dl(c),this._fireEvent([P],c))},_onMouseMove:function(c){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var v=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,v)}},_handleMouseOut:function(c){var v=this._hoveredLayer;v&&(Qn(this._container,"leaflet-interactive"),this._fireEvent([v],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,v){if(!this._mouseHoverThrottled){for(var T,P,V=this._drawFirst;V;V=V.next)(T=V.layer).options.interactive&&T._containsPoint(v)&&(P=T);P!==this._hoveredLayer&&(this._handleMouseOut(c),P&&(Ut(this._container,"leaflet-interactive"),this._fireEvent([P],c,"mouseover"),this._hoveredLayer=P)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],c),this._mouseHoverThrottled=!0,setTimeout(p(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,v,T){this._map._fireDOMEvent(v,T||v.type,c)},_bringToFront:function(c){var v=c._order;if(v){var T=v.next,P=v.prev;if(!T)return;T.prev=P,P?P.next=T:T&&(this._drawFirst=T),v.prev=this._drawLast,this._drawLast.next=v,v.next=null,this._drawLast=v,this._requestRedraw(c)}},_bringToBack:function(c){var v=c._order;if(v){var T=v.next,P=v.prev;if(!P)return;P.next=T,T?T.prev=P:P&&(this._drawLast=P),v.prev=null,v.next=this._drawFirst,this._drawFirst.prev=v,this._drawFirst=v,this._requestRedraw(c)}}});function Qo(c){return yn?new fr(c):null}var ir=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch(c){return function(v){return document.createElement("<"+v+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Ga={_initContainer:function(){this._container=An("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(to.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var v=c._container=ir("shape");Ut(v,"leaflet-vml-shape "+(this.options.className||"")),v.coordsize="1 1",c._path=ir("path"),v.appendChild(c._path),this._updateStyle(c),this._layers[Qt(c)]=c},_addPath:function(c){var v=c._container;this._container.appendChild(v),c.options.interactive&&c.addInteractiveTarget(v)},_removePath:function(c){var v=c._container;mt(v),c.removeInteractiveTarget(v),delete this._layers[Qt(c)]},_updateStyle:function(c){var v=c._stroke,T=c._fill,P=c.options,V=c._container;V.stroked=!!P.stroke,V.filled=!!P.fill,P.stroke?(v||(v=c._stroke=ir("stroke")),V.appendChild(v),v.weight=P.weight+"px",v.color=P.color,v.opacity=P.opacity,v.dashStyle=P.dashArray?ar(P.dashArray)?P.dashArray.join(" "):P.dashArray.replace(/( *, *)/g," "):"",v.endcap=P.lineCap.replace("butt","flat"),v.joinstyle=P.lineJoin):v&&(V.removeChild(v),c._stroke=null),P.fill?(T||(T=c._fill=ir("fill")),V.appendChild(T),T.color=P.fillColor||P.color,T.opacity=P.fillOpacity):T&&(V.removeChild(T),c._fill=null)},_updateCircle:function(c){var v=c._point.round(),T=Math.round(c._radius),P=Math.round(c._radiusY||T);this._setPath(c,c._empty()?"M0 0":"AL "+v.x+","+v.y+" "+T+","+P+" 0,23592600")},_setPath:function(c,v){c._path.v=v},_bringToFront:function(c){Rn(c._container)},_bringToBack:function(c){fn(c._container)}},Za=$?ir:qo,wl=to.extend({getEvents:function(){var c=to.prototype.getEvents.call(this);return c.zoomstart=this._onZoomStart,c},_initContainer:function(){this._container=Za("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Za("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mt(this._container),On(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){to.prototype._update.call(this);var c=this._bounds,v=c.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(v))&&(this._svgSize=v,T.setAttribute("width",v.x),T.setAttribute("height",v.y)),cn(T,c.min),T.setAttribute("viewBox",[c.min.x,c.min.y,v.x,v.y].join(" ")),this.fire("update")}},_initPath:function(c){var v=c._path=Za("path");c.options.className&&Ut(v,c.options.className),c.options.interactive&&Ut(v,"leaflet-interactive"),this._updateStyle(c),this._layers[Qt(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){mt(c._path),c.removeInteractiveTarget(c._path),delete this._layers[Qt(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var v=c._path,T=c.options;!v||(T.stroke?(v.setAttribute("stroke",T.color),v.setAttribute("stroke-opacity",T.opacity),v.setAttribute("stroke-width",T.weight),v.setAttribute("stroke-linecap",T.lineCap),v.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?v.setAttribute("stroke-dasharray",T.dashArray):v.removeAttribute("stroke-dasharray"),T.dashOffset?v.setAttribute("stroke-dashoffset",T.dashOffset):v.removeAttribute("stroke-dashoffset")):v.setAttribute("stroke","none"),T.fill?(v.setAttribute("fill",T.fillColor||T.color),v.setAttribute("fill-opacity",T.fillOpacity),v.setAttribute("fill-rule",T.fillRule||"evenodd")):v.setAttribute("fill","none"))},_updatePoly:function(c,v){this._setPath(c,As(c._parts,v))},_updateCircle:function(c){var v=c._point,T=Math.max(Math.round(c._radius),1),V="a"+T+","+(Math.max(Math.round(c._radiusY),1)||T)+" 0 1,0 ",J=c._empty()?"M0 0":"M"+(v.x-T)+","+v.y+V+2*T+",0 "+V+2*-T+",0 ";this._setPath(c,J)},_setPath:function(c,v){c._path.setAttribute("d",v)},_bringToFront:function(c){Rn(c._path)},_bringToBack:function(c){fn(c._path)}});function Fo(c){return Q||$?new wl(c):null}$&&wl.include(Ga),It.include({getRenderer:function(c){var v=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return v||(v=this._renderer=this._createRenderer()),this.hasLayer(v)||this.addLayer(v),v},_getPaneRenderer:function(c){if("overlayPane"===c||void 0===c)return!1;var v=this._paneRenderers[c];return void 0===v&&(v=this._createRenderer({pane:c}),this._paneRenderers[c]=v),v},_createRenderer:function(c){return this.options.preferCanvas&&Qo(c)||Fo(c)}});var Dc=Zl.extend({initialize:function(c,v){Zl.prototype.initialize.call(this,this._boundsToLatLngs(c),v)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return[(c=li(c)).getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});wl.create=Za,wl.pointsToPath=As,Ur.geometryToLayer=pu,Ur.coordsToLatLng=xl,Ur.coordsToLatLngs=ms,Ur.latLngToCoords=bl,Ur.latLngsToCoords=ci,Ur.getFeature=hr,Ur.asFeature=Ua,It.mergeOptions({boxZoom:!0});var Ot=Zn.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){mn(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){On(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||1!==c.which&&1!==c.button)return!1;this._clearDeferredResetState(),this._resetState(),vo(),Ei(),this._startPoint=this._map.mouseEventToContainerPoint(c),mn(document,{contextmenu:ks,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=An("div","leaflet-zoom-box",this._container),Ut(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var v=new zt(this._point,this._startPoint),T=v.getSize();cn(this._box,v.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(mt(this._box),Qn(this._container,"leaflet-crosshair")),Is(),Ji(),On(document,{contextmenu:ks,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if((1===c.which||1===c.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(p(this._resetState,this),0);var v=new Ri(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(v).fire("boxzoomend",{boxZoomBounds:v})}},_onKeyDown:function(c){27===c.keyCode&&this._finish()}});It.addInitHook("addHandler","boxZoom",Ot),It.mergeOptions({doubleClickZoom:!0});var $r=Zn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var v=this._map,T=v.getZoom(),P=v.options.zoomDelta,V=c.originalEvent.shiftKey?T-P:T+P;"center"===v.options.doubleClickZoom?v.setZoom(V):v.setZoomAround(c.containerPoint,V)}});It.addInitHook("addHandler","doubleClickZoom",$r),It.mergeOptions({dragging:!0,inertia:!Nn,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Sc=Zn.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new Lt(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}Ut(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Qn(this._map._container,"leaflet-grab"),Qn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var v=li(this._map.options.maxBounds);this._offsetLimit=ki(this._map.latLngToContainerPoint(v.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(v.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var v=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(v),this._prunePositions(v)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),v=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=v.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,v){return c-(c-v)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var c=this._draggable._newPos.subtract(this._draggable._startPos),v=this._offsetLimit;c.x<v.min.x&&(c.x=this._viscousLimit(c.x,v.min.x)),c.y<v.min.y&&(c.y=this._viscousLimit(c.y,v.min.y)),c.x>v.max.x&&(c.x=this._viscousLimit(c.x,v.max.x)),c.y>v.max.y&&(c.y=this._viscousLimit(c.y,v.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,v=Math.round(c/2),T=this._initialWorldOffset,P=this._draggable._newPos.x,V=(P-v+T)%c+v-T,J=(P+v+T)%c-v-T,me=Math.abs(V+T)<Math.abs(J+T)?V:J;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=me},_onDragEnd:function(c){var v=this._map,T=v.options,P=!T.inertia||this._times.length<2;if(v.fire("dragend",c),P)v.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),me=T.easeLinearity,Le=V.multiplyBy(me/((this._lastTime-this._times[0])/1e3)),Be=Le.distanceTo([0,0]),Me=Math.min(T.inertiaMaxSpeed,Be),gt=Le.multiplyBy(Me/Be),Tt=Me/(T.inertiaDeceleration*me),un=gt.multiplyBy(-Tt/2).round();un.x||un.y?(un=v._limitOffset(un,v.options.maxBounds),si(function(){v.panBy(un,{duration:Tt,easeLinearity:me,noMoveStart:!0,animate:!0})})):v.fire("moveend")}}});It.addInitHook("addHandler","dragging",Sc),It.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ys=Zn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),mn(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),On(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,v=document.documentElement,T=c.scrollTop||v.scrollTop,P=c.scrollLeft||v.scrollLeft;this._map._container.focus(),window.scrollTo(P,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var P,V,v=this._panKeys={},T=this.keyCodes;for(P=0,V=T.left.length;P<V;P++)v[T.left[P]]=[-1*c,0];for(P=0,V=T.right.length;P<V;P++)v[T.right[P]]=[c,0];for(P=0,V=T.down.length;P<V;P++)v[T.down[P]]=[0,c];for(P=0,V=T.up.length;P<V;P++)v[T.up[P]]=[0,-1*c]},_setZoomDelta:function(c){var P,V,v=this._zoomKeys={},T=this.keyCodes;for(P=0,V=T.zoomIn.length;P<V;P++)v[T.zoomIn[P]]=c;for(P=0,V=T.zoomOut.length;P<V;P++)v[T.zoomOut[P]]=-c},_addHooks:function(){mn(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){On(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var P,v=c.keyCode,T=this._map;if(v in this._panKeys)(!T._panAnim||!T._panAnim._inProgress)&&(P=this._panKeys[v],c.shiftKey&&(P=nn(P).multiplyBy(3)),T.panBy(P),T.options.maxBounds&&T.panInsideBounds(T.options.maxBounds));else if(v in this._zoomKeys)T.setZoom(T.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[v]);else{if(27!==v||!T._popup||!T._popup.options.closeOnEscapeKey)return;T.closePopup()}ks(c)}}});It.addInitHook("addHandler","keyboard",ys),It.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Mc=Zn.extend({addHooks:function(){mn(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){On(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var v=Vl(c),T=this._map.options.wheelDebounceTime;this._delta+=v,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var P=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(p(this._performZoom,this),P),ks(c)},_performZoom:function(){var c=this._map,v=c.getZoom(),T=this._map.options.zoomSnap||0;c._stop();var V=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,J=T?Math.ceil(V/T)*T:V,me=c._limitZoom(v+(this._delta>0?J:-J))-v;this._delta=0,this._startTime=null,me&&("center"===c.options.scrollWheelZoom?c.setZoom(v+me):c.setZoomAround(this._lastMousePos,v+me))}});It.addInitHook("addHandler","scrollWheelZoom",Mc),It.mergeOptions({tap:!0,tapTolerance:15});var es=Zn.extend({addHooks:function(){mn(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){On(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(c.touches){if(zi(c),this._fireClick=!0,c.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var v=c.touches[0],T=v.target;this._startPos=this._newPos=new Dt(v.clientX,v.clientY),T.tagName&&"a"===T.tagName.toLowerCase()&&Ut(T,"leaflet-active"),this._holdTimeout=setTimeout(p(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",v))},this),1e3),this._simulateEvent("mousedown",v),mn(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(c){if(clearTimeout(this._holdTimeout),On(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&c&&c.changedTouches){var v=c.changedTouches[0],T=v.target;T&&T.tagName&&"a"===T.tagName.toLowerCase()&&Qn(T,"leaflet-active"),this._simulateEvent("mouseup",v),this._isTapValid()&&this._simulateEvent("click",v)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(c){var v=c.touches[0];this._newPos=new Dt(v.clientX,v.clientY),this._simulateEvent("mousemove",v)},_simulateEvent:function(c,v){var T=document.createEvent("MouseEvents");T._simulated=!0,v.target._simulatedClick=!0,T.initMouseEvent(c,!0,!0,window,1,v.screenX,v.screenY,v.clientX,v.clientY,!1,!1,!1,!1,0,null),v.target.dispatchEvent(T)}});Ft&&(!Kr||ia)&&It.addInitHook("addHandler","tap",es),It.mergeOptions({touchZoom:Ft&&!Nn,bounceAtZoomLimits:!0});var qa=Zn.extend({addHooks:function(){Ut(this._map._container,"leaflet-touch-zoom"),mn(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Qn(this._map._container,"leaflet-touch-zoom"),On(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var v=this._map;if(c.touches&&2===c.touches.length&&!v._animatingZoom&&!this._zooming){var T=v.mouseEventToContainerPoint(c.touches[0]),P=v.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=v.getSize()._divideBy(2),this._startLatLng=v.containerPointToLatLng(this._centerPoint),"center"!==v.options.touchZoom&&(this._pinchStartLatLng=v.containerPointToLatLng(T.add(P)._divideBy(2))),this._startDist=T.distanceTo(P),this._startZoom=v.getZoom(),this._moved=!1,this._zooming=!0,v._stop(),mn(document,"touchmove",this._onTouchMove,this),mn(document,"touchend",this._onTouchEnd,this),zi(c)}},_onTouchMove:function(c){if(c.touches&&2===c.touches.length&&this._zooming){var v=this._map,T=v.mouseEventToContainerPoint(c.touches[0]),P=v.mouseEventToContainerPoint(c.touches[1]),V=T.distanceTo(P)/this._startDist;if(this._zoom=v.getScaleZoom(V,this._startZoom),!v.options.bounceAtZoomLimits&&(this._zoom<v.getMinZoom()&&V<1||this._zoom>v.getMaxZoom()&&V>1)&&(this._zoom=v._limitZoom(this._zoom)),"center"===v.options.touchZoom){if(this._center=this._startLatLng,1===V)return}else{var J=T._add(P)._divideBy(2)._subtract(this._centerPoint);if(1===V&&0===J.x&&0===J.y)return;this._center=v.unproject(v.project(this._pinchStartLatLng,this._zoom).subtract(J),this._zoom)}this._moved||(v._moveStart(!0,!1),this._moved=!0),Zi(this._animRequest);var me=p(v._move,v,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=si(me,this,!0),zi(c)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,Zi(this._animRequest),On(document,"touchmove",this._onTouchMove,this),On(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});It.addInitHook("addHandler","touchZoom",qa),It.BoxZoom=Ot,It.DoubleClickZoom=$r,It.Drag=Sc,It.Keyboard=ys,It.ScrollWheelZoom=Mc,It.Tap=es,It.TouchZoom=qa,st.version="1.7.1",st.Control=Mt,st.control=Qr,st.Browser=re,st.Evented=tn,st.Mixin=us,st.Util=ka,st.Class=Pi,st.Handler=Zn,st.extend=Hn,st.bind=p,st.stamp=Qt,st.setOptions=Yn,st.DomEvent=Lo,st.DomUtil=Un,st.PosAnimation=Et,st.Draggable=Lt,st.LineUtil=Ba,st.PolyUtil=Xi,st.Point=Dt,st.point=nn,st.Bounds=zt,st.bounds=ki,st.Transformation=La,st.transformation=qi,st.Projection=wo,st.LatLng=Sn,st.latLng=Gn,st.LatLngBounds=Ri,st.latLngBounds=li,st.CRS=jt,st.GeoJSON=Ur,st.geoJSON=ql,st.geoJson=Wl,st.Layer=Di,st.LayerGroup=pl,st.layerGroup=function(c,v){return new pl(c,v)},st.FeatureGroup=ml,st.featureGroup=function(c,v){return new ml(c,v)},st.ImageOverlay=Ns,st.imageOverlay=function(c,v,T){return new Ns(c,v,T)},st.VideoOverlay=Ec,st.videoOverlay=function(c,v,T){return new Ec(c,v,T)},st.SVGOverlay=Xl,st.svgOverlay=function(c,v,T){return new Xl(c,v,T)},st.DivOverlay=Mr,st.Popup=Bs,st.popup=function(c,v){return new Bs(c,v)},st.Tooltip=_s,st.tooltip=function(c,v){return new _s(c,v)},st.Icon=ps,st.icon=function(c){return new ps(c)},st.DivIcon=Ju,st.divIcon=function(c){return new Ju(c)},st.Marker=Hl,st.marker=function(c,v){return new Hl(c,v)},st.TileLayer=$a,st.tileLayer=Tc,st.GridLayer=ja,st.gridLayer=function(c){return new ja(c)},st.SVG=wl,st.svg=Fo,st.Renderer=to,st.Canvas=fr,st.canvas=Qo,st.Path=Os,st.CircleMarker=Fs,st.circleMarker=function(c,v){return new Fs(c,v)},st.Circle=Gl,st.circle=function(c,v,T){return new Gl(c,v,T)},st.Polyline=on,st.polyline=function(c,v){return new on(c,v)},st.Polygon=Zl,st.polygon=function(c,v){return new Zl(c,v)},st.Rectangle=Dc,st.rectangle=function(c,v){return new Dc(c,v)},st.Map=It,st.map=function(c,v){return new It(c,v)};var mu=window.L;st.noConflict=function(){return window.L=mu,this},window.L=st}(ss)},958:function(qu){qu.exports=function(){"use strict";var ss,st,Go;function Hn(p,zr){if(ss)if(st){var Qt="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+ss+")(sharedChunk); ("+st+")(sharedChunk); self.onerror = null;",Cr={};ss(Cr),Go=zr(Cr),"undefined"!=typeof window&&(Go.workerUrl=window.URL.createObjectURL(new Blob([Qt],{type:"text/javascript"})))}else st=zr;else ss=zr}return Hn(0,function(p){var Qt=Cr;function Cr(s,i,l,h){this.cx=3*s,this.bx=3*(l-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=h,this.p2x=l,this.p2y=h}Cr.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},Cr.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},Cr.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},Cr.prototype.solveCurveX=function(s,i){var l,h,f,y,x;for(void 0===i&&(i=1e-6),f=s,x=0;x<8;x++){if(y=this.sampleCurveX(f)-s,Math.abs(y)<i)return f;var E=this.sampleCurveDerivativeX(f);if(Math.abs(E)<1e-6)break;f-=y/E}if((f=s)<(l=0))return l;if(f>(h=1))return h;for(;l<h;){if(y=this.sampleCurveX(f),Math.abs(y-s)<i)return f;s>y?l=f:h=f,f=.5*(h-l)+l}return f},Cr.prototype.solve=function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))};var Qe=$e;function $e(s,i){this.x=s,this.y=i}$e.prototype={clone:function(){return new $e(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,i){return this.clone()._rotateAround(s,i)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var i=s.x-this.x,l=s.y-this.y;return i*i+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,i){return Math.atan2(this.x*i-this.y*s,this.x*s+this.y*i)},_matMult:function(s){var i=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=i,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var i=Math.cos(s),l=Math.sin(s),h=l*this.x+i*this.y;return this.x=i*this.x-l*this.y,this.y=h,this},_rotateAround:function(s,i){var l=Math.cos(s),h=Math.sin(s),f=i.y+h*(this.x-i.x)+l*(this.y-i.y);return this.x=i.x+l*(this.x-i.x)-h*(this.y-i.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$e.convert=function(s){return s instanceof $e?s:Array.isArray(s)?new $e(s[0],s[1]):s};var at="undefined"!=typeof self?self:{};const po=Math.pow(2,53)-1,mo=Math.PI/180,Yn=180/Math.PI;function In(s){return s*mo}const Ol=[[0,0],[1,0],[1,1],[0,1]];function sl(s){if(s<=0)return 0;if(s>=1)return 1;const i=s*s,l=i*s;return 4*(s<.5?l:3*(s-i)+l-.75)}function ar(s,i,l,h){const f=new Qt(s,i,l,h);return function(y){return f.solve(y)}}const Po=ar(.25,.1,.25,1);function gi(s,i,l){return Math.min(l,Math.max(i,s))}function as(s,i,l){const h=l-i,f=((s-i)%h+h)%h+i;return f===i?l:f}function al(s,i,l){if(!s.length)return l(null,[]);let h=s.length;const f=new Array(s.length);let y=null;s.forEach((x,E)=>{i(x,(S,A)=>{S&&(y=S),f[E]=A,0==--h&&l(y,f)})})}function Pn(s){const i=[];for(const l in s)i.push(s[l]);return i}function Ci(s,...i){for(const l of i)for(const h in l)s[h]=l[h];return s}let uu=1;function si(){return uu++}function Zi(){return function s(i){return i?(i^16*Math.random()>>i/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function ka(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function Pi(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function ll(s,i){s.forEach(l=>{i[l]&&(i[l]=i[l].bind(i))})}function _i(s,i){return-1!==s.indexOf(i,s.length-i.length)}function tn(s,i,l){const h={};for(const f in s)h[f]=i.call(l||this,s[f],f,s);return h}function Dt(s,i,l){const h={};for(const f in s)i.call(l||this,s[f],f,s)&&(h[f]=s[f]);return h}function ni(s){return Array.isArray(s)?s.map(ni):"object"==typeof s&&s?tn(s,ni):s}const nn={};function zt(s){nn[s]||("undefined"!=typeof console&&console.warn(s),nn[s]=!0)}function ki(s,i,l){return(l.y-s.y)*(i.x-s.x)>(i.y-s.y)*(l.x-s.x)}function Ri(s){let i=0;for(let l,h,f=0,y=s.length,x=y-1;f<y;x=f++)l=s[f],h=s[x],i+=(h.x-l.x)*(l.y+h.y);return i}function li(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Sn(s){const i={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,f,y)=>{const x=f||y;return i[h]=!x||x.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let Gn,jt,Wr,ea=null;function Ra(s){if(null==ea){const i=s.navigator?s.navigator.userAgent:null;ea=!!s.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return ea}function La(s){try{const i=at[s];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(i){return!1}}const qi={now:()=>void 0!==Wr?Wr:at.performance.now(),setNow(s){Wr=s},restoreNow(){Wr=void 0},frame(s){const i=at.requestAnimationFrame(s);return{cancel:()=>at.cancelAnimationFrame(i)}},getImageData(s,i=0){const l=at.document.createElement("canvas"),h=l.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return l.width=s.width,l.height=s.height,h.drawImage(s,0,0,s.width,s.height),h.getImageData(-i,-i,s.width+2*i,s.height+2*i)},resolveURL:s=>(Gn||(Gn=at.document.createElement("a")),Gn.href=s,Gn.href),get devicePixelRatio(){return at.devicePixelRatio},get prefersReducedMotion(){return!!at.matchMedia&&(null==jt&&(jt=at.matchMedia("(prefers-reduced-motion: reduce)")),jt.matches)}};let Zo;const Mn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Zo){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Zo=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):s}catch(i){Zo=s}}return Zo},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},qo={supported:!1,testSupport:function(s){!ko&&Jn&&(ta?go(s):As=s)}};let As,Jn,ko=!1,ta=!1;function go(s){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,Jn),s.isContextLost())return;qo.supported=!0}catch(l){}s.deleteTexture(i),ko=!0}at.document&&(Jn=at.document.createElement("img"),Jn.onload=function(){As&&go(As),As=null,ta=!0},Jn.onerror=function(){ko=!0,As=null},Jn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Oa="01",_o="NO_ACCESS_TOKEN";function Nn(s){return 0===s.indexOf("mapbox:")}function na(s){return Mn.API_URL_REGEX.test(s)}const cl=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yo(s){const i=s.match(cl);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Xr(s){const i=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${i}`}function Er(s){if(!s)return null;const i=s.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(at.atob(i[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(l){return null}}class ia{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const l=Er(Mn.ACCESS_TOKEN);let h="";return h=l&&l.u?at.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(f,y)=>String.fromCharCode(Number("0x"+y)))):Mn.ACCESS_TOKEN||"",i?`mapbox.eventData.${i}:${h}`:`mapbox.eventData:${h}`}fetchEventData(){const i=La("localStorage"),l=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{const f=at.localStorage.getItem(l);f&&(this.eventData=JSON.parse(f));const y=at.localStorage.getItem(h);y&&(this.anonId=y)}catch(f){zt("Unable to read from LocalStorage")}}saveEventData(){const i=La("localStorage"),l=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{at.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&at.localStorage.setItem(l,JSON.stringify(this.eventData))}catch(f){zt("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,l,h,f){if(!Mn.EVENTS_URL)return;const y=yo(Mn.EVENTS_URL);y.params.push(`access_token=${f||Mn.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.5.1",skuId:Oa,userId:this.anonId},E=l?Ci(x,l):x,S={url:Xr(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=W(S,A=>{this.pendingRequest=null,h(A),this.saveEventData(),this.processRequests(f)})}queueRequest(i,l){this.queue.push(i),this.processRequests(l)}}const ra=new class extends ia{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,i){Mn.EVENTS_URL&&Mn.ACCESS_TOKEN&&Array.isArray(s)&&s.some(l=>Nn(l)||na(l))&&this.queueRequest(Date.now(),i)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Er(Mn.ACCESS_TOKEN),l=i?i.u:Mn.ACCESS_TOKEN;let h=l!==this.eventData.tokenU;Pi(this.anonId)||(this.anonId=Zi(),h=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),x=new Date(f),E=(f-this.eventData.lastSuccess)/864e5;h=h||E>=1||E<-1||y.getDate()!==x.getDate()}else h=!0;if(!h)return this.processRequests();this.postEvent(f,{"enabled.telemetry":!1},y=>{y||(this.eventData.lastSuccess=f,this.eventData.tokenU=l)},s)}},Fl=ra.postTurnstileEvent.bind(ra),Fa=new class extends ia{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,i,l,h){this.skuToken=i,this.errorCb=h,Mn.EVENTS_URL&&(l||Mn.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},l):this.errorCb(new Error(_o)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),Pi(this.anonId)||(this.anonId=Zi()),this.postEvent(l,{skuToken:this.skuToken},h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},s))}},oa=Fa.postMapLoadEvent.bind(Fa),ul=new class extends ia{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,i,l,h){if(!Mn.API_URL||!Mn.SESSION_PATH)return;const f=yo(Mn.API_URL+Mn.SESSION_PATH);f.params.push(`sku=${i||""}`),f.params.push(`access_token=${h||Mn.ACCESS_TOKEN||""}`);const y={url:Xr(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=re(y,x=>{this.pendingRequest=null,l(x),this.saveEventData(),this.processRequests(h)})}getSessionAPI(s,i,l,h){this.skuToken=i,this.errorCb=h,Mn.SESSION_PATH&&Mn.API_URL&&(l||Mn.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},l):this.errorCb(new Error(_o)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||this.getSession(l,this.skuToken,h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},s)}},bc=ul.getSessionAPI.bind(ul),lr=new Set,Wo="mapbox-tiles";let Ro,sa,Xo=500,Kr=50;function Ft(){at.caches&&!Ro&&(Ro=at.caches.open(Wo))}function ls(s){const i=s.indexOf("?");return i<0?s:s.slice(0,i)}let Bt=1/0;const Tr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Tr);class Ko extends Error{constructor(i,l,h){401===l&&na(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(i),this.status=l,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const yn=li()?()=>self.worker&&self.worker.referrer:()=>("blob:"===at.location.protocol?at.parent:at).location.href,Q=function(s,i){if(!(/^file:/.test(l=s.url)||/^file:/.test(yn())&&!/^\w+:/.test(l))){if(at.fetch&&at.Request&&at.AbortController&&at.Request.prototype.hasOwnProperty("signal"))return function(h,f){const y=new at.AbortController,x=new at.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:yn(),signal:y.signal});let E=!1,S=!1;const A=(R=x.url).indexOf("sku=")>0&&na(R);var R;"json"===h.type&&x.headers.set("Accept","application/json");const F=(j,ee,ne)=>{if(S)return;if(j&&"SecurityError"!==j.message&&zt(j),ee&&ne)return z(ee);const ue=Date.now();at.fetch(x).then(ye=>{if(ye.ok){const Ce=A?ye.clone():null;return z(ye,Ce,ue)}return f(new Ko(ye.statusText,ye.status,h.url))}).catch(ye=>{20!==ye.code&&f(new Error(ye.message))})},z=(j,ee,ne)=>{("arrayBuffer"===h.type?j.arrayBuffer():"json"===h.type?j.json():j.text()).then(ue=>{S||(ee&&ne&&function(ye,Ce,Ie){if(Ft(),!Ro)return;const Pe={status:Ce.status,statusText:Ce.statusText,headers:new at.Headers};Ce.headers.forEach((Oe,Ue)=>Pe.headers.set(Ue,Oe));const ke=Sn(Ce.headers.get("Cache-Control")||"");ke["no-store"]||(ke["max-age"]&&Pe.headers.set("Expires",new Date(Ie+1e3*ke["max-age"]).toUTCString()),new Date(Pe.headers.get("Expires")).getTime()-Ie<42e4||function(Oe,Ue){if(void 0===sa)try{new Response(new ReadableStream),sa=!0}catch(Ye){sa=!1}sa?Ue(Oe.body):Oe.blob().then(Ue)}(Ce,Oe=>{const Ue=new at.Response(Oe,Pe);Ft(),Ro&&Ro.then(Ye=>Ye.put(ls(ye.url),Ue)).catch(Ye=>zt(Ye.message))}))}(x,ee,ne),E=!0,f(null,ue,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(ue=>{S||f(new Error(ue.message))})};return A?function(j,ee){if(Ft(),!Ro)return ee(null);const ne=ls(j.url);Ro.then(ue=>{ue.match(ne).then(ye=>{const Ce=function(Ie){if(!Ie)return!1;const Pe=new Date(Ie.headers.get("Expires")||0),ke=Sn(Ie.headers.get("Cache-Control")||"");return Pe>Date.now()&&!ke["no-cache"]}(ye);ue.delete(ne),Ce&&ue.put(ne,ye.clone()),ee(null,ye,Ce)}).catch(ee)}).catch(ee)}(x,F):F(null,null),{cancel:()=>{S=!0,E||y.abort()}}}(s,i);if(li()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,i,void 0,!0)}var l;return function(h,f){const y=new at.XMLHttpRequest;y.open(h.method||"GET",h.url,!0),"arrayBuffer"===h.type&&(y.responseType="arraybuffer");for(const x in h.headers)y.setRequestHeader(x,h.headers[x]);return"json"===h.type&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials="include"===h.credentials,y.onerror=()=>{f(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||0===y.status)&&null!==y.response){let x=y.response;if("json"===h.type)try{x=JSON.parse(y.response)}catch(E){return f(E)}f(null,x,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else f(new Ko(y.statusText,y.status,h.url))},y.send(h.body),{cancel:()=>y.abort()}}(s,i)},$=function(s,i){return Q(Ci(s,{type:"arrayBuffer"}),i)},W=function(s,i){return Q(Ci(s,{method:"POST"}),i)},re=function(s,i){return Q(Ci(s,{method:"GET"}),i)};function le(s){const i=at.document.createElement("a");return i.href=s,i.protocol===at.document.location.protocol&&i.host===at.document.location.host}const ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ve,Ee;ve=[],Ee=0;const be=function(s,i){if(qo.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Ee>=Mn.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:s,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return ve.push(y),y}Ee++;let l=!1;const h=()=>{if(!l)for(l=!0,Ee--;ve.length&&Ee<Mn.MAX_PARALLEL_IMAGE_REQUESTS;){const y=ve.shift(),{requestParameters:x,callback:E,cancelled:S}=y;S||(y.cancel=be(x,E).cancel)}},f=$(s,(y,x,E,S)=>{h(),y?i(y):x&&(at.createImageBitmap?function(A,R){const F=new at.Blob([new Uint8Array(A)],{type:"image/png"});at.createImageBitmap(F).then(z=>{R(null,z)}).catch(z=>{R(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(A,R)=>i(A,R,E,S)):function(A,R){const F=new at.Image,z=at.URL;F.onload=()=>{R(null,F),z.revokeObjectURL(F.src),F.onload=null,at.requestAnimationFrame(()=>{F.src=ge})},F.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new at.Blob([new Uint8Array(A)],{type:"image/png"});F.src=A.byteLength?z.createObjectURL(j):ge}(x,(A,R)=>i(A,R,E,S)))});return{cancel:()=>{f.cancel(),h()}}};function Ae(s,i,l){l[s]&&-1!==l[s].indexOf(i)||(l[s]=l[s]||[],l[s].push(i))}function Ge(s,i,l){if(l&&l[s]){const h=l[s].indexOf(i);-1!==h&&l[s].splice(h,1)}}class it{constructor(i,l={}){Ci(this,l),this.type=i}}class He extends it{constructor(i,l={}){super("error",Ci({error:i},l))}}class xt{on(i,l){return this._listeners=this._listeners||{},Ae(i,l,this._listeners),this}off(i,l){return Ge(i,l,this._listeners),Ge(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Ae(i,l,this._oneTimeListeners),this):new Promise(h=>this.once(i,h))}fire(i,l){"string"==typeof i&&(i=new it(i,l||{}));const h=i.type;if(this.listens(h)){i.target=this;const f=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of f)E.call(this,i);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of y)Ge(h,E,this._oneTimeListeners),E.call(this,i);const x=this._eventedParent;x&&(Ci(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof He&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Ne{constructor(i,l,h,f){this.message=(i?`${i}: `:"")+h,f&&(this.identifier=f),null!=l&&l.__line__&&(this.line=l.__line__)}}function vt(s){const i=s.value;return i?[new Ne(s.key,i,"constants have been deprecated as of v8")]:[]}function qt(s,...i){for(const l of i)for(const h in l)s[h]=l[h];return s}function Nt(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function vn(s){if(Array.isArray(s))return s.map(vn);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const i={};for(const l in s)i[l]=vn(s[l]);return i}return Nt(s)}class rn extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class kn{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[h,f]of l)this.bindings[h]=f}concat(i){return new kn(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const aa={kind:"null"},lt={kind:"number"},Gt={kind:"string"},Ct={kind:"boolean"},xn={kind:"color"},cr={kind:"object"},Vt={kind:"value"},An={kind:"collator"},mt={kind:"formatted"},la={kind:"resolvedImage"};function Rn(s,i){return{kind:"array",itemType:s,N:i}}function fn(s){if("array"===s.kind){const i=fn(s.itemType);return"number"==typeof s.N?`array<${i}, ${s.N}>`:"value"===s.itemType.kind?"array":`array<${i}>`}return s.kind}const Nl=[aa,lt,Gt,Ct,xn,mt,cr,Rn(Vt),la];function Ut(s,i){if("error"===i.kind)return null;if("array"===s.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!Ut(s.itemType,i.itemType))&&("number"!=typeof s.N||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if("value"===s.kind)for(const l of Nl)if(!Ut(l,i))return null}return`Expected ${fn(s)} but found ${fn(i)} instead.`}function Qn(s,i){return i.some(l=>l.kind===s.kind)}function ca(s,i){return i.some(l=>"null"===l?null===s:"array"===l?Array.isArray(s):"object"===l?s&&!Array.isArray(s)&&"object"==typeof s:l===typeof s)}function Br(s){var i={exports:{}};return s(i,i.exports),i.exports}var Dr=Br(function(s,i){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function h(E){return(E=Math.round(E))<0?0:E>255?255:E}function f(E){return h("%"===E[E.length-1]?parseFloat(E)/100*255:parseInt(E))}function y(E){return(S="%"===E[E.length-1]?parseFloat(E)/100:parseFloat(E))<0?0:S>1?1:S;var S}function x(E,S,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?E+(S-E)*A*6:2*A<1?S:3*A<2?E+(S-E)*(2/3-A)*6:E}try{i.parseCSSColor=function(E){var S,A=E.replace(/ /g,"").toLowerCase();if(A in l)return l[A].slice();if("#"===A[0])return 4===A.length?(S=parseInt(A.substr(1),16))>=0&&S<=4095?[(3840&S)>>4|(3840&S)>>8,240&S|(240&S)>>4,15&S|(15&S)<<4,1]:null:7===A.length&&(S=parseInt(A.substr(1),16))>=0&&S<=16777215?[(16711680&S)>>16,(65280&S)>>8,255&S,1]:null;var R=A.indexOf("("),F=A.indexOf(")");if(-1!==R&&F+1===A.length){var z=A.substr(0,R),j=A.substr(R+1,F-(R+1)).split(","),ee=1;switch(z){case"rgba":if(4!==j.length)return null;ee=y(j.pop());case"rgb":return 3!==j.length?null:[f(j[0]),f(j[1]),f(j[2]),ee];case"hsla":if(4!==j.length)return null;ee=y(j.pop());case"hsl":if(3!==j.length)return null;var ne=(parseFloat(j[0])%360+360)%360/360,ue=y(j[1]),ye=y(j[2]),Ce=ye<=.5?ye*(ue+1):ye+ue-ye*ue,Ie=2*ye-Ce;return[h(255*x(Ie,Ce,ne+1/3)),h(255*x(Ie,Ce,ne)),h(255*x(Ie,Ce,ne-1/3)),ee];default:return null}}return null}}catch(E){}});class $t{constructor(i,l,h,f=1){this.r=i,this.g=l,this.b=h,this.a=f}static parse(i){if(!i)return;if(i instanceof $t)return i;if("string"!=typeof i)return;const l=Dr.parseCSSColor(i);return l?new $t(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[i,l,h,f]=this.toArray();return`rgba(${Math.round(i)},${Math.round(l)},${Math.round(h)},${f})`}toArray(){const{r:i,g:l,b:h,a:f}=this;return 0===f?[0,0,0,0]:[255*i/f,255*l/f,255*h/f,f]}}$t.black=new $t(0,0,0,1),$t.white=new $t(1,1,1,1),$t.transparent=new $t(0,0,0,0),$t.red=new $t(1,0,0,1),$t.blue=new $t(0,0,1,1);class hl{constructor(i,l,h){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class wt{constructor(i,l,h,f,y){this.text=i,this.image=l,this.scale=h,this.fontStack=f,this.textColor=y}}class cn{constructor(i){this.sections=i}static fromString(i){return new cn([new wt(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof cn?i:cn.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const l of this.sections){if(l.image){i.push(["image",l.image.name]);continue}i.push(l.text);const h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toArray())),i.push(h)}return i}}class Ni{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Ni({name:i,available:!1}):null}serialize(){return["image",this.name]}}function vo(s,i,l,h){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[s,i,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[s,i,l,h]:[s,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Is(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof $t||s instanceof hl||s instanceof cn||s instanceof Ni)return!0;if(Array.isArray(s)){for(const i of s)if(!Is(i))return!1;return!0}if("object"==typeof s){for(const i in s)if(!Is(s[i]))return!1;return!0}return!1}function Li(s){if(null===s)return aa;if("string"==typeof s)return Gt;if("boolean"==typeof s)return Ct;if("number"==typeof s)return lt;if(s instanceof $t)return xn;if(s instanceof hl)return An;if(s instanceof cn)return mt;if(s instanceof Ni)return la;if(Array.isArray(s)){const i=s.length;let l;for(const h of s){const f=Li(h);if(l){if(l===f)continue;l=Vt;break}l=f}return Rn(l||Vt,i)}return cr}function ur(s){const i=typeof s;return null===s?"":"string"===i||"number"===i||"boolean"===i?String(s):s instanceof $t||s instanceof cn||s instanceof Ni?s.toString():JSON.stringify(s)}class Ei{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(2!==i.length)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Is(i[1]))return l.error("invalid value");const h=i[1];let f=Li(h);const y=l.expectedType;return"array"!==f.kind||0!==f.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(f=y),new Ei(f,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof $t?["rgba"].concat(this.value.toArray()):this.value instanceof cn?this.value.serialize():this.value}}class Ji{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const ua={string:Gt,number:lt,boolean:Ct,object:cr};class zn{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let h,f=1;const y=i[0];if("array"===y){let E,S;if(i.length>2){const A=i[1];if("string"!=typeof A||!(A in ua)||"object"===A)return l.error('The item type argument of "array" must be one of string, number, boolean',1);E=ua[A],f++}else E=Vt;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);S=i[2],f++}h=Rn(E,S)}else h=ua[y];const x=[];for(;f<i.length;f++){const E=l.parse(i[f],f,Vt);if(!E)return null;x.push(E)}return new zn(h,x)}evaluate(i){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(i);if(!Ut(this.type,Li(h)))return h;if(l===this.args.length-1)throw new Ji(`Expected value to be of type ${fn(this.type)}, but found ${fn(Li(h))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,l=[i.kind];if("array"===i.kind){const h=i.itemType;if("string"===h.kind||"number"===h.kind||"boolean"===h.kind){l.push(h.kind);const f=i.N;("number"==typeof f||this.args.length>1)&&l.push(f)}}return l.concat(this.args.map(h=>h.serialize()))}}class Na{constructor(i){this.type=mt,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&"object"==typeof h)return l.error("First argument must be an image or text section.");const f=[];let y=!1;for(let x=1;x<=i.length-1;++x){const E=i[x];if(y&&"object"==typeof E&&!Array.isArray(E)){y=!1;let S=null;if(E["font-scale"]&&(S=l.parse(E["font-scale"],1,lt),!S))return null;let A=null;if(E["text-font"]&&(A=l.parse(E["text-font"],1,Rn(Gt)),!A))return null;let R=null;if(E["text-color"]&&(R=l.parse(E["text-color"],1,xn),!R))return null;const F=f[f.length-1];F.scale=S,F.font=A,F.textColor=R}else{const S=l.parse(i[x],1,Vt);if(!S)return null;const A=S.type.kind;if("string"!==A&&"value"!==A&&"null"!==A&&"resolvedImage"!==A)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new Na(f)}evaluate(i){return new cn(this.sections.map(l=>{const h=l.content.evaluate(i);return Li(h)===la?new wt("",h,null,null,null):new wt(ur(h),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const l of this.sections){i.push(l.content.serialize());const h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),i.push(h)}return i}}class za{constructor(i){this.type=la,this.input=i}static parse(i,l){if(2!==i.length)return l.error("Expected two arguments.");const h=l.parse(i[1],1,Gt);return h?new za(h):l.error("No image name provided.")}evaluate(i){const l=this.input.evaluate(i),h=Ni.fromString(l);return h&&i.availableImages&&(h.available=i.availableImages.indexOf(l)>-1),h}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Wu={"to-boolean":Ct,"to-color":xn,"to-number":lt,"to-string":Gt};class cs{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[0];if(("to-boolean"===h||"to-string"===h)&&2!==i.length)return l.error("Expected one argument.");const f=Wu[h],y=[];for(let x=1;x<i.length;x++){const E=l.parse(i[x],x,Vt);if(!E)return null;y.push(E)}return new cs(f,y)}evaluate(i){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(i));if("color"===this.type.kind){let l,h;for(const f of this.args){if(l=f.evaluate(i),h=null,l instanceof $t)return l;if("string"==typeof l){const y=i.parseColor(l);if(y)return y}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:vo(l[0],l[1],l[2],l[3]),!h))return new $t(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Ji(h||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const h of this.args){if(l=h.evaluate(i),null===l)return 0;const f=Number(l);if(!isNaN(f))return f}throw new Ji(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?cn.fromString(ur(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?Ni.fromString(ur(this.args[0].evaluate(i))):ur(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Na([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new za(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(l=>{i.push(l.serialize())}),i}}const Un=["Unknown","Point","LineString","Polygon"];class mn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Un[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=$t.parse(i)),l}}class Ti{constructor(i,l,h,f){this.name=i,this.type=l,this._evaluate=h,this.args=f}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,l){const h=i[0],f=Ti.definitions[h];if(!f)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=x.filter(([A])=>!Array.isArray(A)||A.length===i.length-1);let S=null;for(const[A,R]of E){S=new Qr(l.registry,l.path,null,l.scope);const F=[];let z=!1;for(let j=1;j<i.length;j++){const ee=i[j],ne=Array.isArray(A)?A[j-1]:A.type,ue=S.parse(ee,1+F.length,ne);if(!ue){z=!0;break}F.push(ue)}if(!z)if(Array.isArray(A)&&A.length!==F.length)S.error(`Expected ${A.length} arguments, but found ${F.length} instead.`);else{for(let j=0;j<F.length;j++){const ee=Array.isArray(A)?A[j]:A.type,ne=F[j];S.concat(j+1).checkSubtype(ee,ne.type)}if(0===S.errors.length)return new Ti(h,y,R,F)}}if(1===E.length)l.errors.push(...S.errors);else{const A=(E.length?E:x).map(([F])=>{return z=F,Array.isArray(z)?`(${z.map(fn).join(", ")})`:`(${fn(z.type)}...)`;var z}).join(" | "),R=[];for(let F=1;F<i.length;F++){const z=l.parse(i[F],1+R.length);if(!z)return null;R.push(fn(z.type))}l.error(`Expected arguments of type ${A}, but found (${R.join(", ")}) instead.`)}return null}static register(i,l){Ti.definitions=l;for(const h in l)i[h]=Ti}}class On{constructor(i,l,h){this.type=An,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(2!==i.length)return l.error("Expected one argument.");const h=i[1];if("object"!=typeof h||Array.isArray(h))return l.error("Collator options argument must be an object.");const f=l.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Ct);if(!f)return null;const y=l.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Ct);if(!y)return null;let x=null;return h.locale&&(x=l.parse(h.locale,1,Gt),!x)?null:new On(f,y,x)}evaluate(i){return new hl(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const bn=8192;function ha(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function Ps(s,i){return!(s[0]<=i[0]||s[2]>=i[2]||s[1]<=i[1]||s[3]>=i[3])}function zl(s,i){const l=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,f=Math.pow(2,i.z);return[Math.round(l*f*bn),Math.round(h*f*bn)]}function da(s,i,l){const h=s[0]-i[0],f=s[1]-i[1],y=s[0]-l[0],x=s[1]-l[1];return h*x-y*f==0&&h*y<=0&&f*x<=0}function Bl(s,i){let l=!1;for(let x=0,E=i.length;x<E;x++){const S=i[x];for(let A=0,R=S.length;A<R-1;A++){if(da(s,S[A],S[A+1]))return!1;(f=S[A])[1]>(h=s)[1]!=(y=S[A+1])[1]>h[1]&&h[0]<(y[0]-f[0])*(h[1]-f[1])/(y[1]-f[1])+f[0]&&(l=!l)}}var h,f,y;return l}function Yr(s,i){for(let l=0;l<i.length;l++)if(Bl(s,i[l]))return!0;return!1}function zi(s,i,l,h){const f=h[0]-l[0],y=h[1]-l[1],x=(s[0]-l[0])*y-f*(s[1]-l[1]),E=(i[0]-l[0])*y-f*(i[1]-l[1]);return x>0&&E<0||x<0&&E>0}function ks(s,i,l){for(const A of l)for(let R=0;R<A.length-1;++R)if((E=[(x=A[R+1])[0]-(y=A[R])[0],x[1]-y[1]])[0]*(S=[(f=i)[0]-(h=s)[0],f[1]-h[1]])[1]-E[1]*S[0]!=0&&zi(h,f,y,x)&&zi(y,x,h,f))return!0;var h,f,y,x,E,S;return!1}function Qi(s,i){for(let l=0;l<s.length;++l)if(!Bl(s[l],i))return!1;for(let l=0;l<s.length-1;++l)if(ks(s[l],s[l+1],i))return!1;return!0}function Ih(s,i){for(let l=0;l<i.length;l++)if(Qi(s,i[l]))return!0;return!1}function Vl(s,i,l){const h=[];for(let f=0;f<s.length;f++){const y=[];for(let x=0;x<s[f].length;x++){const E=zl(s[f][x],l);ha(i,E),y.push(E)}h.push(y)}return h}function Jr(s,i,l){const h=[];for(let f=0;f<s.length;f++){const y=Vl(s[f],i,l);h.push(y)}return h}function dl(s,i,l,h){if(s[0]<l[0]||s[0]>l[2]){const f=.5*h;let y=s[0]-l[0]>f?-h:l[0]-s[0]>f?h:0;0===y&&(y=s[0]-l[2]>f?-h:l[2]-s[0]>f?h:0),s[0]+=y}ha(i,s)}function er(s,i,l,h){const f=Math.pow(2,h.z)*bn,y=[h.x*bn,h.y*bn],x=[];for(const E of s)for(const S of E){const A=[S.x+y[0],S.y+y[1]];dl(A,i,l,f),x.push(A)}return x}function fa(s,i,l,h){const f=Math.pow(2,h.z)*bn,y=[h.x*bn,h.y*bn],x=[];for(const S of s){const A=[];for(const R of S){const F=[R.x+y[0],R.y+y[1]];ha(i,F),A.push(F)}x.push(A)}if(i[2]-i[0]<=f/2){(E=i)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const S of x)for(const A of S)dl(A,i,l,f)}var E;return x}class Lo{constructor(i,l){this.type=Ct,this.geojson=i,this.geometries=l}static parse(i,l){if(2!==i.length)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Is(i[1])){const h=i[1];if("FeatureCollection"===h.type)for(let f=0;f<h.features.length;++f){const y=h.features[f].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new Lo(h,h.features[f].geometry)}else if("Feature"===h.type){const f=h.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Lo(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new Lo(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(l,h){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if("Polygon"===h.type){const E=Vl(h.coordinates,y,x),S=er(l.geometry(),f,y,x);if(!Ps(f,y))return!1;for(const A of S)if(!Bl(A,E))return!1}if("MultiPolygon"===h.type){const E=Jr(h.coordinates,y,x),S=er(l.geometry(),f,y,x);if(!Ps(f,y))return!1;for(const A of S)if(!Yr(A,E))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(l,h){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if("Polygon"===h.type){const E=Vl(h.coordinates,y,x),S=fa(l.geometry(),f,y,x);if(!Ps(f,y))return!1;for(const A of S)if(!Qi(A,E))return!1}if("MultiPolygon"===h.type){const E=Jr(h.coordinates,y,x),S=fa(l.geometry(),f,y,x);if(!Ps(f,y))return!1;for(const A of S)if(!Ih(A,E))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Et(s){if(s instanceof Ti&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof Lo)return!1;let i=!0;return s.eachChild(l=>{i&&!Et(l)&&(i=!1)}),i}function It(s){if(s instanceof Ti&&"feature-state"===s.name)return!1;let i=!0;return s.eachChild(l=>{i&&!It(l)&&(i=!1)}),i}function tr(s,i){if(s instanceof Ti&&i.indexOf(s.name)>=0)return!1;let l=!0;return s.eachChild(h=>{l&&!tr(h,i)&&(l=!1)}),l}class Mt{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(2!==i.length||"string"!=typeof i[1])return l.error("'var' expression requires exactly one string literal argument.");const h=i[1];return l.scope.has(h)?new Mt(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Qr{constructor(i,l=[],h,f=new kn,y=[]){this.registry=i,this.path=l,this.key=l.map(x=>`[${x}]`).join(""),this.scope=f,this.errors=y,this.expectedType=h}parse(i,l,h,f,y={}){return l?this.concat(l,h,f)._parse(i,y):this._parse(i,y)}_parse(i,l){function h(f,y,x){return"assert"===x?new zn(y,[f]):"coerce"===x?new cs(y,[f]):f}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=i[0];if("string"!=typeof f)return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let x=y.parse(i,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,S=x.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==S.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==S.kind&&"string"!==S.kind){if(this.checkSubtype(E,S))return null}else x=h(x,E,l.typeAnnotation||"coerce");else x=h(x,E,l.typeAnnotation||"assert")}if(!(x instanceof Ei)&&"resolvedImage"!==x.type.kind&&Vr(x)){const E=new mn;try{x=new Ei(x.type,x.evaluate(E))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,h){const f="number"==typeof i?this.path.concat(i):this.path,y=h?this.scope.concat(h):this.scope;return new Qr(this.registry,f,l||null,y,this.errors)}error(i,...l){const h=`${this.key}${l.map(f=>`[${f}]`).join("")}`;this.errors.push(new rn(h,i))}checkSubtype(i,l){const h=Ut(i,l);return h&&this.error(h),h}}function Vr(s){if(s instanceof Mt)return Vr(s.boundExpression);if(s instanceof Ti&&"error"===s.name||s instanceof On||s instanceof Lo)return!1;const i=s instanceof cs||s instanceof zn;let l=!0;return s.eachChild(h=>{l=i?l&&Vr(h):l&&h instanceof Ei}),!!l&&Et(s)&&tr(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function wc(s,i){const l=s.length-1;let h,f,y=0,x=l,E=0;for(;y<=x;)if(E=Math.floor((y+x)/2),h=s[E],f=s[E+1],h<=i){if(E===l||i<f)return E;y=E+1}else{if(!(h>i))throw new Ji("Input is not a number.");x=E-1}return 0}class Wi{constructor(i,l,h){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[f,y]of h)this.labels.push(f),this.outputs.push(y)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(i[1],1,lt);if(!h)return null;const f=[];let y=null;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);for(let x=1;x<i.length;x+=2){const E=1===x?-1/0:i[x],S=i[x+1],A=x,R=x+1;if("number"!=typeof E)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(f.length&&f[f.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const F=l.parse(S,R,y);if(!F)return null;y=y||F.type,f.push([E,F])}return new Wi(y,h,f)}evaluate(i){const l=this.labels,h=this.outputs;if(1===l.length)return h[0].evaluate(i);const f=this.input.evaluate(i);if(f<=l[0])return h[0].evaluate(i);const y=l.length;return f>=l[y-1]?h[y-1].evaluate(i):h[wc(l,f)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i}}function et(s,i,l){return s*(1-l)+i*l}var Wt=Object.freeze({__proto__:null,number:et,color:function(s,i,l){return new $t(et(s.r,i.r,l),et(s.g,i.g,l),et(s.b,i.b,l),et(s.a,i.a,l))},array:function(s,i,l){return s.map((h,f)=>et(h,i[f],l))}});const Rs=4/29,Zn=6/29,us=3*Zn*Zn,yi=Math.PI/180,fl=180/Math.PI;function Yo(s){return s>.008856451679035631?Math.pow(s,1/3):s/us+Rs}function Lt(s){return s>Zn?s*s*s:us*(s-Rs)}function pa(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function hs(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Ul(s){const i=hs(s.r),l=hs(s.g),h=hs(s.b),f=Yo((.4124564*i+.3575761*l+.1804375*h)/.95047),y=Yo((.2126729*i+.7151522*l+.072175*h)/1);return{l:116*y-16,a:500*(f-y),b:200*(y-Yo((.0193339*i+.119192*l+.9503041*h)/1.08883)),alpha:s.a}}function ma(s){let i=(s.l+16)/116,l=isNaN(s.a)?i:i+s.a/500,h=isNaN(s.b)?i:i-s.b/200;return i=1*Lt(i),l=.95047*Lt(l),h=1.08883*Lt(h),new $t(pa(3.2404542*l-1.5371385*i-.4985314*h),pa(-.969266*l+1.8760108*i+.041556*h),pa(.0556434*l-.2040259*i+1.0572252*h),s.alpha)}function Sr(s,i,l){const h=i-s;return s+l*(h>180||h<-180?h-360*Math.round(h/360):h)}const ds={forward:Ul,reverse:ma,interpolate:function(s,i,l){return{l:et(s.l,i.l,l),a:et(s.a,i.a,l),b:et(s.b,i.b,l),alpha:et(s.alpha,i.alpha,l)}}},Oo={forward:function(s){const{l:i,a:l,b:h}=Ul(s),f=Math.atan2(h,l)*fl;return{h:f<0?f+360:f,c:Math.sqrt(l*l+h*h),l:i,alpha:s.a}},reverse:function(s){const i=s.h*yi,l=s.c;return ma({l:s.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:s.alpha})},interpolate:function(s,i,l){return{h:Sr(s.h,i.h,l),c:et(s.c,i.c,l),l:et(s.l,i.l,l),alpha:et(s.alpha,i.alpha,l)}}};var xo=Object.freeze({__proto__:null,lab:ds,hcl:Oo});class en{constructor(i,l,h,f,y){this.type=i,this.operator=l,this.interpolation=h,this.input=f,this.labels=[],this.outputs=[];for(const[x,E]of y)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(i,l,h,f){let y=0;if("exponential"===i.name)y=Ls(l,i.base,h,f);else if("linear"===i.name)y=Ls(l,1,h,f);else if("cubic-bezier"===i.name){const x=i.controlPoints;y=new Qt(x[0],x[1],x[2],x[3]).solve(Ls(l,1,h,f))}return y}static parse(i,l){let[h,f,y,...x]=i;if(!Array.isArray(f)||0===f.length)return l.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){const A=f[1];if("number"!=typeof A)return l.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:A}}else{if("cubic-bezier"!==f[0])return l.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const A=f.slice(1);if(4!==A.length||A.some(R=>"number"!=typeof R||R<0||R>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:A}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(y=l.parse(y,2,lt),!y)return null;const E=[];let S=null;"interpolate-hcl"===h||"interpolate-lab"===h?S=xn:l.expectedType&&"value"!==l.expectedType.kind&&(S=l.expectedType);for(let A=0;A<x.length;A+=2){const R=x[A],F=x[A+1],z=A+3,j=A+4;if("number"!=typeof R)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(E.length&&E[E.length-1][0]>=R)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const ee=l.parse(F,j,S);if(!ee)return null;S=S||ee.type,E.push([R,ee])}return"number"===S.kind||"color"===S.kind||"array"===S.kind&&"number"===S.itemType.kind&&"number"==typeof S.N?new en(S,h,f,y,E):l.error(`Type ${fn(S)} is not interpolatable.`)}evaluate(i){const l=this.labels,h=this.outputs;if(1===l.length)return h[0].evaluate(i);const f=this.input.evaluate(i);if(f<=l[0])return h[0].evaluate(i);const y=l.length;if(f>=l[y-1])return h[y-1].evaluate(i);const x=wc(l,f),E=en.interpolationFactor(this.interpolation,f,l[x],l[x+1]),S=h[x].evaluate(i),A=h[x+1].evaluate(i);return"interpolate"===this.operator?Wt[this.type.kind.toLowerCase()](S,A,E):"interpolate-hcl"===this.operator?Oo.reverse(Oo.interpolate(Oo.forward(S),Oo.forward(A),E)):ds.reverse(ds.interpolate(ds.forward(S),ds.forward(A),E))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)l.push(this.labels[h],this.outputs[h].serialize());return l}}function Ls(s,i,l,h){const f=h-l,y=s-l;return 0===f?0:1===i?y/f:(Math.pow(i,y)-1)/(Math.pow(i,f)-1)}class Cc{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let h=null;const f=l.expectedType;f&&"value"!==f.kind&&(h=f);const y=[];for(const E of i.slice(1)){const S=l.parse(E,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!S)return null;h=h||S.type,y.push(S)}const x=f&&y.some(E=>Ut(f,E.type));return new Cc(x?Vt:h,y)}evaluate(i){let l,h=null,f=0;for(const y of this.args)if(f++,h=y.evaluate(i),h&&h instanceof Ni&&!h.available&&(l||(l=h.name),h=null,f===this.args.length&&(h=l)),null!==h)break;return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class Jo{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let y=1;y<i.length-1;y+=2){const x=i[y];if("string"!=typeof x)return l.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=l.parse(i[y+1],y+1);if(!E)return null;h.push([x,E])}const f=l.parse(i[i.length-1],i.length-1,l.expectedType,h);return f?new Jo(h,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[l,h]of this.bindings)i.push(l,h.serialize());return i.push(this.result.serialize()),i}}class eo{constructor(i,l,h){this.type=i,this.index=l,this.input=h}static parse(i,l){if(3!==i.length)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,lt),f=l.parse(i[2],2,Rn(l.expectedType||Vt));return h&&f?new eo(f.type.itemType,h,f):null}evaluate(i){const l=this.index.evaluate(i),h=this.input.evaluate(i);if(l<0)throw new Ji(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new Ji(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new Ji(`Array index must be an integer, but found ${l} instead.`);return h[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ga{constructor(i,l){this.type=Ct,this.needle=i,this.haystack=l}static parse(i,l){if(3!==i.length)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,Vt),f=l.parse(i[2],2,Vt);return h&&f?Qn(h.type,[Ct,Gt,lt,aa,Vt])?new ga(h,f):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${fn(h.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!h)return!1;if(!ca(l,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${fn(Li(l))} instead.`);if(!ca(h,["string","array"]))throw new Ji(`Expected second argument to be of type array or string, but found ${fn(Li(h))} instead.`);return h.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ba{constructor(i,l,h){this.type=lt,this.needle=i,this.haystack=l,this.fromIndex=h}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,Vt),f=l.parse(i[2],2,Vt);if(!h||!f)return null;if(!Qn(h.type,[Ct,Gt,lt,aa,Vt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${fn(h.type)} instead`);if(4===i.length){const y=l.parse(i[3],3,lt);return y?new Ba(h,f,y):null}return new Ba(h,f)}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!ca(l,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${fn(Li(l))} instead.`);if(!ca(h,["string","array"]))throw new Ji(`Expected second argument to be of type array or string, but found ${fn(Li(h))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(i);return h.indexOf(l,f)}return h.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class fs{constructor(i,l,h,f,y,x){this.inputType=i,this.type=l,this.input=h,this.cases=f,this.outputs=y,this.otherwise=x}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let h,f;l.expectedType&&"value"!==l.expectedType.kind&&(f=l.expectedType);const y={},x=[];for(let A=2;A<i.length-1;A+=2){let R=i[A];const F=i[A+1];Array.isArray(R)||(R=[R]);const z=l.concat(A);if(0===R.length)return z.error("Expected at least one branch label.");for(const ee of R){if("number"!=typeof ee&&"string"!=typeof ee)return z.error("Branch labels must be numbers or strings.");if("number"==typeof ee&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ee&&Math.floor(ee)!==ee)return z.error("Numeric branch labels must be integer values.");if(h){if(z.checkSubtype(h,Li(ee)))return null}else h=Li(ee);if(void 0!==y[String(ee)])return z.error("Branch labels must be unique.");y[String(ee)]=x.length}const j=l.parse(F,A,f);if(!j)return null;f=f||j.type,x.push(j)}const E=l.parse(i[1],1,Vt);if(!E)return null;const S=l.parse(i[i.length-1],i.length-1,f);return S?"value"!==E.type.kind&&l.concat(1).checkSubtype(h,E.type)?null:new fs(h,f,E,y,x,S):null}evaluate(i){const l=this.input.evaluate(i);return(Li(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),h=[],f={};for(const x of l){const E=f[this.cases[x]];void 0===E?(f[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[E][1].push(x)}const y=x=>"number"===this.inputType.kind?Number(x):x;for(const[x,E]of h)i.push(1===E.length?y(E[0]):E.map(y)),i.push(this.outputs[x].serialize());return i.push(this.otherwise.serialize()),i}}class Xi{constructor(i,l,h){this.type=i,this.branches=l,this.otherwise=h}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&"value"!==l.expectedType.kind&&(h=l.expectedType);const f=[];for(let x=1;x<i.length-1;x+=2){const E=l.parse(i[x],x,Ct);if(!E)return null;const S=l.parse(i[x+1],x+1,h);if(!S)return null;f.push([E,S]),h=h||S.type}const y=l.parse(i[i.length-1],i.length-1,h);return y?new Xi(h,f,y):null}evaluate(i){for(const[l,h]of this.branches)if(l.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,h]of this.branches)i(l),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class Va{constructor(i,l,h,f){this.type=i,this.input=l,this.beginIndex=h,this.endIndex=f}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,Vt),f=l.parse(i[2],2,lt);if(!h||!f)return null;if(!Qn(h.type,[Rn(Vt),Gt,Vt]))return l.error(`Expected first argument to be of type array or string, but found ${fn(h.type)} instead`);if(4===i.length){const y=l.parse(i[3],3,lt);return y?new Va(h.type,h,f,y):null}return new Va(h.type,h,f)}evaluate(i){const l=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!ca(l,["string","array"]))throw new Ji(`Expected first argument to be of type array or string, but found ${fn(Li(l))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(i);return l.slice(h,f)}return l.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function bo(s,i){return"=="===s||"!="===s?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function wo(s,i,l,h){return 0===h.compare(i,l)}function _a(s,i,l){const h="=="!==s&&"!="!==s;return class bM{constructor(y,x,E){this.type=Ct,this.lhs=y,this.rhs=x,this.collator=E,this.hasUntypedArgument="value"===y.type.kind||"value"===x.type.kind}static parse(y,x){if(3!==y.length&&4!==y.length)return x.error("Expected two or three arguments.");const E=y[0];let S=x.parse(y[1],1,Vt);if(!S)return null;if(!bo(E,S.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${fn(S.type)}'.`);let A=x.parse(y[2],2,Vt);if(!A)return null;if(!bo(E,A.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${fn(A.type)}'.`);if(S.type.kind!==A.type.kind&&"value"!==S.type.kind&&"value"!==A.type.kind)return x.error(`Cannot compare types '${fn(S.type)}' and '${fn(A.type)}'.`);h&&("value"===S.type.kind&&"value"!==A.type.kind?S=new zn(A.type,[S]):"value"!==S.type.kind&&"value"===A.type.kind&&(A=new zn(S.type,[A])));let R=null;if(4===y.length){if("string"!==S.type.kind&&"string"!==A.type.kind&&"value"!==S.type.kind&&"value"!==A.type.kind)return x.error("Cannot use collator to compare non-string types.");if(R=x.parse(y[3],3,An),!R)return null}return new bM(S,A,R)}evaluate(y){const x=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const S=Li(x),A=Li(E);if(S.kind!==A.kind||"string"!==S.kind&&"number"!==S.kind)throw new Ji(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${S.kind}, ${A.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const S=Li(x),A=Li(E);if("string"!==S.kind||"string"!==A.kind)return i(y,x,E)}return this.collator?l(y,x,E,this.collator.evaluate(y)):i(y,x,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[s];return this.eachChild(x=>{y.push(x.serialize())}),y}}}const jl=_a("==",function(s,i,l){return i===l},wo),$l=_a("!=",function(s,i,l){return i!==l},function(s,i,l,h){return!wo(0,i,l,h)}),Di=_a("<",function(s,i,l){return i<l},function(s,i,l,h){return h.compare(i,l)<0}),pl=_a(">",function(s,i,l){return i>l},function(s,i,l,h){return h.compare(i,l)>0}),Pd=_a("<=",function(s,i,l){return i<=l},function(s,i,l,h){return h.compare(i,l)<=0}),ml=_a(">=",function(s,i,l){return i>=l},function(s,i,l,h){return h.compare(i,l)>=0});class hu{constructor(i,l,h,f,y){this.type=Gt,this.number=i,this.locale=l,this.currency=h,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(i,l){if(3!==i.length)return l.error("Expected two arguments.");const h=l.parse(i[1],1,lt);if(!h)return null;const f=i[2];if("object"!=typeof f||Array.isArray(f))return l.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=l.parse(f.locale,1,Gt),!y))return null;let x=null;if(f.currency&&(x=l.parse(f.currency,1,Gt),!x))return null;let E=null;if(f["min-fraction-digits"]&&(E=l.parse(f["min-fraction-digits"],1,lt),!E))return null;let S=null;return f["max-fraction-digits"]&&(S=l.parse(f["max-fraction-digits"],1,lt),!S)?null:new hu(h,y,x,E,S)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class ps{constructor(i){this.type=lt,this.input=i}static parse(i,l){if(2!==i.length)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=l.parse(i[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?l.error(`Expected argument of type string or array, but found ${fn(h.type)} instead.`):new ps(h):null}evaluate(i){const l=this.input.evaluate(i);if("string"==typeof l||Array.isArray(l))return l.length;throw new Ji(`Expected value to be of type string or array, but found ${fn(Li(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(l=>{i.push(l.serialize())}),i}}const gl={"==":jl,"!=":$l,">":pl,"<":Di,">=":ml,"<=":Pd,array:zn,at:eo,boolean:zn,case:Xi,coalesce:Cc,collator:On,format:Na,image:za,in:ga,"index-of":Ba,interpolate:en,"interpolate-hcl":en,"interpolate-lab":en,length:ps,let:Jo,literal:Ei,match:fs,number:zn,"number-format":hu,object:zn,slice:Va,step:Wi,string:zn,"to-boolean":cs,"to-color":cs,"to-number":cs,"to-string":cs,var:Mt,within:Lo};function _l(s,[i,l,h,f]){i=i.evaluate(s),l=l.evaluate(s),h=h.evaluate(s);const y=f?f.evaluate(s):1,x=vo(i,l,h,y);if(x)throw new Ji(x);return new $t(i/255*y,l/255*y,h/255*y,y)}function Xu(s,i){return s in i}function Hl(s,i){const l=i[s];return void 0===l?null:l}function yl(s){return{type:s}}function Os(s){return{result:"success",value:s}}function Fs(s){return{result:"error",value:s}}function vl(s){return"data-driven"===s["property-type"]||"cross-faded-data-driven"===s["property-type"]}function Gl(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Ku(s){return!!s.expression&&s.expression.interpolated}function on(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function du(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function Zl(s){return s}function fu(s,i){const l="color"===i.type,h=s.stops&&"object"==typeof s.stops[0][0],f=h||!(h||void 0!==s.property),y=s.type||(Ku(i)?"exponential":"interval");if(l&&((s=qt({},s)).stops&&(s.stops=s.stops.map(A=>[A[0],$t.parse(A[1])])),s.default=$t.parse(s.default?s.default:i.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!xo[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let x,E,S;if("exponential"===y)x=xl;else if("interval"===y)x=Yu;else if("categorical"===y){x=pu,E=Object.create(null);for(const A of s.stops)E[A[0]]=A[1];S=typeof s.stops[0][0]}else{if("identity"!==y)throw new Error(`Unknown function type "${y}"`);x=ms}if(h){const A={},R=[];for(let j=0;j<s.stops.length;j++){const ee=s.stops[j],ne=ee[0].zoom;void 0===A[ne]&&(A[ne]={zoom:ne,type:s.type,property:s.property,default:s.default,stops:[]},R.push(ne)),A[ne].stops.push([ee[0].value,ee[1]])}const F=[];for(const j of R)F.push([A[j].zoom,fu(A[j],i)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:en.interpolationFactor.bind(void 0,z),zoomStops:F.map(j=>j[0]),evaluate:({zoom:j},ee)=>xl({stops:F,base:s.base},i,j).evaluate(j,ee)}}if(f){const A="exponential"===y?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:en.interpolationFactor.bind(void 0,A),zoomStops:s.stops.map(R=>R[0]),evaluate:({zoom:R})=>x(s,i,R,E,S)}}return{kind:"source",evaluate(A,R){const F=R&&R.properties?R.properties[s.property]:void 0;return void 0===F?Ur(s.default,i.default):x(s,i,F,E,S)}}}function Ur(s,i,l){return void 0!==s?s:void 0!==i?i:void 0!==l?l:void 0}function pu(s,i,l,h,f){return Ur(typeof l===f?h[l]:void 0,s.default,i.default)}function Yu(s,i,l){if("number"!==on(l))return Ur(s.default,i.default);const h=s.stops.length;if(1===h||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[h-1][0])return s.stops[h-1][1];const f=wc(s.stops.map(y=>y[0]),l);return s.stops[f][1]}function xl(s,i,l){const h=void 0!==s.base?s.base:1;if("number"!==on(l))return Ur(s.default,i.default);const f=s.stops.length;if(1===f||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[f-1][0])return s.stops[f-1][1];const y=wc(s.stops.map(R=>R[0]),l),x=function(R,F,z,j){const ee=j-z,ne=R-z;return 0===ee?0:1===F?ne/ee:(Math.pow(F,ne)-1)/(Math.pow(F,ee)-1)}(l,h,s.stops[y][0],s.stops[y+1][0]),E=s.stops[y][1],S=s.stops[y+1][1];let A=Wt[i.type]||Zl;if(s.colorSpace&&"rgb"!==s.colorSpace){const R=xo[s.colorSpace];A=(F,z)=>R.reverse(R.interpolate(R.forward(F),R.forward(z),x))}return"function"==typeof E.evaluate?{evaluate(...R){const F=E.evaluate.apply(void 0,R),z=S.evaluate.apply(void 0,R);if(void 0!==F&&void 0!==z)return A(F,z,x)}}:A(E,S,x)}function ms(s,i,l){return"color"===i.type?l=$t.parse(l):"formatted"===i.type?l=cn.fromString(l.toString()):"resolvedImage"===i.type?l=Ni.fromString(l.toString()):on(l)===i.type||"enum"===i.type&&i.values[l]||(l=void 0),Ur(l,s.default,i.default)}Ti.register(gl,{error:[{kind:"error"},[Gt],(s,[i])=>{throw new Ji(i.evaluate(s))}],typeof:[Gt,[Vt],(s,[i])=>fn(Li(i.evaluate(s)))],"to-rgba":[Rn(lt,4),[xn],(s,[i])=>i.evaluate(s).toArray()],rgb:[xn,[lt,lt,lt],_l],rgba:[xn,[lt,lt,lt,lt],_l],has:{type:Ct,overloads:[[[Gt],(s,[i])=>Xu(i.evaluate(s),s.properties())],[[Gt,cr],(s,[i,l])=>Xu(i.evaluate(s),l.evaluate(s))]]},get:{type:Vt,overloads:[[[Gt],(s,[i])=>Hl(i.evaluate(s),s.properties())],[[Gt,cr],(s,[i,l])=>Hl(i.evaluate(s),l.evaluate(s))]]},"feature-state":[Vt,[Gt],(s,[i])=>Hl(i.evaluate(s),s.featureState||{})],properties:[cr,[],s=>s.properties()],"geometry-type":[Gt,[],s=>s.geometryType()],id:[Vt,[],s=>s.id()],zoom:[lt,[],s=>s.globals.zoom],"heatmap-density":[lt,[],s=>s.globals.heatmapDensity||0],"line-progress":[lt,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[lt,[],s=>s.globals.skyRadialProgress||0],accumulated:[Vt,[],s=>void 0===s.globals.accumulated?null:s.globals.accumulated],"+":[lt,yl(lt),(s,i)=>{let l=0;for(const h of i)l+=h.evaluate(s);return l}],"*":[lt,yl(lt),(s,i)=>{let l=1;for(const h of i)l*=h.evaluate(s);return l}],"-":{type:lt,overloads:[[[lt,lt],(s,[i,l])=>i.evaluate(s)-l.evaluate(s)],[[lt],(s,[i])=>-i.evaluate(s)]]},"/":[lt,[lt,lt],(s,[i,l])=>i.evaluate(s)/l.evaluate(s)],"%":[lt,[lt,lt],(s,[i,l])=>i.evaluate(s)%l.evaluate(s)],ln2:[lt,[],()=>Math.LN2],pi:[lt,[],()=>Math.PI],e:[lt,[],()=>Math.E],"^":[lt,[lt,lt],(s,[i,l])=>Math.pow(i.evaluate(s),l.evaluate(s))],sqrt:[lt,[lt],(s,[i])=>Math.sqrt(i.evaluate(s))],log10:[lt,[lt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN10],ln:[lt,[lt],(s,[i])=>Math.log(i.evaluate(s))],log2:[lt,[lt],(s,[i])=>Math.log(i.evaluate(s))/Math.LN2],sin:[lt,[lt],(s,[i])=>Math.sin(i.evaluate(s))],cos:[lt,[lt],(s,[i])=>Math.cos(i.evaluate(s))],tan:[lt,[lt],(s,[i])=>Math.tan(i.evaluate(s))],asin:[lt,[lt],(s,[i])=>Math.asin(i.evaluate(s))],acos:[lt,[lt],(s,[i])=>Math.acos(i.evaluate(s))],atan:[lt,[lt],(s,[i])=>Math.atan(i.evaluate(s))],min:[lt,yl(lt),(s,i)=>Math.min(...i.map(l=>l.evaluate(s)))],max:[lt,yl(lt),(s,i)=>Math.max(...i.map(l=>l.evaluate(s)))],abs:[lt,[lt],(s,[i])=>Math.abs(i.evaluate(s))],round:[lt,[lt],(s,[i])=>{const l=i.evaluate(s);return l<0?-Math.round(-l):Math.round(l)}],floor:[lt,[lt],(s,[i])=>Math.floor(i.evaluate(s))],ceil:[lt,[lt],(s,[i])=>Math.ceil(i.evaluate(s))],"filter-==":[Ct,[Gt,Vt],(s,[i,l])=>s.properties()[i.value]===l.value],"filter-id-==":[Ct,[Vt],(s,[i])=>s.id()===i.value],"filter-type-==":[Ct,[Gt],(s,[i])=>s.geometryType()===i.value],"filter-<":[Ct,[Gt,Vt],(s,[i,l])=>{const h=s.properties()[i.value],f=l.value;return typeof h==typeof f&&h<f}],"filter-id-<":[Ct,[Vt],(s,[i])=>{const l=s.id(),h=i.value;return typeof l==typeof h&&l<h}],"filter->":[Ct,[Gt,Vt],(s,[i,l])=>{const h=s.properties()[i.value],f=l.value;return typeof h==typeof f&&h>f}],"filter-id->":[Ct,[Vt],(s,[i])=>{const l=s.id(),h=i.value;return typeof l==typeof h&&l>h}],"filter-<=":[Ct,[Gt,Vt],(s,[i,l])=>{const h=s.properties()[i.value],f=l.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[Ct,[Vt],(s,[i])=>{const l=s.id(),h=i.value;return typeof l==typeof h&&l<=h}],"filter->=":[Ct,[Gt,Vt],(s,[i,l])=>{const h=s.properties()[i.value],f=l.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[Ct,[Vt],(s,[i])=>{const l=s.id(),h=i.value;return typeof l==typeof h&&l>=h}],"filter-has":[Ct,[Vt],(s,[i])=>i.value in s.properties()],"filter-has-id":[Ct,[],s=>null!==s.id()&&void 0!==s.id()],"filter-type-in":[Ct,[Rn(Gt)],(s,[i])=>i.value.indexOf(s.geometryType())>=0],"filter-id-in":[Ct,[Rn(Vt)],(s,[i])=>i.value.indexOf(s.id())>=0],"filter-in-small":[Ct,[Gt,Rn(Vt)],(s,[i,l])=>l.value.indexOf(s.properties()[i.value])>=0],"filter-in-large":[Ct,[Gt,Rn(Vt)],(s,[i,l])=>function(h,f,y,x){for(;y<=x;){const E=y+x>>1;if(f[E]===h)return!0;f[E]>h?x=E-1:y=E+1}return!1}(s.properties()[i.value],l.value,0,l.value.length-1)],all:{type:Ct,overloads:[[[Ct,Ct],(s,[i,l])=>i.evaluate(s)&&l.evaluate(s)],[yl(Ct),(s,i)=>{for(const l of i)if(!l.evaluate(s))return!1;return!0}]]},any:{type:Ct,overloads:[[[Ct,Ct],(s,[i,l])=>i.evaluate(s)||l.evaluate(s)],[yl(Ct),(s,i)=>{for(const l of i)if(l.evaluate(s))return!0;return!1}]]},"!":[Ct,[Ct],(s,[i])=>!i.evaluate(s)],"is-supported-script":[Ct,[Gt],(s,[i])=>{const l=s.globals&&s.globals.isSupportedScript;return!l||l(i.evaluate(s))}],upcase:[Gt,[Gt],(s,[i])=>i.evaluate(s).toUpperCase()],downcase:[Gt,[Gt],(s,[i])=>i.evaluate(s).toLowerCase()],concat:[Gt,yl(Vt),(s,i)=>i.map(l=>ur(l.evaluate(s))).join("")],"resolved-locale":[Gt,[An],(s,[i])=>i.evaluate(s).resolvedLocale()]});class bl{constructor(i,l){var h;this.expression=i,this._warningHistory={},this._evaluator=new mn,this._defaultValue=l?"color"===(h=l).type&&du(h.default)?new $t(0,0,0,0):"color"===h.type?$t.parse(h.default)||null:void 0===h.default?null:h.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(i,l,h,f,y,x){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(i,l,h,f,y,x){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Ji(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,"undefined"!=typeof console&&console.warn(E.message)),this._defaultValue}}}function ci(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in gl}function hr(s,i){const l=new Qr(gl,[],i?function(f){const y={color:xn,string:Gt,number:lt,enum:Gt,boolean:Ct,formatted:mt,resolvedImage:la};return"array"===f.type?Rn(y[f.value]||Vt,f.length):y[f.type]}(i):void 0),h=l.parse(s,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return h?Os(new bl(h,i)):Fs(l.errors)}class Ua{constructor(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent="constant"!==i&&!It(l.expression)}evaluateWithoutErrorHandling(i,l,h,f,y,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,f,y,x)}evaluate(i,l,h,f,y,x){return this._styleExpression.evaluate(i,l,h,f,y,x)}}class gs{constructor(i,l,h,f){this.kind=i,this.zoomStops=h,this._styleExpression=l,this.isStateDependent="camera"!==i&&!It(l.expression),this.interpolationType=f}evaluateWithoutErrorHandling(i,l,h,f,y,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,f,y,x)}evaluate(i,l,h,f,y,x){return this._styleExpression.evaluate(i,l,h,f,y,x)}interpolationFactor(i,l,h){return this.interpolationType?en.interpolationFactor(this.interpolationType,i,l,h):0}}function ql(s,i){if("error"===(s=hr(s,i)).result)return s;const l=s.value.expression,h=Et(l);if(!h&&!vl(i))return Fs([new rn("","data expressions not supported")]);const f=tr(l,["zoom"]);if(!f&&!Gl(i))return Fs([new rn("","zoom expressions not supported")]);const y=Ns(l);return y||f?y instanceof rn?Fs([y]):y instanceof en&&!Ku(i)?Fs([new rn("",'"interpolate" expressions cannot be used with this property')]):Os(y?new gs(h?"camera":"composite",s.value,y.labels,y instanceof en?y.interpolation:void 0):new Ua(h?"constant":"source",s.value)):Fs([new rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wl{constructor(i,l){this._parameters=i,this._specification=l,qt(this,fu(this._parameters,this._specification))}static deserialize(i){return new Wl(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Ns(s){let i=null;if(s instanceof Jo)i=Ns(s.result);else if(s instanceof Cc){for(const l of s.args)if(i=Ns(l),i)break}else(s instanceof Wi||s instanceof en)&&s.input instanceof Ti&&"zoom"===s.input.name&&(i=s);return i instanceof rn||s.eachChild(l=>{const h=Ns(l);h instanceof rn?i=h:!i&&h?i=new rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&h&&i!==h&&(i=new rn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function dr(s){const i=s.key,l=s.value,h=s.valueSpec||{},f=s.objectElementValidators||{},y=s.style,x=s.styleSpec;let E=[];const S=on(l);if("object"!==S)return[new Ne(i,l,`object expected, ${S} found`)];for(const A in l){const R=A.split(".")[0],F=h[R]||h["*"];let z;if(f[R])z=f[R];else if(h[R])z=$r;else if(f["*"])z=f["*"];else{if(!h["*"]){E.push(new Ne(i,l[A],`unknown property "${A}"`));continue}z=$r}E=E.concat(z({key:(i&&`${i}.`)+A,value:l[A],valueSpec:F,style:y,styleSpec:x,object:l,objectKey:A},l))}for(const A in h)f[A]||h[A].required&&void 0===h[A].default&&void 0===l[A]&&E.push(new Ne(i,l,`missing required property "${A}"`));return E}function Ec(s){const i=s.value,l=s.valueSpec,h=s.style,f=s.styleSpec,y=s.key,x=s.arrayElementValidator||$r;if("array"!==on(i))return[new Ne(y,i,`array expected, ${on(i)} found`)];if(l.length&&i.length!==l.length)return[new Ne(y,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new Ne(y,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let E={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum};f.$version<7&&(E.function=l.function),"object"===on(l.value)&&(E=l.value);let S=[];for(let A=0;A<i.length;A++)S=S.concat(x({array:i,arrayIndex:A,value:i[A],valueSpec:E,style:h,styleSpec:f,key:`${y}[${A}]`}));return S}function jr(s){const i=s.key,l=s.value,h=s.valueSpec;let f=on(l);if("number"===f&&l!=l&&(f="NaN"),"number"!==f)return[new Ne(i,l,`number expected, ${f} found`)];if("minimum"in h){let y=h.minimum;if("array"===on(h.minimum)&&(y=h.minimum[s.arrayIndex]),l<y)return[new Ne(i,l,`${l} is less than the minimum value ${y}`)]}if("maximum"in h){let y=h.maximum;if("array"===on(h.maximum)&&(y=h.maximum[s.arrayIndex]),l>y)return[new Ne(i,l,`${l} is greater than the maximum value ${y}`)]}return[]}function Xl(s){const i=s.valueSpec,l=Nt(s.value.type);let h,f,y,x={};const E="categorical"!==l&&void 0===s.value.property,S=!E,A="array"===on(s.value.stops)&&"array"===on(s.value.stops[0])&&"object"===on(s.value.stops[0][0]),R=dr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(j){if("identity"===l)return[new Ne(j.key,j.value,'identity function may not have a "stops" property')];let ee=[];const ne=j.value;return ee=ee.concat(Ec({key:j.key,value:ne,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:F})),"array"===on(ne)&&0===ne.length&&ee.push(new Ne(j.key,ne,"array must have at least one stop")),ee},default:function(j){return $r({key:j.key,value:j.value,valueSpec:i,style:j.style,styleSpec:j.styleSpec})}}});return"identity"===l&&E&&R.push(new Ne(s.key,s.value,'missing required property "property"')),"identity"===l||s.value.stops||R.push(new Ne(s.key,s.value,'missing required property "stops"')),"exponential"===l&&s.valueSpec.expression&&!Ku(s.valueSpec)&&R.push(new Ne(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(S&&!vl(s.valueSpec)?R.push(new Ne(s.key,s.value,"property functions not supported")):E&&!Gl(s.valueSpec)&&R.push(new Ne(s.key,s.value,"zoom functions not supported"))),"categorical"!==l&&!A||void 0!==s.value.property||R.push(new Ne(s.key,s.value,'"property" property is required')),R;function F(j){let ee=[];const ne=j.value,ue=j.key;if("array"!==on(ne))return[new Ne(ue,ne,`array expected, ${on(ne)} found`)];if(2!==ne.length)return[new Ne(ue,ne,`array length 2 expected, length ${ne.length} found`)];if(A){if("object"!==on(ne[0]))return[new Ne(ue,ne,`object expected, ${on(ne[0])} found`)];if(void 0===ne[0].zoom)return[new Ne(ue,ne,"object stop key must have zoom")];if(void 0===ne[0].value)return[new Ne(ue,ne,"object stop key must have value")];if(y&&y>Nt(ne[0].zoom))return[new Ne(ue,ne[0].zoom,"stop zoom values must appear in ascending order")];Nt(ne[0].zoom)!==y&&(y=Nt(ne[0].zoom),f=void 0,x={}),ee=ee.concat(dr({key:`${ue}[0]`,value:ne[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:jr,value:z}}))}else ee=ee.concat(z({key:`${ue}[0]`,value:ne[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},ne));return ci(vn(ne[1]))?ee.concat([new Ne(`${ue}[1]`,ne[1],"expressions are not allowed in function stops.")]):ee.concat($r({key:`${ue}[1]`,value:ne[1],valueSpec:i,style:j.style,styleSpec:j.styleSpec}))}function z(j,ee){const ne=on(j.value),ue=Nt(j.value),ye=null!==j.value?j.value:ee;if(h){if(ne!==h)return[new Ne(j.key,ye,`${ne} stop domain type must match previous stop domain type ${h}`)]}else h=ne;if("number"!==ne&&"string"!==ne&&"boolean"!==ne)return[new Ne(j.key,ye,"stop domain value must be a number, string, or boolean")];if("number"!==ne&&"categorical"!==l){let Ce=`number expected, ${ne} found`;return vl(i)&&void 0===l&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(j.key,ye,Ce)]}return"categorical"!==l||"number"!==ne||isFinite(ue)&&Math.floor(ue)===ue?"categorical"!==l&&"number"===ne&&void 0!==f&&ue<f?[new Ne(j.key,ye,"stop domain values must appear in ascending order")]:(f=ue,"categorical"===l&&ue in x?[new Ne(j.key,ye,"stop domain values must be unique")]:(x[ue]=!0,[])):[new Ne(j.key,ye,`integer expected, found ${ue}`)]}}function zs(s){const i=("property"===s.expressionContext?ql:hr)(vn(s.value),s.valueSpec);if("error"===i.result)return i.value.map(h=>new Ne(`${s.key}${h.key}`,s.value,h.message));const l=i.value.expression||i.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!l.outputDefined())return[new Ne(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===s.expressionContext&&"layout"===s.propertyType&&!It(l))return[new Ne(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext&&!It(l))return[new Ne(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!tr(l,["zoom","feature-state"]))return[new Ne(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!Et(l))return[new Ne(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mr(s){const i=s.key,l=s.value,h=s.valueSpec,f=[];return Array.isArray(h.values)?-1===h.values.indexOf(Nt(l))&&f.push(new Ne(i,l,`expected one of [${h.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(h.values).indexOf(Nt(l))&&f.push(new Ne(i,l,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(l)} found`)),f}function Bs(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const i of s.slice(1))if(!Bs(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}const Kl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function _s(s){if(null==s)return{filter:()=>!0,needGeometry:!1};Bs(s)||(s=ya(s));const i=hr(s,Kl);if("error"===i.result)throw new Error(i.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,h,f)=>i.value.evaluate(l,h,{},f),needGeometry:Ju(s)}}function vi(s,i){return s<i?-1:s>i?1:0}function Ju(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(let i=1;i<s.length;i++)if(Ju(s[i]))return!0;return!1}function ya(s){if(!s)return!0;const i=s[0];return s.length<=1?"any"!==i:"=="===i?ja(s[1],s[2],"=="):"!="===i?Tc(ja(s[1],s[2],"==")):"<"===i||">"===i||"<="===i||">="===i?ja(s[1],s[2],i):"any"===i?(l=s.slice(1),["any"].concat(l.map(ya))):"all"===i?["all"].concat(s.slice(1).map(ya)):"none"===i?["all"].concat(s.slice(1).map(ya).map(Tc)):"in"===i?Oi(s[1],s.slice(2)):"!in"===i?Tc(Oi(s[1],s.slice(2))):"has"===i?$a(s[1]):"!has"===i?Tc($a(s[1])):"within"!==i||s;var l}function ja(s,i,l){switch(s){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,s,i]}}function Oi(s,i){if(0===i.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",s,["literal",i.sort(vi)]]:["filter-in-small",s,["literal",i]]}}function $a(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Tc(s){return["!",s]}function Ha(s){return Bs(vn(s.value))?zs(qt({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ar(s)}function Ar(s){const i=s.value,l=s.key;if("array"!==on(i))return[new Ne(l,i,`array expected, ${on(i)} found`)];const h=s.styleSpec;let f,y=[];if(i.length<1)return[new Ne(l,i,"filter array must have at least 1 element")];switch(y=y.concat(Mr({key:`${l}[0]`,value:i[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),Nt(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===Nt(i[1])&&y.push(new Ne(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&y.push(new Ne(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(f=on(i[1]),"string"!==f&&y.push(new Ne(`${l}[1]`,i[1],`string expected, ${f} found`)));for(let x=2;x<i.length;x++)f=on(i[x]),"$type"===Nt(i[1])?y=y.concat(Mr({key:`${l}[${x}]`,value:i[x],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):"string"!==f&&"number"!==f&&"boolean"!==f&&y.push(new Ne(`${l}[${x}]`,i[x],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let x=1;x<i.length;x++)y=y.concat(Ar({key:`${l}[${x}]`,value:i[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":f=on(i[1]),2!==i.length?y.push(new Ne(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==f&&y.push(new Ne(`${l}[1]`,i[1],`string expected, ${f} found`));break;case"within":f=on(i[1]),2!==i.length?y.push(new Ne(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):"object"!==f&&y.push(new Ne(`${l}[1]`,i[1],`object expected, ${f} found`))}return y}function to(s,i){const l=s.key,h=s.style,f=s.styleSpec,y=s.value,x=s.objectKey,E=f[`${i}_${s.layerType}`];if(!E)return[];const S=x.match(/^(.*)-transition$/);if("paint"===i&&S&&E[S[1]]&&E[S[1]].transition)return $r({key:l,value:y,valueSpec:f.transition,style:h,styleSpec:f});const A=s.valueSpec||E[x];if(!A)return[new Ne(l,y,`unknown property "${x}"`)];let R;if("string"===on(y)&&vl(A)&&!A.tokens&&(R=/^{([^}]+)}$/.exec(y)))return[new Ne(l,y,`"${x}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const F=[];return"symbol"===s.layerType&&("text-field"===x&&h&&!h.glyphs&&F.push(new Ne(l,y,'use of "text-field" requires a style "glyphs" property')),"text-font"===x&&du(vn(y))&&"identity"===Nt(y.type)&&F.push(new Ne(l,y,'"text-font" does not support identity functions'))),F.concat($r({key:s.key,value:y,valueSpec:A,style:h,styleSpec:f,expressionContext:"property",propertyType:i,propertyKey:x}))}function fr(s){return to(s,"paint")}function Qo(s){return to(s,"layout")}function ir(s){let i=[];const l=s.value,h=s.key,f=s.style,y=s.styleSpec;l.type||l.ref||i.push(new Ne(h,l,'either "type" or "ref" is required'));let x=Nt(l.type);const E=Nt(l.ref);if(l.id){const S=Nt(l.id);for(let A=0;A<s.arrayIndex;A++){const R=f.layers[A];Nt(R.id)===S&&i.push(new Ne(h,l.id,`duplicate layer id "${l.id}", previously used at line ${R.id.__line__}`))}}if("ref"in l){let S;["type","source","source-layer","filter","layout"].forEach(A=>{A in l&&i.push(new Ne(h,l[A],`"${A}" is prohibited for ref layers`))}),f.layers.forEach(A=>{Nt(A.id)===E&&(S=A)}),S?S.ref?i.push(new Ne(h,l.ref,"ref cannot reference another ref layer")):x=Nt(S.type):i.push(new Ne(h,l.ref,`ref layer "${E}" not found`))}else if("background"!==x&&"sky"!==x)if(l.source){const S=f.sources&&f.sources[l.source],A=S&&Nt(S.type);S?"vector"===A&&"raster"===x?i.push(new Ne(h,l.source,`layer "${l.id}" requires a raster source`)):"raster"===A&&"raster"!==x?i.push(new Ne(h,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==A||l["source-layer"]?"raster-dem"===A&&"hillshade"!==x?i.push(new Ne(h,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!l.paint||!l.paint["line-gradient"]||"geojson"===A&&S.lineMetrics||i.push(new Ne(h,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Ne(h,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new Ne(h,l.source,`source "${l.source}" not found`))}else i.push(new Ne(h,l,'missing required property "source"'));return i=i.concat(dr({key:h,value:l,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>$r({key:`${h}.type`,value:l.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,object:l,objectKey:"type"}),filter:Ha,layout:S=>dr({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":A=>Qo(qt({layerType:x},A))}}),paint:S=>dr({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":A=>fr(qt({layerType:x},A))}})}})),i}function Ga(s){const i=s.value,l=s.key,h=on(i);return"string"!==h?[new Ne(l,i,`string expected, ${h} found`)]:[]}const Za={promoteId:function({key:s,value:i}){if("string"===on(i))return Ga({key:s,value:i});{const l=[];for(const h in i)l.push(...Ga({key:`${s}.${h}`,value:i[h]}));return l}}};function wl(s){const i=s.value,l=s.key,h=s.styleSpec,f=s.style;if(!i.type)return[new Ne(l,i,'"type" is required')];const y=Nt(i.type);let x;switch(y){case"vector":case"raster":case"raster-dem":return x=dr({key:l,value:i,valueSpec:h[`source_${y.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Za}),x;case"geojson":if(x=dr({key:l,value:i,valueSpec:h.source_geojson,style:f,styleSpec:h,objectElementValidators:Za}),i.cluster)for(const E in i.clusterProperties){const[S,A]=i.clusterProperties[E],R="string"==typeof S?[S,["accumulated"],["get",E]]:S;x.push(...zs({key:`${l}.${E}.map`,value:A,expressionContext:"cluster-map"})),x.push(...zs({key:`${l}.${E}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return x;case"video":return dr({key:l,value:i,valueSpec:h.source_video,style:f,styleSpec:h});case"image":return dr({key:l,value:i,valueSpec:h.source_image,style:f,styleSpec:h});case"canvas":return[new Ne(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Mr({key:`${l}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:h})}}function Fo(s){const i=s.value,l=s.styleSpec,h=l.light,f=s.style;let y=[];const x=on(i);if(void 0===i)return y;if("object"!==x)return y=y.concat([new Ne("light",i,`object expected, ${x} found`)]),y;for(const E in i){const S=E.match(/^(.*)-transition$/);y=y.concat(S&&h[S[1]]&&h[S[1]].transition?$r({key:E,value:i[E],valueSpec:l.transition,style:f,styleSpec:l}):h[E]?$r({key:E,value:i[E],valueSpec:h[E],style:f,styleSpec:l}):[new Ne(E,i[E],`unknown property "${E}"`)])}return y}function Dc(s){const i=s.value,l=s.key,h=s.style,f=s.styleSpec,y=f.terrain;let x=[];const E=on(i);if(void 0===i)return x;if("object"!==E)return x=x.concat([new Ne("terrain",i,`object expected, ${E} found`)]),x;for(const S in i){const A=S.match(/^(.*)-transition$/);x=x.concat(A&&y[A[1]]&&y[A[1]].transition?$r({key:S,value:i[S],valueSpec:f.transition,style:h,styleSpec:f}):y[S]?$r({key:S,value:i[S],valueSpec:y[S],style:h,styleSpec:f}):[new Ne(S,i[S],`unknown property "${S}"`)])}if(i.source){const S=h.sources&&h.sources[i.source],A=S&&Nt(S.type);S?"raster-dem"!==A&&x.push(new Ne(l,i.source,`terrain cannot be used with a source of type ${A}, it only be used with a "raster-dem" source type`)):x.push(new Ne(l,i.source,`source "${i.source}" not found`))}else x.push(new Ne(l,i,'terrain is missing required property "source"'));return x}function Cl(s){const i=s.value,l=s.style,h=s.styleSpec,f=h.fog;let y=[];const x=on(i);if(void 0===i)return y;if("object"!==x)return y=y.concat([new Ne("fog",i,`object expected, ${x} found`)]),y;for(const E in i){const S=E.match(/^(.*)-transition$/);y=y.concat(S&&f[S[1]]&&f[S[1]].transition?$r({key:E,value:i[E],valueSpec:h.transition,style:l,styleSpec:h}):f[E]?$r({key:E,value:i[E],valueSpec:f[E],style:l,styleSpec:h}):[new Ne(E,i[E],`unknown property "${E}"`)])}return y}const Ot={"*":()=>[],array:Ec,boolean:function(s){const i=s.value,l=s.key,h=on(i);return"boolean"!==h?[new Ne(l,i,`boolean expected, ${h} found`)]:[]},number:jr,color:function(s){const i=s.key,l=s.value,h=on(l);return"string"!==h?[new Ne(i,l,`color expected, ${h} found`)]:null===Dr.parseCSSColor(l)?[new Ne(i,l,`color expected, "${l}" found`)]:[]},constants:vt,enum:Mr,filter:Ha,function:Xl,layer:ir,object:dr,source:wl,light:Fo,terrain:Dc,fog:Cl,string:Ga,formatted:function(s){return 0===Ga(s).length?[]:zs(s)},resolvedImage:function(s){return 0===Ga(s).length?[]:zs(s)}};function $r(s){const i=s.value,l=s.valueSpec,h=s.styleSpec;return l.expression&&du(Nt(i))?Xl(s):l.expression&&ci(vn(i))?zs(s):l.type&&Ot[l.type]?Ot[l.type](s):dr(qt({},s,{valueSpec:l.type?h[l.type]:l}))}function Sc(s){const i=s.value,l=s.key,h=Ga(s);return h.length||(-1===i.indexOf("{fontstack}")&&h.push(new Ne(l,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&h.push(new Ne(l,i,'"glyphs" url must include a "{range}" token'))),h}function ys(s,i=xe){let l=[];return l=l.concat($r({key:"",value:s,valueSpec:i.$root,styleSpec:i,style:s,objectElementValidators:{glyphs:Sc,"*":()=>[]}})),s.constants&&(l=l.concat(vt({key:"constants",value:s.constants,style:s,styleSpec:i}))),Mc(l)}function Mc(s){return[].concat(s).sort((i,l)=>i.line-l.line)}function es(s){return function(...i){return Mc(s.apply(this,i))}}ys.source=es(wl),ys.light=es(Fo),ys.terrain=es(Dc),ys.fog=es(Cl),ys.layer=es(ir),ys.filter=es(Ha),ys.paintProperty=es(fr),ys.layoutProperty=es(Qo);const qa=ys,mu=qa.light,c=qa.fog,v=qa.paintProperty,T=qa.layoutProperty;function P(s,i){let l=!1;if(i&&i.length)for(const h of i)s.fire(new He(new Error(h.message))),l=!0;return l}var V=J;function J(s,i,l){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var f=new Int32Array(this.arrayBuffer);s=f[0],this.d=(i=f[1])+2*(l=f[2]);for(var y=0;y<this.d*this.d;y++){var x=f[3+y],E=f[3+y+1];h.push(x===E?null:f.subarray(x,E))}var S=f[3+h.length+1];this.keys=f.subarray(f[3+h.length],S),this.bboxes=f.subarray(S),this.insert=this._insertReadonly}else{this.d=i+2*l;for(var A=0;A<this.d*this.d;A++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=s,this.padding=l,this.scale=i/s,this.uid=0;var R=l/i*s;this.min=-R,this.max=s+R}J.prototype.insert=function(s,i,l,h,f){this._forEachCell(i,l,h,f,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(f)},J.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},J.prototype._insertCell=function(s,i,l,h,f,y){this.cells[f].push(y)},J.prototype.query=function(s,i,l,h,f){var y=this.min,x=this.max;if(s<=y&&i<=y&&x<=l&&x<=h&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(s,i,l,h,this._queryCell,E,{},f),E},J.prototype._queryCell=function(s,i,l,h,f,y,x,E){var S=this.cells[f];if(null!==S)for(var A=this.keys,R=this.bboxes,F=0;F<S.length;F++){var z=S[F];if(void 0===x[z]){var j=4*z;(E?E(R[j+0],R[j+1],R[j+2],R[j+3]):s<=R[j+2]&&i<=R[j+3]&&l>=R[j+0]&&h>=R[j+1])?(x[z]=!0,y.push(A[z])):x[z]=!1}}},J.prototype._forEachCell=function(s,i,l,h,f,y,x,E){for(var S=this._convertToCellCoord(s),A=this._convertToCellCoord(i),R=this._convertToCellCoord(l),F=this._convertToCellCoord(h),z=S;z<=R;z++)for(var j=A;j<=F;j++){var ee=this.d*j+z;if((!E||E(this._convertFromCellCoord(z),this._convertFromCellCoord(j),this._convertFromCellCoord(z+1),this._convertFromCellCoord(j+1)))&&f.call(this,s,i,l,h,ee,y,x,E))return}},J.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},J.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},J.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,i=3+this.cells.length+1+1,l=0,h=0;h<this.cells.length;h++)l+=this.cells[h].length;var f=new Int32Array(i+l+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var y=i,x=0;x<s.length;x++){var E=s[x];f[3+x]=y,f.set(E,y),y+=E.length}return f[3+s.length]=y,f.set(this.keys,y),f[3+s.length+1]=y+=this.keys.length,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer};const{ImageData:me,ImageBitmap:Le}=at,Be={};function Me(s,i,l={}){Object.defineProperty(i,"_classRegistryKey",{value:s,writeable:!1}),Be[s]={klass:i,omit:l.omit||[],shallow:l.shallow||[]}}Me("Object",Object),V.serialize=function(s,i){const l=s.toArrayBuffer();return i&&i.push(l),{buffer:l}},V.deserialize=function(s){return new V(s.buffer)},Me("Grid",V),Me("Color",$t),Me("Error",Error),Me("ResolvedImage",Ni),Me("StylePropertyFunction",Wl),Me("StyleExpression",bl,{omit:["_evaluator"]}),Me("ZoomDependentExpression",gs),Me("ZoomConstantExpression",Ua),Me("CompoundExpression",Ti,{omit:["_evaluate"]});for(const s in gl)gl[s]._classRegistryKey||Me(`Expression_${s}`,gl[s]);function gt(s){return s&&"undefined"!=typeof ArrayBuffer&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function Tt(s){return Le&&s instanceof Le}function un(s,i){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(gt(s)||Tt(s))return i&&i.push(s),s;if(ArrayBuffer.isView(s)){const l=s;return i&&i.push(l.buffer),l}if(s instanceof me)return i&&i.push(s.data.buffer),s;if(Array.isArray(s)){const l=[];for(const h of s)l.push(un(h,i));return l}if("object"==typeof s){const l=s.constructor,h=l._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");const f=l.serialize?l.serialize(s,i):{};if(!l.serialize){for(const y in s){if(!s.hasOwnProperty(y)||Be[h].omit.indexOf(y)>=0)continue;const x=s[y];f[y]=Be[h].shallow.indexOf(y)>=0?x:un(x,i)}s instanceof Error&&(f.message=s.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==h&&(f.$name=h),f}throw new Error("can't serialize object of type "+typeof s)}function ei(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||gt(s)||Tt(s)||ArrayBuffer.isView(s)||s instanceof me)return s;if(Array.isArray(s))return s.map(ei);if("object"==typeof s){const i=s.$name||"Object",{klass:l}=Be[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(s);const h=Object.create(l.prototype);for(const f of Object.keys(s)){if("$name"===f)continue;const y=s[f];h[f]=Be[i].shallow.indexOf(f)>=0?y:ei(y)}return h}throw new Error("can't deserialize object of type "+typeof s)}class pr{constructor(){this.first=!0}update(i,l){const h=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=h,!0))}}const El=s=>s>=1536&&s<=1791,no=s=>s>=1872&&s<=1919,No=s=>s>=2208&&s<=2303,Yl=s=>s>=11904&&s<=12031,gu=s=>s>=12032&&s<=12255,Qu=s=>s>=12272&&s<=12287,va=s=>s>=12288&&s<=12351,Jl=s=>s>=12352&&s<=12447,Wa=s=>s>=12448&&s<=12543,xi=s=>s>=12544&&s<=12591,xa=s=>s>=12704&&s<=12735,_u=s=>s>=12736&&s<=12783,Ac=s=>s>=12784&&s<=12799,Xa=s=>s>=12800&&s<=13055,Ka=s=>s>=13056&&s<=13311,Ic=s=>s>=13312&&s<=19903,Pc=s=>s>=19968&&s<=40959,kc=s=>s>=40960&&s<=42127,yu=s=>s>=42128&&s<=42191,Ql=s=>s>=44032&&s<=55215,kd=s=>s>=63744&&s<=64255,mr=s=>s>=64336&&s<=65023,Ya=s=>s>=65040&&s<=65055,Si=s=>s>=65072&&s<=65103,Rd=s=>s>=65104&&s<=65135,Tl=s=>s>=65136&&s<=65279,Rc=s=>s>=65280&&s<=65519;function ec(s){for(const i of s)if(ba(i.charCodeAt(0)))return!0;return!1}function fp(s){for(const i of s)if(!Ld(i.charCodeAt(0)))return!1;return!0}function Ld(s){return!(El(s)||no(s)||No(s)||mr(s)||Tl(s))}function ba(s){return!(746!==s&&747!==s&&(s<4352||!(xa(s)||xi(s)||Si(s)&&!(s>=65097&&s<=65103)||kd(s)||Ka(s)||Yl(s)||_u(s)||!(!va(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||Ic(s)||Pc(s)||Xa(s)||(i=s,i>=12592&&i<=12687)||(i=>i>=43360&&i<=43391)(s)||(i=>i>=55216&&i<=55295)(s)||(i=>i>=4352&&i<=4607)(s)||Ql(s)||Jl(s)||Qu(s)||(i=>i>=12688&&i<=12703)(s)||gu(s)||Ac(s)||Wa(s)&&12540!==s||!(!Rc(s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!Rd(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(i=>i>=5120&&i<=5759)(s)||(i=>i>=6320&&i<=6399)(s)||Ya(s)||(i=>i>=19904&&i<=19967)(s)||kc(s)||yu(s))));var i}function vu(s){return!(ba(s)||(i=s,(l=i)>=128&&l<=255&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||(l=>l>=8192&&l<=8303)(i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||(l=>l>=8448&&l<=8527)(i)||(l=>l>=8528&&l<=8591)(i)||(l=>l>=8960&&l<=9215)(i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||(l=>l>=9216&&l<=9279)(i)&&9251!==i||(l=>l>=9280&&l<=9311)(i)||(l=>l>=9312&&l<=9471)(i)||(l=>l>=9632&&l<=9727)(i)||(l=>l>=9728&&l<=9983)(i)&&!(i>=9754&&i<=9759)||(l=>l>=11008&&l<=11263)(i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||va(i)||Wa(i)||(l=>l>=57344&&l<=63743)(i)||Si(i)||Rd(i)||Rc(i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i,l}function xu(s){return s>=1424&&s<=2303||mr(s)||Tl(s)}function Lc(s,i){return!(!i&&xu(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(l=s,l>=6016&&l<=6143));var l}function m(s){for(const i of s)if(xu(i.charCodeAt(0)))return!0;return!1}const o="deferred",d="loading",_="loaded";let w=null,C="unavailable",M=null;const k=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(C="error"),w&&w(s)};function O(){B.fire(new it("pluginStateChange",{pluginStatus:C,pluginURL:M}))}const B=new xt,U=function(){return C},q=function(){if(C!==o||!M)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");C=d,O(),M&&$({url:M},s=>{s?k(s):(C=_,O())})},X={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>C===_||null!=X.applyArabicShaping,isLoading:()=>C===d,setState(s){C=s.pluginStatus,M=s.pluginURL},isParsed:()=>null!=X.applyArabicShaping&&null!=X.processBidirectionalText&&null!=X.processStyledBidirectionalText,getPluginURL:()=>M};class Y{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pr,this.transition={})}isSupportedScript(i){return function(l,h){for(const f of l)if(!Lc(f.charCodeAt(0),h))return!1;return!0}(i,X.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,l=i-Math.floor(i),h=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*l}}}class oe{constructor(i,l){this.property=i,this.value=l,this.expression=function(h,f){if(du(h))return new Wl(h,f);if(ci(h)){const y=ql(h,f);if("error"===y.result)throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=h;return"string"==typeof h&&"color"===f.type&&(y=$t.parse(h)),{kind:"constant",evaluate:()=>y}}}(void 0===l?i.specification.default:l,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,l,h){return this.property.possiblyEvaluate(this,i,l,h)}}class se{constructor(i){this.property=i,this.value=new oe(i,void 0)}transitioned(i,l){return new ie(this.property,this.value,l,Ci({},i.transition,this.transition),i.now)}untransitioned(){return new ie(this.property,this.value,null,{},0)}}class pe{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return ni(this._values[i].value.value)}setValue(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new se(this._values[i].property)),this._values[i].value=new oe(this._values[i].property,null===l?void 0:ni(l))}getTransition(i){return ni(this._values[i].transition)}setTransition(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new se(this._values[i].property)),this._values[i].transition=ni(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);void 0!==h&&(i[l]=h);const f=this.getTransition(l);void 0!==f&&(i[`${l}-transition`]=f)}return i}transitioned(i,l){const h=new ae(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].transitioned(i,l._values[f]);return h}untransitioned(){const i=new ae(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class ie{constructor(i,l,h,f,y){const x=f.delay||0,E=f.duration||0;y=y||0,this.property=i,this.value=l,this.begin=y+x,this.end=this.begin+E,i.specification.transition&&(f.delay||f.duration)&&(this.prior=h)}possiblyEvaluate(i,l,h){const f=i.now||0,y=this.value.possiblyEvaluate(i,l,h),x=this.prior;if(x){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return x.possiblyEvaluate(i,l,h);{const E=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,l,h),y,sl(E))}}return y}}class ae{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,h){const f=new we(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(i,l,h);return f}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class fe{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return ni(this._values[i].value)}setValue(i,l){this._values[i]=new oe(this._values[i].property,null===l?void 0:ni(l))}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);void 0!==h&&(i[l]=h)}return i}possiblyEvaluate(i,l,h){const f=new we(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(i,l,h);return f}}class _e{constructor(i,l,h){this.property=i,this.value=l,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,l,h,f){return this.property.evaluate(this.value,this.parameters,i,l,h,f)}}class we{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class ce{constructor(i){this.specification=i}possiblyEvaluate(i,l){return i.expression.evaluate(l)}interpolate(i,l,h){const f=Wt[this.specification.type];return f?f(i,l,h):i}}class Se{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,h,f){return new _e(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(l,null,{},h,f)}:i.expression,l)}interpolate(i,l,h){if("constant"!==i.value.kind||"constant"!==l.value.kind)return i;if(void 0===i.value.value||void 0===l.value.value)return new _e(this,{kind:"constant",value:void 0},i.parameters);const f=Wt[this.specification.type];return f?new _e(this,{kind:"constant",value:f(i.value.value,l.value.value,h)},i.parameters):i}evaluate(i,l,h,f,y,x){return"constant"===i.kind?i.value:i.evaluate(l,h,f,y,x)}}class je extends Se{possiblyEvaluate(i,l,h,f){if(void 0===i.value)return new _e(this,{kind:"constant",value:void 0},l);if("constant"===i.expression.kind){const y=i.expression.evaluate(l,null,{},h,f),x="resolvedImage"===i.property.specification.type&&"string"!=typeof y?y.name:y,E=this._calculate(x,x,x,l);return new _e(this,{kind:"constant",value:E},l)}if("camera"===i.expression.kind){const y=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new _e(this,{kind:"constant",value:y},l)}return new _e(this,i.expression,l)}evaluate(i,l,h,f,y,x){if("source"===i.kind){const E=i.evaluate(l,h,f,y,x);return this._calculate(E,E,E,l)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},h,f),i.evaluate({zoom:Math.floor(l.zoom)},h,f),i.evaluate({zoom:Math.floor(l.zoom)+1},h,f),l):i.value}_calculate(i,l,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l,other:h}:{from:h,to:l,other:i}}interpolate(i){return i}}class We{constructor(i){this.specification=i}possiblyEvaluate(i,l,h,f){if(void 0!==i.value){if("constant"===i.expression.kind){const y=i.expression.evaluate(l,null,{},h,f);return this._calculate(y,y,y,l)}return this._calculate(i.expression.evaluate(new Y(Math.floor(l.zoom-1),l)),i.expression.evaluate(new Y(Math.floor(l.zoom),l)),i.expression.evaluate(new Y(Math.floor(l.zoom+1),l)),l)}}_calculate(i,l,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:h,to:l}}interpolate(i){return i}}class Te{constructor(i){this.specification=i}possiblyEvaluate(i,l,h,f){return!!i.expression.evaluate(l,null,{},h,f)}interpolate(){return!1}}class ze{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in i){const h=i[l];h.specification.overridable&&this.overridableProperties.push(l);const f=this.defaultPropertyValues[l]=new oe(h,void 0),y=this.defaultTransitionablePropertyValues[l]=new se(h);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=f.possiblyEvaluate({})}}}function ct(s,i){return 256*(s=gi(Math.floor(s),0,255))+gi(Math.floor(i),0,255)}Me("DataDrivenProperty",Se),Me("DataConstantProperty",ce),Me("CrossFadedDataDrivenProperty",je),Me("CrossFadedProperty",We),Me("ColorRampProperty",Te);const ht={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ut{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class tt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ft(s,i=1){let l=0,h=0;return{members:s.map(f=>{const y=ht[f.type].BYTES_PER_ELEMENT,x=l=sn(l,Math.max(i,y)),E=f.components||1;return h=Math.max(h,y),l+=y*E,{name:f.name,type:f.type,components:E,offset:x}}),size:sn(l,Math.max(h,i)),alignment:i}}function sn(s,i){return Math.ceil(s/i)*i}class kt extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const f=2*i;return this.int16[f+0]=l,this.int16[f+1]=h,i}}kt.prototype.bytesPerElement=4,Me("StructArrayLayout2i4",kt);class Mi extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)}emplace(i,l,h,f,y){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=f,this.int16[x+3]=y,i}}Mi.prototype.bytesPerElement=8,Me("StructArrayLayout4i8",Mi);class ai extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E){const S=this.length;return this.resize(S+1),this.emplace(S,i,l,h,f,y,x,E)}emplace(i,l,h,f,y,x,E,S){const A=6*i,R=12*i,F=3*i;return this.int16[A+0]=l,this.int16[A+1]=h,this.uint8[R+4]=f,this.uint8[R+5]=y,this.uint8[R+6]=x,this.uint8[R+7]=E,this.float32[F+2]=S,i}}ai.prototype.bytesPerElement=12,Me("StructArrayLayout2i4ub1f12",ai);class Zt extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)}emplace(i,l,h,f){const y=3*i;return this.float32[y+0]=l,this.float32[y+1]=h,this.float32[y+2]=f,i}}Zt.prototype.bytesPerElement=12,Me("StructArrayLayout3f12",Zt);class an extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S,A,R){const F=this.length;return this.resize(F+1),this.emplace(F,i,l,h,f,y,x,E,S,A,R)}emplace(i,l,h,f,y,x,E,S,A,R,F){const z=10*i;return this.uint16[z+0]=l,this.uint16[z+1]=h,this.uint16[z+2]=f,this.uint16[z+3]=y,this.uint16[z+4]=x,this.uint16[z+5]=E,this.uint16[z+6]=S,this.uint16[z+7]=A,this.uint16[z+8]=R,this.uint16[z+9]=F,i}}an.prototype.bytesPerElement=20,Me("StructArrayLayout10ui20",an);class bi extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S){const A=this.length;return this.resize(A+1),this.emplace(A,i,l,h,f,y,x,E,S)}emplace(i,l,h,f,y,x,E,S,A){const R=8*i;return this.uint16[R+0]=l,this.uint16[R+1]=h,this.uint16[R+2]=f,this.uint16[R+3]=y,this.uint16[R+4]=x,this.uint16[R+5]=E,this.uint16[R+6]=S,this.uint16[R+7]=A,i}}bi.prototype.bytesPerElement=16,Me("StructArrayLayout8ui16",bi);class Co extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue){const ye=this.length;return this.resize(ye+1),this.emplace(ye,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue)}emplace(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye){const Ce=16*i;return this.int16[Ce+0]=l,this.int16[Ce+1]=h,this.int16[Ce+2]=f,this.int16[Ce+3]=y,this.uint16[Ce+4]=x,this.uint16[Ce+5]=E,this.uint16[Ce+6]=S,this.uint16[Ce+7]=A,this.int16[Ce+8]=R,this.int16[Ce+9]=F,this.int16[Ce+10]=z,this.int16[Ce+11]=j,this.int16[Ce+12]=ee,this.int16[Ce+13]=ne,this.int16[Ce+14]=ue,this.int16[Ce+15]=ye,i}}Co.prototype.bytesPerElement=32,Me("StructArrayLayout4i4ui4i4i32",Co);class zo extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}zo.prototype.bytesPerElement=4,Me("StructArrayLayout1ul4",zo);class io extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S,A,R,F,z,j){const ee=this.length;return this.resize(ee+1),this.emplace(ee,i,l,h,f,y,x,E,S,A,R,F,z,j)}emplace(i,l,h,f,y,x,E,S,A,R,F,z,j,ee){const ne=20*i,ue=10*i;return this.int16[ne+0]=l,this.int16[ne+1]=h,this.int16[ne+2]=f,this.int16[ne+3]=y,this.int16[ne+4]=x,this.float32[ue+3]=E,this.float32[ue+4]=S,this.float32[ue+5]=A,this.float32[ue+6]=R,this.int16[ne+14]=F,this.uint32[ue+8]=z,this.uint16[ne+18]=j,this.uint16[ne+19]=ee,i}}io.prototype.bytesPerElement=40,Me("StructArrayLayout5i4f1i1ul2ui40",io);class Eo extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E){const S=this.length;return this.resize(S+1),this.emplace(S,i,l,h,f,y,x,E)}emplace(i,l,h,f,y,x,E,S){const A=8*i;return this.int16[A+0]=l,this.int16[A+1]=h,this.int16[A+2]=f,this.int16[A+4]=y,this.int16[A+5]=x,this.int16[A+6]=E,this.int16[A+7]=S,i}}Eo.prototype.bytesPerElement=16,Me("StructArrayLayout3i2i2i16",Eo);class Vs extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,f,y)}emplace(i,l,h,f,y,x){const E=4*i,S=8*i;return this.float32[E+0]=l,this.float32[E+1]=h,this.float32[E+2]=f,this.int16[S+6]=y,this.int16[S+7]=x,i}}Vs.prototype.bytesPerElement=16,Me("StructArrayLayout2f1f2i16",Vs);class Bo extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)}emplace(i,l,h,f,y){const x=12*i,E=3*i;return this.uint8[x+0]=l,this.uint8[x+1]=h,this.float32[E+1]=f,this.float32[E+2]=y,i}}Bo.prototype.bytesPerElement=12,Me("StructArrayLayout2ub2f12",Bo);class pn extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)}emplace(i,l,h,f){const y=3*i;return this.uint16[y+0]=l,this.uint16[y+1]=h,this.uint16[y+2]=f,i}}pn.prototype.bytesPerElement=6,Me("StructArrayLayout3ui6",pn);class ui extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke)}emplace(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke,Oe){const Ue=30*i,Ye=15*i,nt=60*i;return this.int16[Ue+0]=l,this.int16[Ue+1]=h,this.int16[Ue+2]=f,this.float32[Ye+2]=y,this.float32[Ye+3]=x,this.uint16[Ue+8]=E,this.uint16[Ue+9]=S,this.uint32[Ye+5]=A,this.uint32[Ye+6]=R,this.uint32[Ye+7]=F,this.uint16[Ue+16]=z,this.uint16[Ue+17]=j,this.uint16[Ue+18]=ee,this.float32[Ye+10]=ne,this.float32[Ye+11]=ue,this.uint8[nt+48]=ye,this.uint8[nt+49]=Ce,this.uint8[nt+50]=Ie,this.uint32[Ye+13]=Pe,this.int16[Ue+28]=ke,this.uint8[nt+58]=Oe,i}}ui.prototype.bytesPerElement=60,Me("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",ui);class En extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke,Oe,Ue,Ye,nt,rt,qe,Ke,ot,Xe){const At=this.length;return this.resize(At+1),this.emplace(At,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke,Oe,Ue,Ye,nt,rt,qe,Ke,ot,Xe)}emplace(i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne,ue,ye,Ce,Ie,Pe,ke,Oe,Ue,Ye,nt,rt,qe,Ke,ot,Xe,At){const dt=38*i,Bn=19*i;return this.int16[dt+0]=l,this.int16[dt+1]=h,this.int16[dt+2]=f,this.float32[Bn+2]=y,this.float32[Bn+3]=x,this.int16[dt+8]=E,this.int16[dt+9]=S,this.int16[dt+10]=A,this.int16[dt+11]=R,this.int16[dt+12]=F,this.int16[dt+13]=z,this.uint16[dt+14]=j,this.uint16[dt+15]=ee,this.uint16[dt+16]=ne,this.uint16[dt+17]=ue,this.uint16[dt+18]=ye,this.uint16[dt+19]=Ce,this.uint16[dt+20]=Ie,this.uint16[dt+21]=Pe,this.uint16[dt+22]=ke,this.uint16[dt+23]=Oe,this.uint16[dt+24]=Ue,this.uint16[dt+25]=Ye,this.uint16[dt+26]=nt,this.uint16[dt+27]=rt,this.uint16[dt+28]=qe,this.uint32[Bn+15]=Ke,this.float32[Bn+16]=ot,this.float32[Bn+17]=Xe,this.float32[Bn+18]=At,i}}En.prototype.bytesPerElement=76,Me("StructArrayLayout3i2f6i15ui1ul3f76",En);class ri extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}ri.prototype.bytesPerElement=4,Me("StructArrayLayout1f4",ri);class gr extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,h)}emplace(i,l,h,f){const y=3*i;return this.int16[y+0]=l,this.int16[y+1]=h,this.int16[y+2]=f,i}}gr.prototype.bytesPerElement=6,Me("StructArrayLayout3i6",gr);class jn extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)}emplace(i,l,h,f,y){const x=6*i;return this.uint32[3*i+0]=l,this.uint16[x+2]=h,this.uint16[x+3]=f,this.uint16[x+4]=y,i}}jn.prototype.bytesPerElement=12,Me("StructArrayLayout1ul3ui12",jn);class Ki extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const f=2*i;return this.uint16[f+0]=l,this.uint16[f+1]=h,i}}Ki.prototype.bytesPerElement=4,Me("StructArrayLayout2ui4",Ki);class Vo extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}Vo.prototype.bytesPerElement=2,Me("StructArrayLayout1ui2",Vo);class ro extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,f,y)}emplace(i,l,h,f,y,x){const E=5*i;return this.float32[E+0]=l,this.float32[E+1]=h,this.float32[E+2]=f,this.float32[E+3]=y,this.float32[E+4]=x,i}}ro.prototype.bytesPerElement=20,Me("StructArrayLayout5f20",ro);class Oc extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const f=2*i;return this.float32[f+0]=l,this.float32[f+1]=h,i}}Oc.prototype.bytesPerElement=8,Me("StructArrayLayout2f8",Oc);class Od extends tt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,i,l,h,f)}emplace(i,l,h,f,y){const x=4*i;return this.float32[x+0]=l,this.float32[x+1]=h,this.float32[x+2]=f,this.float32[x+3]=y,i}}Od.prototype.bytesPerElement=16,Me("StructArrayLayout4f16",Od);class eh extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}eh.prototype.size=40;class Fc extends io{get(i){return new eh(this,i)}}Me("CollisionBoxArray",Fc);class Fd extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Fd.prototype.size=60;class Yt extends ui{get(i){return new Fd(this,i)}}Me("PlacedSymbolArray",Yt);class th extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}th.prototype.size=76;class pp extends En{get(i){return new th(this,i)}}Me("SymbolInstanceArray",pp);class $y extends ri{getoffsetX(i){return this.float32[1*i+0]}}Me("GlyphOffsetArray",$y);class Hy extends gr{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Me("SymbolLineVertexArray",Hy);class Gy extends ut{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Gy.prototype.size=12;class Zy extends jn{get(i){return new Gy(this,i)}}Me("FeatureIndexArray",Zy);class qy extends ut{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}qy.prototype.size=4;class Wy extends Ki{get(i){return new qy(this,i)}}Me("FillExtrusionCentroidArray",Wy);const Yb=ft([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Jb=ft([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Xy=Br(function(s){s.exports=function(i,l){var h,f,y,x,E,S,A,R;for(f=i.length-(h=3&i.length),y=l,E=3432918353,S=461845907,R=0;R<f;)A=255&i.charCodeAt(R)|(255&i.charCodeAt(++R))<<8|(255&i.charCodeAt(++R))<<16|(255&i.charCodeAt(++R))<<24,++R,y=27492+(65535&(x=5*(65535&(y=(y^=A=(65535&(A=(A=(65535&A)*E+(((A>>>16)*E&65535)<<16)&4294967295)<<15|A>>>17))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,h){case 3:A^=(255&i.charCodeAt(R+2))<<16;case 2:A^=(255&i.charCodeAt(R+1))<<8;case 1:y^=A=(65535&(A=(A=(65535&(A^=255&i.charCodeAt(R)))*E+(((A>>>16)*E&65535)<<16)&4294967295)<<15|A>>>17))*S+(((A>>>16)*S&65535)<<16)&4294967295}return y^=i.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}}),Ph=Br(function(s){s.exports=function(i,l){for(var h,f=i.length,y=l^f,x=0;f>=4;)h=1540483477*(65535&(h=255&i.charCodeAt(x)|(255&i.charCodeAt(++x))<<8|(255&i.charCodeAt(++x))<<16|(255&i.charCodeAt(++x))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:y^=(255&i.charCodeAt(x+2))<<16;case 2:y^=(255&i.charCodeAt(x+1))<<8;case 1:y=1540483477*(65535&(y^=255&i.charCodeAt(x)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}}),Nd=Xy,Hr=Ph;Nd.murmur3=Xy,Nd.murmur2=Hr;class bu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,l,h,f){this.ids.push(kh(i)),this.positions.push(l,h,f)}getPositions(i){const l=kh(i);let h=0,f=this.ids.length-1;for(;h<f;){const x=h+f>>1;this.ids[x]>=l?f=x:h=x+1}const y=[];for(;this.ids[h]===l;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(i,l){const h=new Float64Array(i.ids),f=new Uint32Array(i.positions);return dg(h,f,0,h.length-1),l&&l.push(h.buffer,f.buffer),{ids:h,positions:f}}static deserialize(i){const l=new bu;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l}}function kh(s){const i=+s;return!isNaN(i)&&i<=po?i:Nd(String(s))}function dg(s,i,l,h){for(;l<h;){const f=s[l+h>>1];let y=l-1,x=h+1;for(;;){do{y++}while(s[y]<f);do{x--}while(s[x]>f);if(y>=x)break;zd(s,y,x),zd(i,3*y,3*x),zd(i,3*y+1,3*x+1),zd(i,3*y+2,3*x+2)}x-l<h-x?(dg(s,i,l,x),l=x+1):(dg(s,i,x+1,h),h=x)}}function zd(s,i,l){const h=s[i];s[i]=s[l],s[l]=h}Me("FeaturePositionMap",bu);class Gr{constructor(i,l){this.gl=i.gl,this.location=l}}class Us extends Gr{constructor(i,l){super(i,l),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Rh extends Gr{constructor(i,l){super(i,l),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Nc extends Gr{constructor(i,l){super(i,l),this.current=$t.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const zc=new Float32Array(16),fg=new Float32Array(9);function mp(s){return[ct(255*s.r,255*s.g),ct(255*s.b,255*s.a)]}class Lh{constructor(i,l,h){this.value=i,this.uniformNames=l.map(f=>`u_${f}`),this.type=h}setUniform(i,l,h){i.set(h.constantOr(this.value))}getBinding(i,l,h){return"color"===this.type?new Nc(i,l):new Us(i,l)}}class Oh{constructor(i,l){this.uniformNames=l.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tl.concat(l.br),this.patternTo=i.tl.concat(i.br)}setUniform(i,l,h,f){const y="u_pattern_to"===f||"u_dash_to"===f?this.patternTo:"u_pattern_from"===f||"u_dash_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;y&&i.set(y)}getBinding(i,l,h){return"u_pattern_from"===h||"u_pattern_to"===h||"u_dash_from"===h||"u_dash_to"===h?new Rh(i,l):new Us(i,l)}}class Bc{constructor(i,l,h,f){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(i,l,h,f,y){const x=this.paintVertexArray.length,E=this.expression.evaluate(new Y(0),l,{},f,[],y);this.paintVertexArray.resize(i),this._setPaintValue(x,i,E)}updatePaintArray(i,l,h,f){const y=this.expression.evaluate({zoom:0},h,f);this._setPaintValue(i,l,y)}_setPaintValue(i,l,h){if("color"===this.type){const f=mp(h);for(let y=i;y<l;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=i;f<l;f++)this.paintVertexArray.emplace(f,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wa{constructor(i,l,h,f,y,x){this.expression=i,this.uniformNames=l.map(E=>`u_${E}_t`),this.type=h,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,l,h,f,y){const x=this.expression.evaluate(new Y(this.zoom),l,{},f,[],y),E=this.expression.evaluate(new Y(this.zoom+1),l,{},f,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(S,i,x,E)}updatePaintArray(i,l,h,f){const y=this.expression.evaluate({zoom:this.zoom},h,f),x=this.expression.evaluate({zoom:this.zoom+1},h,f);this._setPaintValue(i,l,y,x)}_setPaintValue(i,l,h,f){if("color"===this.type){const y=mp(h),x=mp(f);for(let E=i;E<l;E++)this.paintVertexArray.emplace(E,y[0],y[1],x[0],x[1])}else{for(let y=i;y<l;y++)this.paintVertexArray.emplace(y,h,f);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l){const h=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,f=gi(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);i.set(f)}getBinding(i,l,h){return new Us(i,l)}}class Ir{constructor(i,l,h,f,y,x,E){this.expression=i,this.type=h,this.useIntegerZoom=f,this.zoom=y,this.layerId=E,this.paintVertexAttributes=("array"===h?Jb:Yb).members;for(let S=0;S<l.length;++S);this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(i,l,h){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(f,i,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(i,l,h,f,y){this._setPaintValues(i,l,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(i,l,h,f){if(!f||!h)return;const{min:y,mid:x,max:E}=h,S=f[y],A=f[x],R=f[E];if(S&&A&&R)for(let F=i;F<l;F++)this._setPaintValue(this.zoomInPaintVertexArray,F,A,S),this._setPaintValue(this.zoomOutPaintVertexArray,F,A,R)}_setPaintValue(i,l,h,f){i.emplace(l,h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],h.pixelRatio,f.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ja{constructor(i,l,h=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const y in i.paint._values){if(!h(y))continue;const x=i.paint.get(y);if(!(x instanceof _e&&vl(x.property.specification)))continue;const E=pg(y,i.type),S=x.value,A=x.property.specification.type,R=x.property.useIntegerZoom,F=x.property.specification["property-type"],z="cross-faded"===F||"cross-faded-data-driven"===F,j="line-dasharray"===String(y)&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==S.kind||j)if("source"===S.kind||j||z){const ee=mg(y,A,"source");this.binders[y]=z?new Ir(S,E,A,R,l,ee,i.id):new Bc(S,E,A,ee),f.push(`/a_${y}`)}else{const ee=mg(y,A,"composite");this.binders[y]=new wa(S,E,A,R,l,ee),f.push(`/z_${y}`)}else this.binders[y]=z?new Oh(S.value,E):new Lh(S.value,E,A),f.push(`/u_${y}`)}this.cacheKey=f.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof Bc||l instanceof wa?l.maxValue:0}populatePaintArrays(i,l,h,f,y){for(const x in this.binders){const E=this.binders[x];(E instanceof Bc||E instanceof wa||E instanceof Ir)&&E.populatePaintArray(i,l,h,f,y)}}setConstantPatternPositions(i,l){for(const h in this.binders){const f=this.binders[h];f instanceof Oh&&f.setConstantPatternPositions(i,l)}}updatePaintArrays(i,l,h,f,y){let x=!1;for(const E in i){const S=l.getPositions(E);for(const A of S){const R=h.feature(A.index);for(const F in this.binders){const z=this.binders[F];if((z instanceof Bc||z instanceof wa||z instanceof Ir)&&!0===z.expression.isStateDependent){const j=f.paint.get(F);z.expression=j.value,z.updatePaintArray(A.start,A.end,R,i[E],y),x=!0}}}}return x}defines(){const i=[];for(const l in this.binders){const h=this.binders[l];(h instanceof Lh||h instanceof Oh)&&i.push(...h.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Bc||h instanceof wa||h instanceof Ir)for(let f=0;f<h.paintVertexAttributes.length;f++)i.push(h.paintVertexAttributes[f].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Lh||h instanceof Oh||h instanceof wa)for(const f of h.uniformNames)i.push(f)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,l){const h=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Lh||y instanceof Oh||y instanceof wa)for(const x of y.uniformNames)if(l[x]){const E=y.getBinding(i,l[x],x);h.push({name:x,property:f,binding:E})}}return h}setUniforms(i,l,h,f){for(const{name:y,property:x,binding:E}of l)this.binders[x].setUniform(E,f,h.get(x),y)}updatePaintBuffers(i){this._buffers=[];for(const l in this.binders){const h=this.binders[l];if(i&&h instanceof Ir){const f=2===i.fromScale?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(h instanceof Bc||h instanceof wa)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(i){for(const l in this.binders){const h=this.binders[l];(h instanceof Bc||h instanceof wa||h instanceof Ir)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof Bc||l instanceof wa||l instanceof Ir)&&l.destroy()}}}class Ca{constructor(i,l,h=(()=>!0)){this.programConfigurations={};for(const f of i)this.programConfigurations[f.id]=new Ja(f,l,h);this.needsUpload=!1,this._featureMap=new bu,this._bufferOffset=0}populatePaintArrays(i,l,h,f,y,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(i,l,f,y,x);void 0!==l.id&&this._featureMap.add(l.id,h,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,h,f){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(i,this._featureMap,l,y,f)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const Qb={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function pg(s,i){return Qb[s]||[s.replace(`${i}-`,"").replace(/-/g,"_")]}const Ky={"line-pattern":{source:an,composite:an},"fill-pattern":{source:an,composite:an},"fill-extrusion-pattern":{source:an,composite:an},"line-dasharray":{source:bi,composite:bi}},Yy={color:{source:Oc,composite:Od},number:{source:ri,composite:Oc}};function mg(s,i,l){const h=Ky[s];return h&&h[l]||Yy[i][l]}Me("ConstantBinder",Lh),Me("CrossFadedConstantBinder",Oh),Me("SourceExpressionBinder",Bc),Me("CrossFadedCompositeBinder",Ir),Me("CompositeExpressionBinder",wa),Me("ProgramConfiguration",Ja,{omit:["_buffers"]}),Me("ProgramConfigurationSet",Ca);const Bd="-transition";class Qa extends xt{constructor(i,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==i.type&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new fe(l.layout)),l.paint)){this._transitionablePaint=new pe(l.paint);for(const h in i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(const h in i.layout)this.setLayoutProperty(h,i.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new we(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l,h={}){null!=l&&this._validate(T,`layers.${this.id}.layout.${i}`,i,l,h)||("visibility"!==i?this._unevaluatedLayout.setValue(i,l):this.visibility=l)}getPaintProperty(i){return _i(i,Bd)?this._transitionablePaint.getTransition(i.slice(0,-Bd.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l,h={}){if(null!=l&&this._validate(v,`layers.${this.id}.paint.${i}`,i,l,h))return!1;if(_i(i,Bd))return this._transitionablePaint.setTransition(i.slice(0,-Bd.length),l||void 0),!1;{const f=this._transitionablePaint._values[i],y="cross-faded-data-driven"===f.property.specification["property-type"],x=f.value.isDataDriven(),E=f.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);const S=this._transitionablePaint._values[i].value;return S.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(i,E,S)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,l,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Dt(i,(l,h)=>!(void 0===l||"layout"===h&&!Object.keys(l).length||"paint"===h&&!Object.keys(l).length))}_validate(i,l,h,f,y={}){return(!y||!1!==y.validate)&&P(this,i.call(qa,{key:l,layerType:this.type,objectKey:h,value:f,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof _e&&vl(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}}const Fh=ft([{name:"a_pos",components:2,type:"Int16"}],4),{members:gp}=Fh;class Pr{constructor(i=[]){this.segments=i}prepareSegment(i,l,h,f){let y=this.segments[this.segments.length-1];return i>Pr.MAX_VERTEX_ARRAY_LENGTH&&zt(`Max vertices per segment is ${Pr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!y||y.vertexLength+i>Pr.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},void 0!==f&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,h,f){return new Pr([{vertexOffset:i,primitiveOffset:l,vertexLength:h,primitiveLength:f,vaos:{},sortKey:0}])}}Pr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Me("SegmentVector",Pr);var qn=8192;const wu=Math.pow(2,14)-1,Vd=-wu-1;function Ea(s){const i=qn/s.extent,l=s.loadGeometry();for(let h=0;h<l.length;h++){const f=l[h];for(let y=0;y<f.length;y++){const x=f[y],E=Math.round(x.x*i),S=Math.round(x.y*i);x.x=gi(E,Vd,wu),x.y=gi(S,Vd,wu),(E<x.x||E>x.x+1||S<x.y||S>x.y+1)&&zt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Cu(s,i){return{type:s.type,id:s.id,properties:s.properties,geometry:i?Ea(s):[]}}function Ud(s,i,l,h,f){s.emplaceBack(2*i+(h+1)/2,2*l+(f+1)/2)}class _p{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new kt,this.indexArray=new pn,this.segments=new Pr,this.programConfigurations=new Ca(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,h){const f=this.layers[0],y=[];let x=null;"circle"===f.type&&(x=f.layout.get("circle-sort-key"));for(const{feature:E,id:S,index:A,sourceLayerIndex:R}of i){const F=this.layers[0]._featureFilter.needGeometry,z=Cu(E,F);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),z,h))continue;const j=x?x.evaluate(z,{},h):void 0,ee={id:S,properties:E.properties,type:E.type,sourceLayerIndex:R,index:A,geometry:F?z.geometry:Ea(E),patterns:{},sortKey:j};y.push(ee)}x&&y.sort((E,S)=>E.sortKey-S.sortKey);for(const E of y){const{geometry:S,index:A,sourceLayerIndex:R}=E,F=i[A].feature;this.addFeature(E,S,A,h),l.featureIndex.insert(F,S,A,R,this.index)}}update(i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,gp),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,h,f){for(const y of l)for(const x of y){const E=x.x,S=x.y;if(E<0||E>=qn||S<0||S>=qn)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),R=A.vertexLength;Ud(this.layoutVertexArray,E,S,-1,-1),Ud(this.layoutVertexArray,E,S,1,-1),Ud(this.layoutVertexArray,E,S,1,1),Ud(this.layoutVertexArray,E,S,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},f)}}function jd(s,i){for(let l=0;l<s.length;l++)if(Ta(i,s[l]))return!0;for(let l=0;l<i.length;l++)if(Ta(s,i[l]))return!0;return!!Vc(s,i)}function e1(s,i,l){return!!Ta(s,i)||!!pt(i,s,l)}function $d(s,i){if(1===s.length)return Qy(i,s[0]);for(let l=0;l<i.length;l++){const h=i[l];for(let f=0;f<h.length;f++)if(Ta(s,h[f]))return!0}for(let l=0;l<s.length;l++)if(Qy(i,s[l]))return!0;for(let l=0;l<i.length;l++)if(Vc(s,i[l]))return!0;return!1}function Nh(s,i,l){if(s.length>1){if(Vc(s,i))return!0;for(let h=0;h<i.length;h++)if(pt(i[h],s,l))return!0}for(let h=0;h<s.length;h++)if(pt(s[h],i,l))return!0;return!1}function Vc(s,i){if(0===s.length||0===i.length)return!1;for(let l=0;l<s.length-1;l++){const h=s[l],f=s[l+1];for(let y=0;y<i.length-1;y++)if(Jy(h,f,i[y],i[y+1]))return!0}return!1}function Jy(s,i,l,h){return ki(s,l,h)!==ki(i,l,h)&&ki(s,i,l)!==ki(s,i,h)}function pt(s,i,l){const h=l*l;if(1===i.length)return s.distSqr(i[0])<h;for(let f=1;f<i.length;f++)if(yp(s,i[f-1],i[f])<h)return!0;return!1}function yp(s,i,l){const h=i.distSqr(l);if(0===h)return s.distSqr(i);const f=((s.x-i.x)*(l.x-i.x)+(s.y-i.y)*(l.y-i.y))/h;return s.distSqr(f<0?i:f>1?l:l.sub(i)._mult(f)._add(i))}function Qy(s,i){let l,h,f,y=!1;for(let x=0;x<s.length;x++){l=s[x];for(let E=0,S=l.length-1;E<l.length;S=E++)h=l[E],f=l[S],h.y>i.y!=f.y>i.y&&i.x<(f.x-h.x)*(i.y-h.y)/(f.y-h.y)+h.x&&(y=!y)}return y}function Ta(s,i){let l=!1;for(let h=0,f=s.length-1;h<s.length;f=h++){const y=s[h],x=s[f];y.y>i.y!=x.y>i.y&&i.x<(x.x-y.x)*(i.y-y.y)/(x.y-y.y)+y.x&&(l=!l)}return l}function nh(s,i,l,h,f){for(const x of s)if(i<=x.x&&l<=x.y&&h>=x.x&&f>=x.y)return!0;const y=[new Qe(i,l),new Qe(i,f),new Qe(h,f),new Qe(h,l)];if(s.length>2)for(const x of y)if(Ta(s,x))return!0;for(let x=0;x<s.length-1;x++)if(ev(s[x],s[x+1],y))return!0;return!1}function ev(s,i,l){const h=l[0],f=l[2];if(s.x<h.x&&i.x<h.x||s.x>f.x&&i.x>f.x||s.y<h.y&&i.y<h.y||s.y>f.y&&i.y>f.y)return!1;const y=ki(s,i,l[0]);return y!==ki(s,i,l[1])||y!==ki(s,i,l[2])||y!==ki(s,i,l[3])}function Eu(s,i,l){const h=i.paint.get(s).value;return"constant"===h.kind?h.value:l.programConfigurations.get(i.id).getMaxValue(s)}function zh(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function tv(s,i,l,h,f){if(!i[0]&&!i[1])return s;const y=Qe.convert(i)._mult(f);"viewport"===l&&y._rotate(-h);const x=[];for(let E=0;E<s.length;E++)x.push(s[E].sub(y));return x}function Tu(s,i,l,h){const f=Qe.convert(s)._mult(h);return"viewport"===i&&f._rotate(-l),f}Me("CircleBucket",_p,{omit:["layers"]});const vs=new ze({"circle-sort-key":new Se(xe.layout_circle["circle-sort-key"])});var Hd={paint:new ze({"circle-radius":new Se(xe.paint_circle["circle-radius"]),"circle-color":new Se(xe.paint_circle["circle-color"]),"circle-blur":new Se(xe.paint_circle["circle-blur"]),"circle-opacity":new Se(xe.paint_circle["circle-opacity"]),"circle-translate":new ce(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new ce(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ce(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ce(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Se(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Se(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Se(xe.paint_circle["circle-stroke-opacity"])}),layout:vs},_r="undefined"!=typeof Float32Array?Float32Array:Array;function gg(){var s=new _r(9);return _r!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Gd(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Zd(s,i,l){var h=i[0],f=i[1],y=i[2],x=i[3],E=i[4],S=i[5],A=i[6],R=i[7],F=i[8],z=i[9],j=i[10],ee=i[11],ne=i[12],ue=i[13],ye=i[14],Ce=i[15],Ie=l[0],Pe=l[1],ke=l[2],Oe=l[3];return s[0]=Ie*h+Pe*E+ke*F+Oe*ne,s[1]=Ie*f+Pe*S+ke*z+Oe*ue,s[2]=Ie*y+Pe*A+ke*j+Oe*ye,s[3]=Ie*x+Pe*R+ke*ee+Oe*Ce,s[4]=(Ie=l[4])*h+(Pe=l[5])*E+(ke=l[6])*F+(Oe=l[7])*ne,s[5]=Ie*f+Pe*S+ke*z+Oe*ue,s[6]=Ie*y+Pe*A+ke*j+Oe*ye,s[7]=Ie*x+Pe*R+ke*ee+Oe*Ce,s[8]=(Ie=l[8])*h+(Pe=l[9])*E+(ke=l[10])*F+(Oe=l[11])*ne,s[9]=Ie*f+Pe*S+ke*z+Oe*ue,s[10]=Ie*y+Pe*A+ke*j+Oe*ye,s[11]=Ie*x+Pe*R+ke*ee+Oe*Ce,s[12]=(Ie=l[12])*h+(Pe=l[13])*E+(ke=l[14])*F+(Oe=l[15])*ne,s[13]=Ie*f+Pe*S+ke*z+Oe*ue,s[14]=Ie*y+Pe*A+ke*j+Oe*ye,s[15]=Ie*x+Pe*R+ke*ee+Oe*Ce,s}Math.hypot||(Math.hypot=function(){for(var s=0,i=arguments.length;i--;)s+=arguments[i]*arguments[i];return Math.sqrt(s)});var qd=Zd;function Bh(){var s=new _r(3);return _r!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function _g(s){return Math.hypot(s[0],s[1],s[2])}function ih(s,i,l){var h=new _r(3);return h[0]=s,h[1]=i,h[2]=l,h}function Du(s,i,l){return s[0]=i[0]-l[0],s[1]=i[1]-l[1],s[2]=i[2]-l[2],s}function rh(s,i,l){return s[0]=i[0]*l[0],s[1]=i[1]*l[1],s[2]=i[2]*l[2],s}function yg(s,i,l,h){return s[0]=i[0]+l[0]*h,s[1]=i[1]+l[1]*h,s[2]=i[2]+l[2]*h,s}function nv(s,i){var l=i[0],h=i[1],f=i[2],y=l*l+h*h+f*f;return y>0&&(y=1/Math.sqrt(y)),s[0]=i[0]*y,s[1]=i[1]*y,s[2]=i[2]*y,s}function vp(s,i,l){var h=l[0],f=l[1],y=l[2],x=i[0],E=i[1],S=i[2],A=f*S-y*E,R=y*x-h*S,F=h*E-f*x,z=f*F-y*R,j=y*A-h*F,ee=h*R-f*A,ne=2*l[3];return R*=ne,F*=ne,j*=2,ee*=2,s[0]=x+(A*=ne)+(z*=2),s[1]=E+R+j,s[2]=S+F+ee,s}var Vh,t1=Du,iv=rh,rv=_g;function Uh(s,i,l){var h=i[0],f=i[1],y=i[2],x=i[3];return s[0]=l[0]*h+l[4]*f+l[8]*y+l[12]*x,s[1]=l[1]*h+l[5]*f+l[9]*y+l[13]*x,s[2]=l[2]*h+l[6]*f+l[10]*y+l[14]*x,s[3]=l[3]*h+l[7]*f+l[11]*y+l[15]*x,s}function oh(){var s=new _r(4);return _r!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Wd(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function Su(s,i,l){l*=.5;var h=i[0],f=i[1],y=i[2],x=i[3],E=Math.sin(l),S=Math.cos(l);return s[0]=h*S+x*E,s[1]=f*S+y*E,s[2]=y*S-f*E,s[3]=x*S-h*E,s}function vg(s,i,l,h,f,y,x,E,S){if(y&&s.queryGeometry.isAboveHorizon)return!1;y&&(S*=s.pixelToTileUnitsFactor);for(const A of i)for(const R of A){const F=R.add(E),z=f&&l.elevation?l.elevation.exaggeration()*f.getElevationAt(F.x,F.y,!0):0,j=y?F:ov(F,z,h),ee=y?s.tilespaceRays.map(ue=>xp(ue,z)):s.queryGeometry.screenGeometry,ne=Uh([],[R.x,R.y,z,1],h);if(!x&&y?S*=ne[3]/l.cameraToCenterDistance:x&&!y&&(S*=l.cameraToCenterDistance/ne[3]),e1(ee,j,S))return!0}return!1}function ov(s,i,l){const h=Uh([],[s.x,s.y,i,1],l);return new Qe(h[0]/h[3],h[1]/h[3])}Bh(),Vh=new _r(4),_r!=Float32Array&&(Vh[0]=0,Vh[1]=0,Vh[2]=0,Vh[3]=0),Bh(),ih(1,0,0),ih(0,1,0),oh(),oh(),gg();const sv=ih(0,0,0),Xd=ih(0,0,1);function xp(s,i){const l=Bh();return sv[2]=i,s.intersectsPlane(sv,Xd,l),new Qe(l[0],l[1])}class bp extends _p{}function Kd(s,{width:i,height:l},h,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==i*l*h)throw new RangeError("mismatched image size")}else f=new Uint8Array(i*l*h);return s.width=i,s.height=l,s.data=f,s}function wp(s,{width:i,height:l},h){if(i===s.width&&l===s.height)return;const f=Kd({},{width:i,height:l},h);tc(s,f,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,i),height:Math.min(s.height,l)},h),s.width=i,s.height=l,s.data=f.data}function tc(s,i,l,h,f,y){if(0===f.width||0===f.height)return i;if(f.width>s.width||f.height>s.height||l.x>s.width-f.width||l.y>s.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>i.width||f.height>i.height||h.x>i.width-f.width||h.y>i.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,E=i.data;for(let S=0;S<f.height;S++){const A=((l.y+S)*s.width+l.x)*y,R=((h.y+S)*i.width+h.x)*y;for(let F=0;F<f.width*y;F++)E[R+F]=x[A+F]}return i}Me("HeatmapBucket",bp,{omit:["layers"]});class Uc{constructor(i,l){Kd(this,i,1,l)}resize(i){wp(this,i,1)}clone(){return new Uc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,f,y){tc(i,l,h,f,y,1)}}class js{constructor(i,l){Kd(this,i,4,l)}resize(i){wp(this,i,4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,f,y){tc(i,l,h,f,y,4)}}Me("AlphaImage",Uc),Me("RGBAImage",js);var av={paint:new ze({"heatmap-radius":new Se(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Se(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ce(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Te(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ce(xe.paint_heatmap["heatmap-opacity"])})};function Cp(s){const i={},l=s.resolution||256,h=s.clips?s.clips.length:1,f=s.image||new js({width:l,height:h}),y=(x,E,S)=>{i[s.evaluationKey]=S;const A=s.expression.evaluate(i);f.data[x+E+0]=Math.floor(255*A.r/A.a),f.data[x+E+1]=Math.floor(255*A.g/A.a),f.data[x+E+2]=Math.floor(255*A.b/A.a),f.data[x+E+3]=Math.floor(255*A.a)};if(s.clips)for(let x=0,E=0;x<h;++x,E+=4*l)for(let S=0,A=0;S<l;S++,A+=4){const R=S/(l-1),{start:F,end:z}=s.clips[x];y(E,A,F*(1-R)+z*R)}else for(let x=0,E=0;x<l;x++,E+=4)y(0,E,x/(l-1));return f}var lv={paint:new ze({"hillshade-illumination-direction":new ce(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ce(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ce(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ce(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ce(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ce(xe.paint_hillshade["hillshade-accent-color"])})};const $s=ft([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dl}=$s;var Yd=Jd,cv=Jd;function Jd(s,i,l){l=l||2;var h,f,y,x,E,S,A,R=i&&i.length,F=R?i[0]*l:s.length,z=xg(s,0,F,l,!0),j=[];if(!z||z.next===z.prev)return j;if(R&&(z=function(ne,ue,ye,Ce){var Ie,Pe,ke,Oe=[];for(Ie=0,Pe=ue.length;Ie<Pe;Ie++)(ke=xg(ne,ue[Ie]*Ce,Ie<Pe-1?ue[Ie+1]*Ce:ne.length,Ce,!1))===ke.next&&(ke.steiner=!0),Oe.push(wg(ke));for(Oe.sort(fv),Ie=0;Ie<Oe.length;Ie++)n1(Oe[Ie],ye),ye=jc(ye,ye.next);return ye}(s,i,z,l)),s.length>80*l){h=y=s[0],f=x=s[1];for(var ee=l;ee<F;ee+=l)(E=s[ee])<h&&(h=E),(S=s[ee+1])<f&&(f=S),E>y&&(y=E),S>x&&(x=S);A=0!==(A=Math.max(y-h,x-f))?1/A:0}return jh(z,j,l,h,f,A),j}function xg(s,i,l,h,f){var y,x;if(f===Eg(s,i,l,h)>0)for(y=i;y<l;y+=h)x=tf(y,s[y],s[y+1],x);else for(y=l-h;y>=i;y-=h)x=tf(y,s[y],s[y+1],x);return x&&Hh(x,x.next)&&(Au(x),x=x.next),x}function jc(s,i){if(!s)return s;i||(i=s);var l,h=s;do{if(l=!1,h.steiner||!Hh(h,h.next)&&0!==Bi(h.prev,h,h.next))h=h.next;else{if(Au(h),(h=i=h.prev)===h.next)break;l=!0}}while(l||h!==i);return i}function jh(s,i,l,h,f,y,x){if(s){!x&&y&&function(R,F,z,j){var ee=R;do{null===ee.z&&(ee.z=Mu(ee.x,ee.y,F,z,j)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next}while(ee!==R);ee.prevZ.nextZ=null,ee.prevZ=null,function(ne){var ue,ye,Ce,Ie,Pe,ke,Oe,Ue,Ye=1;do{for(ye=ne,ne=null,Pe=null,ke=0;ye;){for(ke++,Ce=ye,Oe=0,ue=0;ue<Ye&&(Oe++,Ce=Ce.nextZ);ue++);for(Ue=Ye;Oe>0||Ue>0&&Ce;)0!==Oe&&(0===Ue||!Ce||ye.z<=Ce.z)?(Ie=ye,ye=ye.nextZ,Oe--):(Ie=Ce,Ce=Ce.nextZ,Ue--),Pe?Pe.nextZ=Ie:ne=Ie,Ie.prevZ=Pe,Pe=Ie;ye=Ce}Pe.nextZ=null,Ye*=2}while(ke>1)}(ee)}(s,h,f,y);for(var E,S,A=s;s.prev!==s.next;)if(E=s.prev,S=s.next,y?uv(s,h,f,y):bg(s))i.push(E.i/l),i.push(s.i/l),i.push(S.i/l),Au(s),s=S.next,A=S.next;else if((s=S)===A){x?1===x?jh(s=hv(jc(s),i,l),i,l,h,f,y,2):2===x&&dv(s,i,l,h,f,y):jh(jc(s),i,l,h,f,y,1);break}}}function bg(s){var i=s.prev,l=s,h=s.next;if(Bi(i,l,h)>=0)return!1;for(var f=s.next.next;f!==s.prev;){if(ts(i.x,i.y,l.x,l.y,h.x,h.y,f.x,f.y)&&Bi(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function uv(s,i,l,h){var f=s.prev,y=s,x=s.next;if(Bi(f,y,x)>=0)return!1;for(var E=f.x>y.x?f.x>x.x?f.x:x.x:y.x>x.x?y.x:x.x,S=f.y>y.y?f.y>x.y?f.y:x.y:y.y>x.y?y.y:x.y,A=Mu(f.x<y.x?f.x<x.x?f.x:x.x:y.x<x.x?y.x:x.x,f.y<y.y?f.y<x.y?f.y:x.y:y.y<x.y?y.y:x.y,i,l,h),R=Mu(E,S,i,l,h),F=s.prevZ,z=s.nextZ;F&&F.z>=A&&z&&z.z<=R;){if(F!==s.prev&&F!==s.next&&ts(f.x,f.y,y.x,y.y,x.x,x.y,F.x,F.y)&&Bi(F.prev,F,F.next)>=0||(F=F.prevZ,z!==s.prev&&z!==s.next&&ts(f.x,f.y,y.x,y.y,x.x,x.y,z.x,z.y)&&Bi(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;F&&F.z>=A;){if(F!==s.prev&&F!==s.next&&ts(f.x,f.y,y.x,y.y,x.x,x.y,F.x,F.y)&&Bi(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;z&&z.z<=R;){if(z!==s.prev&&z!==s.next&&ts(f.x,f.y,y.x,y.y,x.x,x.y,z.x,z.y)&&Bi(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function hv(s,i,l){var h=s;do{var f=h.prev,y=h.next.next;!Hh(f,y)&&Ep(f,h,h.next,y)&&Qd(f,y)&&Qd(y,f)&&(i.push(f.i/l),i.push(h.i/l),i.push(y.i/l),Au(h),Au(h.next),h=s=y),h=h.next}while(h!==s);return jc(h)}function dv(s,i,l,h,f,y){var x=s;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&$h(x,E)){var S=ef(x,E);return x=jc(x,x.next),S=jc(S,S.next),jh(x,i,l,h,f,y),void jh(S,i,l,h,f,y)}E=E.next}x=x.next}while(x!==s)}function fv(s,i){return s.x-i.x}function n1(s,i){if(i=function(h,f){var y,x=f,E=h.x,S=h.y,A=-1/0;do{if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){var R=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(R<=E&&R>A){if(A=R,R===E){if(S===x.y)return x;if(S===x.next.y)return x.next}y=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!y)return null;if(E===A)return y;var F,z=y,j=y.x,ee=y.y,ne=1/0;x=y;do{E>=x.x&&x.x>=j&&E!==x.x&&ts(S<ee?E:A,S,j,ee,S<ee?A:E,S,x.x,x.y)&&(F=Math.abs(S-x.y)/(E-x.x),Qd(x,h)&&(F<ne||F===ne&&(x.x>y.x||x.x===y.x&&pv(y,x)))&&(y=x,ne=F)),x=x.next}while(x!==z);return y}(s,i)){var l=ef(i,s);jc(i,i.next),jc(l,l.next)}}function pv(s,i){return Bi(s.prev,s,i.prev)<0&&Bi(i.next,s,s.next)<0}function Mu(s,i,l,h,f){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-l)*f)|s<<8))|s<<4))|s<<2))|s<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-h)*f)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function wg(s){var i=s,l=s;do{(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next}while(i!==s);return l}function ts(s,i,l,h,f,y,x,E){return(f-x)*(i-E)-(s-x)*(y-E)>=0&&(s-x)*(h-E)-(l-x)*(i-E)>=0&&(l-x)*(y-E)-(f-x)*(h-E)>=0}function $h(s,i){return s.next.i!==i.i&&s.prev.i!==i.i&&!function(l,h){var f=l;do{if(f.i!==l.i&&f.next.i!==l.i&&f.i!==h.i&&f.next.i!==h.i&&Ep(f,f.next,l,h))return!0;f=f.next}while(f!==l);return!1}(s,i)&&(Qd(s,i)&&Qd(i,s)&&function(l,h){var f=l,y=!1,x=(l.x+h.x)/2,E=(l.y+h.y)/2;do{f.y>E!=f.next.y>E&&f.next.y!==f.y&&x<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next}while(f!==l);return y}(s,i)&&(Bi(s.prev,s,i.prev)||Bi(s,i.prev,i))||Hh(s,i)&&Bi(s.prev,s,s.next)>0&&Bi(i.prev,i,i.next)>0)}function Bi(s,i,l){return(i.y-s.y)*(l.x-i.x)-(i.x-s.x)*(l.y-i.y)}function Hh(s,i){return s.x===i.x&&s.y===i.y}function Ep(s,i,l,h){var f=Dp(Bi(s,i,l)),y=Dp(Bi(s,i,h)),x=Dp(Bi(l,h,s)),E=Dp(Bi(l,h,i));return f!==y&&x!==E||!(0!==f||!Tp(s,l,i))||!(0!==y||!Tp(s,h,i))||!(0!==x||!Tp(l,s,h))||!(0!==E||!Tp(l,i,h))}function Tp(s,i,l){return i.x<=Math.max(s.x,l.x)&&i.x>=Math.min(s.x,l.x)&&i.y<=Math.max(s.y,l.y)&&i.y>=Math.min(s.y,l.y)}function Dp(s){return s>0?1:s<0?-1:0}function Qd(s,i){return Bi(s.prev,s,s.next)<0?Bi(s,i,s.next)>=0&&Bi(s,s.prev,i)>=0:Bi(s,i,s.prev)<0||Bi(s,s.next,i)<0}function ef(s,i){var l=new Cg(s.i,s.x,s.y),h=new Cg(i.i,i.x,i.y),f=s.next,y=i.prev;return s.next=i,i.prev=s,l.next=f,f.prev=l,h.next=l,l.prev=h,y.next=h,h.prev=y,h}function tf(s,i,l,h){var f=new Cg(s,i,l);return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function Au(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Cg(s,i,l){this.i=s,this.x=i,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Eg(s,i,l,h){for(var f=0,y=i,x=l-h;y<l;y+=h)f+=(s[x]-s[y])*(s[y+1]+s[x+1]),x=y;return f}function Tg(s,i,l,h,f){Dg(s,i,l||0,h||s.length-1,f||mv)}function Dg(s,i,l,h,f){for(;h>l;){if(h-l>600){var y=h-l+1,x=i-l+1,E=Math.log(y),S=.5*Math.exp(2*E/3),A=.5*Math.sqrt(E*S*(y-S)/y)*(x-y/2<0?-1:1);Dg(s,i,Math.max(l,Math.floor(i-x*S/y+A)),Math.min(h,Math.floor(i+(y-x)*S/y+A)),f)}var R=s[i],F=l,z=h;for(Gh(s,l,i),f(s[h],R)>0&&Gh(s,l,h);F<z;){for(Gh(s,F,z),F++,z--;f(s[F],R)<0;)F++;for(;f(s[z],R)>0;)z--}0===f(s[l],R)?Gh(s,l,z):Gh(s,++z,h),z<=i&&(l=z+1),i<=z&&(h=z-1)}}function Gh(s,i,l){var h=s[i];s[i]=s[l],s[l]=h}function mv(s,i){return s<i?-1:s>i?1:0}function Sp(s,i){const l=s.length;if(l<=1)return[s];const h=[];let f,y;for(let x=0;x<l;x++){const E=Ri(s[x]);0!==E&&(s[x].area=Math.abs(E),void 0===y&&(y=E<0),y===E<0?(f&&h.push(f),f=[s[x]]):f.push(s[x]))}if(f&&h.push(f),i>1)for(let x=0;x<h.length;x++)h[x].length<=i||(Tg(h[x],i,1,h[x].length-1,Sg),h[x]=h[x].slice(0,i));return h}function Sg(s,i){return i.area-s.area}function sh(s,i,l){const h=l.patternDependencies;let f=!1;for(const y of i){const x=y.paint.get(`${s}-pattern`);x.isConstant()||(f=!0);const E=x.constantOr(null);E&&(f=!0,h[E.to]=!0,h[E.from]=!0)}return f}function nf(s,i,l,h,f){const y=f.patternDependencies;for(const x of i){const E=x.paint.get(`${s}-pattern`).value;if("constant"!==E.kind){let S=E.evaluate({zoom:h-1},l,{},f.availableImages),A=E.evaluate({zoom:h},l,{},f.availableImages),R=E.evaluate({zoom:h+1},l,{},f.availableImages);S=S&&S.name?S.name:S,A=A&&A.name?A.name:A,R=R&&R.name?R.name:R,y[S]=!0,y[A]=!0,y[R]=!0,l.patterns[x.id]={min:S,mid:A,max:R}}}return l}Jd.deviation=function(s,i,l,h){var f=i&&i.length,y=Math.abs(Eg(s,0,f?i[0]*l:s.length,l));if(f)for(var x=0,E=i.length;x<E;x++)y-=Math.abs(Eg(s,i[x]*l,x<E-1?i[x+1]*l:s.length,l));var S=0;for(x=0;x<h.length;x+=3){var A=h[x]*l,R=h[x+1]*l,F=h[x+2]*l;S+=Math.abs((s[A]-s[F])*(s[R+1]-s[A+1])-(s[A]-s[R])*(s[F+1]-s[A+1]))}return 0===y&&0===S?0:Math.abs((S-y)/y)},Jd.flatten=function(s){for(var i=s[0][0].length,l={vertices:[],holes:[],dimensions:i},h=0,f=0;f<s.length;f++){for(var y=0;y<s[f].length;y++)for(var x=0;x<i;x++)l.vertices.push(s[f][y][x]);f>0&&l.holes.push(h+=s[f-1].length)}return l},Yd.default=cv;class Zh{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kt,this.indexArray=new pn,this.indexArray2=new Ki,this.programConfigurations=new Ca(i.layers,i.zoom),this.segments=new Pr,this.segments2=new Pr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,h){this.hasPattern=sh("fill",this.layers,l);const f=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:x,id:E,index:S,sourceLayerIndex:A}of i){const R=this.layers[0]._featureFilter.needGeometry,F=Cu(x,R);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),F,h))continue;const z=f?f.evaluate(F,{},h,l.availableImages):void 0,j={id:E,properties:x.properties,type:x.type,sourceLayerIndex:A,index:S,geometry:R?F.geometry:Ea(x),patterns:{},sortKey:z};y.push(j)}f&&y.sort((x,E)=>x.sortKey-E.sortKey);for(const x of y){const{geometry:E,index:S,sourceLayerIndex:A}=x;if(this.hasPattern){const R=nf("fill",this.layers,x,this.zoom,l);this.patternFeatures.push(R)}else this.addFeature(x,E,S,h,{});l.featureIndex.insert(i[S].feature,E,S,A,this.index)}}update(i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,h)}addFeatures(i,l,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Dl),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,h,f,y){for(const x of Sp(l,500)){let E=0;for(const j of x)E+=j.length;const S=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),A=S.vertexLength,R=[],F=[];for(const j of x){if(0===j.length)continue;j!==x[0]&&F.push(R.length/2);const ee=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),ne=ee.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(ne+j.length-1,ne),R.push(j[0].x),R.push(j[0].y);for(let ue=1;ue<j.length;ue++)this.layoutVertexArray.emplaceBack(j[ue].x,j[ue].y),this.indexArray2.emplaceBack(ne+ue-1,ne+ue),R.push(j[ue].x),R.push(j[ue].y);ee.vertexLength+=j.length,ee.primitiveLength+=j.length}const z=Yd(R,F);for(let j=0;j<z.length;j+=3)this.indexArray.emplaceBack(A+z[j],A+z[j+1],A+z[j+2]);S.vertexLength+=E,S.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,y,f)}}Me("FillBucket",Zh,{omit:["layers","patternFeatures"]});const gv=new ze({"fill-sort-key":new Se(xe.layout_fill["fill-sort-key"])});var wi={paint:new ze({"fill-antialias":new ce(xe.paint_fill["fill-antialias"]),"fill-opacity":new Se(xe.paint_fill["fill-opacity"]),"fill-color":new Se(xe.paint_fill["fill-color"]),"fill-outline-color":new Se(xe.paint_fill["fill-outline-color"]),"fill-translate":new ce(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new ce(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new je(xe.paint_fill["fill-pattern"])}),layout:gv};const _v=ft([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),yv=ft([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:rf}=_v;var Mp=ah;function ah(s,i,l,h,f){this.properties={},this.extent=l,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=f,s.readFields(vv,this,i)}function vv(s,i,l){1==s?i.id=l.readVarint():2==s?function(h,f){for(var y=h.readVarint()+h.pos;h.pos<y;){var x=f._keys[h.readVarint()],E=f._values[h.readVarint()];f.properties[x]=E}}(l,i):3==s?i.type=l.readVarint():4==s&&(i._geometry=l.pos)}function xv(s){for(var i,l,h=0,f=0,y=s.length,x=y-1;f<y;x=f++)h+=((l=s[x]).x-(i=s[f]).x)*(i.y+l.y);return h}ah.types=["Unknown","Point","LineString","Polygon"],ah.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var i,l=s.readVarint()+s.pos,h=1,f=0,y=0,x=0,E=[];s.pos<l;){if(f<=0){var S=s.readVarint();h=7&S,f=S>>3}if(f--,1===h||2===h)y+=s.readSVarint(),x+=s.readSVarint(),1===h&&(i&&E.push(i),i=[]),i.push(new Qe(y,x));else{if(7!==h)throw new Error("unknown command "+h);i&&i.push(i[0].clone())}}return i&&E.push(i),E},ah.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var i=s.readVarint()+s.pos,l=1,h=0,f=0,y=0,x=1/0,E=-1/0,S=1/0,A=-1/0;s.pos<i;){if(h<=0){var R=s.readVarint();l=7&R,h=R>>3}if(h--,1===l||2===l)(f+=s.readSVarint())<x&&(x=f),f>E&&(E=f),(y+=s.readSVarint())<S&&(S=y),y>A&&(A=y);else if(7!==l)throw new Error("unknown command "+l)}return[x,S,E,A]},ah.prototype.toGeoJSON=function(s,i,l){var h,f,y=this.extent*Math.pow(2,l),x=this.extent*s,E=this.extent*i,S=this.loadGeometry(),A=ah.types[this.type];function R(j){for(var ee=0;ee<j.length;ee++){var ne=j[ee];j[ee]=[360*(ne.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+E)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(h=0;h<S.length;h++)F[h]=S[h][0];R(S=F);break;case 2:for(h=0;h<S.length;h++)R(S[h]);break;case 3:for(S=function(j){var ee=j.length;if(ee<=1)return[j];for(var ne,ue,ye=[],Ce=0;Ce<ee;Ce++){var Ie=xv(j[Ce]);0!==Ie&&(void 0===ue&&(ue=Ie<0),ue===Ie<0?(ne&&ye.push(ne),ne=[j[Ce]]):ne.push(j[Ce]))}return ne&&ye.push(ne),ye}(S),h=0;h<S.length;h++)for(f=0;f<S[h].length;f++)R(S[h][f])}1===S.length?S=S[0]:A="Multi"+A;var z={type:"Feature",geometry:{type:A,coordinates:S},properties:this.properties};return"id"in this&&(z.id=this.id),z};var Mg=Ag;function Ag(s,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(i1,this,i),this.length=this._features.length}function i1(s,i,l){15===s?i.version=l.readVarint():1===s?i.name=l.readString():5===s?i.extent=l.readVarint():2===s?i._features.push(l.pos):3===s?i._keys.push(l.readString()):4===s&&i._values.push(function(h){for(var f=null,y=h.readVarint()+h.pos;h.pos<y;){var x=h.readVarint()>>3;f=1===x?h.readString():2===x?h.readFloat():3===x?h.readDouble():4===x?h.readVarint64():5===x?h.readVarint():6===x?h.readSVarint():7===x?h.readBoolean():null}return f}(l))}function r1(s,i,l){if(3===s){var h=new Mg(l,l.readVarint()+l.pos);h.length&&(i[h.name]=h)}}Ag.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var i=this._pbf.readVarint()+this._pbf.pos;return new Mp(this._pbf,i,this.extent,this._keys,this._values)};var el={VectorTile:function(s,i){this.layers=s.readFields(r1,{},i)},VectorTileFeature:Mp,VectorTileLayer:Mg};const ns=el.VectorTileFeature.types,Ap=Math.pow(2,13);function lh(s,i,l,h,f,y,x,E){s.emplaceBack((i<<1)+x,(l<<1)+y,(Math.floor(h*Ap)<<1)+f,Math.round(E))}class Ip{constructor(){this.acc=new Qe(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Qe(i.x,i.y),this.max=new Qe(i.x,i.y))}append(i,l){this.currentPolyCount.edges++,this.acc._add(i);let h=!!this.borders;const f=this.min,y=this.max;i.x<f.x?(f.x=i.x,h=!0):i.x>y.x&&(y.x=i.x,h=!0),i.y<f.y?(f.y=i.y,h=!0):i.y>y.y&&(y.y=i.y,h=!0),((0===i.x||i.x===qn)&&i.x===l.x)!=((0===i.y||i.y===qn)&&i.y===l.y)&&this.processBorderOverlap(i,l),h&&this.checkBorderIntersection(i,l)}checkBorderIntersection(i,l){l.x<0!=i.x<0&&this.addBorderIntersection(0,et(l.y,i.y,(0-l.x)/(i.x-l.x))),l.x>qn!=i.x>qn&&this.addBorderIntersection(1,et(l.y,i.y,(qn-l.x)/(i.x-l.x))),l.y<0!=i.y<0&&this.addBorderIntersection(2,et(l.x,i.x,(0-l.y)/(i.y-l.y))),l.y>qn!=i.y>qn&&this.addBorderIntersection(3,et(l.x,i.x,(qn-l.y)/(i.y-l.y)))}addBorderIntersection(i,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];l<h[0]&&(h[0]=l),l>h[1]&&(h[1]=l)}processBorderOverlap(i,l){if(i.x===l.x){if(i.y===l.y)return;const h=0===i.x?0:1;this.addBorderIntersection(h,l.y),this.addBorderIntersection(h,i.y)}else{const h=0===i.y?2:3;this.addBorderIntersection(h,l.x),this.addBorderIntersection(h,i.x)}}centroid(){const i=this.polyCount.reduce((l,h)=>l+h.edges,0);return 0!==i?this.acc.div(i)._round():new Qe(0,0)}span(){return new Qe(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,l)=>i+ +(l[0]!==Number.MAX_VALUE),0)}}class oo{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Mi,this.centroidVertexArray=new Wy,this.indexArray=new pn,this.programConfigurations=new Ca(i.layers,i.zoom),this.segments=new Pr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=i.enableTerrain}populate(i,l,h){this.features=[],this.hasPattern=sh("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(f){const y=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*y/(y*y+1)/qn/(1<<f.z)}(h);for(const{feature:f,id:y,index:x,sourceLayerIndex:E}of i){const S=this.layers[0]._featureFilter.needGeometry,A=Cu(f,S);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),A,h))continue;const R={id:y,sourceLayerIndex:E,index:x,geometry:S?A.geometry:Ea(f),properties:f.properties,type:f.type,patterns:{}},F=this.layoutVertexArray.length;this.hasPattern?this.features.push(nf("fill-extrusion",this.layers,R,this.zoom,l)):this.addFeature(R,R.geometry,x,h,{}),l.featureIndex.insert(f,R.geometry,x,E,this.index,F)}this.sortBorders()}addFeatures(i,l,h){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,l,h)}this.sortBorders()}update(i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,rf),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,yv.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,h,f,y){const x=this.enableTerrain?new Ip:null;for(const S of Sp(l,500)){let A=0,R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===S.length||(E=S[0]).every(ne=>ne.x<=0)||E.every(ne=>ne.x>=qn)||E.every(ne=>ne.y<=0)||E.every(ne=>ne.y>=qn))continue;for(let ne=0;ne<S.length;ne++){const ue=S[ne];if(0===ue.length)continue;A+=ue.length;let ye=0;x&&x.startRing(ue[0]);for(let Ce=0;Ce<ue.length;Ce++){const Ie=ue[Ce];if(Ce>=1){const Pe=ue[Ce-1];if(!qh(Ie,Pe)){x&&x.append(Ie,Pe),R.vertexLength+4>Pr.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ke=Ie.sub(Pe)._perp(),Oe=ke.x/(Math.abs(ke.x)+Math.abs(ke.y)),Ue=ke.y>0?1:0,Ye=Pe.dist(Ie);ye+Ye>32768&&(ye=0),lh(this.layoutVertexArray,Ie.x,Ie.y,Oe,Ue,0,0,ye),lh(this.layoutVertexArray,Ie.x,Ie.y,Oe,Ue,0,1,ye),ye+=Ye,lh(this.layoutVertexArray,Pe.x,Pe.y,Oe,Ue,0,0,ye),lh(this.layoutVertexArray,Pe.x,Pe.y,Oe,Ue,0,1,ye);const nt=R.vertexLength;this.indexArray.emplaceBack(nt,nt+2,nt+1),this.indexArray.emplaceBack(nt+1,nt+2,nt+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+A>Pr.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),"Polygon"!==ns[i.type])continue;const F=[],z=[],j=R.vertexLength;for(let ne=0;ne<S.length;ne++){const ue=S[ne];if(0!==ue.length){ue!==S[0]&&z.push(F.length/2);for(let ye=0;ye<ue.length;ye++){const Ce=ue[ye];lh(this.layoutVertexArray,Ce.x,Ce.y,0,0,1,1,0),F.push(Ce.x),F.push(Ce.y),x&&x.currentPolyCount.top++}}}const ee=Yd(F,z);for(let ne=0;ne<ee.length;ne+=3)this.indexArray.emplaceBack(j+ee[ne],j+ee[ne+2],j+ee[ne+1]);R.primitiveLength+=ee.length/3,R.vertexLength+=A}var E;if(x&&x.polyCount.length>0){if(x.borders){x.vertexArrayOffset=this.centroidVertexArray.length;const S=x.borders,A=this.featuresOnBorder.push(x)-1;for(let R=0;R<4;R++)S[R][0]!==Number.MAX_VALUE&&this.borders[R].push(A)}this.encodeCentroid(x.borders?void 0:x.centroid(),x)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,y,f)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((l,h)=>this.featuresOnBorder[l].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}encodeCentroid(i,l,h=!0){let f,y;if(i)if(0!==i.y){const E=l.span()._mult(this.tileToMeter);f=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(E.x/10)),y=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else f=Math.ceil(7*(i.x+450)),y=0;else f=0,y=+h;let x=h?this.centroidVertexArray.length:l.vertexArrayOffset;for(const E of l.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let S=0;S<2*E.edges;S++)this.centroidVertexArray.emplace(x++,0,y),this.centroidVertexArray.emplace(x++,f,y);for(let S=0;S<E.top;S++)this.centroidVertexArray.emplace(x++,f,y)}}}function qh(s,i){return s.x===i.x&&(s.x<0||s.x>qn)||s.y===i.y&&(s.y<0||s.y>qn)}Me("FillExtrusionBucket",oo,{omit:["layers","features"]}),Me("PartMetadata",Ip);var Pp={paint:new ze({"fill-extrusion-opacity":new ce(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Se(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ce(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ce(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new je(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Se(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Se(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ce(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Wh(s,i){return s.x*i.x+s.y*i.y}function Ig(s,i){if(1===s.length){let l=0;const h=i[l++];let f;for(;!f||h.equals(f);)if(f=i[l++],!f)return 1/0;for(;l<i.length;l++){const y=i[l],x=s[0],E=f.sub(h),S=y.sub(h),A=x.sub(h),R=Wh(E,E),F=Wh(E,S),z=Wh(S,S),j=Wh(A,E),ee=Wh(A,S),ne=R*z-F*F,ue=(z*j-F*ee)/ne,ye=(R*ee-F*j)/ne,Ce=h.z*(1-ue-ye)+f.z*ue+y.z*ye;if(isFinite(Ce))return Ce}return 1/0}{let l=1/0;for(const h of i)l=Math.min(l,h.z);return l}}function kp(s){const i=new Qe(s[0],s[1]);return i.z=s[2],i}function bv(s,i,l,h,f,y,x,E){const S=x*f.getElevationAt(s,i,!0,!0),A=0!==y[0],R=A?0===y[1]?x*(y[0]/7-450):x*function(F,z,j){const ee=Math.floor(z[0]/8),ne=Math.floor(z[1]/8),ue=10*(z[0]-8*ee),ye=10*(z[1]-8*ne),Ce=F.getElevationAt(ee,ne,!0,!0),Ie=F.getMeterToDEM(j),Pe=Math.floor(.5*(ue*Ie-1)),ke=Math.floor(.5*(ye*Ie-1)),Oe=F.tileCoordToPixel(ee,ne),Ue=2*Pe+1,Ye=2*ke+1,nt=(Pt=Ue,hn=Ye,[(At=F).getElevationAtPixel(dt=Oe.x-Pe,Bn=Oe.y-ke,!0),At.getElevationAtPixel(dt+hn,Bn,!0),At.getElevationAtPixel(dt,Bn+hn,!0),At.getElevationAtPixel(dt+Pt,Bn+hn,!0)]),rt=Math.abs(nt[0]-nt[1]),qe=Math.abs(nt[2]-nt[3]),Ke=Math.abs(nt[0]-nt[2])+Math.abs(nt[1]-nt[3]),ot=Math.min(.25,.5*Ie*(rt+qe)/Ue),Xe=Math.min(.25,.5*Ie*Ke/Ye);var At,dt,Bn,Pt,hn;return Ce+Math.max(ot*ue,Xe*ye)}(f,y,E):S;return{base:S+(0===l)?-1:l,top:A?Math.max(R+h,S+l+2):S+h}}const Pg=ft([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:wv}=Pg,kg=ft([{name:"a_packed",components:3,type:"Float32"}]),{members:Cv}=kg,Ev=el.VectorTileFeature.types,Tv=Math.cos(Math.PI/180*37.5);class of{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new ai,this.layoutVertexArray2=new Zt,this.indexArray=new pn,this.programConfigurations=new Ca(i.layers,i.zoom),this.segments=new Pr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,h){this.hasPattern=sh("line",this.layers,l);const f=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:A,id:R,index:F,sourceLayerIndex:z}of i){const j=this.layers[0]._featureFilter.needGeometry,ee=Cu(A,j);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),ee,h))continue;const ne=f?f.evaluate(ee,{},h):void 0,ue={id:R,properties:A.properties,type:A.type,sourceLayerIndex:z,index:F,geometry:j?ee.geometry:Ea(A),patterns:{},sortKey:ne};y.push(ue)}f&&y.sort((A,R)=>A.sortKey-R.sortKey);const{lineAtlas:x,featureIndex:E}=l,S=this.addConstantDashes(x);for(const A of y){const{geometry:R,index:F,sourceLayerIndex:z}=A;if(S&&this.addFeatureDashes(A,x),this.hasPattern){const j=nf("line",this.layers,A,this.zoom,l);this.patternFeatures.push(j)}else this.addFeature(A,R,F,h,x.positions);E.insert(i[F].feature,R,F,z,this.index)}}addConstantDashes(i){let l=!1;for(const h of this.layers){const f=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if("constant"!==f.kind||"constant"!==y.kind)l=!0;else{const x=y.value,E=f.value;if(!E)continue;i.addDash(E.from,x),i.addDash(E.to,x),E.other&&i.addDash(E.other,x)}}return l}addFeatureDashes(i,l){const h=this.zoom;for(const f of this.layers){const y=f.paint.get("line-dasharray").value,x=f.layout.get("line-cap").value;if("constant"===y.kind&&"constant"===x.kind)continue;let E,S,A,R,F,z;if("constant"===y.kind){const ue=y.value;if(!ue)continue;E=ue.other||ue.to,S=ue.to,A=ue.from}else E=y.evaluate({zoom:h-1},i),S=y.evaluate({zoom:h},i),A=y.evaluate({zoom:h+1},i);"constant"===x.kind?R=F=z=x.value:(R=x.evaluate({zoom:h-1},i),F=x.evaluate({zoom:h},i),z=x.evaluate({zoom:h+1},i)),l.addDash(E,R),l.addDash(S,F),l.addDash(A,z);const j=l.getKey(E,R),ee=l.getKey(S,F),ne=l.getKey(A,z);i.patterns[f.id]={min:j,mid:ee,max:ne}}}update(i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,h)}addFeatures(i,l,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Cv)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,wv),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,h,f,y){const x=this.layers[0].layout,E=x.get("line-join").evaluate(i,{}),S=x.get("line-cap").evaluate(i,{}),A=x.get("line-miter-limit"),R=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const F of l)this.addLine(F,i,E,S,A,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,y,f)}addLine(i,l,h,f,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<i.length-1;ye++)this.totalDistance+=i[ye].dist(i[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E="Polygon"===Ev[l.type];let S=i.length;for(;S>=2&&i[S-1].equals(i[S-2]);)S--;let A=0;for(;A<S-1&&i[A].equals(i[A+1]);)A++;if(S<(E?3:2))return;"bevel"===h&&(y=1.05);const R=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let z,j,ee,ne,ue;this.e1=this.e2=-1,E&&(z=i[S-2],ue=i[A].sub(z)._unit()._perp());for(let ye=A;ye<S;ye++){if(ee=ye===S-1?E?i[A+1]:void 0:i[ye+1],ee&&i[ye].equals(ee))continue;ue&&(ne=ue),z&&(j=z),z=i[ye],ue=ee?ee.sub(z)._unit()._perp():ne,ne=ne||ue;let Ce=ne.add(ue);0===Ce.x&&0===Ce.y||Ce._unit();const Ie=ne.x*ue.x+ne.y*ue.y,Pe=Ce.x*ue.x+Ce.y*ue.y,ke=0!==Pe?1/Pe:1/0,Oe=2*Math.sqrt(2-2*Pe),Ue=Pe<Tv&&j&&ee,Ye=ne.x*ue.y-ne.y*ue.x>0;if(Ue&&ye>A){const qe=z.dist(j);if(qe>2*R){const Ke=z.sub(z.sub(j)._mult(R/qe)._round());this.updateDistance(j,Ke),this.addCurrentVertex(Ke,ne,0,0,F),j=Ke}}const nt=j&&ee;let rt=nt?h:E?"butt":f;if(nt&&"round"===rt&&(ke<x?rt="miter":ke<=2&&(rt="fakeround")),"miter"===rt&&ke>y&&(rt="bevel"),"bevel"===rt&&(ke>2&&(rt="flipbevel"),ke<y&&(rt="miter")),j&&this.updateDistance(j,z),"miter"===rt)Ce._mult(ke),this.addCurrentVertex(z,Ce,0,0,F);else if("flipbevel"===rt){if(ke>100)Ce=ue.mult(-1);else{const qe=ke*ne.add(ue).mag()/ne.sub(ue).mag();Ce._perp()._mult(qe*(Ye?-1:1))}this.addCurrentVertex(z,Ce,0,0,F),this.addCurrentVertex(z,Ce.mult(-1),0,0,F)}else if("bevel"===rt||"fakeround"===rt){const qe=-Math.sqrt(ke*ke-1),Ke=Ye?qe:0,ot=Ye?0:qe;if(j&&this.addCurrentVertex(z,ne,Ke,ot,F),"fakeround"===rt){const Xe=Math.round(180*Oe/Math.PI/20);for(let At=1;At<Xe;At++){let dt=At/Xe;if(.5!==dt){const Pt=dt-.5;dt+=dt*Pt*(dt-1)*((1.0904+Ie*(Ie*(3.55645-1.43519*Ie)-3.2452))*Pt*Pt+(.848013+Ie*(.215638*Ie-1.06021)))}const Bn=ue.sub(ne)._mult(dt)._add(ne)._unit()._mult(Ye?-1:1);this.addHalfVertex(z,Bn.x,Bn.y,!1,Ye,0,F)}}ee&&this.addCurrentVertex(z,ue,-Ke,-ot,F)}else if("butt"===rt)this.addCurrentVertex(z,Ce,0,0,F);else if("square"===rt){const qe=j?1:-1;j||this.addCurrentVertex(z,Ce,qe,qe,F),this.addCurrentVertex(z,Ce,0,0,F),j&&this.addCurrentVertex(z,Ce,qe,qe,F)}else"round"===rt&&(j&&(this.addCurrentVertex(z,ne,0,0,F),this.addCurrentVertex(z,ne,1,1,F,!0)),ee&&(this.addCurrentVertex(z,ue,-1,-1,F,!0),this.addCurrentVertex(z,ue,0,0,F)));if(Ue&&ye<S-1){const qe=z.dist(ee);if(qe>2*R){const Ke=z.add(ee.sub(z)._mult(R/qe)._round());this.updateDistance(z,Ke),this.addCurrentVertex(Ke,ue,0,0,F),z=Ke}}}}addCurrentVertex(i,l,h,f,y,x=!1){const E=l.y*f-l.x,S=-l.y-l.x*f;this.addHalfVertex(i,l.x+l.y*h,l.y-l.x*h,x,!1,h,y),this.addHalfVertex(i,E,S,x,!0,-f,y)}addHalfVertex({x:i,y:l},h,f,y,x,E,S){this.layoutVertexArray.emplaceBack((i<<1)+(y?1:0),(l<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*f)+128,1+(0===E?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const A=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),S.primitiveLength++),x?this.e2=A:this.e1=A}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}Me("LineBucket",of,{omit:["layers","patternFeatures"]});const Rp=new ze({"line-cap":new Se(xe.layout_line["line-cap"]),"line-join":new Se(xe.layout_line["line-join"]),"line-miter-limit":new ce(xe.layout_line["line-miter-limit"]),"line-round-limit":new ce(xe.layout_line["line-round-limit"]),"line-sort-key":new Se(xe.layout_line["line-sort-key"])});var Lp={paint:new ze({"line-opacity":new Se(xe.paint_line["line-opacity"]),"line-color":new Se(xe.paint_line["line-color"]),"line-translate":new ce(xe.paint_line["line-translate"]),"line-translate-anchor":new ce(xe.paint_line["line-translate-anchor"]),"line-width":new Se(xe.paint_line["line-width"]),"line-gap-width":new Se(xe.paint_line["line-gap-width"]),"line-offset":new Se(xe.paint_line["line-offset"]),"line-blur":new Se(xe.paint_line["line-blur"]),"line-dasharray":new je(xe.paint_line["line-dasharray"]),"line-pattern":new je(xe.paint_line["line-pattern"]),"line-gradient":new Te(xe.paint_line["line-gradient"])}),layout:Rp};const Rg=new class extends Se{possiblyEvaluate(s,i){return i=new Y(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(s,i)}evaluate(s,i,l,h){return i=Ci({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(s,i,l,h)}}(Lp.paint.properties["line-width"].specification);function Dv(s,i){return i>0?i+2*s:s}Rg.useIntegerZoom=!0;const Lg=ft([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),sf=ft([{name:"a_projected_pos",components:3,type:"Float32"}],4);ft([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Sv=ft([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Mv=ft([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $c=ft([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Av=ft([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ft([{name:"triangle",components:3,type:"Uint16"}]),ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ft([{type:"Float32",name:"offsetX"}]),ft([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Sl=128;function Op(s,i){const{expression:l}=i;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new Y(s+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:f}=l;let y=0;for(;y<h.length&&h[y]<=s;)y++;y=Math.max(0,y-1);let x=y;for(;x<h.length&&h[x]<s+1;)x++;x=Math.min(h.length-1,x);const E=h[y],S=h[x];return"composite"===l.kind?{kind:"composite",minZoom:E,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:S,minSize:l.evaluate(new Y(E)),maxSize:l.evaluate(new Y(S)),interpolationType:f}}}function af(s,{uSize:i,uSizeT:l},{lowerSize:h,upperSize:f}){return"source"===s.kind?h/Sl:"composite"===s.kind?et(h/Sl,f/Sl,l):i}function nc(s,i){let l=0,h=0;if("constant"===s.kind)h=s.layoutSize;else if("source"!==s.kind){const{interpolationType:f,minZoom:y,maxZoom:x}=s,E=f?gi(en.interpolationFactor(f,i,y,x),0,1):0;"camera"===s.kind?h=et(s.minSize,s.maxSize,E):l=E}return{uSizeT:l,uSize:h}}var Da=Object.freeze({__proto__:null,getSizeData:Op,evaluateSizeForFeature:af,evaluateSizeForZoom:nc,SIZE_PACK_FACTOR:Sl});function Og(s,i,l){return s.sections.forEach(h=>{h.text=function(f,y,x){const E=y.layout.get("text-transform").evaluate(x,{});return"uppercase"===E?f=f.toLocaleUpperCase():"lowercase"===E&&(f=f.toLocaleLowerCase()),X.applyArabicShaping&&(f=X.applyArabicShaping(f)),f}(h.text,i,l)}),s}const Xh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Iv(s){return"\ufe36"===s||"\ufe48"===s||"\ufe38"===s||"\ufe44"===s||"\ufe42"===s||"\ufe3e"===s||"\ufe3c"===s||"\ufe3a"===s||"\ufe18"===s||"\ufe40"===s||"\ufe10"===s||"\ufe13"===s||"\ufe14"===s||"\uff40"===s||"\uffe3"===s||"\ufe11"===s||"\ufe12"===s}function Fg(s){return"\ufe35"===s||"\ufe47"===s||"\ufe37"===s||"\ufe43"===s||"\ufe41"===s||"\ufe3d"===s||"\ufe3b"===s||"\ufe39"===s||"\ufe17"===s||"\ufe3f"===s}var Pv=function(s,i,l,h,f){var y,x,E=8*f-h-1,S=(1<<E)-1,A=S>>1,R=-7,F=l?f-1:0,z=l?-1:1,j=s[i+F];for(F+=z,y=j&(1<<-R)-1,j>>=-R,R+=E;R>0;y=256*y+s[i+F],F+=z,R-=8);for(x=y&(1<<-R)-1,y>>=-R,R+=h;R>0;x=256*x+s[i+F],F+=z,R-=8);if(0===y)y=1-A;else{if(y===S)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,h),y-=A}return(j?-1:1)*x*Math.pow(2,y-h)},Fp=function(s,i,l,h,f,y){var x,E,S,A=8*y-f-1,R=(1<<A)-1,F=R>>1,z=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,j=h?0:y-1,ee=h?1:-1,ne=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(E=isNaN(i)?1:0,x=R):(x=Math.floor(Math.log(i)/Math.LN2),i*(S=Math.pow(2,-x))<1&&(x--,S*=2),(i+=x+F>=1?z/S:z*Math.pow(2,1-F))*S>=2&&(x++,S/=2),x+F>=R?(E=0,x=R):x+F>=1?(E=(i*S-1)*Math.pow(2,f),x+=F):(E=i*Math.pow(2,F-1)*Math.pow(2,f),x=0));f>=8;s[l+j]=255&E,j+=ee,E/=256,f-=8);for(x=x<<f|E,A+=f;A>0;s[l+j]=255&x,j+=ee,x/=256,A-=8);s[l+j-ee]|=128*ne},ch=ti;function ti(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}ti.Varint=0,ti.Fixed64=1,ti.Bytes=2,ti.Fixed32=5;var Np=4294967296,Iu=1/Np,tl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Hc(s){return s.type===ti.Bytes?s.readVarint()+s.pos:s.pos+1}function zp(s,i,l){var h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));l.realloc(h);for(var f=l.pos-1;f>=s;f--)l.buf[f+h]=l.buf[f]}function o1(s,i){for(var l=0;l<s.length;l++)i.writeVarint(s[l])}function Hs(s,i){for(var l=0;l<s.length;l++)i.writeSVarint(s[l])}function Bp(s,i){for(var l=0;l<s.length;l++)i.writeFloat(s[l])}function Vp(s,i){for(var l=0;l<s.length;l++)i.writeDouble(s[l])}function kv(s,i){for(var l=0;l<s.length;l++)i.writeBoolean(s[l])}function Ng(s,i){for(var l=0;l<s.length;l++)i.writeFixed32(s[l])}function Yh(s,i){for(var l=0;l<s.length;l++)i.writeSFixed32(s[l])}function zg(s,i){for(var l=0;l<s.length;l++)i.writeFixed64(s[l])}function Bg(s,i){for(var l=0;l<s.length;l++)i.writeSFixed64(s[l])}function uh(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+16777216*s[i+3]}function Gc(s,i,l){s[l]=i,s[l+1]=i>>>8,s[l+2]=i>>>16,s[l+3]=i>>>24}function Up(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16)+(s[i+3]<<24)}function s1(s,i,l){i.glyphs=[],1===s&&l.readMessage(hh,i)}function hh(s,i,l){if(3===s){const{id:h,bitmap:f,width:y,height:x,left:E,top:S,advance:A}=l.readMessage(jp,{});i.glyphs.push({id:h,bitmap:new Uc({width:y+6,height:x+6},f),metrics:{width:y,height:x,left:E,top:S,advance:A}})}else 4===s?i.ascender=l.readSVarint():5===s&&(i.descender=l.readSVarint())}function jp(s,i,l){1===s?i.id=l.readVarint():2===s?i.bitmap=l.readBytes():3===s?i.width=l.readVarint():4===s?i.height=l.readVarint():5===s?i.left=l.readSVarint():6===s?i.top=l.readSVarint():7===s&&(i.advance=l.readVarint())}function lf(s){let i=0,l=0;for(const x of s)i+=x.w*x.h,l=Math.max(l,x.w);s.sort((x,E)=>E.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let f=0,y=0;for(const x of s)for(let E=h.length-1;E>=0;E--){const S=h[E];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,y=Math.max(y,x.y+x.h),f=Math.max(f,x.x+x.w),x.w===S.w&&x.h===S.h){const A=h.pop();E<h.length&&(h[E]=A)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(h.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:f,h:y,fill:i/(f*y)||0}}ti.prototype={destroy:function(){this.buf=null},readFields:function(s,i,l){for(l=l||this.length;this.pos<l;){var h=this.readVarint(),f=h>>3,y=this.pos;this.type=7&h,s(f,i,this),this.pos===y&&this.skip(h)}return i},readMessage:function(s,i){return this.readFields(s,i,this.readVarint()+this.pos)},readFixed32:function(){var s=uh(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=Up(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=uh(this.buf,this.pos)+uh(this.buf,this.pos+4)*Np;return this.pos+=8,s},readSFixed64:function(){var s=uh(this.buf,this.pos)+Up(this.buf,this.pos+4)*Np;return this.pos+=8,s},readFloat:function(){var s=Pv(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Pv(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var i,l,h=this.buf;return i=127&(l=h[this.pos++]),l<128?i:(i|=(127&(l=h[this.pos++]))<<7,l<128?i:(i|=(127&(l=h[this.pos++]))<<14,l<128?i:(i|=(127&(l=h[this.pos++]))<<21,l<128?i:function(f,y,x){var E,S,A=x.buf;if(E=(112&(S=A[x.pos++]))>>4,S<128||(E|=(127&(S=A[x.pos++]))<<3,S<128)||(E|=(127&(S=A[x.pos++]))<<10,S<128)||(E|=(127&(S=A[x.pos++]))<<17,S<128)||(E|=(127&(S=A[x.pos++]))<<24,S<128)||(E|=(1&(S=A[x.pos++]))<<31,S<128))return function(s,i,l){return l?4294967296*i+(s>>>0):4294967296*(i>>>0)+(s>>>0)}(f,E,y);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(l=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,i=this.pos;return this.pos=s,s-i>=12&&tl?tl.decode(this.buf.subarray(i,s)):function(l,h,f){for(var y="",x=h;x<f;){var E,S,A,R=l[x],F=null,z=R>239?4:R>223?3:R>191?2:1;if(x+z>f)break;1===z?R<128&&(F=R):2===z?128==(192&(E=l[x+1]))&&(F=(31&R)<<6|63&E)<=127&&(F=null):3===z?(S=l[x+2],128==(192&(E=l[x+1]))&&128==(192&S)&&((F=(15&R)<<12|(63&E)<<6|63&S)<=2047||F>=55296&&F<=57343)&&(F=null)):4===z&&(S=l[x+2],A=l[x+3],128==(192&(E=l[x+1]))&&128==(192&S)&&128==(192&A)&&((F=(15&R)<<18|(63&E)<<12|(63&S)<<6|63&A)<=65535||F>=1114112)&&(F=null)),null===F?(F=65533,z=1):F>65535&&(F-=65536,y+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),y+=String.fromCharCode(F),x+=z}return y}(this.buf,i,s)},readBytes:function(){var s=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,s);return this.pos=s,i},readPackedVarint:function(s,i){if(this.type!==ti.Bytes)return s.push(this.readVarint(i));var l=Hc(this);for(s=s||[];this.pos<l;)s.push(this.readVarint(i));return s},readPackedSVarint:function(s){if(this.type!==ti.Bytes)return s.push(this.readSVarint());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==ti.Bytes)return s.push(this.readBoolean());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==ti.Bytes)return s.push(this.readFloat());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==ti.Bytes)return s.push(this.readDouble());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==ti.Bytes)return s.push(this.readFixed32());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==ti.Bytes)return s.push(this.readSFixed32());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==ti.Bytes)return s.push(this.readFixed64());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==ti.Bytes)return s.push(this.readSFixed64());var i=Hc(this);for(s=s||[];this.pos<i;)s.push(this.readSFixed64());return s},skip:function(s){var i=7&s;if(i===ti.Varint)for(;this.buf[this.pos++]>127;);else if(i===ti.Bytes)this.pos=this.readVarint()+this.pos;else if(i===ti.Fixed32)this.pos+=4;else{if(i!==ti.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(s,i){this.writeVarint(s<<3|i)},realloc:function(s){for(var i=this.length||16;i<this.pos+s;)i*=2;if(i!==this.length){var l=new Uint8Array(i);l.set(this.buf),this.buf=l,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Gc(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Gc(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Gc(this.buf,-1&s,this.pos),Gc(this.buf,Math.floor(s*Iu),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Gc(this.buf,-1&s,this.pos),Gc(this.buf,Math.floor(s*Iu),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(i,l){var h,f,y,E;if(i>=0?(h=i%4294967296|0,f=i/4294967296|0):(f=~(-i/4294967296),4294967295^(h=~(-i%4294967296))?h=h+1|0:(h=0,f=f+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),y=h,(E=l).buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,E.buf[E.pos]=127&(y>>>=7),function(y,x){var E=(7&y)<<4;x.buf[x.pos++]|=E|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(f,l)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var i=this.pos;this.pos=function(h,f,y){for(var x,E,S=0;S<f.length;S++){if((x=f.charCodeAt(S))>55295&&x<57344){if(!E){x>56319||S+1===f.length?(h[y++]=239,h[y++]=191,h[y++]=189):E=x;continue}if(x<56320){h[y++]=239,h[y++]=191,h[y++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(h[y++]=239,h[y++]=191,h[y++]=189,E=null);x<128?h[y++]=x:(x<2048?h[y++]=x>>6|192:(x<65536?h[y++]=x>>12|224:(h[y++]=x>>18|240,h[y++]=x>>12&63|128),h[y++]=x>>6&63|128),h[y++]=63&x|128)}return y}(this.buf,s,this.pos);var l=this.pos-i;l>=128&&zp(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeFloat:function(s){this.realloc(4),Fp(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Fp(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var i=s.length;this.writeVarint(i),this.realloc(i);for(var l=0;l<i;l++)this.buf[this.pos++]=s[l]},writeRawMessage:function(s,i){this.pos++;var l=this.pos;s(i,this);var h=this.pos-l;h>=128&&zp(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,i,l){this.writeTag(s,ti.Bytes),this.writeRawMessage(i,l)},writePackedVarint:function(s,i){i.length&&this.writeMessage(s,o1,i)},writePackedSVarint:function(s,i){i.length&&this.writeMessage(s,Hs,i)},writePackedBoolean:function(s,i){i.length&&this.writeMessage(s,kv,i)},writePackedFloat:function(s,i){i.length&&this.writeMessage(s,Bp,i)},writePackedDouble:function(s,i){i.length&&this.writeMessage(s,Vp,i)},writePackedFixed32:function(s,i){i.length&&this.writeMessage(s,Ng,i)},writePackedSFixed32:function(s,i){i.length&&this.writeMessage(s,Yh,i)},writePackedFixed64:function(s,i){i.length&&this.writeMessage(s,zg,i)},writePackedSFixed64:function(s,i){i.length&&this.writeMessage(s,Bg,i)},writeBytesField:function(s,i){this.writeTag(s,ti.Bytes),this.writeBytes(i)},writeFixed32Field:function(s,i){this.writeTag(s,ti.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(s,i){this.writeTag(s,ti.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(s,i){this.writeTag(s,ti.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(s,i){this.writeTag(s,ti.Fixed64),this.writeSFixed64(i)},writeVarintField:function(s,i){this.writeTag(s,ti.Varint),this.writeVarint(i)},writeSVarintField:function(s,i){this.writeTag(s,ti.Varint),this.writeSVarint(i)},writeStringField:function(s,i){this.writeTag(s,ti.Bytes),this.writeString(i)},writeFloatField:function(s,i){this.writeTag(s,ti.Fixed32),this.writeFloat(i)},writeDoubleField:function(s,i){this.writeTag(s,ti.Fixed64),this.writeDouble(i)},writeBooleanField:function(s,i){this.writeVarintField(s,Boolean(i))}};class $p{constructor(i,{pixelRatio:l,version:h,stretchX:f,stretchY:y,content:x}){this.paddedRect=i,this.pixelRatio=l,this.stretchX=f,this.stretchY=y,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cf{constructor(i,l){const h={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(i,h,y),this.addImages(l,f,y);const{w:x,h:E}=lf(y),S=new js({width:x||1,height:E||1});for(const A in i){const R=i[A],F=h[A].paddedRect;js.copy(R.data,S,{x:0,y:0},{x:F.x+1,y:F.y+1},R.data)}for(const A in l){const R=l[A],F=f[A].paddedRect,z=F.x+1,j=F.y+1,ee=R.data.width,ne=R.data.height;js.copy(R.data,S,{x:0,y:0},{x:z,y:j},R.data),js.copy(R.data,S,{x:0,y:ne-1},{x:z,y:j-1},{width:ee,height:1}),js.copy(R.data,S,{x:0,y:0},{x:z,y:j+ne},{width:ee,height:1}),js.copy(R.data,S,{x:ee-1,y:0},{x:z-1,y:j},{width:1,height:ne}),js.copy(R.data,S,{x:0,y:0},{x:z+ee,y:j},{width:1,height:ne})}this.image=S,this.iconPositions=h,this.patternPositions=f}addImages(i,l,h){for(const f in i){const y=i[f],x={x:0,y:0,w:y.data.width+2,h:y.data.height+2};h.push(x),l[f]=new $p(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(i,l){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in i.updatedImages)this.patchUpdatedImage(this.iconPositions[h],i.getImage(h),l),this.patchUpdatedImage(this.patternPositions[h],i.getImage(h),l)}patchUpdatedImage(i,l,h){if(!i||!l||i.version===l.version)return;i.version=l.version;const[f,y]=i.tl;h.update(l.data,void 0,{x:f,y})}}Me("ImagePosition",$p),Me("ImageAtlas",cf);const Gs={horizontal:1,vertical:2,horizontalOnly:3};class Jh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,l){const h=new Jh;return h.scale=i||1,h.fontStack=l,h}static forImage(i){const l=new Jh;return l.imageName=i,l}}class dh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const h=new dh;for(let f=0;f<i.sections.length;f++){const y=i.sections[f];y.image?h.addImageSection(y):h.addTextSection(y,l)}return h}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(l,h){let f="";for(let y=0;y<l.length;y++){const x=l.charCodeAt(y+1)||null,E=l.charCodeAt(y-1)||null;f+=!h&&(x&&vu(x)&&!Xh[l[y+1]]||E&&vu(E)&&!Xh[l[y-1]])||!Xh[l[y]]?l[y]:Xh[l[y]]}return f}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&uf[this.text.charCodeAt(h)];h++)i++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&uf[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const h=new dh;return h.text=this.text.substring(i,l),h.sectionIndex=this.sectionIndex.slice(i,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(Jh.forText(i.scale,i.fontStack||l));const h=this.sections.length-1;for(let f=0;f<i.text.length;++f)this.sectionIndex.push(h)}addImageSection(i){const l=i.image?i.image.name:"";if(0===l.length)return void zt("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Jh.forImage(l)),this.sectionIndex.push(this.sections.length-1)):zt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Hp(s,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne){const ue=dh.fromFeature(s,f);let ye;F===Gs.vertical&&ue.verticalizePunctuation(z);const{processBidirectionalText:Ce,processStyledBidirectionalText:Ie}=X;if(Ce&&1===ue.sections.length){ye=[];const Oe=Ce(ue.toString(),Zp(ue,A,y,i,h,j,ee));for(const Ue of Oe){const Ye=new dh;Ye.text=Ue,Ye.sections=ue.sections;for(let nt=0;nt<Ue.length;nt++)Ye.sectionIndex.push(0);ye.push(Ye)}}else if(Ie){ye=[];const Oe=Ie(ue.text,ue.sectionIndex,Zp(ue,A,y,i,h,j,ee));for(const Ue of Oe){const Ye=new dh;Ye.text=Ue[0],Ye.sectionIndex=Ue[1],Ye.sections=ue.sections,ye.push(Ye)}}else ye=function(Oe,Ue){const Ye=[],nt=Oe.text;let rt=0;for(const qe of Ue)Ye.push(Oe.substring(rt,qe)),rt=qe;return rt<nt.length&&Ye.push(Oe.substring(rt,nt.length)),Ye}(ue,Zp(ue,A,y,i,h,j,ee));const Pe=[],ke={positionedLines:Pe,text:ue.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Oe,Ue,Ye,nt,rt,qe,Ke,ot,Xe,At,dt,Bn){let Pt=0,hn=0,bt=0;const Rt="right"===ot?1:"left"===ot?0:.5;let wn=!1;for(const Wn of rt){const Xn=Wn.getSections();for(const Lr of Xn){if(Lr.imageName)continue;const Fi=Ue[Lr.fontStack];if(Fi&&(wn=void 0!==Fi.ascender&&void 0!==Fi.descender,!wn))break}if(!wn)break}let yr=0;for(const Wn of rt){Wn.trim();const Xn=Wn.getMaxScale(),Lr=24*(Xn-1),Fi={positionedGlyphs:[],lineOffset:0};Oe.positionedLines[yr]=Fi;const Or=Fi.positionedGlyphs;let vr=0;if(!Wn.length()){hn+=qe,++yr;continue}let Kn=0,Ui=0;for(let di=0;di<Wn.length();di++){const ji=Wn.getSection(di),is=Wn.getSectionIndex(di),$i=Wn.getCharCode(di);let Hi=ji.scale,Tn=null,Fr=null,bs=null,qs=24,Ws=0;const il=!(Xe===Gs.horizontal||!dt&&!ba($i)||dt&&(uf[$i]||(Ai=$i,El(Ai)||no(Ai)||No(Ai)||mr(Ai)||Tl(Ai))));if(ji.imageName){const rl=nt[ji.imageName];if(!rl)continue;bs=ji.imageName,Oe.iconsInText=Oe.iconsInText||!0,Fr=rl.paddedRect;const To=rl.displaySize;Hi=24*Hi/Bn,Tn={width:To[0],height:To[1],left:1,top:-3,advance:il?To[1]:To[0],localGlyph:!1},Ws=wn?-Tn.height*Hi:24*Xn-17-To[1]*Hi,qs=Tn.advance;const Aa=(il?To[0]:To[1])*Hi-24*Xn;Aa>0&&Aa>vr&&(vr=Aa)}else{const rl=Ye[ji.fontStack];if(!rl)continue;rl[$i]&&(Fr=rl[$i]);const To=Ue[ji.fontStack];if(!To)continue;const Aa=To.glyphs[$i];if(!Aa)continue;if(Tn=Aa.metrics,qs=8203!==$i?24:0,wn){const Ou=void 0!==To.ascender?Math.abs(To.ascender):0,Xs=void 0!==To.descender?Math.abs(To.descender):0,ph=(Ou+Xs)*Hi;Kn<ph&&(Kn=ph,Ui=(Ou-Xs)/2*Hi),Ws=-Ou*Hi}else Ws=24*(Xn-Hi)-17}il?(Oe.verticalizable=!0,Or.push({glyph:$i,imageName:bs,x:Pt,y:hn+Ws,vertical:il,scale:Hi,localGlyph:Tn.localGlyph,fontStack:ji.fontStack,sectionIndex:is,metrics:Tn,rect:Fr}),Pt+=qs*Hi+At):(Or.push({glyph:$i,imageName:bs,x:Pt,y:hn+Ws,vertical:il,scale:Hi,localGlyph:Tn.localGlyph,fontStack:ji.fontStack,sectionIndex:is,metrics:Tn,rect:Fr}),Pt+=Tn.advance*Hi+At)}0!==Or.length&&(bt=Math.max(Pt-At,bt),wn?qp(Or,Rt,vr,Ui,qe*Xn/2):qp(Or,Rt,vr,0,qe/2)),Pt=0;const hi=qe*Xn+vr;Fi.lineOffset=Math.max(vr,Lr),hn+=hi,++yr}var Ai;const kr=hn,{horizontalAlign:Rr,verticalAlign:Ii}=ff(Ke);(function(Wn,Xn,Lr,Fi,Or,vr){const Kn=(Xn-Lr)*Or,Ui=-vr*Fi;for(const hi of Wn)for(const di of hi.positionedGlyphs)di.x+=Kn,di.y+=Ui})(Oe.positionedLines,Rt,Rr,Ii,bt,kr),Oe.top+=-Ii*kr,Oe.bottom=Oe.top+kr,Oe.left+=-Rr*bt,Oe.right=Oe.left+bt,Oe.hasBaseline=wn}(ke,i,l,h,ye,x,E,S,F,A,z,ne),!function(Oe){for(const Ue of Oe)if(0!==Ue.positionedGlyphs.length)return!1;return!0}(Pe)&&ke}const uf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Rv={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Gp(s,i,l,h,f,y){if(i.imageName){const x=h[i.imageName];return x?x.displaySize[0]*i.scale*24/y+f:0}{const x=l[i.fontStack],E=x&&x.glyphs[s];return E?E.metrics.advance*i.scale+f:0}}function hf(s,i,l,h){const f=Math.pow(s-i,2);return h?s<i?f/2:2*f:f+Math.abs(l)*l}function Vg(s,i,l){let h=0;return 10===s&&(h-=1e4),l&&(h+=150),40!==s&&65288!==s||(h+=50),41!==i&&65289!==i||(h+=50),h}function df(s,i,l,h,f,y){let x=null,E=hf(i,l,f,y);for(const S of h){const A=hf(i-S.x,l,f,y)+S.badness;A<=E&&(x=S,E=A)}return{index:s,x:i,priorBreak:x,badness:E}}function Ug(s){return s?Ug(s.priorBreak).concat(s.index):[]}function Zp(s,i,l,h,f,y,x){if("point"!==y)return[];if(!s)return[];const E=[],S=function(z,j,ee,ne,ue,ye){let Ce=0;for(let Ie=0;Ie<z.length();Ie++){const Pe=z.getSection(Ie);Ce+=Gp(z.getCharCode(Ie),Pe,ne,ue,j,ye)}return Ce/Math.max(1,Math.ceil(Ce/ee))}(s,i,l,h,f,x),A=s.text.indexOf("\u200b")>=0;let R=0;for(let z=0;z<s.length();z++){const j=s.getSection(z),ee=s.getCharCode(z);if(uf[ee]||(R+=Gp(ee,j,h,f,i,x)),z<s.length()-1){const ne=!((F=ee)<11904||!(xa(F)||xi(F)||Si(F)||kd(F)||Ka(F)||Yl(F)||_u(F)||va(F)||Ic(F)||Pc(F)||Xa(F)||Rc(F)||Jl(F)||Qu(F)||gu(F)||Ac(F)||Wa(F)||Ya(F)||yu(F)||kc(F)));(Rv[ee]||ne||j.imageName)&&E.push(df(z+1,R,S,E,Vg(ee,s.getCharCode(z+1),ne&&A),!1))}}var F;return Ug(df(s.length(),R,S,E,0,!0))}function ff(s){let i=.5,l=.5;switch(s){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function qp(s,i,l,h,f){if(!(i||l||h||f))return;const y=s.length-1,x=s[y],E=(x.x+x.metrics.advance*x.scale)*i;for(let S=0;S<=y;S++)s[S].x-=E,s[S].y+=l+h+f}function Pu(s,i,l){const{horizontalAlign:h,verticalAlign:f}=ff(l),y=i[0]-s.displaySize[0]*h,x=i[1]-s.displaySize[1]*f;return{image:s,top:x,bottom:x+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function Wp(s,i,l,h,f,y){const x=s.image;let E;if(x.content){const ue=x.content,ye=x.pixelRatio||1;E=[ue[0]/ye,ue[1]/ye,x.displaySize[0]-ue[2]/ye,x.displaySize[1]-ue[3]/ye]}const S=i.left*y,A=i.right*y;let R,F,z,j;"width"===l||"both"===l?(j=f[0]+S-h[3],F=f[0]+A+h[1]):(j=f[0]+(S+A-x.displaySize[0])/2,F=j+x.displaySize[0]);const ee=i.top*y,ne=i.bottom*y;return"height"===l||"both"===l?(R=f[1]+ee-h[0],z=f[1]+ne+h[2]):(R=f[1]+(ee+ne-x.displaySize[1])/2,z=R+x.displaySize[1]),{image:x,top:R,right:F,bottom:z,left:j,collisionPadding:E}}class ic extends Qe{constructor(i,l,h,f,y){super(i,l),this.angle=f,this.z=h,void 0!==y&&(this.segment=y)}clone(){return new ic(this.x,this.y,this.z,this.angle,this.segment)}}function jg(s,i,l,h,f){if(void 0===i.segment)return!0;let y=i,x=i.segment+1,E=0;for(;E>-l/2;){if(x--,x<0)return!1;E-=s[x].dist(y),y=s[x]}E+=s[x].dist(s[x+1]),x++;const S=[];let A=0;for(;E<l/2;){const R=s[x],F=s[x+1];if(!F)return!1;let z=s[x-1].angleTo(R)-R.angleTo(F);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:E,angleDelta:z}),A+=z;E-S[0].distance>h;)A-=S.shift().angleDelta;if(A>f)return!1;x++,E+=R.dist(F)}return!0}function Qh(s){let i=0;for(let l=0;l<s.length-1;l++)i+=s[l].dist(s[l+1]);return i}function $g(s,i,l){return s?.6*i*l:0}function Xp(s,i){return Math.max(s?s.right-s.left:0,i?i.right-i.left:0)}function Hg(s,i,l,h,f,y){const x=$g(l,f,y),E=Xp(l,h)*y;let S=0;const A=Qh(s)/2;for(let R=0;R<s.length-1;R++){const F=s[R],z=s[R+1],j=F.dist(z);if(S+j>A){const ee=(A-S)/j,ne=et(F.x,z.x,ee),ue=et(F.y,z.y,ee),ye=new ic(ne,ue,0,z.angleTo(F),R);return!x||jg(s,ye,E,x,i)?ye:void 0}S+=j}}function Gg(s,i,l,h,f,y,x,E,S){const A=$g(h,y,x),R=Xp(h,f),F=R*x,z=0===s[0].x||s[0].x===S||0===s[0].y||s[0].y===S;return i-F<i/4&&(i=F+i/4),pf(s,z?i/2*E%i:(R/2+2*y)*x*E%i,i,A,l,F,z,!1,S)}function pf(s,i,l,h,f,y,x,E,S){const A=y/2,R=Qh(s);let F=0,z=i-l,j=[];for(let ee=0;ee<s.length-1;ee++){const ne=s[ee],ue=s[ee+1],ye=ne.dist(ue),Ce=ue.angleTo(ne);for(;z+l<F+ye;){z+=l;const Ie=(z-F)/ye,Pe=et(ne.x,ue.x,Ie),ke=et(ne.y,ue.y,Ie);if(Pe>=0&&Pe<S&&ke>=0&&ke<S&&z-A>=0&&z+A<=R){const Oe=new ic(Pe,ke,0,Ce,ee);Oe._round(),h&&!jg(s,Oe,y,h,f)||j.push(Oe)}}F+=ye}return E||j.length||x||(j=pf(s,F/2,l,h,f,y,x,!0,S)),j}function Kp(s,i,l,h,f){const y=[];for(let x=0;x<s.length;x++){const E=s[x];let S;for(let A=0;A<E.length-1;A++){let R=E[A],F=E[A+1];R.x<i&&F.x<i||(R.x<i?R=new Qe(i,R.y+(i-R.x)/(F.x-R.x)*(F.y-R.y))._round():F.x<i&&(F=new Qe(i,R.y+(i-R.x)/(F.x-R.x)*(F.y-R.y))._round()),R.y<l&&F.y<l||(R.y<l?R=new Qe(R.x+(l-R.y)/(F.y-R.y)*(F.x-R.x),l)._round():F.y<l&&(F=new Qe(R.x+(l-R.y)/(F.y-R.y)*(F.x-R.x),l)._round()),R.x>=h&&F.x>=h||(R.x>=h?R=new Qe(h,R.y+(h-R.x)/(F.x-R.x)*(F.y-R.y))._round():F.x>=h&&(F=new Qe(h,R.y+(h-R.x)/(F.x-R.x)*(F.y-R.y))._round()),R.y>=f&&F.y>=f||(R.y>=f?R=new Qe(R.x+(f-R.y)/(F.y-R.y)*(F.x-R.x),f)._round():F.y>=f&&(F=new Qe(R.x+(f-R.y)/(F.y-R.y)*(F.x-R.x),f)._round()),S&&R.equals(S[S.length-1])||(S=[R],y.push(S)),S.push(F)))))}}return y}Me("Anchor",ic);const Zc=1e20;function ed(s,i,l,h,f,y,x,E,S){for(let A=i;A<i+h;A++)Yp(s,l*y+A,y,f,x,E,S);for(let A=l;A<l+f;A++)Yp(s,A*y+i,1,h,x,E,S)}function Yp(s,i,l,h,f,y,x){y[0]=0,x[0]=-Zc,x[1]=Zc,f[0]=s[i];for(let E=1,S=0,A=0;E<h;E++){f[E]=s[i+E*l];const R=E*E;do{const F=y[S];A=(f[E]-f[F]+R-F*F)/(E-F)/2}while(A<=x[S]&&--S>-1);S++,y[S]=E,x[S]=A,x[S+1]=Zc}for(let E=0,S=0;E<h;E++){for(;x[S+1]<E;)S++;const A=y[S],R=E-A;s[i+E*l]=f[A]+R*R}}const td={none:0,ideographs:1,all:2};class ku{constructor(i,l,h){this.requestManager=i,this.localGlyphMode=l,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,l){const h=[];for(const f in i)for(const y of i[f])h.push({stack:f,id:y});al(h,({stack:f,id:y},x)=>{let E=this.entries[f];E||(E=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=E.glyphs[y];if(void 0!==S)return void x(null,{stack:f,id:y,glyph:S});if(S=this._tinySDF(E,f,y),S)return E.glyphs[y]=S,void x(null,{stack:f,id:y,glyph:S});const A=Math.floor(y/256);if(256*A>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[A])return void x(null,{stack:f,id:y,glyph:S});let R=E.requests[A];R||(R=E.requests[A]=[],ku.loadGlyphRange(f,A,this.url,this.requestManager,(F,z)=>{if(z){E.ascender=z.ascender,E.descender=z.descender;for(const j in z.glyphs)this._doesCharSupportLocalGlyph(+j)||(E.glyphs[+j]=z.glyphs[+j]);E.ranges[A]=!0}for(const j of R)j(F,z);delete E.requests[A]})),R.push((F,z)=>{F?x(F):z&&x(null,{stack:f,id:y,glyph:z.glyphs[y]||null})})},(f,y)=>{if(f)l(f);else if(y){const x={};for(const{stack:E,id:S,glyph:A}of y)void 0===x[E]&&(x[E]={}),void 0===x[E].glyphs&&(x[E].glyphs={}),x[E].glyphs[S]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},x[E].ascender=this.entries[E].ascender,x[E].descender=this.entries[E].descender;l(null,x)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==td.none&&(this.localGlyphMode===td.all?!!this.localFontFamily:!!this.localFontFamily&&(Pc(i)||Ql(i)||Jl(i)||Wa(i))||va(i))}_tinySDF(i,l,h){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(h))return;let y=i.tinySDF;if(!y){let ne="400";/bold/i.test(l)?ne="900":/medium/i.test(l)?ne="500":/light/i.test(l)&&(ne="200"),y=i.tinySDF=new ku.TinySDF({fontFamily:f,fontWeight:ne,fontSize:48,buffer:6,radius:16}),y.fontWeight=ne}if(this.localGlyphs[y.fontWeight][h])return this.localGlyphs[y.fontWeight][h];const x=String.fromCharCode(h),{data:E,width:S,height:A,glyphWidth:R,glyphHeight:F,glyphLeft:z,glyphTop:j,glyphAdvance:ee}=y.draw(x);return this.localGlyphs[y.fontWeight][h]={id:h,bitmap:new Uc({width:S,height:A},E),metrics:{width:R/2,height:F/2,left:z/2,top:j/2-27,advance:ee/2,localGlyph:!0}}}}function mf(s,i,l,h){const f=[],y=s.image,x=y.pixelRatio,E=y.paddedRect.w-2,S=y.paddedRect.h-2,A=s.right-s.left,R=s.bottom-s.top,F=y.stretchX||[[0,E]],z=y.stretchY||[[0,S]],j=(qe,Ke)=>qe+Ke[1]-Ke[0],ee=F.reduce(j,0),ne=z.reduce(j,0),ue=E-ee,ye=S-ne;let Ce=0,Ie=ee,Pe=0,ke=ne,Oe=0,Ue=ue,Ye=0,nt=ye;if(y.content&&h){const qe=y.content;Ce=qc(F,0,qe[0]),Pe=qc(z,0,qe[1]),Ie=qc(F,qe[0],qe[2]),ke=qc(z,qe[1],qe[3]),Oe=qe[0]-Ce,Ye=qe[1]-Pe,Ue=qe[2]-qe[0]-Ie,nt=qe[3]-qe[1]-ke}const rt=(qe,Ke,ot,Xe)=>{const At=nd(qe.stretch-Ce,Ie,A,s.left),dt=gf(qe.fixed-Oe,Ue,qe.stretch,ee),Bn=nd(Ke.stretch-Pe,ke,R,s.top),Pt=gf(Ke.fixed-Ye,nt,Ke.stretch,ne),hn=nd(ot.stretch-Ce,Ie,A,s.left),bt=gf(ot.fixed-Oe,Ue,ot.stretch,ee),Rt=nd(Xe.stretch-Pe,ke,R,s.top),wn=gf(Xe.fixed-Ye,nt,Xe.stretch,ne),yr=new Qe(At,Bn),Ai=new Qe(hn,Bn),kr=new Qe(hn,Rt),Rr=new Qe(At,Rt),Ii=new Qe(dt/x,Pt/x),Wn=new Qe(bt/x,wn/x),Xn=i*Math.PI/180;if(Xn){const Or=Math.sin(Xn),vr=Math.cos(Xn),Kn=[vr,-Or,Or,vr];yr._matMult(Kn),Ai._matMult(Kn),Rr._matMult(Kn),kr._matMult(Kn)}const Lr=qe.stretch+qe.fixed,Fi=Ke.stretch+Ke.fixed;return{tl:yr,tr:Ai,bl:Rr,br:kr,tex:{x:y.paddedRect.x+1+Lr,y:y.paddedRect.y+1+Fi,w:ot.stretch+ot.fixed-Lr,h:Xe.stretch+Xe.fixed-Fi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ii,pixelOffsetBR:Wn,minFontScaleX:Ue/x/A,minFontScaleY:nt/x/R,isSDF:l}};if(h&&(y.stretchX||y.stretchY)){const qe=Zg(F,ue,ee),Ke=Zg(z,ye,ne);for(let ot=0;ot<qe.length-1;ot++){const Xe=qe[ot],At=qe[ot+1];for(let dt=0;dt<Ke.length-1;dt++)f.push(rt(Xe,Ke[dt],At,Ke[dt+1]))}}else f.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:S+1}));return f}function qc(s,i,l){let h=0;for(const f of s)h+=Math.max(i,Math.min(l,f[1]))-Math.max(i,Math.min(l,f[0]));return h}function Zg(s,i,l){const h=[{fixed:-1,stretch:0}];for(const[f,y]of s){const x=h[h.length-1];h.push({fixed:f-x.stretch,stretch:x.stretch}),h.push({fixed:f-x.stretch,stretch:x.stretch+(y-f)})}return h.push({fixed:i+1,stretch:l}),h}function nd(s,i,l,h){return s/i*l+h}function gf(s,i,l,h){return s-i*l/h}function Lv(s,i,l,h){const f=i+s.positionedLines[h].lineOffset;return 0===h?l+f/2:l+(f+(i+s.positionedLines[h-1].lineOffset))/2}ku.loadGlyphRange=function(s,i,l,h,f){const y=256*i,x=y+255,E=h.transformRequest(h.normalizeGlyphsURL(l).replace("{fontstack}",s).replace("{range}",`${y}-${x}`),Tr.Glyphs);$(E,(S,A)=>{if(S)f(S);else if(A){const R={},F=new ch(A).readFields(s1,{});for(const z of F.glyphs)R[z.id]=z;f(null,{glyphs:R,ascender:F.ascender,descender:F.descender})}})},ku.TinySDF=class{constructor({fontSize:s=24,buffer:i=3,radius:l=8,cutoff:h=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}){this.buffer=i,this.cutoff=h,this.radius=l;const E=this.size=s+4*i,S=this._createCanvas(E),A=this.ctx=S.getContext("2d",{willReadFrequently:!0});A.font=`${x} ${y} ${s}px ${f}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(s){const i=document.createElement("canvas");return i.width=i.height=s,i}draw(s){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(s),x=Math.floor(l),E=Math.min(this.size-this.buffer,Math.ceil(y-f)),S=Math.min(this.size-this.buffer,Math.ceil(l)+Math.ceil(h)),A=E+2*this.buffer,R=S+2*this.buffer,F=A*R,z=new Uint8ClampedArray(F),j={data:z,width:A,height:R,glyphWidth:E,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(0===E||0===S)return j;const{ctx:ee,buffer:ne,gridInner:ue,gridOuter:ye}=this;ee.clearRect(ne,ne,E,S),ee.fillText(s,ne,ne+x+1);const Ce=ee.getImageData(ne,ne,E,S);ye.fill(Zc,0,F),ue.fill(0,0,F);for(let Ie=0;Ie<S;Ie++)for(let Pe=0;Pe<E;Pe++){const ke=Ce.data[4*(Ie*E+Pe)+3]/255;if(0===ke)continue;const Oe=(Ie+ne)*A+Pe+ne;if(1===ke)ye[Oe]=0,ue[Oe]=Zc;else{const Ue=.5-ke;ye[Oe]=Ue>0?Ue*Ue:0,ue[Oe]=Ue<0?Ue*Ue:0}}ed(ye,0,0,A,R,A,this.f,this.v,this.z),ed(ue,ne,ne,E,S,A,this.f,this.v,this.z);for(let Ie=0;Ie<F;Ie++){const Pe=Math.sqrt(ye[Ie])-Math.sqrt(ue[Ie]);z[Ie]=Math.round(255-255*(Pe/this.radius+this.cutoff))}return j}};class qg{constructor(i=[],l=Jp){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const i=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:h}=this,f=l[i];for(;i>0;){const y=i-1>>1,x=l[y];if(h(f,x)>=0)break;l[i]=x,i=y}l[i]=f}_down(i){const{data:l,compare:h}=this,f=this.length>>1,y=l[i];for(;i<f;){let x=1+(i<<1),E=l[x];const S=x+1;if(S<this.length&&h(l[S],E)<0&&(x=S,E=l[S]),h(E,y)>=0)break;l[i]=E,i=x}l[i]=y}}function Jp(s,i){return s<i?-1:s>i?1:0}function Wg(s,i=1,l=!1){let h=1/0,f=1/0,y=-1/0,x=-1/0;const E=s[0];for(let j=0;j<E.length;j++){const ee=E[j];(!j||ee.x<h)&&(h=ee.x),(!j||ee.y<f)&&(f=ee.y),(!j||ee.x>y)&&(y=ee.x),(!j||ee.y>x)&&(x=ee.y)}const S=Math.min(y-h,x-f);let A=S/2;const R=new qg([],a1);if(0===S)return new Qe(h,f);for(let j=h;j<y;j+=S)for(let ee=f;ee<x;ee+=S)R.push(new Ru(j+A,ee+A,A,s));let F=function(j){let ee=0,ne=0,ue=0;const ye=j[0];for(let Ce=0,Ie=ye.length,Pe=Ie-1;Ce<Ie;Pe=Ce++){const ke=ye[Ce],Oe=ye[Pe],Ue=ke.x*Oe.y-Oe.x*ke.y;ne+=(ke.x+Oe.x)*Ue,ue+=(ke.y+Oe.y)*Ue,ee+=3*Ue}return new Ru(ne/ee,ue/ee,0,j)}(s),z=R.length;for(;R.length;){const j=R.pop();(j.d>F.d||!F.d)&&(F=j,l&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,z)),j.max-F.d<=i||(A=j.h/2,R.push(new Ru(j.p.x-A,j.p.y-A,A,s)),R.push(new Ru(j.p.x+A,j.p.y-A,A,s)),R.push(new Ru(j.p.x-A,j.p.y+A,A,s)),R.push(new Ru(j.p.x+A,j.p.y+A,A,s)),z+=4)}return l&&(console.log(`num probes: ${z}`),console.log(`best distance: ${F.d}`)),F.p}function a1(s,i){return i.max-s.max}function Ru(s,i,l,h){this.p=new Qe(s,i),this.h=l,this.d=function(f,y){let x=!1,E=1/0;for(let S=0;S<y.length;S++){const A=y[S];for(let R=0,F=A.length,z=F-1;R<F;z=R++){const j=A[R],ee=A[z];j.y>f.y!=ee.y>f.y&&f.x<(ee.x-j.x)*(f.y-j.y)/(ee.y-j.y)+j.x&&(x=!x),E=Math.min(E,yp(f,j,ee))}}return(x?1:-1)*Math.sqrt(E)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Qp=Number.POSITIVE_INFINITY,Xg=Math.sqrt(2);function Kg(s,i){return i[1]!==Qp?function(l,h,f){let y=0,x=0;switch(h=Math.abs(h),f=Math.abs(f),l){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(l){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,x]}(s,i[0],i[1]):function(l,h){let f=0,y=0;h<0&&(h=0);const x=h/Xg;switch(l){case"top-right":case"top-left":y=x-7;break;case"bottom-right":case"bottom-left":y=7-x;break;case"bottom":y=7-h;break;case"top":y=h-7}switch(l){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=h;break;case"right":f=-h}return[f,y]}(s,i[0])}function Ov(s,i,l,h,f,y,x,E){s.createArrays(),s.tilePixelRatio=qn/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const S=s.layers[0].layout,A=s.layers[0]._unevaluatedLayout._values,R={};if("composite"===s.textSizeData.kind){const{minZoom:j,maxZoom:ee}=s.textSizeData;R.compositeTextSizes=[A["text-size"].possiblyEvaluate(new Y(j),x),A["text-size"].possiblyEvaluate(new Y(ee),x)]}if("composite"===s.iconSizeData.kind){const{minZoom:j,maxZoom:ee}=s.iconSizeData;R.compositeIconSizes=[A["icon-size"].possiblyEvaluate(new Y(j),x),A["icon-size"].possiblyEvaluate(new Y(ee),x)]}R.layoutTextSize=A["text-size"].possiblyEvaluate(new Y(E+1),x),R.layoutIconSize=A["icon-size"].possiblyEvaluate(new Y(E+1),x),R.textMaxSize=A["text-size"].possiblyEvaluate(new Y(18),x);const F="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),z=S.get("text-size");for(const j of s.features){const ee=S.get("text-font").evaluate(j,{},x).join(","),ne=z.evaluate(j,{},x),ue=R.layoutTextSize.evaluate(j,{},x),ye=(R.layoutIconSize.evaluate(j,{},x),{horizontal:{},vertical:void 0}),Ce=j.text;let Ie,Pe=[0,0];if(Ce){const Ue=Ce.toString(),Ye=24*S.get("text-letter-spacing").evaluate(j,{},x),nt=24*S.get("text-line-height").evaluate(j,{},x),rt=fp(Ue)?Ye:0,qe=S.get("text-anchor").evaluate(j,{},x),Ke=S.get("text-variable-anchor");if(!Ke){const Pt=S.get("text-radial-offset").evaluate(j,{},x);Pe=Pt?Kg(qe,[24*Pt,Qp]):S.get("text-offset").evaluate(j,{},x).map(hn=>24*hn)}let ot=F?"center":S.get("text-justify").evaluate(j,{},x);const Xe=S.get("symbol-placement"),At="point"===Xe,dt="point"===Xe?24*S.get("text-max-width").evaluate(j,{},x):0,Bn=Pt=>{s.allowVerticalPlacement&&ec(Ue)&&(ye.vertical=Hp(Ce,i,l,f,ee,dt,nt,qe,Pt,rt,Pe,Gs.vertical,!0,Xe,ue,ne))};if(!F&&Ke){const Pt="auto"===ot?Ke.map(bt=>Zs(bt)):[ot];let hn=!1;for(let bt=0;bt<Pt.length;bt++){const Rt=Pt[bt];if(!ye.horizontal[Rt])if(hn)ye.horizontal[Rt]=ye.horizontal[0];else{const wn=Hp(Ce,i,l,f,ee,dt,nt,"center",Rt,rt,Pe,Gs.horizontal,!1,Xe,ue,ne);wn&&(ye.horizontal[Rt]=wn,hn=1===wn.positionedLines.length)}}Bn("left")}else{if("auto"===ot&&(ot=Zs(qe)),At||S.get("text-writing-mode").indexOf("horizontal")>=0||!ec(Ue)){const Pt=Hp(Ce,i,l,f,ee,dt,nt,qe,ot,rt,Pe,Gs.horizontal,!1,Xe,ue,ne);Pt&&(ye.horizontal[ot]=Pt)}Bn("point"===Xe?"left":ot)}}let ke=!1;if(j.icon&&j.icon.name){const Ue=h[j.icon.name];Ue&&(Ie=Pu(f[j.icon.name],S.get("icon-offset").evaluate(j,{},x),S.get("icon-anchor").evaluate(j,{},x)),ke=Ue.sdf,void 0===s.sdfIcons?s.sdfIcons=Ue.sdf:s.sdfIcons!==Ue.sdf&&zt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ue.pixelRatio!==s.pixelRatio||0!==S.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}const Oe=Jg(ye.horizontal)||ye.vertical;s.iconsInText||(s.iconsInText=!!Oe&&Oe.iconsInText),(Oe||Ie)&&Fv(s,j,ye,Ie,h,R,ue,0,Pe,ke,x)}y&&s.generateCollisionDebugBuffers(E,s.collisionBoxArray)}function Zs(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Fv(s,i,l,h,f,y,x,E,S,A,R){let F=y.textMaxSize.evaluate(i,{},R);void 0===F&&(F=x);const z=s.layers[0].layout,j=z.get("icon-offset").evaluate(i,{},R),ee=Jg(l.horizontal)||l.vertical,ne=x/24,ue=s.tilePixelRatio*F/24,ye=s.tilePixelRatio*z.get("symbol-spacing"),Ce=z.get("text-padding")*s.tilePixelRatio,Ie=z.get("icon-padding")*s.tilePixelRatio,Pe=In(z.get("text-max-angle")),ke="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),Oe="map"===z.get("icon-rotation-alignment")&&"point"!==z.get("symbol-placement"),Ue=z.get("symbol-placement"),Ye=ye/2,nt=z.get("icon-text-fit");let rt;h&&"none"!==nt&&(s.allowVerticalPlacement&&l.vertical&&(rt=Wp(h,l.vertical,nt,z.get("icon-text-fit-padding"),j,ne)),ee&&(h=Wp(h,ee,nt,z.get("icon-text-fit-padding"),j,ne)));const qe=(Ke,ot)=>{ot.x<0||ot.x>=qn||ot.y<0||ot.y>=qn||function(Xe,At,dt,Bn,Pt,hn,bt,Rt,wn,yr,Ai,kr,Rr,Ii,Wn,Xn,Lr,Fi,Or,vr,Kn,Ui,hi,di){const ji=Xe.addToLineVertexArray(At,Bn);let is,$i,Hi,Tn,Fr,bs,qs,Ws=0,il=0,rl=0,To=0,Aa=-1,Ou=-1;const Xs={};let ph=Nd(""),Jc=0,Af=0;if(void 0===wn._unevaluatedLayout.getValue("text-radial-offset")?[Jc,Af]=wn.layout.get("text-offset").evaluate(Kn,{},di).map(ws=>24*ws):(Jc=24*wn.layout.get("text-radial-offset").evaluate(Kn,{},di),Af=Qp),Xe.allowVerticalPlacement&&Pt.vertical){const ws=Pt.vertical;if(Wn)bs=em(ws),Rt&&(qs=em(Rt));else{const Cs=wn.layout.get("text-rotate").evaluate(Kn,{},di)+90;Hi=_f(yr,dt,At,Ai,kr,Rr,ws,Ii,Cs,Xn),Rt&&(Tn=_f(yr,dt,At,Ai,kr,Rr,Rt,Fi,Cs))}}if(hn){const ws=wn.layout.get("icon-rotate").evaluate(Kn,{},di),Cs="none"!==wn.layout.get("icon-text-fit"),hd=mf(hn,ws,hi,Cs),gm=Rt?mf(Rt,ws,hi,Cs):void 0;$i=_f(yr,dt,At,Ai,kr,Rr,hn,Fi,ws),Ws=4*hd.length;const Zv=Xe.iconSizeData;let Fu=null;"source"===Zv.kind?(Fu=[Sl*wn.layout.get("icon-size").evaluate(Kn,{},di)],Fu[0]>rc&&zt(`${Xe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Zv.kind&&(Fu=[Sl*Ui.compositeIconSizes[0].evaluate(Kn,{},di),Sl*Ui.compositeIconSizes[1].evaluate(Kn,{},di)],(Fu[0]>rc||Fu[1]>rc)&&zt(`${Xe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Xe.addSymbols(Xe.icon,hd,Fu,vr,Or,Kn,!1,dt,At,ji.lineStartIndex,ji.lineLength,-1,di),Aa=Xe.icon.placedSymbolArray.length-1,gm&&(il=4*gm.length,Xe.addSymbols(Xe.icon,gm,Fu,vr,Or,Kn,Gs.vertical,dt,At,ji.lineStartIndex,ji.lineLength,-1,di),Ou=Xe.icon.placedSymbolArray.length-1)}for(const ws in Pt.horizontal){const Cs=Pt.horizontal[ws];is||(ph=Nd(Cs.text),Wn?Fr=em(Cs):is=_f(yr,dt,At,Ai,kr,Rr,Cs,Ii,wn.layout.get("text-rotate").evaluate(Kn,{},di),Xn));const hd=1===Cs.positionedLines.length;if(rl+=Yg(Xe,dt,At,Cs,bt,wn,Wn,Kn,Xn,ji,Pt.vertical?Gs.horizontal:Gs.horizontalOnly,hd?Object.keys(Pt.horizontal):[ws],Xs,Aa,Ui,di),hd)break}Pt.vertical&&(To+=Yg(Xe,dt,At,Pt.vertical,bt,wn,Wn,Kn,Xn,ji,Gs.vertical,["vertical"],Xs,Ou,Ui,di));let Qc=-1;const mm=(ws,Cs)=>ws?Math.max(ws,Cs):Cs;Qc=mm(Fr,Qc),Qc=mm(bs,Qc),Qc=mm(qs,Qc);const mh=Qc>-1?1:0;Xe.glyphOffsetArray.length>=ao.MAX_GLYPHS&&zt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Kn.sortKey&&Xe.addToSortKeyRanges(Xe.symbolInstances.length,Kn.sortKey),Xe.symbolInstances.emplaceBack(dt.x,dt.y,dt.z,At.x,At.y,Xs.right>=0?Xs.right:-1,Xs.center>=0?Xs.center:-1,Xs.left>=0?Xs.left:-1,Xs.vertical>=0?Xs.vertical:-1,Aa,Ou,ph,void 0!==is?is:Xe.collisionBoxArray.length,void 0!==is?is+1:Xe.collisionBoxArray.length,void 0!==Hi?Hi:Xe.collisionBoxArray.length,void 0!==Hi?Hi+1:Xe.collisionBoxArray.length,void 0!==$i?$i:Xe.collisionBoxArray.length,void 0!==$i?$i+1:Xe.collisionBoxArray.length,Tn||Xe.collisionBoxArray.length,Tn?Tn+1:Xe.collisionBoxArray.length,Ai,rl,To,Ws,il,mh,0,Jc,Af,Qc)}(s,ot,ot,Ke,l,h,f,rt,s.layers[0],s.collisionBoxArray,i.index,i.sourceLayerIndex,s.index,Ce,ke,S,0,Ie,Oe,j,i,y,A,R)};if("line"===Ue)for(const Ke of Kp(i.geometry,0,0,qn,qn)){const ot=Gg(Ke,ye,Pe,l.vertical||ee,h,24,ue,s.overscaling,qn);for(const Xe of ot){const At=ee;At&&Qg(s,At.text,Ye,Xe)||qe(Ke,Xe)}}else if("line-center"===Ue){for(const Ke of i.geometry)if(Ke.length>1){const ot=Hg(Ke,Pe,l.vertical||ee,h,24,ue);ot&&qe(Ke,ot)}}else if("Polygon"===i.type)for(const Ke of Sp(i.geometry,0)){const ot=Wg(Ke,16);qe(Ke[0],new ic(ot.x,ot.y,0,0,void 0))}else if("LineString"===i.type)for(const Ke of i.geometry)qe(Ke,new ic(Ke[0].x,Ke[0].y,0,0,void 0));else if("Point"===i.type)for(const Ke of i.geometry)for(const ot of Ke)qe([ot],new ic(ot.x,ot.y,0,0,void 0))}const rc=32640;function Yg(s,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne){const ue=function(Ie,Pe,ke,Oe,Ue,Ye,nt,rt){const qe=[];if(0===Pe.positionedLines.length)return qe;const Ke=Oe.layout.get("text-rotate").evaluate(Ye,{})*Math.PI/180,ot=function(Pt){const hn=Pt[0],bt=Pt[1],Rt=hn*bt;return Rt>0?[hn,-bt]:Rt<0?[-hn,bt]:0===hn?[bt,hn]:[bt,-hn]}(ke);let Xe=Math.abs(Pe.top-Pe.bottom);for(const Pt of Pe.positionedLines)Xe-=Pt.lineOffset;const At=Pe.positionedLines.length,dt=Xe/At;let Bn=Pe.top-ke[1];for(let Pt=0;Pt<At;++Pt){const hn=Pe.positionedLines[Pt];Bn=Lv(Pe,dt,Bn,Pt);for(const bt of hn.positionedGlyphs){if(!bt.rect)continue;const Rt=bt.rect||{};let wn=4,yr=!0,Ai=1,kr=0;if(bt.imageName){const Tn=nt[bt.imageName];if(!Tn)continue;if(Tn.sdf){zt("SDF images are not supported in formatted text and will be ignored.");continue}yr=!1,Ai=Tn.pixelRatio,wn=1/Ai}const Rr=(Ue||rt)&&bt.vertical,Ii=bt.metrics.advance*bt.scale/2,Wn=bt.metrics,Xn=bt.rect;if(null===Xn)continue;rt&&Pe.verticalizable&&(kr=bt.imageName?Ii-bt.metrics.width*bt.scale/2:0);const Lr=Ue?[bt.x+Ii,bt.y]:[0,0];let Fi=[0,0],Or=[0,0],vr=!1;Ue||(Rr?(Or=[bt.x+Ii+ot[0],bt.y+ot[1]-kr],vr=!0):Fi=[bt.x+Ii+ke[0],bt.y+ke[1]-kr]);const Kn=Xn.w*bt.scale/(Ai*(bt.localGlyph?2:1)),Ui=Xn.h*bt.scale/(Ai*(bt.localGlyph?2:1));let hi,di,ji,is;if(Rr){const Tn=bt.y-Bn,Fr=new Qe(-Ii,Ii-Tn),bs=-Math.PI/2,qs=new Qe(...Or);hi=new Qe(-Ii+Fi[0],Fi[1]),hi._rotateAround(bs,Fr)._add(qs),hi.x+=-Tn+Ii,hi.y-=(Wn.left-wn)*bt.scale;const Ws=bt.imageName?Wn.advance*bt.scale:24*bt.scale,il=String.fromCharCode(bt.glyph);Iv(il)?hi.x+=(1-wn)*bt.scale:Fg(il)?hi.x+=Ws-Wn.height*bt.scale+(-wn-1)*bt.scale:hi.x+=bt.imageName||Wn.width+2*wn===Xn.w&&Wn.height+2*wn===Xn.h?(Ws-Ui)/2:(Ws-(Wn.height+2*wn)*bt.scale)/2,di=new Qe(hi.x,hi.y-Kn),ji=new Qe(hi.x+Ui,hi.y),is=new Qe(hi.x+Ui,hi.y-Kn)}else{const Tn=(Wn.left-wn)*bt.scale-Ii+Fi[0],Fr=(-Wn.top-wn)*bt.scale+Fi[1],bs=Tn+Kn,qs=Fr+Ui;hi=new Qe(Tn,Fr),di=new Qe(bs,Fr),ji=new Qe(Tn,qs),is=new Qe(bs,qs)}if(Ke){let Tn;Tn=Ue?new Qe(0,0):vr?new Qe(ot[0],ot[1]):new Qe(ke[0],ke[1]),hi._rotateAround(Ke,Tn),di._rotateAround(Ke,Tn),ji._rotateAround(Ke,Tn),is._rotateAround(Ke,Tn)}const $i=new Qe(0,0),Hi=new Qe(0,0);qe.push({tl:hi,tr:di,bl:ji,br:is,tex:Rt,writingMode:Pe.writingMode,glyphOffset:Lr,sectionIndex:bt.sectionIndex,isSDF:yr,pixelOffsetTL:$i,pixelOffsetBR:Hi,minFontScaleX:0,minFontScaleY:0})}}return qe}(0,h,S,y,x,E,f,s.allowVerticalPlacement),ye=s.textSizeData;let Ce=null;"source"===ye.kind?(Ce=[Sl*y.layout.get("text-size").evaluate(E,{},ne)],Ce[0]>rc&&zt(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ye.kind&&(Ce=[Sl*ee.compositeTextSizes[0].evaluate(E,{},ne),Sl*ee.compositeTextSizes[1].evaluate(E,{},ne)],(Ce[0]>rc||Ce[1]>rc)&&zt(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,ue,Ce,S,x,E,R,i,l,A.lineStartIndex,A.lineLength,j,ne);for(const Ie of F)z[Ie]=s.text.placedSymbolArray.length-1;return 4*ue.length}function Jg(s){for(const i in s)return s[i];return null}function _f(s,i,l,h,f,y,x,E,S,A){let R=x.top,F=x.bottom,z=x.left,j=x.right;const ee=x.collisionPadding;if(ee&&(z-=ee[0],R-=ee[1],j+=ee[2],F+=ee[3]),S){const ne=new Qe(z,R),ue=new Qe(j,R),ye=new Qe(z,F),Ce=new Qe(j,F),Ie=In(S);let Pe=new Qe(0,0);A&&(Pe=new Qe(A[0],A[1])),ne._rotateAround(Ie,Pe),ue._rotateAround(Ie,Pe),ye._rotateAround(Ie,Pe),Ce._rotateAround(Ie,Pe),z=Math.min(ne.x,ue.x,ye.x,Ce.x),j=Math.max(ne.x,ue.x,ye.x,Ce.x),R=Math.min(ne.y,ue.y,ye.y,Ce.y),F=Math.max(ne.y,ue.y,ye.y,Ce.y)}return s.emplaceBack(i.x,i.y,i.z,l.x,l.y,z,R,j,F,E,h,f,y),s.length-1}function em(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const i=s.bottom-s.top;return i>0?Math.max(10,i):null}function Qg(s,i,l,h){const f=s.compareText;if(i in f){const y=f[i];for(let x=y.length-1;x>=0;x--)if(h.dist(y[x])<l)return!0}else f[i]=[];return f[i].push(h),!1}const Nv=el.VectorTileFeature.types,zv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yf(s,i,l,h,f,y,x,E,S,A,R,F,z,j,ee,ne){const ue=R?Math.min(rc,Math.round(R[0])):0,ye=R?Math.min(rc,Math.round(R[1])):0;s.emplaceBack(i,l,Math.round(32*x),Math.round(32*E),S,A,(ue<<1)+(F?1:0),ye,16*z,16*j,256*ee,256*ne,h,f,y,0)}function Xt(s,i,l){s.emplaceBack(i.x,i.y,l),s.emplaceBack(i.x,i.y,l),s.emplaceBack(i.x,i.y,l),s.emplaceBack(i.x,i.y,l)}function oi(s){for(const i of s.sections)if(m(i.text))return!0;return!1}class vf{constructor(i){this.layoutVertexArray=new Co,this.indexArray=new pn,this.programConfigurations=i,this.segments=new Pr,this.dynamicLayoutVertexArray=new Zt,this.opacityVertexArray=new zo,this.placedSymbolArray=new Yt}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,l,h,f){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Lg.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,sf.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,zv,!0),this.opacityVertexBuffer.itemSize=1),(h||f)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Me("SymbolBuffers",vf);class fh{constructor(i,l,h){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new h,this.segments=new Pr,this.collisionVertexArray=new Bo,this.collisionVertexArrayExt=new Zt}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Sv.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,Mv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Me("CollisionBuffers",fh);class ao{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gd([]),this.placementViewportMatrix=Gd([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Op(this.zoom,l["text-size"]),this.iconSizeData=Op(this.zoom,l["icon-size"]);const h=this.layers[0].layout,f=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(x=>Gs[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID}createArrays(){this.text=new vf(new Ca(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new vf(new Ca(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new $y,this.lineVertexArray=new Hy,this.symbolInstances=new pp}calculateGlyphDependencies(i,l,h,f,y){for(let x=0;x<i.length;x++)if(l[i.charCodeAt(x)]=!0,f&&y){const E=Xh[i.charAt(x)];E&&(l[E.charCodeAt(0)]=!0)}}populate(i,l,h){const f=this.layers[0],y=f.layout,x=y.get("text-font"),E=y.get("text-field"),S=y.get("icon-image"),A=("constant"!==E.value.kind||E.value.value instanceof cn&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),R="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,F=y.get("symbol-sort-key");if(this.features=[],!A&&!R)return;const z=l.iconDependencies,j=l.glyphDependencies,ee=l.availableImages,ne=new Y(this.zoom);for(const{feature:ue,id:ye,index:Ce,sourceLayerIndex:Ie}of i){const Pe=f._featureFilter.needGeometry,ke=Cu(ue,Pe);if(!f._featureFilter.filter(ne,ke,h))continue;let Oe,Ue;if(Pe||(ke.geometry=Ea(ue)),A){const nt=f.getValueAndResolveTokens("text-field",ke,h,ee),rt=cn.factory(nt);oi(rt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===U()||this.hasRTLText&&X.isParsed())&&(Oe=Og(rt,f,ke))}if(R){const nt=f.getValueAndResolveTokens("icon-image",ke,h,ee);Ue=nt instanceof Ni?nt:Ni.fromString(nt)}if(!Oe&&!Ue)continue;const Ye=this.sortFeaturesByKey?F.evaluate(ke,{},h):void 0;if(this.features.push({id:ye,text:Oe,icon:Ue,index:Ce,sourceLayerIndex:Ie,geometry:ke.geometry,properties:ue.properties,type:Nv[ue.type],sortKey:Ye}),Ue&&(z[Ue.name]=!0),Oe){const nt=x.evaluate(ke,{},h).join(","),rt="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Gs.vertical)>=0;for(const qe of Oe.sections)if(qe.image)z[qe.image.name]=!0;else{const Ke=ec(Oe.toString()),ot=qe.fontStack||nt,Xe=j[ot]=j[ot]||{};this.calculateGlyphDependencies(qe.text,Xe,rt,this.allowVerticalPlacement,Ke)}}}"line"===y.get("symbol-placement")&&(this.features=function(ue){const ye={},Ce={},Ie=[];let Pe=0;function ke(nt){Ie.push(ue[nt]),Pe++}function Oe(nt,rt,qe){const Ke=Ce[nt];return delete Ce[nt],Ce[rt]=Ke,Ie[Ke].geometry[0].pop(),Ie[Ke].geometry[0]=Ie[Ke].geometry[0].concat(qe[0]),Ke}function Ue(nt,rt,qe){const Ke=ye[rt];return delete ye[rt],ye[nt]=Ke,Ie[Ke].geometry[0].shift(),Ie[Ke].geometry[0]=qe[0].concat(Ie[Ke].geometry[0]),Ke}function Ye(nt,rt,qe){const Ke=qe?rt[0][rt[0].length-1]:rt[0][0];return`${nt}:${Ke.x}:${Ke.y}`}for(let nt=0;nt<ue.length;nt++){const rt=ue[nt],qe=rt.geometry,Ke=rt.text?rt.text.toString():null;if(!Ke){ke(nt);continue}const ot=Ye(Ke,qe),Xe=Ye(Ke,qe,!0);if(ot in Ce&&Xe in ye&&Ce[ot]!==ye[Xe]){const At=Ue(ot,Xe,qe),dt=Oe(ot,Xe,Ie[At].geometry);delete ye[ot],delete Ce[Xe],Ce[Ye(Ke,Ie[dt].geometry,!0)]=dt,Ie[At].geometry=null}else ot in Ce?Oe(ot,Xe,qe):Xe in ye?Ue(ot,Xe,qe):(ke(nt),ye[ot]=Pe-1,Ce[Xe]=Pe-1)}return Ie.filter(nt=>nt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,ye)=>ue.sortKey-ye.sortKey)}update(i,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,h),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const h=this.lineVertexArray.length;if(void 0!==i.segment){let f=i.dist(l[i.segment+1]),y=i.dist(l[i.segment]);const x={};for(let E=i.segment+1;E<l.length;E++)x[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:f},E<l.length-1&&(f+=l[E+1].dist(l[E]));for(let E=i.segment||0;E>=0;E--)x[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:y},E>0&&(y+=l[E-1].dist(l[E]));for(let E=0;E<l.length;E++){const S=x[E];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,l,h,f,y,x,E,S,A,R,F,z,j){const ee=i.indexArray,ne=i.layoutVertexArray,ue=i.segments.prepareSegment(4*l.length,ne,ee,this.canOverlap?x.sortKey:void 0),ye=this.glyphOffsetArray.length,Ce=ue.vertexLength,Ie=this.allowVerticalPlacement&&E===Gs.vertical?Math.PI/2:0,Pe=x.text&&x.text.sections;for(let ke=0;ke<l.length;ke++){const{tl:Oe,tr:Ue,bl:Ye,br:nt,tex:rt,pixelOffsetTL:qe,pixelOffsetBR:Ke,minFontScaleX:ot,minFontScaleY:Xe,glyphOffset:At,isSDF:dt,sectionIndex:Bn}=l[ke],Pt=ue.vertexLength,hn=At[1];yf(ne,S.x,S.y,S.z,A.x,A.y,Oe.x,hn+Oe.y,rt.x,rt.y,h,dt,qe.x,qe.y,ot,Xe),yf(ne,S.x,S.y,S.z,A.x,A.y,Ue.x,hn+Ue.y,rt.x+rt.w,rt.y,h,dt,Ke.x,qe.y,ot,Xe),yf(ne,S.x,S.y,S.z,A.x,A.y,Ye.x,hn+Ye.y,rt.x,rt.y+rt.h,h,dt,qe.x,Ke.y,ot,Xe),yf(ne,S.x,S.y,S.z,A.x,A.y,nt.x,hn+nt.y,rt.x+rt.w,rt.y+rt.h,h,dt,Ke.x,Ke.y,ot,Xe),Xt(i.dynamicLayoutVertexArray,S,Ie),ee.emplaceBack(Pt,Pt+1,Pt+2),ee.emplaceBack(Pt+1,Pt+2,Pt+3),ue.vertexLength+=4,ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),ke!==l.length-1&&Bn===l[ke+1].sectionIndex||i.programConfigurations.populatePaintArrays(ne.length,x,x.index,{},j,Pe&&Pe[Bn])}i.placedSymbolArray.emplaceBack(S.x,S.y,S.z,A.x,A.y,ye,this.glyphOffsetArray.length-ye,Ce,R,F,A.segment,h?h[0]:0,h?h[1]:0,f[0],f[1],E,0,!1,0,z,0)}_commitLayoutVertex(i,l,h,f,y,x,E){i.emplaceBack(l,h,f,y,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(i,l,h,f,y,x,E){const S=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),A=S.vertexLength,R=E.tileAnchorX,F=E.tileAnchorY;for(let j=0;j<4;j++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(l,-i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(l,i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(l,i.padding,i.padding),h.collisionVertexArrayExt.emplaceBack(l,-i.padding,i.padding),this._commitLayoutVertex(h.layoutVertexArray,f,y,x,R,F,new Qe(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,y,x,R,F,new Qe(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,y,x,R,F,new Qe(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,f,y,x,R,F,new Qe(i.x1,i.y2)),S.vertexLength+=4;const z=h.indexArray;z.emplaceBack(A,A+1),z.emplaceBack(A+1,A+2),z.emplaceBack(A+2,A+3),z.emplaceBack(A+3,A),S.primitiveLength+=4}_addTextDebugCollisionBoxes(i,l,h,f,y,x){for(let E=f;E<y;E++){const S=h.get(E),A=this.getSymbolInstanceTextSize(i,x,l,E);this._addCollisionDebugVertices(S,A,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(i,l,h,f,y,x){for(let E=f;E<y;E++){const S=h.get(E),A=this.getSymbolInstanceIconSize(i,l,E);this._addCollisionDebugVertices(S,A,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,x)}}generateCollisionDebugBuffers(i,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fh(Eo,$c.members,Ki),this.iconCollisionBox=new fh(Eo,$c.members,Ki);const h=nc(this.iconSizeData,i),f=nc(this.textSizeData,i);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(f,i,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(f,i,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(i,l,h,f){const y=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:f),x=af(this.textSizeData,i,y)/24;return this.tilePixelRatio*x}getSymbolInstanceIconSize(i,l,h){const f=this.icon.placedSymbolArray.get(h),y=af(this.iconSizeData,i,f);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(i,l,h){i.emplaceBack(l,-h,-h),i.emplaceBack(l,h,-h),i.emplaceBack(l,h,h),i.emplaceBack(l,-h,h)}_updateTextDebugCollisionBoxes(i,l,h,f,y,x){for(let E=f;E<y;E++){const S=h.get(E),A=this.getSymbolInstanceTextSize(i,x,l,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,S.padding)}}_updateIconDebugCollisionBoxes(i,l,h,f,y){for(let x=f;x<y;x++){const E=h.get(x),S=this.getSymbolInstanceIconSize(i,l,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,E.padding)}}updateCollisionDebugBuffers(i,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=nc(this.iconSizeData,i),f=nc(this.textSizeData,i);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(f,i,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(f,i,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(h,i,l,x.iconBoxStartIndex,x.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(h,i,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,l,h,f,y,x,E,S,A){const R={};for(let F=l;F<h;F++){const z=i.get(F);R.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},R.textFeatureIndex=z.featureIndex;break}for(let F=f;F<y;F++){const z=i.get(F);R.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},R.verticalTextFeatureIndex=z.featureIndex;break}for(let F=x;F<E;F++){const z=i.get(F);R.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},R.iconFeatureIndex=z.featureIndex;break}for(let F=S;F<A;F++){const z=i.get(F);R.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},R.verticalIconFeatureIndex=z.featureIndex;break}return R}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,l){const h=i.placedSymbolArray.get(l),f=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<f;y+=4)i.indexArray.emplaceBack(y,y+1,y+2),i.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(i),h=Math.cos(i),f=[],y=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const S=this.symbolInstances.get(E);f.push(0|Math.round(l*S.tileAnchorX+h*S.tileAnchorY)),y.push(S.featureIndex)}return x.sort((E,S)=>f[E]-f[S]||y[S]-y[E]),x}addToSortKeyRanges(i,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((f,y,x)=>{f>=0&&x.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Me("SymbolBucket",ao,{omit:["layers","collisionBoxArray","features","compareText"]}),ao.MAX_GLYPHS=65535,ao.addDynamicAttributes=Xt;const e_=new ze({"symbol-placement":new ce(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new ce(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ce(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Se(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ce(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ce(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ce(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new ce(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ce(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Se(xe.layout_symbol["icon-size"]),"icon-text-fit":new ce(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ce(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Se(xe.layout_symbol["icon-image"]),"icon-rotate":new Se(xe.layout_symbol["icon-rotate"]),"icon-padding":new ce(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new ce(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Se(xe.layout_symbol["icon-offset"]),"icon-anchor":new Se(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ce(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ce(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ce(xe.layout_symbol["text-rotation-alignment"]),"text-field":new Se(xe.layout_symbol["text-field"]),"text-font":new Se(xe.layout_symbol["text-font"]),"text-size":new Se(xe.layout_symbol["text-size"]),"text-max-width":new Se(xe.layout_symbol["text-max-width"]),"text-line-height":new Se(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Se(xe.layout_symbol["text-letter-spacing"]),"text-justify":new Se(xe.layout_symbol["text-justify"]),"text-radial-offset":new Se(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ce(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new Se(xe.layout_symbol["text-anchor"]),"text-max-angle":new ce(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new ce(xe.layout_symbol["text-writing-mode"]),"text-rotate":new Se(xe.layout_symbol["text-rotate"]),"text-padding":new ce(xe.layout_symbol["text-padding"]),"text-keep-upright":new ce(xe.layout_symbol["text-keep-upright"]),"text-transform":new Se(xe.layout_symbol["text-transform"]),"text-offset":new Se(xe.layout_symbol["text-offset"]),"text-allow-overlap":new ce(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ce(xe.layout_symbol["text-ignore-placement"]),"text-optional":new ce(xe.layout_symbol["text-optional"])});var tm={paint:new ze({"icon-opacity":new Se(xe.paint_symbol["icon-opacity"]),"icon-color":new Se(xe.paint_symbol["icon-color"]),"icon-halo-color":new Se(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Se(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Se(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new ce(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new ce(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Se(xe.paint_symbol["text-opacity"]),"text-color":new Se(xe.paint_symbol["text-color"],{runtimeType:xn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Se(xe.paint_symbol["text-halo-color"]),"text-halo-width":new Se(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Se(xe.paint_symbol["text-halo-blur"]),"text-translate":new ce(xe.paint_symbol["text-translate"]),"text-translate-anchor":new ce(xe.paint_symbol["text-translate-anchor"])}),layout:e_};class xf{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:aa,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Me("FormatSectionOverride",xf,{omit:["defaultValue"]});class Sa extends Qa{constructor(i){super(i,tm)}recalculate(i,l){super.recalculate(i,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const f=[];for(const y of h)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,l,h,f){const y=this.layout.get(i).evaluate(l,{},h,f),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||ci(x.value)||!y?y:(E=l.properties,y.replace(/{([^{}]+)}/g,(A,R)=>R in E?String(E[R]):""));var E}createBucket(i){return new ao(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of tm.paint.overridableProperties){if(!Sa.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),h=new xf(l),f=new bl(h,l.property.specification);let y=null;y="constant"===l.value.kind||"source"===l.value.kind?new Ua("source",f):new gs("composite",f,l.value.zoomStops,l.value._interpolationType),this.paint._values[i]=new _e(l.property,y,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&Sa.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const h=i.get("text-field"),f=tm.paint.properties[l];let y=!1;const x=E=>{for(const S of E)if(f.overrides&&f.overrides.hasOverride(S))return void(y=!0)};if("constant"===h.value.kind&&h.value.value instanceof cn)x(h.value.value.sections);else if("source"===h.value.kind){const E=A=>{y||(A instanceof Ei&&Li(A.value)===mt?x(A.value.sections):A instanceof Na?x(A.sections):A.eachChild(E))},S=h.value;S._styleExpression&&E(S._styleExpression.expression)}return y}getProgramConfiguration(i){return new Ja(this,i)}}var nm={paint:new ze({"background-color":new ce(xe.paint_background["background-color"]),"background-pattern":new We(xe.paint_background["background-pattern"]),"background-opacity":new ce(xe.paint_background["background-opacity"])})},t_={paint:new ze({"raster-opacity":new ce(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new ce(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ce(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ce(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new ce(xe.paint_raster["raster-saturation"]),"raster-contrast":new ce(xe.paint_raster["raster-contrast"]),"raster-resampling":new ce(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new ce(xe.paint_raster["raster-fade-duration"])})};class im extends Qa{constructor(i){super(i,{}),this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var l1={paint:new ze({"sky-type":new ce(xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new ce(xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ce(xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ce(xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ce(xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new Te(xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ce(xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ce(xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ce(xe.paint_sky["sky-opacity"])})};function bf(s,i,l){const h=ih(0,0,1),f=Wd(oh());return function(y,x,E){E*=.5;var S=x[0],A=x[1],R=x[2],F=x[3],z=Math.sin(E),j=Math.cos(E);y[0]=S*j-R*z,y[1]=A*j+F*z,y[2]=R*j+S*z,y[3]=F*j-A*z}(f,f,l?-In(s)+Math.PI:In(s)),Su(f,f,-In(i)),vp(h,h,f),nv(h,h)}const c1={circle:class extends Qa{constructor(s){super(s,Hd)}createBucket(s){return new _p(s)}queryRadius(s){const i=s;return Eu("circle-radius",this,i)+Eu("circle-stroke-width",this,i)+zh(this.paint.get("circle-translate"))}queryIntersectsFeature(s,i,l,h,f,y,x,E){const S=Tu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l);return vg(s,h,y,x,E,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),S,A)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new Ja(this,s)}},heatmap:class extends Qa{createBucket(s){return new bp(s)}constructor(s){super(s,av),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return Eu("heatmap-radius",this,s)}queryIntersectsFeature(s,i,l,h,f,y,x,E){const S=this.paint.get("heatmap-radius").evaluate(i,l);return vg(s,h,y,x,E,!0,!0,new Qe(0,0),S)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new Ja(this,s)}},hillshade:class extends Qa{constructor(s){super(s,lv)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(s){return new Ja(this,s)}},fill:class extends Qa{constructor(s){super(s,wi)}getProgramIds(){const s=this.paint.get("fill-pattern"),i=s&&s.constantOr(1),l=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(s){return new Ja(this,s)}recalculate(s,i){super.recalculate(s,i);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Zh(s)}queryRadius(){return zh(this.paint.get("fill-translate"))}queryIntersectsFeature(s,i,l,h,f,y){return!s.queryGeometry.isAboveHorizon&&$d(tv(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends Qa{constructor(s){super(s,Pp)}createBucket(s){return new oo(s)}queryRadius(){return zh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new Ja(this,s)}queryIntersectsFeature(s,i,l,h,f,y,x,E,S){const A=Tu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(i,l),F=this.paint.get("fill-extrusion-base").evaluate(i,l),z=[0,0],j=E&&y.elevation,ee=y.elevation?y.elevation.exaggeration():1;if(j){const ye=s.tile.getBucket(this).centroidVertexArray,Ce=S+1;if(Ce<ye.length){const Ie=ye.get(Ce);z[0]=Ie.a_centroid_pos0,z[1]=Ie.a_centroid_pos1}}if(0===z[0]&&1===z[1])return!1;const ne=(ye=h,Ce=F,Ie=R,Pe=A,ke=x,(Oe=j?E:null)?function(rt,qe,Ke,ot,Xe,At,dt,Bn,Pt){const hn=[],bt=[],Rt=[0,0,0,1];for(const wn of rt){const yr=[],Ai=[];for(const kr of wn){const Rr=kr.x+ot.x,Ii=kr.y+ot.y,Wn=bv(Rr,Ii,qe,Ke,At,dt,Bn,Pt);Rt[0]=Rr,Rt[1]=Ii,Rt[2]=Wn.base,Rt[3]=1,Uh(Rt,Rt,Xe),Rt[3]=Math.max(Rt[3],1e-5);const Xn=kp([Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]]);Rt[0]=Rr,Rt[1]=Ii,Rt[2]=Wn.top,Rt[3]=1,Uh(Rt,Rt,Xe),Rt[3]=Math.max(Rt[3],1e-5);const Lr=kp([Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]]);yr.push(Xn),Ai.push(Lr)}hn.push(yr),bt.push(Ai)}return[hn,bt]}(ye,Ce,Ie,Pe,ke,Oe,z,ee,y.center.lat):function(rt,qe,Ke,ot,Xe){const At=[],dt=[],Bn=Xe[8]*qe,Pt=Xe[9]*qe,hn=Xe[10]*qe,bt=Xe[11]*qe,Rt=Xe[8]*Ke,wn=Xe[9]*Ke,yr=Xe[10]*Ke,Ai=Xe[11]*Ke;for(const kr of rt){const Rr=[],Ii=[];for(const Wn of kr){const Xn=Wn.x+ot.x,Lr=Wn.y+ot.y,Fi=Xe[0]*Xn+Xe[4]*Lr+Xe[12],Or=Xe[1]*Xn+Xe[5]*Lr+Xe[13],vr=Xe[2]*Xn+Xe[6]*Lr+Xe[14],Kn=Xe[3]*Xn+Xe[7]*Lr+Xe[15],Ui=Fi+Bn,hi=Or+Pt,di=vr+hn,ji=Math.max(Kn+bt,1e-5),is=Fi+Rt,$i=Or+wn,Hi=vr+yr,Tn=Math.max(Kn+Ai,1e-5),Fr=new Qe(Ui/ji,hi/ji);Fr.z=di/ji,Rr.push(Fr);const bs=new Qe(is/Tn,$i/Tn);bs.z=Hi/Tn,Ii.push(bs)}At.push(Rr),dt.push(Ii)}return[At,dt]}(ye,Ce,Ie,Pe,ke)),ue=s.queryGeometry;var ye,Ce,Ie,Pe,ke,Oe;return function(ye,Ce,Ie){let Pe=1/0;$d(Ie,Ce)&&(Pe=Ig(Ie,Ce[0]));for(let ke=0;ke<Ce.length;ke++){const Oe=Ce[ke],Ue=ye[ke];for(let Ye=0;Ye<Oe.length-1;Ye++){const nt=Oe[Ye],rt=[nt,Oe[Ye+1],Ue[Ye+1],Ue[Ye],nt];jd(Ie,rt)&&(Pe=Math.min(Pe,Ig(Ie,rt)))}}return Pe!==1/0&&Pe}(ne[0],ne[1],ue.isPointQuery()?ue.screenBounds:ue.screenGeometry)}},line:class extends Qa{constructor(s){super(s,Lp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Wi,this.gradientVersion=(this.gradientVersion+1)%po}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,i){super.recalculate(s,i),this.paint._values["line-floorwidth"]=Rg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new of(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new Ja(this,s)}queryRadius(s){const i=s,l=Dv(Eu("line-width",this,i),Eu("line-gap-width",this,i)),h=Eu("line-offset",this,i);return l/2+Math.abs(h)+zh(this.paint.get("line-translate"))}queryIntersectsFeature(s,i,l,h,f,y){if(s.queryGeometry.isAboveHorizon)return!1;const x=tv(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),E=s.pixelToTileUnitsFactor/2*Dv(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),S=this.paint.get("line-offset").evaluate(i,l);return S&&(h=function(A,R){const F=[],z=new Qe(0,0);for(let j=0;j<A.length;j++){const ee=A[j],ne=[];for(let ue=0;ue<ee.length;ue++){const ye=ee[ue-1],Ce=ee[ue],Ie=ee[ue+1],Pe=0===ue?z:Ce.sub(ye)._unit()._perp(),ke=ue===ee.length-1?z:Ie.sub(Ce)._unit()._perp(),Oe=Pe._add(ke)._unit();Oe._mult(1/(Oe.x*ke.x+Oe.y*ke.y)),ne.push(Oe._mult(R)._add(Ce))}F.push(ne)}return F}(h,S*s.pixelToTileUnitsFactor)),function(A,R,F){for(let z=0;z<R.length;z++){const j=R[z];if(A.length>=3)for(let ee=0;ee<j.length;ee++)if(Ta(A,j[ee]))return!0;if(Nh(A,j,F))return!0}return!1}(x,h,E)}isTileClipped(){return!0}},symbol:Sa,background:class extends Qa{constructor(s){super(s,nm)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Qa{constructor(s){super(s,t_)}getProgramIds(){return["raster"]}},sky:class extends Qa{constructor(s){super(s,l1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"sky-gradient"===s?this._updateColorRamp():"sky-atmosphere-sun"!==s&&"sky-atmosphere-halo-color"!==s&&"sky-atmosphere-color"!==s&&"sky-atmosphere-sun-intensity"!==s||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}}getCenter(s,i){const l=this.paint.get("sky-type");if("atmosphere"===l){const h=this.paint.get("sky-atmosphere-sun"),f=!h,y=s.style.light,x=y.properties.get("position");return f&&"viewport"===y.properties.get("anchor")&&zt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?bf(x.azimuthal,90-x.polar,i):bf(h[0],90-h[1],i)}if("gradient"===l){const h=this.paint.get("sky-gradient-center");return bf(h[0],90-h[1],i)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return"atmosphere"===s?["skyboxCapture","skybox"]:"gradient"===s?["skyboxGradient"]:null}}},{HTMLImageElement:Ml,HTMLCanvasElement:id,HTMLVideoElement:rd,ImageData:wf,ImageBitmap:rm}=at;class Cf{constructor(i,l,h,f){this.context=i,this.format=h,this.texture=i.gl.createTexture(),this.update(l,f)}update(i,l,h){const{width:f,height:y}=i,x=!(this.size&&this.size[0]===f&&this.size[1]===y||h),{context:E}=this,{gl:S}=E;if(this.useMipmap=Boolean(l&&l.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!l||!1!==l.premultiply)),x)this.size=[f,y],i instanceof Ml||i instanceof id||i instanceof rd||i instanceof wf||rm&&i instanceof rm?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,i):S.texImage2D(S.TEXTURE_2D,0,this.format,f,y,0,this.format,S.UNSIGNED_BYTE,i.data);else{const{x:A,y:R}=h||{x:0,y:0};i instanceof Ml||i instanceof id||i instanceof rd||i instanceof wf||rm&&i instanceof rm?S.texSubImage2D(S.TEXTURE_2D,0,A,R,S.RGBA,S.UNSIGNED_BYTE,i):S.texSubImage2D(S.TEXTURE_2D,0,A,R,f,y,S.RGBA,S.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(i,l,h){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),h!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=y.LINEAR),i!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,i),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,h||i),this.filter=i),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Wc{constructor(i,l){i&&(l?this.setSouthWest(i).setNorthEast(l):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Vi?new Vi(i.lng,i.lat):Vi.convert(i),this}setSouthWest(i){return this._sw=i instanceof Vi?new Vi(i.lng,i.lat):Vi.convert(i),this}extend(i){const l=this._sw,h=this._ne;let f,y;if(i instanceof Vi)f=i,y=i;else{if(!(i instanceof Wc))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(Wc.convert(i)):this.extend(Vi.convert(i)):this;if(f=i._sw,y=i._ne,!f||!y)return this}return l||h?(l.lng=Math.min(f.lng,l.lng),l.lat=Math.min(f.lat,l.lat),h.lng=Math.max(y.lng,h.lng),h.lat=Math.max(y.lat,h.lat)):(this._sw=new Vi(f.lng,f.lat),this._ne=new Vi(y.lng,y.lat)),this}getCenter(){return new Vi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vi(this.getWest(),this.getNorth())}getSouthEast(){return new Vi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:h}=Vi.convert(i);let f=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f}static convert(i){return!i||i instanceof Wc?i:new Wc(i)}}const Bv=6371008.8;class Vi{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vi(as(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,h=this.lat*l,f=i.lat*l,y=Math.sin(h)*Math.sin(f)+Math.cos(h)*Math.cos(f)*Math.cos((i.lng-this.lng)*l);return Bv*Math.acos(Math.min(y,1))}toBounds(i=0){const l=360*i/40075017,h=l/Math.cos(Math.PI/180*this.lat);return new Wc(new Vi(this.lng-h,this.lat-l),new Vi(this.lng+h,this.lat+l))}static convert(i){if(i instanceof Vi)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new Vi(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new Vi(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Vv=2*Math.PI*Bv;function om(s){return Vv*Math.cos(s*Math.PI/180)}function sm(s){return(180+s)/360}function n_(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function od(s,i){return s/om(i)}function am(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function i_(s,i){return s*om(am(i))}class sd{constructor(i,l,h=0){this.x=+i,this.y=+l,this.z=+h}static fromLngLat(i,l=0){const h=Vi.convert(i);return new sd(sm(h.lng),n_(h.lat),od(l,h.lat))}toLngLat(){return new Vi(360*this.x-180,am(this.y))}toAltitude(){return i_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vv*(i=am(this.y),1/Math.cos(i*Math.PI/180));var i}}class r_{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.image=new Uc({width:i,height:l}),this.positions={},this.uploaded=!1}getDash(i,l){const h=this.getKey(i,l);return this.positions[h]}trim(){const i=this.width,l=this.height=ka(this.nextRow);this.image.resize({width:i,height:l})}getKey(i,l){return i.join(",")+l}getDashRanges(i,l,h){const f=[];let y=i.length%2==1?-i[i.length-1]*h:0,x=i[0]*h,E=!0;f.push({left:y,right:x,isDash:E,zeroLength:0===i[0]});let S=i[0];for(let A=1;A<i.length;A++){E=!E;const R=i[A];y=S*h,S+=R,x=S*h,f.push({left:y,right:x,isDash:E,zeroLength:0===R})}return f}addRoundDash(i,l,h){const f=l/2;for(let y=-h;y<=h;y++){const x=this.width*(this.nextRow+h+y);let E=0,S=i[E];for(let A=0;A<this.width;A++){A/S.right>1&&(S=i[++E]);const R=Math.abs(A-S.left),F=Math.abs(A-S.right),z=Math.min(R,F);let j;const ee=y/h*(f+1);if(S.isDash){const ne=f-Math.abs(ee);j=Math.sqrt(z*z+ne*ne)}else j=f-Math.sqrt(z*z+ee*ee);this.image.data[x+A]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(i,l){for(let S=i.length-1;S>=0;--S){const A=i[S],R=i[S+1];A.zeroLength?i.splice(S,1):R&&R.isDash===A.isDash&&(R.left=A.left,i.splice(S,1))}const h=i[0],f=i[i.length-1];h.isDash===f.isDash&&(h.left=f.left-this.width,f.right=h.right+this.width);const y=this.width*this.nextRow;let x=0,E=i[x];for(let S=0;S<this.width;S++){S/E.right>1&&(E=i[++x]);const A=Math.abs(S-E.left),R=Math.abs(S-E.right),F=Math.min(A,R);this.image.data[y+S]=Math.max(0,Math.min(255,(E.isDash?F:-F)+l+128))}}addDash(i,l){const h=this.getKey(i,l);if(this.positions[h])return this.positions[h];const f="round"===l,y=f?7:0,x=2*y+1;if(this.nextRow+x>this.height)return zt("LineAtlas out of space"),null;0===i.length&&i.push(1);let E=0;for(let R=0;R<i.length;R++)i[R]<0&&(zt("Negative value is found in line dasharray, replacing values with 0"),i[R]=0),E+=i[R];if(0!==E){const R=this.width/E,F=this.getDashRanges(i,this.width,R);f?this.addRoundDash(F,R,y):this.addRegularDash(F,"square"===l?.5*R:0)}const S=this.nextRow+y;this.nextRow+=x;const A={tl:[S,y],br:[E,0]};return this.positions[h]=A,A}}Me("LineAtlas",r_);class u1{constructor(i){this._callback=i,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const h1=at.performance;function Uv(s){const i=s?s.url.toString():void 0;return h1.getEntriesByName(i)}class d1{constructor(){this.tasks={},this.taskQueue=[],ll(["process"],this),this.invoker=new u1(this.process),this.nextId=0}add(i,l){const h=this.nextId++,f=function({type:y,isSymbolTile:x,zoom:E}){return E=E||0,"message"===y?0:"maybePrepare"!==y||x?"parseTile"!==y||x?"parseTile"===y&&x?300-E:"maybePrepare"===y&&x?400-E:500:200-E:100-E}(l);if(0===f){li();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:i,metadata:l,priority:f,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){li();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const l=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let i=null,l=1/0;for(let f=0;f<this.taskQueue.length;f++){const y=this.tasks[this.taskQueue[f]];y.priority<l&&(l=y.priority,i=f)}if(null===i)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}function jv(s,i,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[s*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}class o_{constructor(i,l,h){this.z=i,this.x=l,this.y=h,this.key=Lu(0,i,i,l,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l){const h=(y=this.y,x=this.z,E=jv(256*(f=this.x),256*(y=Math.pow(2,x)-y-1),x),S=jv(256*(f+1),256*(y+1),x),E[0]+","+E[1]+","+S[0]+","+S[1]);var f,y,x,E,S;const A=function(R,F,z){let j,ee="";for(let ne=R;ne>0;ne--)j=1<<ne-1,ee+=(F&j?1:0)+(z&j?2:0);return ee}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",h)}getTilePoint(i){const l=Math.pow(2,this.z);return new Qe((i.x*l-this.x)*qn,(i.y*l-this.y)*qn)}getTileVec3(i){const l=Math.pow(2,this.z);return ih((i.x*l-this.x)*qn,(i.y*l-this.y)*qn,i_(i.z,i.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class $v{constructor(i,l){this.wrap=i,this.canonical=l,this.key=Lu(i,l.z,l.z,l.x,l.y)}}class rr{constructor(i,l,h,f,y){this.overscaledZ=i,this.wrap=l,this.canonical=new o_(h,+f,+y),this.key=0===l&&i===h?this.canonical.key:Lu(l,i,h,f,y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const l=this.canonical.z-i;return i>this.canonical.z?new rr(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rr(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l=!0){if(this.overscaledZ===i&&l)return this.key;if(i>this.canonical.z)return Lu(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return Lu(this.wrap*+l,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new rr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,f=2*this.canonical.y;return[new rr(l,this.wrap,l,h,f),new rr(l,this.wrap,l,h+1,f),new rr(l,this.wrap,l,h,f+1),new rr(l,this.wrap,l,h+1,f+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new rr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new rr(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $v(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new sd(i.x-this.wrap,i.y))}getTileVec3(i){return this.canonical.getTileVec3(new sd(i.x-this.wrap,i.y,i.z))}}function Lu(s,i,l,h,f){const y=1<<Math.min(l,22);let x=y*(f%y)+h%y;return s&&l<22&&(x+=y*y*((s<0?-2*s-1:2*s)%(1<<2*(22-l)))),16*(32*x+l)+(i-l)}Me("CanonicalTileID",o_),Me("OverscaledTileID",rr,{omit:["projMatrix"]});class s_{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const h=i[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}class lm{constructor(i,l,h,f,y){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=h,i._y=f,this.properties=i.properties,this.id=y}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(i[l]=this[l]);return i}}var cm=ft([{name:"a_pos",type:"Int16",components:2}]);class um{constructor(i,l,h){this.tileID=i,this.uid=si(),this.uses=0,this.tileSize=l,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const l=i+this.timeAdded;l<qi.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(i,l,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(f,y){const x={};if(!y)return x;for(const E of f){const S=E.layerIds.map(A=>y.getLayer(A)).filter(Boolean);if(0!==S.length){E.layers=S,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(A=>S.filter(R=>R.id===A)[0]));for(const A of S)x[A.id]=E}}return x}(i.buckets,l.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof ao){if(this.hasSymbolBuckets=!0,!h)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof ao&&y.hasRTLText){this.hasRTLText=!0,X.isLoading()||X.isLoaded()||"deferred"!==U()||q();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(f).queryRadius(y))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Fc}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const h in this.buckets){const f=this.buckets[h];f.uploadPending()&&f.upload(i)}const l=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Cf(i,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Cf(i,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Cf(i,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,l,h,f,y,x,E,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:E,transform:x,params:y},i,l,h):{}}querySourceFeatures(i,l){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const f=h.loadVTLayers(),y=l?l.sourceLayer:"",x=f._geojsonTileLayer||f[y];if(!x)return;const E=_s(l&&l.filter),{z:S,x:A,y:R}=this.tileID.canonical,F={z:S,x:A,y:R};for(let z=0;z<x.length;z++){const j=x.feature(z);if(E.needGeometry){const ue=Cu(j,!0);if(!E.filter(new Y(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!E.filter(new Y(this.tileID.overscaledZ),j))continue;const ee=h.getId(j,y),ne=new lm(j,S,A,R,ee);ne.tile=F,i.push(ne)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const l=this.expirationTime;if(i.cacheControl){const h=Sn(i.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const h=Date.now();let f=!1;if(this.expirationTime>h)f=!1;else if(l)if(this.expirationTime<l)f=!0;else{const y=this.expirationTime-l;y?this.expirationTime=h+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(i).length)return;const h=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!l.style.hasLayer(f))continue;const y=this.buckets[f],x=y.layers[0].sourceLayer||"_geojsonTileLayer",E=h[x],S=i[x];if(!E||!S||0===Object.keys(S).length)continue;y.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=l&&l.style&&l.style.getLayer(f);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<qi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=qi.now()+i}setDependencies(i,l){const h={};for(const f of l)h[f]=!0;this.dependencies[i]=h}hasDependency(i,l){for(const h of i){const f=this.dependencies[h];if(f)for(const y of l)if(f[y])return!0}return!1}clearQueryDebugViz(){}}class hm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,l,h){const f=String(l);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][f]=this.stateChanges[i][f]||{},Ci(this.stateChanges[i][f],h),null===this.deletedStates[i]){this.deletedStates[i]={};for(const y in this.state[i])y!==f&&(this.deletedStates[i][y]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][f]){this.deletedStates[i][f]={};for(const y in this.state[i][f])h[y]||(this.deletedStates[i][f][y]=null)}else for(const y in h)this.deletedStates[i]&&this.deletedStates[i][f]&&null===this.deletedStates[i][f][y]&&delete this.deletedStates[i][f][y]}removeFeatureState(i,l,h){if(null===this.deletedStates[i])return;const f=String(l);if(this.deletedStates[i]=this.deletedStates[i]||{},h&&void 0!==l)null!==this.deletedStates[i][f]&&(this.deletedStates[i][f]=this.deletedStates[i][f]||{},this.deletedStates[i][f][h]=null);else if(void 0!==l)if(this.stateChanges[i]&&this.stateChanges[i][f])for(h in this.deletedStates[i][f]={},this.stateChanges[i][f])this.deletedStates[i][f][h]=null;else this.deletedStates[i][f]=null;else this.deletedStates[i]=null}getState(i,l){const h=String(l),f=Ci({},(this.state[i]||{})[h],(this.stateChanges[i]||{})[h]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const y=this.deletedStates[i][l];if(null===y)return{};for(const x in y)delete f[x]}return f}initializeTileState(i,l){i.setFeatureState(this.state,l)}coalesceChanges(i,l){const h={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const x in this.stateChanges[f])this.state[f][x]||(this.state[f][x]={}),Ci(this.state[f][x],this.stateChanges[f][x]),y[x]=this.state[f][x];h[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(null===this.deletedStates[f])for(const x in this.state[f])y[x]={},this.state[f][x]={};else for(const x in this.deletedStates[f]){if(null===this.deletedStates[f][x])this.state[f][x]={};else for(const E of Object.keys(this.deletedStates[f][x]))delete this.state[f][x][E];y[x]=this.state[f][x]}h[f]=h[f]||{},Ci(h[f],y)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(h).length)for(const f in i)i[f].setFeatureState(h,l)}}class a_{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,l){const h=this.toIdx(i,l);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,l){return this.leaves[this.toIdx(i,l)]}toIdx(i,l){return l*this.size+i}}function oc(s,i,l,h){let f=0,y=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(l[x]<s[x]||l[x]>i[x])return null}else{const E=1/h[x];let S=(s[x]-l[x])*E,A=(i[x]-l[x])*E;if(S>A){const R=S;S=A,A=R}if(S>f&&(f=S),A<y&&(y=A),f>y)return null}return f}function dm(s,i,l,h,f,y,x,E,S,A,R){const F=h-s,z=f-i,j=y-l,ee=x-s,ne=E-i,ue=S-l,ye=R[1]*ue-R[2]*ne,Ce=R[2]*ee-R[0]*ue,Ie=R[0]*ne-R[1]*ee,Pe=F*ye+z*Ce+j*Ie;if(Math.abs(Pe)<1e-15)return null;const ke=1/Pe,Oe=A[0]-s,Ue=A[1]-i,Ye=A[2]-l,nt=(Oe*ye+Ue*Ce+Ye*Ie)*ke;if(nt<0||nt>1)return null;const rt=Ue*j-Ye*z,qe=Ye*F-Oe*j,Ke=Oe*z-Ue*F,ot=(R[0]*rt+R[1]*qe+R[2]*Ke)*ke;return ot<0||nt+ot>1?null:(ee*rt+ne*qe+ue*Ke)*ke}function l_(s,i,l){return(s-i)/(l-i)}function Hv(s,i,l,h,f,y,x,E,S){const A=1<<l,R=y-h,F=x-f,z=(s+1)/A*R+h,j=(i+0)/A*F+f,ee=(i+1)/A*F+f;E[0]=(s+0)/A*R+h,E[1]=j,S[0]=z,S[1]=ee}class Ef{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(y){const x=Math.ceil(Math.log2(y.dim/8)),E=[];let S=Math.ceil(Math.pow(2,x));const A=1/S,R=(j,ee,ne,ue,ye)=>{const Ce=ue?1:0,Ie=(j+1)*ne-Ce,Pe=ee*ne,ke=(ee+1)*ne-Ce;ye[0]=j*ne,ye[1]=Pe,ye[2]=Ie,ye[3]=ke};let F=new a_(S);const z=[];for(let j=0;j<S*S;j++){R(j%S,Math.floor(j/S),A,!1,z);const ee=sc(z[0],z[1],y),ne=sc(z[2],z[1],y),ue=sc(z[2],z[3],y),ye=sc(z[0],z[3],y);F.minimums.push(Math.min(ee,ne,ue,ye)),F.maximums.push(Math.max(ee,ne,ue,ye)),F.leaves.push(1)}for(E.push(F),S/=2;S>=1;S/=2){const j=E[E.length-1];F=new a_(S);for(let ee=0;ee<S*S;ee++){R(ee%S,Math.floor(ee/S),2,!0,z);const ne=j.getElevation(z[0],z[1]),ue=j.getElevation(z[2],z[1]),ye=j.getElevation(z[2],z[3]),Ce=j.getElevation(z[0],z[3]),Ie=j.isLeaf(z[0],z[1]),Pe=j.isLeaf(z[2],z[1]),ke=j.isLeaf(z[2],z[3]),Oe=j.isLeaf(z[0],z[3]),Ue=Math.min(ne.min,ue.min,ye.min,Ce.min),Ye=Math.max(ne.max,ue.max,ye.max,Ce.max),nt=Ie&&Pe&&ke&&Oe;F.maximums.push(Ye),F.minimums.push(Ue),F.leaves.push(Ye-Ue<=5&&nt?1:0)}E.push(F)}return E}(this.dem),h=l.length-1,f=l[h];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(l,0,0,h,0)}raycastRoot(i,l,h,f,y,x,E=1){return oc([i,l,-100],[h,f,this.maximums[0]*E],y,x)}raycast(i,l,h,f,y,x,E=1){if(!this.nodeCount)return null;const S=this.raycastRoot(i,l,h,f,y,x,E);if(null==S)return null;const A=[],R=[],F=[],z=[],j=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:ee,t:ne,nodex:ue,nodey:ye,depth:Ce}=j.pop();if(this.leaves[ee]){Hv(ue,ye,Ce,i,l,h,f,F,z);const Pe=1<<Ce,ke=(ue+0)/Pe,Oe=(ue+1)/Pe,Ue=(ye+0)/Pe,Ye=(ye+1)/Pe,nt=sc(ke,Ue,this.dem)*E,rt=sc(Oe,Ue,this.dem)*E,qe=sc(Oe,Ye,this.dem)*E,Ke=sc(ke,Ye,this.dem)*E,ot=dm(F[0],F[1],nt,z[0],F[1],rt,z[0],z[1],qe,y,x),Xe=dm(z[0],z[1],qe,F[0],z[1],Ke,F[0],F[1],nt,y,x),At=Math.min(null!==ot?ot:Number.MAX_VALUE,null!==Xe?Xe:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const dt=yg([],y,x,ne);if(c_(nt,rt,Ke,qe,l_(dt[0],F[0],z[0]),l_(dt[1],F[1],z[1]))>=dt[2])return ne}continue}let Ie=0;for(let Pe=0;Pe<this._siblingOffset.length;Pe++){Hv((ue<<1)+this._siblingOffset[Pe][0],(ye<<1)+this._siblingOffset[Pe][1],Ce+1,i,l,h,f,F,z),F[2]=-100,z[2]=this.maximums[this.childOffsets[ee]+Pe]*E;const ke=oc(F,z,y,x);if(null!=ke){const Oe=ke;A[Pe]=Oe;let Ue=!1;for(let Ye=0;Ye<Ie&&!Ue;Ye++)Oe>=A[R[Ye]]&&(R.splice(Ye,0,Pe),Ue=!0);Ue||(R[Ie]=Pe),Ie++}}for(let Pe=0;Pe<Ie;Pe++){const ke=R[Pe];j.push({idx:this.childOffsets[ee]+ke,t:A[ke],nodex:(ue<<1)+this._siblingOffset[ke][0],nodey:(ye<<1)+this._siblingOffset[ke][1],depth:Ce+1})}}return null}_addNode(i,l,h){return this.minimums.push(i),this.maximums.push(l),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,l,h,f,y){if(1===i[f].isLeaf(l,h))return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const x=f-1,E=i[x];let S,A=0;for(let R=0;R<this._siblingOffset.length;R++){const F=2*l+this._siblingOffset[R][0],z=2*h+this._siblingOffset[R][1],j=E.getElevation(F,z),ee=E.isLeaf(F,z),ne=this._addNode(j.min,j.max,ee);ee&&(A|=1<<R),S||(S=ne)}for(let R=0;R<this._siblingOffset.length;R++)A&1<<R||this._construct(i,2*l+this._siblingOffset[R][0],2*h+this._siblingOffset[R][1],x,S+R)}}function c_(s,i,l,h,f,y){return et(et(s,l,y),et(i,h,y),f)}function sc(s,i,l){const h=l.dim,f=gi(s*h-.5,0,h-1),y=gi(i*h-.5,0,h-1),x=Math.floor(f),E=Math.floor(y),S=Math.min(x+1,h-1),A=Math.min(E+1,h-1);return c_(l.get(x,E),l.get(S,E),l.get(x,A),l.get(S,A),f-x,y-E)}const u_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Tf{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,l,h,f=!1,y=!1){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&"mapbox"!==h&&"terrarium"!==h)return zt(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const x=this.dim=l.height-2;if(this.data=new Uint32Array(l.data.buffer),this.encoding=h||"mapbox",this.borderReady=f,!f){for(let E=0;E<x;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(x,E)]=this.data[this._idx(x-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,x)]=this.data[this._idx(E,x-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(x,-1)]=this.data[this._idx(x-1,0)],this.data[this._idx(-1,x)]=this.data[this._idx(0,x-1)],this.data[this._idx(x,x)]=this.data[this._idx(x-1,x-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ef(this)}get(i,l,h=!1){const f=new Uint8Array(this.data.buffer);h&&(i=gi(i,-1,this.dim),l=gi(l,-1,this.dim));const y=4*this._idx(i,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(f[y],f[y+1],f[y+2])}static getUnpackVector(i){return u_[i]}get unpackVector(){return u_[this.encoding]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}_unpackMapbox(i,l,h){return(256*i*256+256*l+h)/10-1e4}_unpackTerrarium(i,l,h){return 256*i+l+h/256-32768}static pack(i,l){const h=[0,0,0,0],f=Tf.getUnpackVector(l);let y=Math.floor((i+f[3])/f[2]);return h[2]=y%256,y=Math.floor(y/256),h[1]=y%256,y=Math.floor(y/256),h[0]=y,h}getPixels(){return new js({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,l,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let f=l*this.dim,y=l*this.dim+this.dim,x=h*this.dim,E=h*this.dim+this.dim;switch(l){case-1:f=y-1;break;case 1:y=f+1}switch(h){case-1:x=E-1;break;case 1:E=x+1}const S=-l*this.dim,A=-h*this.dim;for(let R=x;R<E;R++)for(let F=f;F<y;F++)this.data[this._idx(F,R)]=i.data[this._idx(F+S,R+A)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Me("DEMData",Tf),Me("DemMinMaxQuadTree",Ef,{omit:["dem"]});class ad{constructor(i,l){this.max=i,this.onRemove=l,this.reset()}reset(){for(const i in this.data)for(const l of this.data[i])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(i,l,h){const f=i.wrapped().key;void 0===this.data[f]&&(this.data[f]=[]);const y={value:l,timeout:void 0};if(void 0!==h&&(y.timeout=setTimeout(()=>{this.remove(i,y)},h)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const l=this.data[i].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),l.value}getByKey(i){const l=this.data[i];return l?l[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,l){if(!this.has(i))return this;const h=i.wrapped().key,f=void 0===l?0:this.data[h].indexOf(l),y=this.data[h][f];return this.data[h].splice(f,1),y.timeout&&clearTimeout(y.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(y.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(i){const l=[];for(const h in this.data)for(const f of this.data[h])i(f.value)||l.push(f);for(const h of l)this.remove(h.value.tileID,h)}}class nl{constructor(i,l,h){this.func=i,this.mask=l,this.range=h}}nl.ReadOnly=!1,nl.ReadWrite=!0,nl.disabled=new nl(519,nl.ReadOnly,[0,1]);class Xc{constructor(i,l,h,f,y,x){this.test=i,this.ref=l,this.mask=h,this.fail=f,this.depthFail=y,this.pass=x}}Xc.disabled=new Xc({func:519,mask:0},0,0,7680,7680,7680);class xs{constructor(i,l,h){this.blendFunction=i,this.blendColor=l,this.mask=h}}xs.Replace=[1,0],xs.disabled=new xs(xs.Replace,$t.transparent,[!1,!1,!1,!1]),xs.unblended=new xs(xs.Replace,$t.transparent,[!0,!0,!0,!0]),xs.alphaBlended=new xs([1,771],$t.transparent,[!0,!0,!0,!0]);class Ma{constructor(i,l,h){this.enable=i,this.mode=l,this.frontFace=h}}Ma.disabled=new Ma(!1,1029,2305),Ma.backCCW=new Ma(!0,1029,2305),Ma.backCW=new Ma(!0,1029,2304),Ma.frontCW=new Ma(!0,1028,2304),Ma.frontCCW=new Ma(!0,1028,2305);class Yc extends xt{constructor(i,l,h){super(),this.id=i,this._onlySymbols=h,l.on("data",f=>{"source"===f.dataType&&"metadata"===f.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===f.dataType&&"content"===f.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new ad(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new hm}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const l=this._tiles[i];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,l){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,l)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const h=this._tiles[l];h.upload(i),h.prepare(this.map.style.imageManager)}}getIds(){return Pn(this._tiles).map(i=>i.tileID).sort(Df).map(i=>i.key)}getRenderableIds(i){const l=[];for(const h in this._tiles)this._isIdRenderable(+h,i)&&l.push(this._tiles[h]);return i?l.sort((h,f)=>{const y=h.tileID,x=f.tileID,E=new Qe(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),S=new Qe(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-x.overscaledZ||S.y-E.y||S.x-E.x}).map(h=>h.tileID.key):l.map(h=>h.tileID).sort(Df).map(h=>h.key)}hasRenderableParent(i){const l=this.findLoadedParent(i,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(i,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(l||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,l){const h=this._tiles[i];h&&("loading"!==h.state&&(h.state=l),this._loadTile(h,this._tileLoaded.bind(this,h,i,l)))}_tileLoaded(i,l,h,f){if(f)return i.state="errored",void(404!==f.status?this._source.fire(new He(f,{tile:i})):this.update(this.transform));i.timeAdded=qi.now(),"expired"===h&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(l,i),"raster-dem"===this.getSource().type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new it("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const l=this.getRenderableIds();for(let f=0;f<l.length;f++){const y=l[f];if(i.neighboringTiles&&i.neighboringTiles[y]){const x=this.getTileByID(y);h(i,x),h(x,i)}}function h(f,y){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let x=y.tileID.canonical.x-f.tileID.canonical.x;const E=y.tileID.canonical.y-f.tileID.canonical.y,S=Math.pow(2,f.tileID.canonical.z),A=y.tileID.key;0===x&&0===E||Math.abs(E)>1||(Math.abs(x)>1&&(1===Math.abs(x+S)?x+=S:1===Math.abs(x-S)&&(x-=S)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,x,E),f.neighboringTiles&&f.neighboringTiles[A]&&(f.neighboringTiles[A].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,l,h,f){for(const y in this._tiles){let x=this._tiles[y];if(f[y]||!x.hasData()||x.tileID.overscaledZ<=l||x.tileID.overscaledZ>h)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>l+1;){const A=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[A.key],x&&x.hasData()&&(E=A)}let S=E;for(;S.overscaledZ>l;)if(S=S.scaledTo(S.overscaledZ-1),i[S.key]){f[E.key]=E;break}}}findLoadedParent(i,l){if(i.key in this._loadedParentTiles){const h=this._loadedParentTiles[i.key];return h&&h.tileID.overscaledZ>=l?h:null}for(let h=i.overscaledZ-1;h>=l;h--){const f=i.scaledTo(h),y=this._getLoadedTile(f);if(y)return y}}_getLoadedTile(i){const l=this._tiles[i.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,l){l=l||this._source.tileSize;const h=Math.ceil(i.width/l)+1,f=Math.ceil(i.height/l)+1,y=Math.floor(h*f*5),x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(x)}handleWrapJump(i){const l=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,l){const h={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+l),h[y.tileID.key]=y}this._tiles=h;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(i,l,h){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let f;this.updateCacheSize(i,l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new rr(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(f=i.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(E=>this._source.hasTile(E)))):f=[];const y=this._updateRetainedTiles(f);if(Sf(this._source.type)&&0!==f.length){const E={},S={},A=Object.keys(y);for(const F of A){const z=y[F],j=this._tiles[F];if(!j||j.fadeEndTime&&j.fadeEndTime<=qi.now())continue;const ee=this.findLoadedParent(z,Math.max(z.overscaledZ-Yc.maxOverzooming,this._source.minzoom));ee&&(this._addTile(ee.tileID),E[ee.tileID.key]=ee.tileID),S[F]=z}const R=f[f.length-1].overscaledZ;for(const F in this._tiles){const z=this._tiles[F];if(y[F]||!z.hasData())continue;let j=z.tileID;for(;j.overscaledZ>R;){j=j.scaledTo(j.overscaledZ-1);const ee=this._tiles[j.key];if(ee&&ee.hasData()&&S[j.key]){y[F]=z.tileID;break}}}for(const F in E)y[F]||(this._coveredTiles[F]=!0,y[F]=E[F])}for(const E in y)this._tiles[E].clearFadeHold();const x=function(E,S){const A=[];for(const R in E)R in S||A.push(R);return A}(this._tiles,y);for(const E of x){const S=this._tiles[E];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const l={};if(0===i.length)return l;const h={},f=i[i.length-1].overscaledZ,y=i[0].overscaledZ,x=Math.max(y-Yc.maxOverzooming,this._source.minzoom),E=Math.max(y+Yc.maxUnderzooming,this._source.minzoom),S={};for(const A of i){const R=this._addTile(A);l[A.key]=A,R.hasData()||f<this._source.maxzoom&&(S[A.key]=A)}this._retainLoadedChildren(S,f,E,l);for(const A of i){let R=this._tiles[A.key];if(R.hasData())continue;if(A.canonical.z>=this._source.maxzoom){const z=A.children(this._source.maxzoom)[0],j=this.getTile(z);if(j&&j.hasData()){l[z.key]=z;continue}}else{const z=A.children(this._source.maxzoom);if(l[z[0].key]&&l[z[1].key]&&l[z[2].key]&&l[z[3].key])continue}let F=R.wasRequested();for(let z=A.overscaledZ-1;z>=x;--z){const j=A.scaledTo(z);if(h[j.key]||(h[j.key]=!0,R=this.getTile(j),!R&&F&&(R=this._addTile(j)),R&&(l[j.key]=j,F=R.wasRequested(),R.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const l=[];let h,f=this._tiles[i].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){h=this._loadedParentTiles[f.key];break}l.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(h=this._getLoadedTile(y),h)break;f=y}for(const y of l)this._loadedParentTiles[y]=h}}_addTile(i){let l=this._tiles[i.key];if(l)return l;l=this._cache.getAndRemove(i),l&&(this._setTileReloadTimer(i.key,l),l.tileID=i,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,l)));const h=Boolean(l);return h||(l=new um(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom),this._loadTile(l,this._tileLoaded.bind(this,l,i.key,l.state))),l?(l.uses++,this._tiles[i.key]=l,h||this._source.fire(new it("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(i,l){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const h=l.getExpiryTimeout();h&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},h))}_removeTile(i){const l=this._tiles[i];l&&(l.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._cache.reset()}tilesIn(i,l,h){const f=[],y=this.transform;if(!y)return f;for(const x in this._tiles){const E=this._tiles[x];if(h&&E.clearQueryDebugViz(),E.holdingForFade())continue;const S=i.containsTile(E,y,l);S&&f.push(S)}return f}getVisibleCoordinates(i){const l=this.getRenderableIds(i).map(h=>this._tiles[h].tileID);for(const h of l)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(Sf(this._source.type))for(const i in this._tiles){const l=this._tiles[i];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=qi.now())return!0}return!1}setFeatureState(i,l,h){this._state.updateState(i=i||"_geojsonTileLayer",l,h)}removeFeatureState(i,l,h){this._state.removeFeatureState(i=i||"_geojsonTileLayer",l,h)}getFeatureState(i,l){return this._state.getState(i=i||"_geojsonTileLayer",l)}setDependencies(i,l,h){const f=this._tiles[i];f&&f.setDependencies(l,h)}reloadTilesForDependencies(i,l){for(const h in this._tiles)this._tiles[h].hasDependency(i,l)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(i,l))}}function Df(s,i){const l=Math.abs(2*s.wrap)-+(s.wrap<0),h=Math.abs(2*i.wrap)-+(i.wrap<0);return s.overscaledZ-i.overscaledZ||h-l||i.canonical.y-s.canonical.y||i.canonical.x-s.canonical.x}function Sf(s){return"raster"===s||"image"===s||"video"===s}Yc.maxOverzooming=10,Yc.maxUnderzooming=3;class cd{constructor(i,l,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=l,this._offset=h}static create(i,l,h){const f=h||i.findDEMTileFor(l);if(!f||!f.dem)return;const y=f.dem,x=f.tileID,E=1<<l.canonical.z-x.canonical.z;return new cd(f,f.tileSize/qn/E,[(l.canonical.x/E-x.canonical.x)*y.dim,(l.canonical.y/E-x.canonical.y)*y.dim])}tileCoordToPixel(i,l){const h=l*this._scale+this._offset[1],f=Math.floor(i*this._scale+this._offset[0]),y=Math.floor(h);return new Qe(f,y)}getElevationAt(i,l,h,f){const y=i*this._scale+this._offset[0],x=l*this._scale+this._offset[1],E=Math.floor(y),S=Math.floor(x),A=this._dem;return f=!!f,h?et(et(A.get(E,S,f),A.get(E,S+1,f),x-S),et(A.get(E+1,S,f),A.get(E+1,S+1,f),x-S),y-E):A.get(E,S,f)}getElevationAtPixel(i,l,h){return this._dem.get(i,l,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*od(1,i)*this._dem.stride}}class ud{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new V(qn,16,0),this.featureIndexArray=new Zy,this.promoteId=l}insert(i,l,h,f,y,x=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,f,y,x);const S=this.grid;for(let A=0;A<l.length;A++){const R=l[A],F=[1/0,1/0,-1/0,-1/0];for(let z=0;z<R.length;z++){const j=R[z];F[0]=Math.min(F[0],j.x),F[1]=Math.min(F[1],j.y),F[2]=Math.max(F[2],j.x),F[3]=Math.max(F[3],j.y)}F[0]<qn&&F[1]<qn&&F[2]>=0&&F[3]>=0&&S.insert(E,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new el.VectorTile(new ch(this.rawTileData)).layers,this.sourceLayerCoder=new s_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,l,h,f){this.loadVTLayers();const y=i.params||{},x=_s(y.filter),E=i.tileResult,S=i.transform,A=E.bufferedTilespaceBounds,R=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(ee,ne,ue,ye)=>nh(E.bufferedTilespaceGeometry,ee,ne,ue,ye));R.sort(d_);let F=null;S.elevation&&R.length>0&&(F=cd.create(S.elevation,this.tileID));const z={};let j;for(let ee=0;ee<R.length;ee++){const ne=R[ee];if(ne===j)continue;j=ne;const ue=this.featureIndexArray.get(ne);let ye=null;this.loadMatchingFeature(z,ue,x,y.layers,y.availableImages,l,h,f,(Ce,Ie,Pe,ke=0)=>(ye||(ye=Ea(Ce)),Ie.queryIntersectsFeature(E,Ce,Pe,ye,this.z,i.transform,i.pixelPosMatrix,F,ke)))}return z}loadMatchingFeature(i,l,h,f,y,x,E,S,A){const{featureIndex:R,bucketIndex:F,sourceLayerIndex:z,layoutVertexArrayOffset:j}=l,ee=this.bucketLayerIDs[F];if(f&&!function(Ce,Ie){for(let Pe=0;Pe<Ce.length;Pe++)if(Ie.indexOf(Ce[Pe])>=0)return!0;return!1}(f,ee))return;const ne=this.sourceLayerCoder.decode(z),ue=this.vtLayers[ne].feature(R);if(h.needGeometry){const Ce=Cu(ue,!0);if(!h.filter(new Y(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!h.filter(new Y(this.tileID.overscaledZ),ue))return;const ye=this.getId(ue,ne);for(let Ce=0;Ce<ee.length;Ce++){const Ie=ee[Ce];if(f&&f.indexOf(Ie)<0)continue;const Pe=x[Ie];if(!Pe)continue;let ke={};void 0!==ye&&S&&(ke=S.getState(Pe.sourceLayer||"_geojsonTileLayer",ye));const Oe=Ci({},E[Ie]);Oe.paint=h_(Oe.paint,Pe.paint,ue,ke,y),Oe.layout=h_(Oe.layout,Pe.layout,ue,ke,y);const Ue=!A||A(ue,Pe,ke,j);if(!Ue)continue;const Ye=new lm(ue,this.z,this.x,this.y,ye);Ye.layer=Oe;let nt=i[Ie];void 0===nt&&(nt=i[Ie]=[]),nt.push({featureIndex:R,feature:Ye,intersectionZ:Ue})}}lookupSymbolFeatures(i,l,h,f,y,x,E,S){const A={};this.loadVTLayers();const R=_s(y);for(const F of i)this.loadMatchingFeature(A,{bucketIndex:h,sourceLayerIndex:f,featureIndex:F,layoutVertexArrayOffset:0},R,x,E,S,l);return A}hasLayer(i){for(const l of this.bucketLayerIDs)for(const h of l)if(i===h)return!0;return!1}getId(i,l){let h=i.id;return this.promoteId&&(h=i.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]],"boolean"==typeof h&&(h=Number(h))),h}}function h_(s,i,l,h,f){return tn(s,(y,x)=>{const E=i instanceof we?i.get(x):null;return E&&E.evaluate?E.evaluate(l,h,f):E})}function d_(s,i){return i-s}Me("FeatureIndex",ud,{omit:["rawTileData","sourceLayerCoder"]});class Gv{constructor(i){const l={},h=[];for(const E in i){const S=i[E],A=l[E]={};for(const R in S.glyphs){const F=S.glyphs[+R];if(!F||0===F.bitmap.width||0===F.bitmap.height)continue;const z=F.metrics.localGlyph?2:1,j={x:0,y:0,w:F.bitmap.width+2*z,h:F.bitmap.height+2*z};h.push(j),A[R]=j}}const{w:f,h:y}=lf(h),x=new Uc({width:f||1,height:y||1});for(const E in i){const S=i[E];for(const A in S.glyphs){const R=S.glyphs[+A];if(!R||0===R.bitmap.width||0===R.bitmap.height)continue;const F=l[E][A],z=R.metrics.localGlyph?2:1;Uc.copy(R.bitmap,x,{x:0,y:0},{x:F.x+z,y:F.y+z},R.bitmap)}}this.image=x,this.positions=l}}Me("GlyphAtlas",Gv);class f_{constructor(i){this.tileID=new rr(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile}parse(i,l,h,f,y){this.status="parsing",this.data=i,this.collisionBoxArray=new Fc;const x=new s_(Object.keys(i.layers).sort()),E=new ud(this.tileID,this.promoteId);E.bucketLayerIDs=[];const S={},A=new r_(256,256),R={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:A,availableImages:h},F=l.familiesBySource[this.source];for(const ke in F){const Oe=i.layers[ke];if(!Oe)continue;let Ue=!1,Ye=!1;for(const qe of F[ke])"symbol"===qe[0].type?Ue=!0:Ye=!0;if(!0===this.isSymbolTile&&!Ue||!1===this.isSymbolTile&&!Ye)continue;1===Oe.version&&zt(`Vector tile source "${this.source}" layer "${ke}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const nt=x.encode(ke),rt=[];for(let qe=0;qe<Oe.length;qe++){const Ke=Oe.feature(qe),ot=E.getId(Ke,ke);rt.push({feature:Ke,id:ot,index:qe,sourceLayerIndex:nt})}for(const qe of F[ke]){const Ke=qe[0];void 0!==this.isSymbolTile&&"symbol"===Ke.type!==this.isSymbolTile||Ke.minzoom&&this.zoom<Math.floor(Ke.minzoom)||Ke.maxzoom&&this.zoom>=Ke.maxzoom||"none"!==Ke.visibility&&(Mf(qe,this.zoom,h),(S[Ke.id]=Ke.createBucket({index:E.bucketLayerIDs.length,layers:qe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:nt,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(rt,R,this.tileID.canonical),E.bucketLayerIDs.push(qe.map(ot=>ot.id)))}}let z,j,ee,ne;A.trim();const ue={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ye=tn(R.glyphDependencies,ke=>Object.keys(ke).map(Number));Object.keys(ye).length?f.send("getGlyphs",{uid:this.uid,stacks:ye},(ke,Oe)=>{z||(z=ke,j=Oe,Pe.call(this))},void 0,!1,ue):j={};const Ce=Object.keys(R.iconDependencies);Ce.length?f.send("getImages",{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"},(ke,Oe)=>{z||(z=ke,ee=Oe,Pe.call(this))},void 0,!1,ue):ee={};const Ie=Object.keys(R.patternDependencies);function Pe(){if(z)return y(z);if(j&&ee&&ne){const ke=new Gv(j),Oe=new cf(ee,ne);for(const Ue in S){const Ye=S[Ue];Ye instanceof ao?(Mf(Ye.layers,this.zoom,h),Ov(Ye,j,ke.positions,ee,Oe.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):Ye.hasPattern&&(Ye instanceof of||Ye instanceof Zh||Ye instanceof oo)&&(Mf(Ye.layers,this.zoom,h),Ye.addFeatures(R,this.tileID.canonical,Oe.patternPositions))}this.status="done",y(null,{buckets:Pn(S).filter(Ue=>!Ue.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ke.image,lineAtlas:A,imageAtlas:Oe,glyphMap:this.returnDependencies?j:null,iconMap:this.returnDependencies?ee:null,glyphPositions:this.returnDependencies?ke.positions:null})}}Ie.length?f.send("getImages",{icons:Ie,source:this.source,tileID:this.tileID,type:"patterns"},(ke,Oe)=>{z||(z=ke,ne=Oe,Pe.call(this))},void 0,!1,ue):ne={},Pe.call(this)}}function Mf(s,i,l){const h=new Y(i);for(const f of s)f.recalculate(h,l)}class p_{constructor(i){this.entries={},this.scheduler=i}request(i,l,h,f){const y=this.entries[i]=this.entries[i]||{callbacks:[]};if(y.result){const[x,E]=y.result;return this.scheduler?this.scheduler.add(()=>{f(x,E)},l):f(x,E),()=>{}}return y.callbacks.push(f),y.cancel||(y.cancel=h((x,E)=>{y.result=[x,E];for(const S of y.callbacks)this.scheduler?this.scheduler.add(()=>{S(x,E)},l):S(x,E);setTimeout(()=>delete this.entries[i],3e3)})),()=>{y.result||(y.callbacks=y.callbacks.filter(x=>x!==f),y.callbacks.length||(y.cancel(),delete this.entries[i]))}}}function pm(s,i,l){const h=JSON.stringify(s.request);return s.data&&(this.deduped.entries[h]={result:[null,s.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},f=>{const y=$(s.request,(x,E,S,A)=>{x?f(x):E&&f(null,{vectorTile:l?void 0:new el.VectorTile(new ch(E)),rawData:E,cacheControl:S,expires:A})});return()=>{y.cancel(),f()}},i)}p.ARRAY_TYPE=_r,p.AUTH_ERR_MSG=_o,p.Actor=class{constructor(s,i,l){this.target=s,this.parent=i,this.mapId=l,this.callbacks={},this.cancelCallbacks={},ll(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=li()?s:at,this.scheduler=new d1}send(s,i,l,h,f=!1,y){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=y,this.callbacks[x]=l);const E=Ra(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:s,hasCallback:!!l,targetMapId:h,mustQueue:f,sourceMapId:this.mapId,data:un(i,E)},E),{cancel:()=>{l&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(s){const i=s.data,l=i.id;if(l&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){const h=this.cancelCallbacks[l];delete this.cancelCallbacks[l],h&&h.cancel()}else if(i.mustQueue||li()){const h=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,i),h&&h.metadata||{type:"message"})}else this.processTask(l,i)}processTask(s,i){if("<response>"===i.type){const l=this.callbacks[s];delete this.callbacks[s],l&&(i.error?l(ei(i.error)):l(null,ei(i.data)))}else{const l=Ra(this.globalScope)?void 0:[],h=i.hasCallback?(y,x)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:y?un(y):null,data:un(x,l)},l)}:y=>{},f=ei(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,f,h);else if(this.parent.getWorkerSource){const y=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,y[0],f.source)[y[1]](f,h)}else h(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},p.CanonicalTileID=o_,p.Color=$t,p.ColorMode=xs,p.CullFaceMode=Ma,p.DEMData=Tf,p.DataConstantProperty=ce,p.DedupedRequest=p_,p.DepthMode=nl,p.EXTENT=qn,p.Elevation=class{getAtPointOrZero(s,i=0){return this.getAtPoint(s,i)||0}getAtPoint(s,i,l=!0){null==i&&(i=null);const h=this._source();if(!h||s.y<0||s.y>1)return i;const f=h.getSource().maxzoom,y=1<<f,x=Math.floor(s.x),E=s.x-x,S=new rr(f,x,f,Math.floor(E*y),Math.floor(s.y*y)),A=this.findDEMTileFor(S);if(!A||!A.dem)return i;const R=A.dem,F=1<<A.tileID.canonical.z,z=(E*F-A.tileID.canonical.x)*R.dim,j=(s.y*F-A.tileID.canonical.y)*R.dim,ee=Math.floor(z),ne=Math.floor(j);return(l?this.exaggeration():1)*et(et(R.get(ee,ne),R.get(ee,ne+1),j-ne),et(R.get(ee+1,ne),R.get(ee+1,ne+1),j-ne),z-ee)}getAtTileOffset(s,i,l){const h=1<<s.canonical.z;return this.getAtPointOrZero(new sd(s.wrap+(s.canonical.x+i/qn)/h,(s.canonical.y+l/qn)/h))}getForTilePoints(s,i,l,h){const f=cd.create(this,s,h);return!!f&&(i.forEach(y=>{y[2]=this.exaggeration()*f.getElevationAt(y[0],y[1],l)}),!0)}getMinMaxForTile(s){const i=this.findDEMTileFor(s);if(!i||!i.dem)return null;const l=i.dem.tree,h=i.tileID,f=1<<s.canonical.z-h.canonical.z;let y=s.canonical.x/f-h.canonical.x,x=s.canonical.y/f-h.canonical.y,E=0;for(let S=0;S<s.canonical.z-h.canonical.z&&!l.leaves[E];S++){y*=2,x*=2;const A=2*Math.floor(x)+Math.floor(y);E=l.childOffsets[E]+A,y%=1,x%=1}return{min:this.exaggeration()*l.minimums[E],max:this.exaggeration()*l.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,i,l){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},p.ErrorEvent=He,p.EvaluationParameters=Y,p.Event=it,p.Evented=xt,p.GlyphManager=ku,p.ImagePosition=$p,p.LineAtlas=r_,p.LngLat=Vi,p.LngLatBounds=Wc,p.LocalGlyphMode=td,p.MAX_SAFE_INTEGER=po,p.MercatorCoordinate=sd,p.ONE_EM=24,p.OverscaledTileID=rr,p.Properties=ze,p.RGBAImage=js,p.RequestManager=class{constructor(s,i,l){this._transformRequestFn=s,this._customAccessToken=i,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const s=function(){let i="";for(let l=0;l<10;l++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Oa,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeStyleURL(s,i){if(!Nn(s))return s;const l=yo(s);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||i)}normalizeGlyphsURL(s,i){if(!Nn(s))return s;const l=yo(s);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||i)}normalizeSourceURL(s,i){if(!Nn(s))return s;const l=yo(s);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||i)}normalizeSpriteURL(s,i,l,h){const f=yo(s);return Nn(s)?(f.path=`/styles/v1${f.path}/sprite${i}${l}`,this._makeAPIURL(f,this._customAccessToken||h)):(f.path+=`${i}${l}`,Xr(f))}normalizeTileURL(s,i,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Nn(s))return s;const h=yo(s);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||l&&"raster"!==h.authority&&512===l?"@2x":""}${qo.supported?".webp":"$1"}`),"raster"===h.authority?h.path=`/${Mn.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${Mn.TILE_URL_VERSION}${h.path}`);const f=this._customAccessToken||function(y){for(const x of y){const E=x.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(h.params)||Mn.ACCESS_TOKEN;return Mn.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,f)}canonicalizeTileURL(s,i){const l=yo(s);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return s;let h="mapbox://";l.path.match(/^\/raster\/v1\//)?h+=`raster/${l.path.replace(`/${Mn.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${l.path.replace(`/${Mn.TILE_URL_VERSION}/`,"")}`;let f=l.params;return i&&(f=f.filter(y=>!y.match(/^access_token=/))),f.length&&(h+=`?${f.join("&")}`),h}canonicalizeTileset(s,i){const l=!!i&&Nn(i),h=[];for(const f of s.tiles||[])na(f)?h.push(this.canonicalizeTileURL(f,l)):h.push(f);return h}_makeAPIURL(s,i){const l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",h=yo(Mn.API_URL);if(s.protocol=h.protocol,s.authority=h.authority,"http"===s.protocol){const f=s.params.indexOf("secure");f>=0&&s.params.splice(f,1)}if("/"!==h.path&&(s.path=`${h.path}${s.path}`),!Mn.REQUIRE_ACCESS_TOKEN)return Xr(s);if(i=i||Mn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return s.params=s.params.filter(f=>-1===f.indexOf("access_token")),s.params.push(`access_token=${i||""}`),Xr(s)}},p.ResourceType=Tr,p.SegmentVector=Pr,p.SourceCache=Yc,p.StencilMode=Xc,p.StructArrayLayout1ui2=Vo,p.StructArrayLayout2f1f2i16=Vs,p.StructArrayLayout2i4=kt,p.StructArrayLayout2ui4=Ki,p.StructArrayLayout3f12=Zt,p.StructArrayLayout3ui6=pn,p.StructArrayLayout4i8=Mi,p.Texture=Cf,p.Tile=um,p.Transitionable=pe,p.Uniform1f=Us,p.Uniform1i=class extends Gr{constructor(s,i){super(s,i),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},p.Uniform2f=class extends Gr{constructor(s,i){super(s,i),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},p.Uniform3f=class extends Gr{constructor(s,i){super(s,i),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},p.Uniform4f=Rh,p.UniformColor=Nc,p.UniformMatrix3f=class extends Gr{constructor(s,i){super(s,i),this.current=fg}set(s){for(let i=0;i<9;i++)if(s[i]!==this.current[i]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}},p.UniformMatrix4f=class extends Gr{constructor(s,i){super(s,i),this.current=zc}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let i=1;i<16;i++)if(s[i]!==this.current[i]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},p.UnwrappedTileID=$v,p.ValidationError=Ne,p.VectorTileWorkerSource=class extends xt{constructor(s,i,l,h,f){super(),this.actor=s,this.layerIndex=i,this.availableImages=l,this.loadVectorData=f||pm,this.loading={},this.loaded={},this.deduped=new p_(s.scheduler),this.isSpriteLoaded=h,this.scheduler=s.scheduler}loadTile(s,i){const l=s.uid,h=s&&s.request,f=h&&h.collectResourceTiming,y=this.loading[l]=new f_(s);y.abort=this.loadVectorData(s,(x,E)=>{const S=!this.loading[l];if(delete this.loading[l],S||x||!E)return y.status="done",S||(this.loaded[l]=y),i(x);const A=E.rawData,R={};E.expires&&(R.expires=E.expires),E.cacheControl&&(R.cacheControl=E.cacheControl),y.vectorTile=E.vectorTile||new el.VectorTile(new ch(A));const F=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,j)=>{if(z||!j)return i(z);const ee={};if(f){const ne=Uv(h);ne.length>0&&(ee.resourceTiming=JSON.parse(JSON.stringify(ne)))}i(null,Ci({rawTileData:A.slice(0)},j,R,ee))})};this.isSpriteLoaded?F():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(F,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):F()}),this.loaded=this.loaded||{},this.loaded[l]=y})}reloadTile(s,i){const l=this.loaded,h=s.uid,f=this;if(l&&l[h]){const y=l[h];y.showCollisionBoxes=s.showCollisionBoxes,y.enableTerrain=!!s.enableTerrain;const x=(E,S)=>{const A=y.reloadCallback;A&&(delete y.reloadCallback,y.parse(y.vectorTile,f.layerIndex,this.availableImages,f.actor,A)),i(E,S)};"parsing"===y.status?y.reloadCallback=x:"done"===y.status&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(s,i){const l=s.uid,h=this.loading[l];h&&(h.abort&&h.abort(),delete this.loading[l]),i()}removeTile(s,i){const l=this.loaded,h=s.uid;l&&l[h]&&delete l[h],i()}},p.WritingMode=Gs,p.ZoomHistory=pr,p.add=function(s,i,l){return s[0]=i[0]+l[0],s[1]=i[1]+l[1],s[2]=i[2]+l[2],s},p.addDynamicAttributes=Xt,p.altitudeFromMercatorZ=i_,p.asyncAll=al,p.bezier=ar,p.bindAll=ll,p.bufferConvexPolygon=function(s,i){const l=[];for(let h=0;h<s.length;h++){const f=as(h-1,-1,s.length-1),y=as(h+1,-1,s.length-1),x=s[h],E=s[y],S=s[f].sub(x).unit(),A=E.sub(x).unit(),R=A.angleWithSep(S.x,S.y),F=S.add(A).unit().mult(-1*i/Math.sin(R/2));l.push(x.add(F))}return l},p.cacheEntryPossiblyAdded=function(s){Bt++,Bt>Kr&&(s.getActor().send("enforceCacheSizeLimit",Xo),Bt=0)},p.clamp=gi,p.clearTileCache=function(s){const i=at.caches.delete(Wo);s&&i.catch(s).then(()=>s())},p.clipLine=Kp,p.clone=function(s){var i=new _r(3);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i},p.clone$1=function(s){var i=new _r(16);return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],i},p.clone$2=ni,p.collisionCircleLayout=Av,p.config=Mn,p.conjugate=function(s,i){return s[0]=-i[0],s[1]=-i[1],s[2]=-i[2],s[3]=i[3],s},p.copy=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s},p.create=Bh,p.create$1=function(){var s=new _r(16);return _r!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},p.create$2=gg,p.createExpression=hr,p.createFilter=_s,p.createLayout=ft,p.createStyleLayer=function(s){return"custom"===s.type?new im(s):new c1[s.type](s)},p.cross=function(s,i,l){var h=i[0],f=i[1],y=i[2],x=l[0],E=l[1],S=l[2];return s[0]=f*S-y*E,s[1]=y*x-h*S,s[2]=h*E-f*x,s},p.degToRad=In,p.div=function(s,i,l){return s[0]=i[0]/l[0],s[1]=i[1]/l[1],s[2]=i[2]/l[2],s},p.dot=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]},p.dot$1=function(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]+s[3]*i[3]},p.ease=Po,p.easeCubicInOut=sl,p.emitValidationErrors=P,p.endsWith=_i,p.enforceCacheSizeLimit=function(s){Ft(),Ro&&Ro.then(i=>{i.keys().then(l=>{for(let h=0;h<l.length-s;h++)i.delete(l[h])})})},p.evaluateSizeForFeature=af,p.evaluateSizeForZoom=nc,p.evaluateVariableOffset=Kg,p.evented=B,p.exactEquals=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]&&s[3]===i[3]},p.exactEquals$1=function(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]},p.exported=qi,p.exported$1=qo,p.extend=Ci,p.filterObject=Dt,p.fromMat4=function(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[4],s[4]=i[5],s[5]=i[6],s[6]=i[8],s[7]=i[9],s[8]=i[10],s},p.fromQuat=function(s,i){var l=i[0],h=i[1],f=i[2],y=i[3],x=l+l,E=h+h,S=f+f,A=l*x,R=h*x,F=h*E,z=f*x,j=f*E,ee=f*S,ne=y*x,ue=y*E,ye=y*S;return s[0]=1-F-ee,s[1]=R+ye,s[2]=z-ue,s[3]=0,s[4]=R-ye,s[5]=1-A-ee,s[6]=j+ne,s[7]=0,s[8]=z+ue,s[9]=j-ne,s[10]=1-A-F,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},p.fromRotation=function(s,i){var l=Math.sin(i),h=Math.cos(i);return s[0]=h,s[1]=l,s[2]=0,s[3]=-l,s[4]=h,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},p.fromScaling=function(s,i){return s[0]=i[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},p.furthestTileCorner=function(s){const i=Math.round((s+45+360)%360/90)%4;return Ol[i]},p.getAABBPointSquareDist=function(s,i,l){let h=0;for(let f=0;f<2;++f){const y=l?l[f]:0;s[f]>y&&(h+=(s[f]-y)*(s[f]-y)),i[f]<y&&(h+=(y-i[f])*(y-i[f]))}return h},p.getAnchorAlignment=ff,p.getAnchorJustification=Zs,p.getBounds=function(s){let i=1/0,l=1/0,h=-1/0,f=-1/0;for(const y of s)i=Math.min(i,y.x),l=Math.min(l,y.y),h=Math.max(h,y.x),f=Math.max(f,y.y);return{min:new Qe(i,l),max:new Qe(h,f)}},p.getImage=be,p.getJSON=function(s,i){return Q(Ci(s,{type:"json"}),i)},p.getMapSessionAPI=bc,p.getPerformanceMeasurement=Uv,p.getRTLTextPluginStatus=U,p.getReferrer=yn,p.getVideo=function(s,i){const l=at.document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let h=0;h<s.length;h++){const f=at.document.createElement("source");le(s[h])||(l.crossOrigin="Anonymous"),f.src=s[h],l.appendChild(f)}return{cancel:()=>{}}},p.identity=Gd,p.identity$1=Wd,p.invert=function(s,i){var l=i[0],h=i[1],f=i[2],y=i[3],x=i[4],E=i[5],S=i[6],A=i[7],R=i[8],F=i[9],z=i[10],j=i[11],ee=i[12],ne=i[13],ue=i[14],ye=i[15],Ce=l*E-h*x,Ie=l*S-f*x,Pe=l*A-y*x,ke=h*S-f*E,Oe=h*A-y*E,Ue=f*A-y*S,Ye=R*ne-F*ee,nt=R*ue-z*ee,rt=R*ye-j*ee,qe=F*ue-z*ne,Ke=F*ye-j*ne,ot=z*ye-j*ue,Xe=Ce*ot-Ie*Ke+Pe*qe+ke*rt-Oe*nt+Ue*Ye;return Xe?(s[0]=(E*ot-S*Ke+A*qe)*(Xe=1/Xe),s[1]=(f*Ke-h*ot-y*qe)*Xe,s[2]=(ne*Ue-ue*Oe+ye*ke)*Xe,s[3]=(z*Oe-F*Ue-j*ke)*Xe,s[4]=(S*rt-x*ot-A*nt)*Xe,s[5]=(l*ot-f*rt+y*nt)*Xe,s[6]=(ue*Pe-ee*Ue-ye*Ie)*Xe,s[7]=(R*Ue-z*Pe+j*Ie)*Xe,s[8]=(x*Ke-E*rt+A*Ye)*Xe,s[9]=(h*rt-l*Ke-y*Ye)*Xe,s[10]=(ee*Oe-ne*Pe+ye*Ce)*Xe,s[11]=(F*Pe-R*Oe-j*Ce)*Xe,s[12]=(E*nt-x*qe-S*Ye)*Xe,s[13]=(l*qe-h*nt+f*Ye)*Xe,s[14]=(ne*Ie-ee*ke-ue*Ce)*Xe,s[15]=(R*ke-F*Ie+z*Ce)*Xe,s):null},p.isMapAuthenticated=function(s){return lr.has(s)},p.isMapboxURL=Nn,p.latFromMercatorY=am,p.len=rv,p.length=_g,p.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},p.loadVectorTile=pm,p.makeRequest=Q,p.mercatorXfromLng=sm,p.mercatorYfromLat=n_,p.mercatorZfromAltitude=od,p.mul=function(s,i,l){return s[0]=i[0]*l[0],s[1]=i[1]*l[1],s[2]=i[2]*l[2],s[3]=i[3]*l[3],s},p.mul$1=qd,p.mul$2=iv,p.multiply=Zd,p.multiply$1=rh,p.nextPowerOfTwo=ka,p.normalize=nv,p.normalize$1=function(s,i){var l=i[0],h=i[1],f=i[2],y=i[3],x=l*l+h*h+f*f+y*y;return x>0&&(x=1/Math.sqrt(x)),s[0]=l*x,s[1]=h*x,s[2]=f*x,s[3]=y*x,s},p.number=et,p.ortho=function(s,i,l,h,f,y,x){var E=1/(i-l),S=1/(h-f),A=1/(y-x);return s[0]=-2*E,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*S,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*A,s[11]=0,s[12]=(i+l)*E,s[13]=(f+h)*S,s[14]=(x+y)*A,s[15]=1,s},p.pbf=ch,p.perspective=function(s,i,l,h,f){var y,x=1/Math.tan(i/2);return s[0]=x/l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=f&&f!==1/0?(s[10]=(f+h)*(y=1/(h-f)),s[14]=2*f*h*y):(s[10]=-1,s[14]=-2*h),s},p.pick=function(s,i){const l={};for(let h=0;h<i.length;h++){const f=i[h];f in s&&(l[f]=s[f])}return l},p.plugin=X,p.pointGeometry=Qe,p.polygonIntersectsBox=nh,p.polygonIntersectsPolygon=jd,p.polygonizeBounds=function(s,i,l=0,h=!0){const f=new Qe(l,l),y=s.sub(f),x=i.add(f),E=[y,new Qe(x.x,y.y),x,new Qe(y.x,x.y)];return h&&E.push(y),E},p.posAttributes=cm,p.postMapLoadEvent=oa,p.postTurnstileEvent=Fl,p.potpack=lf,p.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},p.radToDeg=function(s){return s*Yn},p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.registerForPluginStateChange=function(s){return s({pluginStatus:C,pluginURL:M}),B.on("pluginStateChange",s),s},p.removeAuthState=function(s){lr.delete(s)},p.renderColorRamp=Cp,p.rotateX=function(s,i,l){var h=Math.sin(l),f=Math.cos(l),y=i[4],x=i[5],E=i[6],S=i[7],A=i[8],R=i[9],F=i[10],z=i[11];return i!==s&&(s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[4]=y*f+A*h,s[5]=x*f+R*h,s[6]=E*f+F*h,s[7]=S*f+z*h,s[8]=A*f-y*h,s[9]=R*f-x*h,s[10]=F*f-E*h,s[11]=z*f-S*h,s},p.rotateX$1=Su,p.rotateY=function(s,i,l){var h=Math.sin(l),f=Math.cos(l),y=i[0],x=i[1],E=i[2],S=i[3],A=i[8],R=i[9],F=i[10],z=i[11];return i!==s&&(s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=y*f-A*h,s[1]=x*f-R*h,s[2]=E*f-F*h,s[3]=S*f-z*h,s[8]=y*h+A*f,s[9]=x*h+R*f,s[10]=E*h+F*f,s[11]=S*h+z*f,s},p.rotateZ=function(s,i,l){var h=Math.sin(l),f=Math.cos(l),y=i[0],x=i[1],E=i[2],S=i[3],A=i[4],R=i[5],F=i[6],z=i[7];return i!==s&&(s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15]),s[0]=y*f+A*h,s[1]=x*f+R*h,s[2]=E*f+F*h,s[3]=S*f+z*h,s[4]=A*f-y*h,s[5]=R*f-x*h,s[6]=F*f-E*h,s[7]=z*f-S*h,s},p.rotateZ$1=function(s,i,l){l*=.5;var h=i[0],f=i[1],y=i[2],x=i[3],E=Math.sin(l),S=Math.cos(l);return s[0]=h*S+f*E,s[1]=f*S-h*E,s[2]=y*S+x*E,s[3]=x*S-y*E,s},p.scale=function(s,i,l){return s[0]=i[0]*l,s[1]=i[1]*l,s[2]=i[2]*l,s},p.scale$1=function(s,i,l){var h=l[0],f=l[1],y=l[2];return s[0]=i[0]*h,s[1]=i[1]*h,s[2]=i[2]*h,s[3]=i[3]*h,s[4]=i[4]*f,s[5]=i[5]*f,s[6]=i[6]*f,s[7]=i[7]*f,s[8]=i[8]*y,s[9]=i[9]*y,s[10]=i[10]*y,s[11]=i[11]*y,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],s},p.scale$2=function(s,i,l){return s[0]=i[0]*l,s[1]=i[1]*l,s[2]=i[2]*l,s[3]=i[3]*l,s},p.scaleAndAdd=yg,p.setCacheLimits=function(s,i){Xo=s,Kr=i},p.setRTLTextPlugin=function(s,i,l=!1){if(C===o||C===d||C===_)throw new Error("setRTLTextPlugin cannot be called multiple times.");M=qi.resolveURL(s),C=o,w=i,O(),l||q()},p.smoothstep=function(s,i,l){return(l=gi((l-s)/(i-s),0,1))*l*(3-2*l)},p.spec=xe,p.storeAuthState=function(s,i){i?lr.add(s):lr.delete(s)},p.sub=t1,p.subtract=Du,p.symbolSize=Da,p.transformMat3=function(s,i,l){var h=i[0],f=i[1],y=i[2];return s[0]=h*l[0]+f*l[3]+y*l[6],s[1]=h*l[1]+f*l[4]+y*l[7],s[2]=h*l[2]+f*l[5]+y*l[8],s},p.transformMat4=Uh,p.transformMat4$1=function(s,i,l){var h=i[0],f=i[1],y=i[2],x=l[3]*h+l[7]*f+l[11]*y+l[15];return s[0]=(l[0]*h+l[4]*f+l[8]*y+l[12])/(x=x||1),s[1]=(l[1]*h+l[5]*f+l[9]*y+l[13])/x,s[2]=(l[2]*h+l[6]*f+l[10]*y+l[14])/x,s},p.transformQuat=vp,p.translate=function(s,i,l){var h,f,y,x,E,S,A,R,F,z,j,ee,ne=l[0],ue=l[1],ye=l[2];return i===s?(s[12]=i[0]*ne+i[4]*ue+i[8]*ye+i[12],s[13]=i[1]*ne+i[5]*ue+i[9]*ye+i[13],s[14]=i[2]*ne+i[6]*ue+i[10]*ye+i[14],s[15]=i[3]*ne+i[7]*ue+i[11]*ye+i[15]):(f=i[1],y=i[2],x=i[3],E=i[4],S=i[5],A=i[6],R=i[7],F=i[8],z=i[9],j=i[10],ee=i[11],s[0]=h=i[0],s[1]=f,s[2]=y,s[3]=x,s[4]=E,s[5]=S,s[6]=A,s[7]=R,s[8]=F,s[9]=z,s[10]=j,s[11]=ee,s[12]=h*ne+E*ue+F*ye+i[12],s[13]=f*ne+S*ue+z*ye+i[13],s[14]=y*ne+A*ue+j*ye+i[14],s[15]=x*ne+R*ue+ee*ye+i[15]),s},p.triggerPluginCompletionEvent=k,p.uniqueId=si,p.validateCustomStyleLayer=function(s){const i=[],l=s.id;return void 0===l&&i.push({message:`layers.${l}: missing required property "id"`}),void 0===s.render&&i.push({message:`layers.${l}: missing required method "render"`}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},p.validateFog=c,p.validateLight=mu,p.validateStyle=qa,p.values=Pn,p.vectorTile=el,p.version="2.5.1",p.warnOnce=zt,p.window=at,p.wrap=as}),Hn(0,function(p){function zr(Q){const $=typeof Q;if("number"===$||"boolean"===$||"string"===$||null==Q)return JSON.stringify(Q);if(Array.isArray(Q)){let le="[";for(const ge of Q)le+=`${zr(ge)},`;return`${le}]`}const W=Object.keys(Q).sort();let re="{";for(let le=0;le<W.length;le++)re+=`${JSON.stringify(W[le])}:${zr(Q[W[le]])},`;return`${re}}`}function Qt(Q){let $="";for(const W of p.refProperties)$+=`/${zr(Q[W])}`;return $}class Cr{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,W){for(const le of $){this._layerConfigs[le.id]=le;const ge=this._layers[le.id]=p.createStyleLayer(le);ge._featureFilter=p.createFilter(ge.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of W)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const re=function(le,ge){const ve={};for(let be=0;be<le.length;be++){const Ae=ge&&ge[le[be].id]||Qt(le[be]);ge&&(ge[le[be].id]=Ae);let Ge=ve[Ae];Ge||(Ge=ve[Ae]=[]),Ge.push(le[be])}const Ee=[];for(const be in ve)Ee.push(ve[be]);return Ee}(p.values(this._layerConfigs),this.keyCache);for(const le of re){const ge=le.map(it=>this._layers[it.id]),ve=ge[0];if("none"===ve.visibility)continue;const Ee=ve.source||"";let be=this.familiesBySource[Ee];be||(be=this.familiesBySource[Ee]={});const Ae=ve.sourceLayer||"_geojsonTileLayer";let Ge=be[Ae];Ge||(Ge=be[Ae]=[]),Ge.push(ge)}}}const{ImageBitmap:Qe}=p.window;class $e{loadTile($,W){const{uid:re,encoding:le,rawImageData:ge,padding:ve,buildQuadTree:Ee}=$,be=Qe&&ge instanceof Qe?this.getImageData(ge,ve):ge;W(null,new p.DEMData(re,be,le,ve<1,Ee))}getImageData($,W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const re=this.offscreenCanvasContext.getImageData(-W,-W,$.width+2*W,$.height+2*W);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new p.RGBAImage({width:re.width,height:re.height},re.data)}}var at=function Q($,W){var re,le=$&&$.type;if("FeatureCollection"===le)for(re=0;re<$.features.length;re++)Q($.features[re],W);else if("GeometryCollection"===le)for(re=0;re<$.geometries.length;re++)Q($.geometries[re],W);else if("Feature"===le)Q($.geometry,W);else if("Polygon"===le)po($.coordinates,W);else if("MultiPolygon"===le)for(re=0;re<$.coordinates.length;re++)po($.coordinates[re],W);return $};function po(Q,$){if(0!==Q.length){mo(Q[0],$);for(var W=1;W<Q.length;W++)mo(Q[W],!$)}}function mo(Q,$){for(var W=0,re=0,le=Q.length,ge=le-1;re<le;ge=re++)W+=(Q[re][0]-Q[ge][0])*(Q[ge][1]+Q[re][1]);W>=0!=!!$&&Q.reverse()}const Yn=p.vectorTile.VectorTileFeature.prototype.toGeoJSON;class In{constructor($){this._feature=$,this.extent=p.EXTENT,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(1===this._feature.type){const $=[];for(const W of this._feature.geometry)$.push([new p.pointGeometry(W[0],W[1])]);return $}{const $=[];for(const W of this._feature.geometry){const re=[];for(const le of W)re.push(new p.pointGeometry(le[0],le[1]));$.push(re)}return $}}toGeoJSON($,W,re){return Yn.call(this,$,W,re)}}class Ol{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=$.length,this._features=$}feature($){return new In(this._features[$])}}var sl=p.vectorTile.VectorTileFeature,ar=Po;function Po(Q,$){this.options=$||{},this.features=Q,this.length=Q.length}function gi(Q,$){this.id="number"==typeof Q.id?Q.id:void 0,this.type=Q.type,this.rawGeometry=1===Q.type?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=$||4096}Po.prototype.feature=function(Q){return new gi(this.features[Q],this.options.extent)},gi.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var $=0;$<Q.length;$++){for(var W=Q[$],re=[],le=0;le<W.length;le++)re.push(new p.pointGeometry(W[le][0],W[le][1]));this.geometry.push(re)}return this.geometry},gi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,$=1/0,W=-1/0,re=1/0,le=-1/0,ge=0;ge<Q.length;ge++)for(var ve=Q[ge],Ee=0;Ee<ve.length;Ee++){var be=ve[Ee];$=Math.min($,be.x),W=Math.max(W,be.x),re=Math.min(re,be.y),le=Math.max(le,be.y)}return[$,re,W,le]},gi.prototype.toGeoJSON=sl.prototype.toGeoJSON;var as=Pn,al=ar;function Pn(Q){var $=new p.pbf;return function(W,re){for(var le in W.layers)re.writeMessage(3,Ci,W.layers[le])}(Q,$),$.finish()}function Ci(Q,$){var W;$.writeVarintField(15,Q.version||1),$.writeStringField(1,Q.name||""),$.writeVarintField(5,Q.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<Q.length;W++)re.feature=Q.feature(W),$.writeMessage(2,uu,re);var le=re.keys;for(W=0;W<le.length;W++)$.writeStringField(3,le[W]);var ge=re.values;for(W=0;W<ge.length;W++)$.writeMessage(4,ll,ge[W])}function uu(Q,$){var W=Q.feature;void 0!==W.id&&$.writeVarintField(1,W.id),$.writeMessage(2,si,Q),$.writeVarintField(3,W.type),$.writeMessage(4,Pi,W)}function si(Q,$){var W=Q.feature,re=Q.keys,le=Q.values,ge=Q.keycache,ve=Q.valuecache;for(var Ee in W.properties){var be=ge[Ee];void 0===be&&(re.push(Ee),ge[Ee]=be=re.length-1),$.writeVarint(be);var Ae=W.properties[Ee],Ge=typeof Ae;"string"!==Ge&&"boolean"!==Ge&&"number"!==Ge&&(Ae=JSON.stringify(Ae));var it=Ge+":"+Ae,He=ve[it];void 0===He&&(le.push(Ae),ve[it]=He=le.length-1),$.writeVarint(He)}}function Zi(Q,$){return($<<3)+(7&Q)}function ka(Q){return Q<<1^Q>>31}function Pi(Q,$){for(var W=Q.loadGeometry(),re=Q.type,le=0,ge=0,ve=W.length,Ee=0;Ee<ve;Ee++){var be=W[Ee],Ae=1;1===re&&(Ae=be.length),$.writeVarint(Zi(1,Ae));for(var Ge=3===re?be.length-1:be.length,it=0;it<Ge;it++){1===it&&1!==re&&$.writeVarint(Zi(2,Ge-1));var He=be[it].x-le,xt=be[it].y-ge;$.writeVarint(ka(He)),$.writeVarint(ka(xt)),le+=He,ge+=xt}3===re&&$.writeVarint(Zi(7,1))}}function ll(Q,$){var W=typeof Q;"string"===W?$.writeStringField(1,Q):"boolean"===W?$.writeBooleanField(7,Q):"number"===W&&(Q%1!=0?$.writeDoubleField(3,Q):Q<0?$.writeSVarintField(6,Q):$.writeVarintField(5,Q))}function _i(Q,$,W,re,le,ge){if(le-re<=W)return;const ve=re+le>>1;tn(Q,$,ve,re,le,ge%2),_i(Q,$,W,re,ve-1,ge+1),_i(Q,$,W,ve+1,le,ge+1)}function tn(Q,$,W,re,le,ge){for(;le>re;){if(le-re>600){const Ae=le-re+1,Ge=W-re+1,it=Math.log(Ae),He=.5*Math.exp(2*it/3),xt=.5*Math.sqrt(it*He*(Ae-He)/Ae)*(Ge-Ae/2<0?-1:1);tn(Q,$,W,Math.max(re,Math.floor(W-Ge*He/Ae+xt)),Math.min(le,Math.floor(W+(Ae-Ge)*He/Ae+xt)),ge)}const ve=$[2*W+ge];let Ee=re,be=le;for(Dt(Q,$,re,W),$[2*le+ge]>ve&&Dt(Q,$,re,le);Ee<be;){for(Dt(Q,$,Ee,be),Ee++,be--;$[2*Ee+ge]<ve;)Ee++;for(;$[2*be+ge]>ve;)be--}$[2*re+ge]===ve?Dt(Q,$,re,be):(be++,Dt(Q,$,be,le)),be<=W&&(re=be+1),W<=be&&(le=be-1)}}function Dt(Q,$,W,re){ni(Q,W,re),ni($,2*W,2*re),ni($,2*W+1,2*re+1)}function ni(Q,$,W){const re=Q[$];Q[$]=Q[W],Q[W]=re}function nn(Q,$,W,re){const le=Q-W,ge=$-re;return le*le+ge*ge}as.fromVectorTileJs=Pn,as.fromGeojsonVt=function(Q,$){$=$||{};var W={};for(var re in Q)W[re]=new ar(Q[re].features,$),W[re].name=re,W[re].version=$.version,W[re].extent=$.extent;return Pn({layers:W})},as.GeoJSONWrapper=al;const zt=Q=>Q[0],ki=Q=>Q[1];class Ri{constructor($,W=zt,re=ki,le=64,ge=Float64Array){this.nodeSize=le,this.points=$;const ve=$.length<65536?Uint16Array:Uint32Array,Ee=this.ids=new ve($.length),be=this.coords=new ge(2*$.length);for(let Ae=0;Ae<$.length;Ae++)Ee[Ae]=Ae,be[2*Ae]=W($[Ae]),be[2*Ae+1]=re($[Ae]);_i(Ee,be,le,0,Ee.length-1,0)}range($,W,re,le){return function(ge,ve,Ee,be,Ae,Ge,it){const He=[0,ge.length-1,0],xt=[];let xe,Ne;for(;He.length;){const vt=He.pop(),qt=He.pop(),Nt=He.pop();if(qt-Nt<=it){for(let kn=Nt;kn<=qt;kn++)xe=ve[2*kn],Ne=ve[2*kn+1],xe>=Ee&&xe<=Ae&&Ne>=be&&Ne<=Ge&&xt.push(ge[kn]);continue}const vn=Math.floor((Nt+qt)/2);xe=ve[2*vn],Ne=ve[2*vn+1],xe>=Ee&&xe<=Ae&&Ne>=be&&Ne<=Ge&&xt.push(ge[vn]);const rn=(vt+1)%2;(0===vt?Ee<=xe:be<=Ne)&&(He.push(Nt),He.push(vn-1),He.push(rn)),(0===vt?Ae>=xe:Ge>=Ne)&&(He.push(vn+1),He.push(qt),He.push(rn))}return xt}(this.ids,this.coords,$,W,re,le,this.nodeSize)}within($,W,re){return function(le,ge,ve,Ee,be,Ae){const Ge=[0,le.length-1,0],it=[],He=be*be;for(;Ge.length;){const xt=Ge.pop(),xe=Ge.pop(),Ne=Ge.pop();if(xe-Ne<=Ae){for(let rn=Ne;rn<=xe;rn++)nn(ge[2*rn],ge[2*rn+1],ve,Ee)<=He&&it.push(le[rn]);continue}const vt=Math.floor((Ne+xe)/2),qt=ge[2*vt],Nt=ge[2*vt+1];nn(qt,Nt,ve,Ee)<=He&&it.push(le[vt]);const vn=(xt+1)%2;(0===xt?ve-be<=qt:Ee-be<=Nt)&&(Ge.push(Ne),Ge.push(vt-1),Ge.push(vn)),(0===xt?ve+be>=qt:Ee+be>=Nt)&&(Ge.push(vt+1),Ge.push(xe),Ge.push(vn))}return it}(this.ids,this.coords,$,W,re,this.nodeSize)}}const li={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Q=>Q},Sn=Math.fround||(Gn=new Float32Array(1),Q=>(Gn[0]=+Q,Gn[0]));var Gn;class jt{constructor($){this.options=qo(Object.create(li),$),this.trees=new Array(this.options.maxZoom+1)}load($){const{log:W,minZoom:re,maxZoom:le,nodeSize:ge}=this.options;W&&console.time("total time");const ve=`prepare ${$.length} points`;W&&console.time(ve),this.points=$;let Ee=[];for(let be=0;be<$.length;be++)$[be].geometry&&Ee.push(ea($[be],be));this.trees[le+1]=new Ri(Ee,As,Jn,ge,Float32Array),W&&console.timeEnd(ve);for(let be=le;be>=re;be--){const Ae=+Date.now();Ee=this._cluster(Ee,be),this.trees[be]=new Ri(Ee,As,Jn,ge,Float32Array),W&&console.log("z%d: %d clusters in %dms",be,Ee.length,+Date.now()-Ae)}return W&&console.timeEnd("total time"),this}getClusters($,W){let re=(($[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,$[1]));let ge=180===$[2]?180:(($[2]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)re=-180,ge=180;else if(re>ge){const Ge=this.getClusters([re,le,180,ve],W),it=this.getClusters([-180,le,ge,ve],W);return Ge.concat(it)}const Ee=this.trees[this._limitZoom(W)],be=Ee.range(qi(re),Zo(ve),qi(ge),Zo(le)),Ae=[];for(const Ge of be){const it=Ee.points[Ge];Ae.push(it.numPoints?Ra(it):this.points[it.index])}return Ae}getChildren($){const W=this._getOriginId($),re=this._getOriginZoom($),le="No cluster with the specified id.",ge=this.trees[re];if(!ge)throw new Error(le);const ve=ge.points[W];if(!ve)throw new Error(le);const Ee=this.options.radius/(this.options.extent*Math.pow(2,re-1)),be=ge.within(ve.x,ve.y,Ee),Ae=[];for(const Ge of be){const it=ge.points[Ge];it.parentId===$&&Ae.push(it.numPoints?Ra(it):this.points[it.index])}if(0===Ae.length)throw new Error(le);return Ae}getLeaves($,W,re){const le=[];return this._appendLeaves(le,$,W=W||10,re=re||0,0),le}getTile($,W,re){const le=this.trees[this._limitZoom($)],ge=Math.pow(2,$),{extent:ve,radius:Ee}=this.options,be=Ee/ve,Ae=(re-be)/ge,Ge=(re+1+be)/ge,it={features:[]};return this._addTileFeatures(le.range((W-be)/ge,Ae,(W+1+be)/ge,Ge),le.points,W,re,ge,it),0===W&&this._addTileFeatures(le.range(1-be/ge,Ae,1,Ge),le.points,ge,re,ge,it),W===ge-1&&this._addTileFeatures(le.range(0,Ae,be/ge,Ge),le.points,-1,re,ge,it),it.features.length?it:null}getClusterExpansionZoom($){let W=this._getOriginZoom($)-1;for(;W<=this.options.maxZoom;){const re=this.getChildren($);if(W++,1!==re.length)break;$=re[0].properties.cluster_id}return W}_appendLeaves($,W,re,le,ge){const ve=this.getChildren(W);for(const Ee of ve){const be=Ee.properties;if(be&&be.cluster?ge+be.point_count<=le?ge+=be.point_count:ge=this._appendLeaves($,be.cluster_id,re,le,ge):ge<le?ge++:$.push(Ee),$.length===re)break}return ge}_addTileFeatures($,W,re,le,ge,ve){for(const Ee of $){const be=W[Ee],Ae=be.numPoints;let Ge,it,He;if(Ae)Ge=La(be),it=be.x,He=be.y;else{const Ne=this.points[be.index];Ge=Ne.properties,it=qi(Ne.geometry.coordinates[0]),He=Zo(Ne.geometry.coordinates[1])}const xt={type:1,geometry:[[Math.round(this.options.extent*(it*ge-re)),Math.round(this.options.extent*(He*ge-le))]],tags:Ge};let xe;Ae?xe=be.id:this.options.generateId?xe=be.index:this.points[be.index].id&&(xe=this.points[be.index].id),void 0!==xe&&(xt.id=xe),ve.features.push(xt)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(+$,this.options.maxZoom+1))}_cluster($,W){const re=[],{radius:le,extent:ge,reduce:ve,minPoints:Ee}=this.options,be=le/(ge*Math.pow(2,W));for(let Ae=0;Ae<$.length;Ae++){const Ge=$[Ae];if(Ge.zoom<=W)continue;Ge.zoom=W;const it=this.trees[W+1],He=it.within(Ge.x,Ge.y,be),xt=Ge.numPoints||1;let xe=xt;for(const Ne of He){const vt=it.points[Ne];vt.zoom>W&&(xe+=vt.numPoints||1)}if(xe>=Ee){let Ne=Ge.x*xt,vt=Ge.y*xt,qt=ve&&xt>1?this._map(Ge,!0):null;const Nt=(Ae<<5)+(W+1)+this.points.length;for(const vn of He){const rn=it.points[vn];if(rn.zoom<=W)continue;rn.zoom=W;const kn=rn.numPoints||1;Ne+=rn.x*kn,vt+=rn.y*kn,rn.parentId=Nt,ve&&(qt||(qt=this._map(Ge,!0)),ve(qt,this._map(rn)))}Ge.parentId=Nt,re.push(Wr(Ne/xe,vt/xe,Nt,xe,qt))}else if(re.push(Ge),xe>1)for(const Ne of He){const vt=it.points[Ne];vt.zoom<=W||(vt.zoom=W,re.push(vt))}}return re}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,W){if($.numPoints)return W?qo({},$.properties):$.properties;const re=this.points[$.index].properties,le=this.options.map(re);return W&&le===re?qo({},le):le}}function Wr(Q,$,W,re,le){return{x:Sn(Q),y:Sn($),zoom:1/0,id:W,parentId:-1,numPoints:re,properties:le}}function ea(Q,$){const[W,re]=Q.geometry.coordinates;return{x:Sn(qi(W)),y:Sn(Zo(re)),zoom:1/0,index:$,parentId:-1}}function Ra(Q){return{type:"Feature",id:Q.id,properties:La(Q),geometry:{type:"Point",coordinates:[($=Q.x,360*($-.5)),Mn(Q.y)]}};var $}function La(Q){const $=Q.numPoints,W=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$;return qo(qo({},Q.properties),{cluster:!0,cluster_id:Q.id,point_count:$,point_count_abbreviated:W})}function qi(Q){return Q/360+.5}function Zo(Q){const $=Math.sin(Q*Math.PI/180),W=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return W<0?0:W>1?1:W}function Mn(Q){const $=(180-360*Q)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function qo(Q,$){for(const W in $)Q[W]=$[W];return Q}function As(Q){return Q.x}function Jn(Q){return Q.y}function ko(Q,$,W,re){for(var le,ge=re,ve=W-$>>1,Ee=W-$,be=Q[$],Ae=Q[$+1],Ge=Q[W],it=Q[W+1],He=$+3;He<W;He+=3){var xt=ta(Q[He],Q[He+1],be,Ae,Ge,it);if(xt>ge)le=He,ge=xt;else if(xt===ge){var xe=Math.abs(He-ve);xe<Ee&&(le=He,Ee=xe)}}ge>re&&(le-$>3&&ko(Q,$,le,re),Q[le+2]=ge,W-le>3&&ko(Q,le,W,re))}function ta(Q,$,W,re,le,ge){var ve=le-W,Ee=ge-re;if(0!==ve||0!==Ee){var be=((Q-W)*ve+($-re)*Ee)/(ve*ve+Ee*Ee);be>1?(W=le,re=ge):be>0&&(W+=ve*be,re+=Ee*be)}return(ve=Q-W)*ve+(Ee=$-re)*Ee}function go(Q,$,W,re){var le={id:void 0===Q?null:Q,type:$,geometry:W,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var ve=ge.geometry,Ee=ge.type;if("Point"===Ee||"MultiPoint"===Ee||"LineString"===Ee)Oa(ge,ve);else if("Polygon"===Ee||"MultiLineString"===Ee)for(var be=0;be<ve.length;be++)Oa(ge,ve[be]);else if("MultiPolygon"===Ee)for(be=0;be<ve.length;be++)for(var Ae=0;Ae<ve[be].length;Ae++)Oa(ge,ve[be][Ae])}(le),le}function Oa(Q,$){for(var W=0;W<$.length;W+=3)Q.minX=Math.min(Q.minX,$[W]),Q.minY=Math.min(Q.minY,$[W+1]),Q.maxX=Math.max(Q.maxX,$[W]),Q.maxY=Math.max(Q.maxY,$[W+1])}function _o(Q,$,W,re){if($.geometry){var le=$.geometry.coordinates,ge=$.geometry.type,ve=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Ee=[],be=$.id;if(W.promoteId?be=$.properties[W.promoteId]:W.generateId&&(be=re||0),"Point"===ge)Nn(le,Ee);else if("MultiPoint"===ge)for(var Ae=0;Ae<le.length;Ae++)Nn(le[Ae],Ee);else if("LineString"===ge)na(le,Ee,ve,!1);else if("MultiLineString"===ge){if(W.lineMetrics){for(Ae=0;Ae<le.length;Ae++)na(le[Ae],Ee=[],ve,!1),Q.push(go(be,"LineString",Ee,$.properties));return}cl(le,Ee,ve,!1)}else if("Polygon"===ge)cl(le,Ee,ve,!0);else{if("MultiPolygon"!==ge){if("GeometryCollection"===ge){for(Ae=0;Ae<$.geometry.geometries.length;Ae++)_o(Q,{id:be,geometry:$.geometry.geometries[Ae],properties:$.properties},W,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ae=0;Ae<le.length;Ae++){var Ge=[];cl(le[Ae],Ge,ve,!0),Ee.push(Ge)}}Q.push(go(be,ge,Ee,$.properties))}}function Nn(Q,$){$.push(yo(Q[0])),$.push(Xr(Q[1])),$.push(0)}function na(Q,$,W,re){for(var le,ge,ve=0,Ee=0;Ee<Q.length;Ee++){var be=yo(Q[Ee][0]),Ae=Xr(Q[Ee][1]);$.push(be),$.push(Ae),$.push(0),Ee>0&&(ve+=re?(le*Ae-be*ge)/2:Math.sqrt(Math.pow(be-le,2)+Math.pow(Ae-ge,2))),le=be,ge=Ae}var Ge=$.length-3;$[2]=1,ko($,0,Ge,W),$[Ge+2]=1,$.size=Math.abs(ve),$.start=0,$.end=$.size}function cl(Q,$,W,re){for(var le=0;le<Q.length;le++){var ge=[];na(Q[le],ge,W,re),$.push(ge)}}function yo(Q){return Q/360+.5}function Xr(Q){var $=Math.sin(Q*Math.PI/180),W=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return W<0?0:W>1?1:W}function Er(Q,$,W,re,le,ge,ve,Ee){if(re/=$,ge>=(W/=$)&&ve<re)return Q;if(ve<W||ge>=re)return null;for(var be=[],Ae=0;Ae<Q.length;Ae++){var Ge=Q[Ae],it=Ge.geometry,He=Ge.type,xt=0===le?Ge.minX:Ge.minY,xe=0===le?Ge.maxX:Ge.maxY;if(xt>=W&&xe<re)be.push(Ge);else if(!(xe<W||xt>=re)){var Ne=[];if("Point"===He||"MultiPoint"===He)ia(it,Ne,W,re,le);else if("LineString"===He)ra(it,Ne,W,re,le,!1,Ee.lineMetrics);else if("MultiLineString"===He)Fa(it,Ne,W,re,le,!1);else if("Polygon"===He)Fa(it,Ne,W,re,le,!0);else if("MultiPolygon"===He)for(var vt=0;vt<it.length;vt++){var qt=[];Fa(it[vt],qt,W,re,le,!0),qt.length&&Ne.push(qt)}if(Ne.length){if(Ee.lineMetrics&&"LineString"===He){for(vt=0;vt<Ne.length;vt++)be.push(go(Ge.id,He,Ne[vt],Ge.tags));continue}"LineString"!==He&&"MultiLineString"!==He||(1===Ne.length?(He="LineString",Ne=Ne[0]):He="MultiLineString"),"Point"!==He&&"MultiPoint"!==He||(He=3===Ne.length?"Point":"MultiPoint"),be.push(go(Ge.id,He,Ne,Ge.tags))}}}return be.length?be:null}function ia(Q,$,W,re,le){for(var ge=0;ge<Q.length;ge+=3){var ve=Q[ge+le];ve>=W&&ve<=re&&($.push(Q[ge]),$.push(Q[ge+1]),$.push(Q[ge+2]))}}function ra(Q,$,W,re,le,ge,ve){for(var Ee,be,Ae=Fl(Q),Ge=0===le?ul:bc,it=Q.start,He=0;He<Q.length-3;He+=3){var xt=Q[He],xe=Q[He+1],Ne=Q[He+2],vt=Q[He+3],qt=Q[He+4],Nt=0===le?xt:xe,vn=0===le?vt:qt,rn=!1;ve&&(Ee=Math.sqrt(Math.pow(xt-vt,2)+Math.pow(xe-qt,2))),Nt<W?vn>W&&(be=Ge(Ae,xt,xe,vt,qt,W),ve&&(Ae.start=it+Ee*be)):Nt>re?vn<re&&(be=Ge(Ae,xt,xe,vt,qt,re),ve&&(Ae.start=it+Ee*be)):oa(Ae,xt,xe,Ne),vn<W&&Nt>=W&&(be=Ge(Ae,xt,xe,vt,qt,W),rn=!0),vn>re&&Nt<=re&&(be=Ge(Ae,xt,xe,vt,qt,re),rn=!0),!ge&&rn&&(ve&&(Ae.end=it+Ee*be),$.push(Ae),Ae=Fl(Q)),ve&&(it+=Ee)}var kn=Q.length-3;xt=Q[kn],xe=Q[kn+1],Ne=Q[kn+2],(Nt=0===le?xt:xe)>=W&&Nt<=re&&oa(Ae,xt,xe,Ne),kn=Ae.length-3,ge&&kn>=3&&(Ae[kn]!==Ae[0]||Ae[kn+1]!==Ae[1])&&oa(Ae,Ae[0],Ae[1],Ae[2]),Ae.length&&$.push(Ae)}function Fl(Q){var $=[];return $.size=Q.size,$.start=Q.start,$.end=Q.end,$}function Fa(Q,$,W,re,le,ge){for(var ve=0;ve<Q.length;ve++)ra(Q[ve],$,W,re,le,ge,!1)}function oa(Q,$,W,re){Q.push($),Q.push(W),Q.push(re)}function ul(Q,$,W,re,le,ge){var ve=(ge-$)/(re-$);return Q.push(ge),Q.push(W+(le-W)*ve),Q.push(1),ve}function bc(Q,$,W,re,le,ge){var ve=(ge-W)/(le-W);return Q.push($+(re-$)*ve),Q.push(ge),Q.push(1),ve}function lr(Q,$){for(var W=[],re=0;re<Q.length;re++){var le,ge=Q[re],ve=ge.type;if("Point"===ve||"MultiPoint"===ve||"LineString"===ve)le=Wo(ge.geometry,$);else if("MultiLineString"===ve||"Polygon"===ve){le=[];for(var Ee=0;Ee<ge.geometry.length;Ee++)le.push(Wo(ge.geometry[Ee],$))}else if("MultiPolygon"===ve)for(le=[],Ee=0;Ee<ge.geometry.length;Ee++){for(var be=[],Ae=0;Ae<ge.geometry[Ee].length;Ae++)be.push(Wo(ge.geometry[Ee][Ae],$));le.push(be)}W.push(go(ge.id,ve,le,ge.tags))}return W}function Wo(Q,$){var W=[];W.size=Q.size,void 0!==Q.start&&(W.start=Q.start,W.end=Q.end);for(var re=0;re<Q.length;re+=3)W.push(Q[re]+$,Q[re+1],Q[re+2]);return W}function Ro(Q,$){if(Q.transformed)return Q;var W,re,le,ge=1<<Q.z,ve=Q.x,Ee=Q.y;for(W=0;W<Q.features.length;W++){var be=Q.features[W],Ae=be.geometry,Ge=be.type;if(be.geometry=[],1===Ge)for(re=0;re<Ae.length;re+=2)be.geometry.push(sa(Ae[re],Ae[re+1],$,ge,ve,Ee));else for(re=0;re<Ae.length;re++){var it=[];for(le=0;le<Ae[re].length;le+=2)it.push(sa(Ae[re][le],Ae[re][le+1],$,ge,ve,Ee));be.geometry.push(it)}}return Q.transformed=!0,Q}function sa(Q,$,W,re,le,ge){return[Math.round(W*(Q*re-le)),Math.round(W*($*re-ge))]}function Xo(Q,$,W,re,le){for(var ge=$===le.maxZoom?0:le.tolerance/((1<<$)*le.extent),ve={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:re,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ee=0;Ee<Q.length;Ee++){ve.numFeatures++,Kr(ve,Q[Ee],ge,le);var be=Q[Ee].minX,Ae=Q[Ee].minY,Ge=Q[Ee].maxX,it=Q[Ee].maxY;be<ve.minX&&(ve.minX=be),Ae<ve.minY&&(ve.minY=Ae),Ge>ve.maxX&&(ve.maxX=Ge),it>ve.maxY&&(ve.maxY=it)}return ve}function Kr(Q,$,W,re){var le=$.geometry,ge=$.type,ve=[];if("Point"===ge||"MultiPoint"===ge)for(var Ee=0;Ee<le.length;Ee+=3)ve.push(le[Ee]),ve.push(le[Ee+1]),Q.numPoints++,Q.numSimplified++;else if("LineString"===ge)Ft(ve,le,Q,W,!1,!1);else if("MultiLineString"===ge||"Polygon"===ge)for(Ee=0;Ee<le.length;Ee++)Ft(ve,le[Ee],Q,W,"Polygon"===ge,0===Ee);else if("MultiPolygon"===ge)for(var be=0;be<le.length;be++){var Ae=le[be];for(Ee=0;Ee<Ae.length;Ee++)Ft(ve,Ae[Ee],Q,W,!0,0===Ee)}if(ve.length){var Ge=$.tags||null;if("LineString"===ge&&re.lineMetrics){for(var it in Ge={},$.tags)Ge[it]=$.tags[it];Ge.mapbox_clip_start=le.start/le.size,Ge.mapbox_clip_end=le.end/le.size}var He={geometry:ve,type:"Polygon"===ge||"MultiPolygon"===ge?3:"LineString"===ge||"MultiLineString"===ge?2:1,tags:Ge};null!==$.id&&(He.id=$.id),Q.features.push(He)}}function Ft(Q,$,W,re,le,ge){var ve=re*re;if(re>0&&$.size<(le?ve:re))W.numPoints+=$.length/3;else{for(var Ee=[],be=0;be<$.length;be+=3)(0===re||$[be+2]>ve)&&(W.numSimplified++,Ee.push($[be]),Ee.push($[be+1])),W.numPoints++;le&&function(Ae,Ge){for(var it=0,He=0,xt=Ae.length,xe=xt-2;He<xt;xe=He,He+=2)it+=(Ae[He]-Ae[xe])*(Ae[He+1]+Ae[xe+1]);if(it>0===Ge)for(He=0,xt=Ae.length;He<xt/2;He+=2){var Ne=Ae[He],vt=Ae[He+1];Ae[He]=Ae[xt-2-He],Ae[He+1]=Ae[xt-1-He],Ae[xt-2-He]=Ne,Ae[xt-1-He]=vt}}(Ee,ge),Q.push(Ee)}}function ls(Q,$){var W=($=this.options=function(le,ge){for(var ve in ge)le[ve]=ge[ve];return le}(Object.create(this.options),$)).debug;if(W&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var le,ge,ve,Ee,be,Ae,re=function(le,ge){var ve=[];if("FeatureCollection"===le.type)for(var Ee=0;Ee<le.features.length;Ee++)_o(ve,le.features[Ee],ge,Ee);else _o(ve,"Feature"===le.type?le:{geometry:le},ge);return ve}(Q,$);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(le=re,ge=$,ve=ge.buffer/ge.extent,Ee=le,be=Er(le,1,-1-ve,ve,0,-1,2,ge),Ae=Er(le,1,1-ve,2+ve,0,-1,2,ge),(be||Ae)&&(Ee=Er(le,1,-ve,1+ve,0,-1,2,ge)||[],be&&(Ee=lr(be,1).concat(Ee)),Ae&&(Ee=Ee.concat(lr(Ae,-1)))),re=Ee).length&&this.splitTile(re,0,0,0),W&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Bt(Q,$,W){return 32*((1<<Q)*W+$)+Q}function Tr(Q,$){const W=Q.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const re=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!re)return $(null,null);const le=new Ol(re.features);let ge=as(le);0===ge.byteOffset&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),$(null,{vectorTile:le,rawData:ge.buffer})}ls.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ls.prototype.splitTile=function(Q,$,W,re,le,ge,ve){for(var Ee=[Q,$,W,re],be=this.options,Ae=be.debug;Ee.length;){re=Ee.pop(),W=Ee.pop(),$=Ee.pop(),Q=Ee.pop();var Ge=1<<$,it=Bt($,W,re),He=this.tiles[it];if(!He&&(Ae>1&&console.time("creation"),He=this.tiles[it]=Xo(Q,$,W,re,be),this.tileCoords.push({z:$,x:W,y:re}),Ae)){Ae>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,W,re,He.numFeatures,He.numPoints,He.numSimplified),console.timeEnd("creation"));var xt="z"+$;this.stats[xt]=(this.stats[xt]||0)+1,this.total++}if(He.source=Q,le){if($===be.maxZoom||$===le)continue;var xe=1<<le-$;if(W!==Math.floor(ge/xe)||re!==Math.floor(ve/xe))continue}else if($===be.indexMaxZoom||He.numPoints<=be.indexMaxPoints)continue;if(He.source=null,0!==Q.length){Ae>1&&console.time("clipping");var Ne,vt,qt,Nt,vn,rn,kn=.5*be.buffer/be.extent,aa=.5-kn,lt=.5+kn,Gt=1+kn;Ne=vt=qt=Nt=null,vn=Er(Q,Ge,W-kn,W+lt,0,He.minX,He.maxX,be),rn=Er(Q,Ge,W+aa,W+Gt,0,He.minX,He.maxX,be),Q=null,vn&&(Ne=Er(vn,Ge,re-kn,re+lt,1,He.minY,He.maxY,be),vt=Er(vn,Ge,re+aa,re+Gt,1,He.minY,He.maxY,be),vn=null),rn&&(qt=Er(rn,Ge,re-kn,re+lt,1,He.minY,He.maxY,be),Nt=Er(rn,Ge,re+aa,re+Gt,1,He.minY,He.maxY,be),rn=null),Ae>1&&console.timeEnd("clipping"),Ee.push(Ne||[],$+1,2*W,2*re),Ee.push(vt||[],$+1,2*W,2*re+1),Ee.push(qt||[],$+1,2*W+1,2*re),Ee.push(Nt||[],$+1,2*W+1,2*re+1)}}},ls.prototype.getTile=function(Q,$,W){var re=this.options,le=re.extent,ge=re.debug;if(Q<0||Q>24)return null;var ve=1<<Q,Ee=Bt(Q,$=($%ve+ve)%ve,W);if(this.tiles[Ee])return Ro(this.tiles[Ee],le);ge>1&&console.log("drilling down to z%d-%d-%d",Q,$,W);for(var be,Ae=Q,Ge=$,it=W;!be&&Ae>0;)Ae--,Ge=Math.floor(Ge/2),it=Math.floor(it/2),be=this.tiles[Bt(Ae,Ge,it)];return be&&be.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Ae,Ge,it),ge>1&&console.time("drilling down"),this.splitTile(be.source,Ae,Ge,it,Q,$,W),ge>1&&console.timeEnd("drilling down"),this.tiles[Ee]?Ro(this.tiles[Ee],le):null):null};class Ko extends p.VectorTileWorkerSource{constructor($,W,re,le,ge){super($,W,re,le,Tr),ge&&(this.loadGeoJSON=ge)}loadData($,W){const re=$&&$.request,le=re&&re.collectResourceTiming;this.loadGeoJSON($,(ge,ve)=>{if(ge||!ve)return W(ge);if("object"!=typeof ve)return W(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{at(ve,!0);try{if($.filter){const be=p.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===be.result)throw new Error(be.value.map(Ge=>`${Ge.key}: ${Ge.message}`).join(", "));const Ae=ve.features.filter(Ge=>be.value.evaluate({zoom:0},Ge));ve={type:"FeatureCollection",features:Ae}}this._geoJSONIndex=$.cluster?new jt(function({superclusterOptions:be,clusterProperties:Ae}){if(!Ae||!be)return be;const Ge={},it={},He={accumulated:null,zoom:0},xt={properties:null},xe=Object.keys(Ae);for(const Ne of xe){const[vt,qt]=Ae[Ne],Nt=p.createExpression(qt),vn=p.createExpression("string"==typeof vt?[vt,["accumulated"],["get",Ne]]:vt);Ge[Ne]=Nt.value,it[Ne]=vn.value}return be.map=Ne=>{xt.properties=Ne;const vt={};for(const qt of xe)vt[qt]=Ge[qt].evaluate(He,xt);return vt},be.reduce=(Ne,vt)=>{xt.properties=vt;for(const qt of xe)He.accumulated=Ne[qt],Ne[qt]=it[qt].evaluate(He,xt)},be}($)).load(ve.features):new ls(be=ve,$.geojsonVtOptions)}catch(be){return W(be)}this.loaded={};const Ee={};if(le){const be=p.getPerformanceMeasurement(re);be&&(Ee.resourceTiming={},Ee.resourceTiming[$.source]=JSON.parse(JSON.stringify(be)))}W(null,Ee)}var be})}reloadTile($,W){const re=this.loaded;return re&&re[$.uid]?super.reloadTile($,W):this.loadTile($,W)}loadGeoJSON($,W){if($.request)p.getJSON($.request,W);else{if("string"!=typeof $.data)return W(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse($.data))}catch(re){return W(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(re){W(re)}}getClusterChildren($,W){try{W(null,this._geoJSONIndex.getChildren($.clusterId))}catch(re){W(re)}}getClusterLeaves($,W){try{W(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(re){W(re)}}}class yn{constructor($){this.self=$,this.actor=new p.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:p.VectorTileWorkerSource,geojson:Ko},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,re)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=re},this.self.registerRTLTextPlugin=W=>{if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=W.applyArabicShaping,p.plugin.processBidirectionalText=W.processBidirectionalText,p.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}checkIfReady($,W,re){re()}setReferrer($,W){this.referrer=W}spriteLoaded($,W){this.isSpriteLoaded=W;for(const re in this.workerSources[$]){const le=this.workerSources[$][re];for(const ge in le)le[ge]instanceof p.VectorTileWorkerSource&&(le[ge].isSpriteLoaded=W,le[ge].fire(new p.Event("isSpriteLoaded")))}}setImages($,W,re){this.availableImages[$]=W;for(const le in this.workerSources[$]){const ge=this.workerSources[$][le];for(const ve in ge)ge[ve].availableImages=W}re()}enableTerrain($,W,re){this.terrain=W,re()}setLayers($,W,re){this.getLayerIndex($).replace(W),re()}updateLayers($,W,re){this.getLayerIndex($).update(W.layers,W.removedIds),re()}loadTile($,W,re){const le=this.enableTerrain?p.extend({enableTerrain:this.terrain},W):W;this.getWorkerSource($,W.type,W.source).loadTile(le,re)}loadDEMTile($,W,re){const le=this.enableTerrain?p.extend({buildQuadTree:this.terrain},W):W;this.getDEMWorkerSource($,W.source).loadTile(le,re)}reloadTile($,W,re){const le=this.enableTerrain?p.extend({enableTerrain:this.terrain},W):W;this.getWorkerSource($,W.type,W.source).reloadTile(le,re)}abortTile($,W,re){this.getWorkerSource($,W.type,W.source).abortTile(W,re)}removeTile($,W,re){this.getWorkerSource($,W.type,W.source).removeTile(W,re)}removeSource($,W,re){if(!this.workerSources[$]||!this.workerSources[$][W.type]||!this.workerSources[$][W.type][W.source])return;const le=this.workerSources[$][W.type][W.source];delete this.workerSources[$][W.type][W.source],void 0!==le.removeSource?le.removeSource(W,re):re()}loadWorkerSource($,W,re){try{this.self.importScripts(W.url),re()}catch(le){re(le.toString())}}syncRTLPluginState($,W,re){try{p.plugin.setState(W);const le=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&null!=le){this.self.importScripts(le);const ge=p.plugin.isParsed();re(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${le}`),ge)}}catch(le){re(le.toString())}}getAvailableImages($){let W=this.availableImages[$];return W||(W=[]),W}getLayerIndex($){let W=this.layerIndexes[$];return W||(W=this.layerIndexes[$]=new Cr),W}getWorkerSource($,W,re){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][W]||(this.workerSources[$][W]={}),this.workerSources[$][W][re]||(this.workerSources[$][W][re]=new this.workerSourceTypes[W]({send:(le,ge,ve,Ee,be,Ae)=>{this.actor.send(le,ge,ve,$,be,Ae)},scheduler:this.actor.scheduler},this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded)),this.workerSources[$][W][re]}getDEMWorkerSource($,W){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][W]||(this.demWorkerSources[$][W]=new $e),this.demWorkerSources[$][W]}enforceCacheSizeLimit($,W){p.enforceCacheSizeLimit(W)}getWorkerPerformanceMetrics($,W,re){re(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new yn(self)),yn}),Hn(0,function(p){var zr=Qt;function Qt(m){return o=m,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,w,C=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(C);try{w=new Worker(M),_=!0}catch(k){_=!1}return w&&w.terminate(),URL.revokeObjectURL(M),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var w=_.getContext("2d");if(!w)return!1;var C=w.getImageData(0,0,1,1);return C&&C.width===_.width}()||(void 0===Cr[d=o&&o.failIfMajorPerformanceCaveat]&&(Cr[d]=function(_){var w,M,k,O,C=(M=_,k=document.createElement("canvas"),(O=Object.create(Qt.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,k.getContext("webgl",O)||k.getContext("experimental-webgl",O));if(!C)return!1;try{w=C.createShader(C.VERTEX_SHADER)}catch(M){return!1}return!(!w||C.isContextLost())&&(C.shaderSource(w,"void main() {}"),C.compileShader(w),!0===C.getShaderParameter(w,C.COMPILE_STATUS))}(d)),!Cr[d]||document.documentMode));var o,d}var Cr={};function Qe(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let d=0;d<m.length;d++)if(!Qe(m[d],o[d]))return!1;return!0}if("object"==typeof m&&null!==m&&null!==o){if("object"!=typeof o||Object.keys(m).length!==Object.keys(o).length)return!1;for(const d in m)if(!Qe(m[d],o[d]))return!1;return!0}return m===o}Qt.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const $e={create:function(m,o,d){const _=p.window.document.createElement(m);return void 0!==o&&(_.className=o),d&&d.appendChild(_),_},createNS:function(m,o){return p.window.document.createElementNS(m,o)}},at=p.window.document&&p.window.document.documentElement.style,po=at&&void 0!==at.userSelect?"userSelect":"WebkitUserSelect";let mo;$e.disableDrag=function(){at&&po&&(mo=at[po],at[po]="none")},$e.enableDrag=function(){at&&po&&(at[po]=mo)},$e.setTransform=function(m,o){m.style.transform=o};let Yn=!1;try{const m=Object.defineProperty({},"passive",{get(){Yn=!0}});p.window.addEventListener("test",m,m),p.window.removeEventListener("test",m,m)}catch(m){Yn=!1}$e.addEventListener=function(m,o,d,_={}){m.addEventListener(o,d,"passive"in _&&Yn?_:_.capture)},$e.removeEventListener=function(m,o,d,_={}){m.removeEventListener(o,d,"passive"in _&&Yn?_:_.capture)};const In=function(m){m.preventDefault(),m.stopPropagation(),p.window.removeEventListener("click",In,!0)};function Ol(m,o,d){const _=m.offsetWidth===o.width?1:m.offsetWidth/o.width;return new p.pointGeometry((d.clientX-o.left)*_,(d.clientY-o.top)*_)}$e.suppressClick=function(){p.window.addEventListener("click",In,!0),p.window.setTimeout(()=>{p.window.removeEventListener("click",In,!0)},0)},$e.mousePos=function(m,o){const d=m.getBoundingClientRect();return Ol(m,d,o)},$e.touchPos=function(m,o){const d=m.getBoundingClientRect(),_=[];for(let w=0;w<o.length;w++)_.push(Ol(m,d,o[w]));return _},$e.mouseButton=function(m){return void 0!==p.window.InstallTrigger&&2===m.button&&m.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button},$e.remove=function(m){m.parentNode&&m.parentNode.removeChild(m)};class sl{constructor(o,d){this.pos=o,this.dir=d}intersectsPlane(o,d,_){const w=p.dot(d,this.dir);if(Math.abs(w)<1e-6)return!1;const C=p.dot(p.sub(p.create(),o,this.pos),d)/w,M=p.scaleAndAdd(p.create(),this.pos,this.dir,C);return p.copy(_,M),!0}}class ar{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,_){const w=Math.pow(2,_),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const O=p.transformMat4([],k,o),B=1/O[3]/d*w;return p.mul(O,O,[B,B,1/O[3],B])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const O=p.sub([],C[k[0]],C[k[1]]),B=p.sub([],C[k[2]],C[k[1]]),U=p.normalize([],p.cross([],O,B)),q=-p.dot(U,C[k[1]]);return U.concat(q)});return new ar(C,M)}}class Po{constructor(o,d){this.min=o,this.max=d,this.center=p.scale([],p.add([],this.min,this.max),.5)}quadrant(o){const d=[o%2==0,o<2],_=p.clone(this.min),w=p.clone(this.max);for(let C=0;C<d.length;C++)_[C]=d[C]?this.min[C]:this.center[C],w[C]=d[C]?this.center[C]:this.max[C];return w[2]=this.max[2],new Po(_,w)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let _=!0;for(let w=0;w<o.planes.length;w++){const C=o.planes[w];let M=0;for(let k=0;k<d.length;k++)M+=p.dot$1(C,d[k])>=0;if(0===M)return 0;M!==d.length&&(_=!1)}if(_)return 2;for(let w=0;w<3;w++){let C=Number.MAX_VALUE,M=-Number.MAX_VALUE;for(let k=0;k<o.points.length;k++){const O=o.points[k][w]-this.min[w];C=Math.min(C,O),M=Math.max(M,O)}if(M<0||C>this.max[w]-this.min[w])return 0}return 1}}function gi(m){const{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class as extends p.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:_}of this.requestors)this._notify(d,_);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,d){this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let _=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),_=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),_=!1),this._validateContent(d.content,d)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),_=!1),_}_validateStretch(o,d){if(!o)return!0;let _=0;for(const w of o){if(w[0]<_||w[1]<w[0]||d<w[1])return!1;_=w[1]}return!0}_validateContent(o,d){return!(o&&(4!==o.length||o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,d){d.version=this.images[o].version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let _=!0;if(!this.isLoaded())for(const w of o)this.images[w]||(_=!1);this.isLoaded()||_?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const _={};for(const w of o){this.images[w]||this.fire(new p.Event("styleimagemissing",{id:w}));const C=this.images[w];C?_[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:p.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,_)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],_=this.getImage(o);if(!_)return null;if(d&&d.position.version===_.version)return d.position;if(d)d.position.version=_.version;else{const w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},C=new p.ImagePosition(w,_);this.patterns[o]={bin:w,position:C}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const C in this.patterns)o.push(this.patterns[C].bin);const{w:d,h:_}=p.potpack(o),w=this.atlasImage;w.resize({width:d||1,height:_||1});for(const C in this.patterns){const{bin:M}=this.patterns[C],k=M.x+1,O=M.y+1,B=this.images[C].data,U=B.width,q=B.height;p.RGBAImage.copy(B,w,{x:0,y:0},{x:k,y:O},{width:U,height:q}),p.RGBAImage.copy(B,w,{x:0,y:q-1},{x:k,y:O-1},{width:U,height:1}),p.RGBAImage.copy(B,w,{x:0,y:0},{x:k,y:O+q},{width:U,height:1}),p.RGBAImage.copy(B,w,{x:U-1,y:0},{x:k-1,y:O},{width:1,height:q}),p.RGBAImage.copy(B,w,{x:0,y:0},{x:k+U,y:O},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const _=this.images[d];gi(_)&&this.updateImage(d,_)}}}const al=new p.Properties({anchor:new p.DataConstantProperty(p.spec.light.anchor),position:new class{constructor(){this.specification=p.spec.light.position}possiblyEvaluate(m,o){return function([d,_,w]){const C=p.degToRad(_+90),M=p.degToRad(w);return{x:d*Math.cos(C)*Math.sin(M),y:d*Math.sin(C)*Math.sin(M),z:d*Math.cos(M),azimuthal:_,polar:w}}(m.expression.evaluate(o))}interpolate(m,o,d){return{x:p.number(m.x,o.x,d),y:p.number(m.y,o.y,d),z:p.number(m.z,o.z,d),azimuthal:p.number(m.azimuthal,o.azimuthal,d),polar:p.number(m.polar,o.polar,d)}}},color:new p.DataConstantProperty(p.spec.light.color),intensity:new p.DataConstantProperty(p.spec.light.intensity)}),Pn="-transition";class Ci extends p.Evented{constructor(o){super(),this._transitionable=new p.Transitionable(al),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(p.validateLight,o,d))for(const _ in o){const w=o[_];p.endsWith(_,Pn)?this._transitionable.setTransition(_.slice(0,-Pn.length),w):this._transitionable.setValue(_,w)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,_){return(!_||!1!==_.validate)&&p.emitValidationErrors(this,o.call(p.validateStyle,p.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}const uu=new p.Properties({source:new p.DataConstantProperty(p.spec.terrain.source),exaggeration:new p.DataConstantProperty(p.spec.terrain.exaggeration)}),si="-transition";class Zi extends p.Evented{constructor(o){super(),this._transitionable=new p.Transitionable(uu),this.set(o),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(o){for(const d in o){const _=o[d];p.endsWith(d,si)?this._transitionable.setTransition(d.slice(0,-si.length),_):this._transitionable.setValue(d,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}}function ka(m,o,d,_){const w=p.smoothstep(45,65,d),[C,M]=Pi(m,_),k=p.length(o);let O=1-Math.min(1,Math.exp((k-C)/(M-C)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*w*m.alpha}function Pi(m,o){const d=.5/Math.tan(.5*o);return[m.range[0]+d,m.range[1]+d]}const ll=new p.Properties({range:new p.DataConstantProperty(p.spec.fog.range),color:new p.DataConstantProperty(p.spec.fog.color),"horizon-blend":new p.DataConstantProperty(p.spec.fog["horizon-blend"])}),_i="-transition";class tn extends p.Evented{constructor(o){super(),this._transitionable=new p.Transitionable(ll),this.set(o),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d={}){if(!this._validate(p.validateFog,o,d))for(const _ in o){const w=o[_];p.endsWith(_,_i)?this._transitionable.setTransition(_.slice(0,-_i.length),w):this._transitionable.setValue(_,w)}}getOpacity(o){const d=this.properties&&this.properties.get("color")||1;return p.smoothstep(45,65,o)*d.a}getOpacityAtLatLng(o,d){return function(_,w,C){const M=p.MercatorCoordinate.fromLngLat(w),k=C.elevation?C.elevation.getAtPointOrZero(M):0,O=[M.x,M.y,k];return p.transformMat4$1(O,O,C.mercatorFogMatrix),ka(_,O,C.pitch,C._fov)}(this.state,o,d)}getFovAdjustedRange(o){return Pi(this.state,o)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,_){return(!_||!1!==_.validate)&&p.emitValidationErrors(this,o.call(p.validateStyle,p.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}class Dt{constructor(o,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p.uniqueId();const _=this.workerPool.acquire(this.id);for(let w=0;w<_.length;w++){const C=new Dt.Actor(_[w],d,this.id);C.name=`Worker ${w}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,d,_){p.asyncAll(this.actors,(w,C)=>{w.send(o,d,C)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ni(m,o,d){return o*(p.EXTENT/(m.tileSize*Math.pow(2,d-m.tileID.overscaledZ)))}Dt.Actor=p.Actor;class nn{constructor(o,d,_,w){this.screenBounds=o,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(C=>w.pointCoordinate3D(C)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(o,d){let _,w;if(o instanceof p.pointGeometry||"number"==typeof o[0]){const C=p.pointGeometry.convert(o);_=[p.pointGeometry.convert(o)],w=d.isPointAboveHorizon(C)}else{const C=p.pointGeometry.convert(o[0]),M=p.pointGeometry.convert(o[1]);_=[C,M],w=p.polygonizeBounds(C,M).every(k=>d.isPointAboveHorizon(k))}return new nn(_,d.getCameraPoint(),w,d)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(o){return p.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new p.pointGeometry(1,1)):this.screenBounds[1],w=p.polygonizeBounds(d,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<_.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?w[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(w[3]=this.cameraPoint)),p.bufferConvexPolygon(w,o)}containsTile(o,d,_){const w=o.queryPadding+1,C=_?this._bufferedCameraMercator(w,d).map(Y=>o.tileID.getTilePoint(Y)):this._bufferedScreenMercator(w,d).map(Y=>o.tileID.getTilePoint(Y)),M=this.screenGeometryMercator.map(Y=>o.tileID.getTileVec3(Y)),k=M.map(Y=>new p.pointGeometry(Y[0],Y[1])),O=d.getFreeCameraOptions().position||new p.MercatorCoordinate(0,0,0),B=o.tileID.getTileVec3(O),U=M.map(Y=>{const oe=p.sub(Y,Y,B);return p.normalize(oe,oe),new sl(B,oe)}),q=ni(o,1,d.zoom);if(p.polygonIntersectsBox(C,0,0,p.EXTENT,p.EXTENT))return{queryGeometry:this,tilespaceGeometry:k,tilespaceRays:U,bufferedTilespaceGeometry:C,bufferedTilespaceBounds:(X=p.getBounds(C),X.min.x=p.clamp(X.min.x,0,p.EXTENT),X.min.y=p.clamp(X.min.y,0,p.EXTENT),X.max.x=p.clamp(X.max.x,0,p.EXTENT),X.max.y=p.clamp(X.max.y,0,p.EXTENT),X),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:q};var X}_bufferedScreenMercator(o,d){const _=zt(o);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{const w=this.bufferedScreenGeometry(o).map(C=>d.pointCoordinate3D(C));return this._screenRaycastCache[_]=w,w}}_bufferedCameraMercator(o,d){const _=zt(o);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{const w=this.bufferedCameraGeometry(o).map(C=>d.pointCoordinate3D(C));return this._cameraRaycastCache[_]=w,w}}}function zt(m){return 100*m|0}function ki(m,o,d){const _=function(w,C){if(w)return d(w);if(C){const M=p.pick(p.extend(C,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(M.vectorLayers=C.vector_layers,M.vectorLayerIds=M.vectorLayers.map(k=>k.id)),M.tiles=o.canonicalizeTileset(M,m.url),d(null,M)}};return m.url?p.getJSON(o.transformRequest(o.normalizeSourceURL(m.url),p.ResourceType.Source),_):p.exported.frame(()=>_(null,m))}class Ri{constructor(o,d,_){this.bounds=p.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=_||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),_=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*d),w=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*d),C=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*d),M=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*d);return o.x>=_&&o.x<C&&o.y>=w&&o.y<M}}class li{constructor(o,d,_){this.context=o;const w=o.gl;this.buffer=w.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Sn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Gn{constructor(o,d,_,w){this.length=d.length,this.attributes=_,this.itemSize=d.bytesPerElement,this.dynamicDraw=w,this.context=o;const C=o.gl;this.buffer=C.createBuffer(),o.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let _=0;_<this.attributes.length;_++){const w=d.attributes[this.attributes[_].name];void 0!==w&&o.enableVertexAttribArray(w)}}setVertexAttribPointers(o,d,_){for(let w=0;w<this.attributes.length;w++){const C=this.attributes[w],M=d.attributes[C.name];void 0!==M&&o.vertexAttribPointer(M,C.components,o[Sn[C.type]],!1,this.itemSize,C.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class jt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wr extends jt{getDefault(){return p.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ea extends jt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Ra extends jt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class La extends jt{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class qi extends jt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Zo extends jt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Mn extends jt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class qo extends jt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class As extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Jn extends jt{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class ko extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class ta extends jt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class go extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Oa extends jt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class _o extends jt{getDefault(){return p.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Nn extends jt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class na extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class cl extends jt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class yo extends jt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Xr extends jt{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Er extends jt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class ia extends jt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ra extends jt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Fl extends jt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Fa extends jt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class oa extends jt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ul extends jt{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class bc extends jt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class lr extends jt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Wo extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ro extends jt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class sa extends jt{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Xo extends sa{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Kr extends sa{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ft extends Kr{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ls{constructor(o,d,_,w){this.context=o,this.width=d,this.height=_;const C=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Xo(o,C),w&&(this.depthAttachment=new Kr(o,C))}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const _=this.depthAttachment.get();_&&o.deleteRenderbuffer(_)}o.deleteFramebuffer(this.framebuffer)}}class Bt{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Wr(this),this.clearDepth=new ea(this),this.clearStencil=new Ra(this),this.colorMask=new La(this),this.depthMask=new qi(this),this.stencilMask=new Zo(this),this.stencilFunc=new Mn(this),this.stencilOp=new qo(this),this.stencilTest=new As(this),this.depthRange=new Jn(this),this.depthTest=new ko(this),this.depthFunc=new ta(this),this.blend=new go(this),this.blendFunc=new Oa(this),this.blendColor=new _o(this),this.blendEquation=new Nn(this),this.cullFace=new na(this),this.cullFaceSide=new cl(this),this.frontFace=new yo(this),this.program=new Xr(this),this.activeTexture=new Er(this),this.viewport=new ia(this),this.bindFramebuffer=new ra(this),this.bindRenderbuffer=new Fl(this),this.bindTexture=new Fa(this),this.bindVertexBuffer=new oa(this),this.bindElementBuffer=new ul(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new bc(this),this.pixelStoreUnpack=new lr(this),this.pixelStoreUnpackPremultiplyAlpha=new Wo(this),this.pixelStoreUnpackFlipY=new Ro(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new li(this,o,d)}createVertexBuffer(o,d,_){return new Gn(this,o,d,_)}createRenderbuffer(o,d,_){const w=this.gl,C=w.createRenderbuffer();return this.bindRenderbuffer.set(C),w.renderbufferStorage(w.RENDERBUFFER,o,d,_),this.bindRenderbuffer.set(null),C}createFramebuffer(o,d,_){return new ls(this,o,d,_)}clear({color:o,depth:d,stencil:_}){const w=this.gl;let C=0;o&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==_&&(C|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),w.clear(C)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){Qe(o.blendFunction,p.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Tr extends p.Evented{constructor(o,d,_,w){super(),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},d),p.extend(this,p.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new p.ErrorEvent(o)):d&&(p.extend(this,d),d.bounds&&(this.tileBounds=new Ri(d.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(d.tiles),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const _=p.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);o.request=p.getImage(this.map._requestManager.transformRequest(w,p.ResourceType.Tile),(C,M,k,O)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(C)o.state="errored",d(C);else if(M){this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:k,expires:O});const B=this.map.painter.context,U=B.gl;o.texture=this.map.painter.getTileTexture(M.width),o.texture?o.texture.update(M,{useMipmap:!0}):(o.texture=new p.Texture(B,M,U.RGBA,{useMipmap:!0}),o.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),B.extTextureFilterAnisotropic&&U.texParameterf(U.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax)),o.state="loaded",p.cacheEntryPossiblyAdded(this.dispatcher),d(null)}})}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}let Ko;var yn=p.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Q extends p.Evented{constructor(o,d,_,w){super(),this.id=o,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=d}load(o,d){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),(_,w)=>{this._loaded=!0,_?this.fire(new p.ErrorEvent(_)):w&&(this.image=p.exported.getImageData(w),o&&(this.coordinates=o),d&&d(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o;const d=o.map(p.MercatorCoordinate.fromLngLat);this.tileID=function(w){let C=1/0,M=1/0,k=-1/0,O=-1/0;for(const X of w)C=Math.min(C,X.x),M=Math.min(M,X.y),k=Math.max(k,X.x),O=Math.max(O,X.y);const B=Math.max(k-C,O-M),U=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),q=Math.pow(2,U);return new p.CanonicalTileID(U,Math.floor((C+k)/2*q),Math.floor((M+O)/2*q))}(d),this.minzoom=this.maxzoom=this.tileID.z;const _=d.map(w=>this.tileID.getTilePoint(w)._round());return this._boundsArray=new p.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,p.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,p.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,p.EXTENT,p.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const o=this.map.painter.context,d=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new p.Texture(o,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture)}}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const $={vector:class extends p.Evented{constructor(m,o,d,_){if(super(),this.id=m,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(o,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new p.DedupedRequest}load(){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(m,o)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new p.ErrorEvent(m)):o&&(p.extend(this,o),o.bounds&&(this.tileBounds=new Ri(o.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(o.tiles,this.map._requestManager._customAccessToken),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}onAdd(m){this.map=m,this.load()}setSourceProperty(m){this._tileJSONRequest&&this._tileJSONRequest.cancel(),m();const o=this.map.style._getSourceCaches(this.id);for(const d of o)d.clearTiles();this.load()}setTiles(m){return this.setSourceProperty(()=>{this._options.tiles=m}),this}setUrl(m){return this.setSourceProperty(()=>{this.url=m,this._options.url=m}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}loadTile(m,o){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,p.ResourceType.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:m.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,m.actor&&"expired"!==m.state)"loading"===m.state?m.reloadCallback=o:m.request=m.actor.send("reloadTile",_,w.bind(this));else if(m.actor=this._tileWorkers[d]=this._tileWorkers[d]||this.dispatcher.getActor(),this.dispatcher.ready)m.request=m.actor.send("loadTile",_,w.bind(this),void 0,!0);else{const C=p.loadVectorTile.call({deduped:this._deduped},_,(M,k)=>{M||!k?w.call(this,M):(_.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},m.actor&&m.actor.send("loadTile",_,w.bind(this),void 0,!0))},!0);m.request={cancel:C}}function w(C,M){return delete m.request,m.aborted?o(null):C&&404!==C.status?o(C):(M&&M.resourceTiming&&(m.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&m.setExpiryData(M),m.loadVectorData(M,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id})}unloadTile(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Tr,"raster-dem":class extends Tr{constructor(m,o,d,_){super(m,o,d,_),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(m,o){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(w,C){w&&(m.state="errored",o(w)),C&&(m.dem=C,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",o(null))}m.request=p.getImage(this.map._requestManager.transformRequest(d,p.ResourceType.Tile),function(w,C,M,k){if(delete m.request,m.aborted)m.state="unloaded",o(null);else if(w)m.state="errored",o(w);else if(C){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:M,expires:k});const O=p.window.ImageBitmap&&C instanceof p.window.ImageBitmap&&(null==Ko&&(Ko=p.window.OffscreenCanvas&&new p.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof p.window.createImageBitmap),Ko),B=1-(C.width-p.prevPowerOfTwo(C.width))/2;B<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const U=O?C:p.exported.getImageData(C,B),q={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:U,encoding:this.encoding,padding:B};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",q,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const o=m.canonical,d=Math.pow(2,o.z),_=(o.x-1+d)%d,w=0===o.x?m.wrap-1:m.wrap,C=(o.x+1+d)%d,M=o.x+1===d?m.wrap+1:m.wrap,k={};return k[new p.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y).key]={backfilled:!1},k[new p.OverscaledTileID(m.overscaledZ,M,o.z,C,o.y).key]={backfilled:!1},o.y>0&&(k[new p.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y-1).key]={backfilled:!1},k[new p.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},k[new p.OverscaledTileID(m.overscaledZ,M,o.z,C,o.y-1).key]={backfilled:!1}),o.y+1<d&&(k[new p.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y+1).key]={backfilled:!1},k[new p.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},k[new p.OverscaledTileID(m.overscaledZ,M,o.z,C,o.y+1).key]={backfilled:!1}),k}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends p.Evented{constructor(m,o,d,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=o.data,this._options=p.extend({},o),this._collectResourceTiming=o.collectResourceTiming,void 0!==o.maxzoom&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const w=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(void 0!==o.buffer?o.buffer:128)*w,tolerance:(void 0!==o.tolerance?o.tolerance:.375)*w,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:void 0!==o.clusterMaxZoom?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:p.EXTENT,radius:(void 0!==o.clusterRadius?o.clusterRadius:50)*w,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},o),this}getClusterChildren(m,o){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},o),this}getClusterLeaves(m,o,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:o,offset:d},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new p.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=p.extend({},this.workerOptions),o=this._data;"string"==typeof o?(m.request=this.map._requestManager.transformRequest(p.exported.resolveURL(o),p.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(d,_)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new p.ErrorEvent(d));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(w.resourceTiming=_.resourceTiming[this.id]),this.fire(new p.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,o){const d=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(d,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,w)=>(delete m.request,m.unloadVectorData(),m.aborted?o(null):_?o(_):(m.loadVectorData(w,this.map.painter,"reloadTile"===d),o(null))),void 0,"loadTile"===d)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return p.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Q{constructor(m,o,d,_){super(m,o,d,_),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const o of m.urls)this.urls.push(this.map._requestManager.transformRequest(o,p.ResourceType.Source).url);p.getVideo(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new p.ErrorEvent(o)):d&&(this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const o=this.video.seekable;m<o.start(0)||m>o.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,o=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(m,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));for(const d in this.tiles){const _=this.tiles[d];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Q,canvas:class extends Q{constructor(m,o,d,_){super(m,o,d,_),o.coordinates?Array.isArray(o.coordinates)&&4===o.coordinates.length&&!o.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(C=>"number"!=typeof C))||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),o.animate&&"boolean"!=typeof o.animate&&this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),o.canvas?"string"==typeof o.canvas||o.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=o,this.animate=void 0===o.animate||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const o=this.map.painter.context,d=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(o,this.canvas,d.RGBA,{premultiply:!0});for(const _ in this.tiles){const w=this.tiles[_];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}}},W=function(m,o,d,_){const w=new $[o.type](m,o,d,_);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return p.bindAll(["load","abort","unload","serialize","prepare"],w),w};function re(m,o){const d=p.identity([]);return p.scale$1(d,d,[.5*m.width,.5*-m.height,1]),p.translate(d,d,[1,-1,0]),p.multiply(d,d,m.calculateProjMatrix(o.toUnwrapped()))}function le(m,o,d,_,w,C,M,k=!1){const O=m.tilesIn(_,M,k);O.sort(ve);const B=[];for(const q of O)B.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(o,d,m._state,q,w,C,re(m.transform,q.tile.tileID),k)});const U=function(q){const X={},Y={};for(const oe of q){const se=oe.queryResults,pe=oe.wrappedTileID,ie=Y[pe]=Y[pe]||{};for(const ae in se){const fe=se[ae],_e=ie[ae]=ie[ae]||{},we=X[ae]=X[ae]||[];for(const ce of fe)_e[ce.featureIndex]||(_e[ce.featureIndex]=!0,we.push(ce))}}return X}(B);for(const q in U)U[q].forEach(X=>{const Y=X.feature,oe=m.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=oe});return U}function ge(m,o){const d=m.getRenderableIds().map(C=>m.getTileByID(C)),_=[],w={};for(let C=0;C<d.length;C++){const M=d[C],k=M.tileID.canonical.key;w[k]||(w[k]=!0,M.querySourceFeatures(_,o))}return _}function ve(m,o){const d=m.tileID,_=o.tileID;return d.overscaledZ-_.overscaledZ||d.canonical.y-_.canonical.y||d.wrap-_.wrap||d.canonical.x-_.canonical.x}function Ee(){return null!=Lc.workerClass?new Lc.workerClass:new p.window.Worker(Lc.workerUrl)}const be="mapboxgl_preloaded_worker_pool";class Ae{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Ae.workerCount;)this.workers.push(new Ee);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[be]}numActive(){return Object.keys(this.active).length}}let Ge;function it(){return Ge||(Ge=new Ae),Ge}function He(m,o){const d={};for(const _ in m)"ref"!==_&&(d[_]=m[_]);return p.refProperties.forEach(_=>{_ in o&&(d[_]=o[_])}),d}function xt(m){m=m.slice();const o=Object.create(null);for(let d=0;d<m.length;d++)o[m[d].id]=m[d];for(let d=0;d<m.length;d++)"ref"in m[d]&&(m[d]=He(m[d],o[m[d].ref]));return m}Ae.workerCount=2;const xe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Ne(m,o,d){d.push({command:xe.addSource,args:[m,o[m]]})}function vt(m,o,d){o.push({command:xe.removeSource,args:[m]}),d[m]=!0}function qt(m,o,d,_){vt(m,d,_),Ne(m,o,d)}function Nt(m,o,d){let _;for(_ in m[d])if(m[d].hasOwnProperty(_)&&"data"!==_&&!Qe(m[d][_],o[d][_]))return!1;for(_ in o[d])if(o[d].hasOwnProperty(_)&&"data"!==_&&!Qe(m[d][_],o[d][_]))return!1;return!0}function vn(m,o,d,_,w,C){let M;for(M in o=o||{},m=m||{})m.hasOwnProperty(M)&&(Qe(m[M],o[M])||d.push({command:C,args:[_,M,o[M],w]}));for(M in o)o.hasOwnProperty(M)&&!m.hasOwnProperty(M)&&(Qe(m[M],o[M])||d.push({command:C,args:[_,M,o[M],w]}))}function rn(m){return m.id}function kn(m,o){return m[o.id]=o,m}class aa{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=p.clamp(o,0,1);let d=1,_=this._distances[d];const w=o*this.paddedLength+this.padding;for(;_<w&&d<this._distances.length;)_=this._distances[++d];const C=d-1,M=this._distances[C],k=_-M,O=k>0?(w-M)/k:0;return this.points[C].mult(1-O).add(this.points[d].mult(O))}}class lt{constructor(o,d,_){const w=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(o/_),this.yCellCount=Math.ceil(d/_);for(let M=0;M<this.xCellCount*this.yCellCount;M++)w.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,_,w,C){this._forEachCell(d,_,w,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(_),this.bboxes.push(w),this.bboxes.push(C)}insertCircle(o,d,_,w){this._forEachCell(d-w,_-w,d+w,_+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(_),this.circles.push(w)}_insertBoxCell(o,d,_,w,C,M){this.boxCells[C].push(M)}_insertCircleCell(o,d,_,w,C,M){this.circleCells[C].push(M)}_query(o,d,_,w,C,M){if(_<0||o>this.width||w<0||d>this.height)return!C&&[];const k=[];if(o<=0&&d<=0&&this.width<=_&&this.height<=w){if(C)return!0;for(let O=0;O<this.boxKeys.length;O++)k.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const B=this.circles[3*O],U=this.circles[3*O+1],q=this.circles[3*O+2];k.push({key:this.circleKeys[O],x1:B-q,y1:U-q,x2:B+q,y2:U+q})}return M?k.filter(M):k}return this._forEachCell(o,d,_,w,this._queryCell,k,{hitTest:C,seenUids:{box:{},circle:{}}},M),C?k.length>0:k}_queryCircle(o,d,_,w,C){const M=o-_,k=o+_,O=d-_,B=d+_;if(k<0||M>this.width||B<0||O>this.height)return!w&&[];const U=[];return this._forEachCell(M,O,k,B,this._queryCellCircle,U,{hitTest:w,circle:{x:o,y:d,radius:_},seenUids:{box:{},circle:{}}},C),w?U.length>0:U}query(o,d,_,w,C){return this._query(o,d,_,w,!1,C)}hitTest(o,d,_,w,C){return this._query(o,d,_,w,!0,C)}hitTestCircle(o,d,_,w){return this._queryCircle(o,d,_,!0,w)}_queryCell(o,d,_,w,C,M,k,O){const B=k.seenUids,U=this.boxCells[C];if(null!==U){const X=this.bboxes;for(const Y of U)if(!B.box[Y]){B.box[Y]=!0;const oe=4*Y;if(o<=X[oe+2]&&d<=X[oe+3]&&_>=X[oe+0]&&w>=X[oe+1]&&(!O||O(this.boxKeys[Y]))){if(k.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[Y],x1:X[oe],y1:X[oe+1],x2:X[oe+2],y2:X[oe+3]})}}}const q=this.circleCells[C];if(null!==q){const X=this.circles;for(const Y of q)if(!B.circle[Y]){B.circle[Y]=!0;const oe=3*Y;if(this._circleAndRectCollide(X[oe],X[oe+1],X[oe+2],o,d,_,w)&&(!O||O(this.circleKeys[Y]))){if(k.hitTest)return M.push(!0),!0;{const se=X[oe],pe=X[oe+1],ie=X[oe+2];M.push({key:this.circleKeys[Y],x1:se-ie,y1:pe-ie,x2:se+ie,y2:pe+ie})}}}}}_queryCellCircle(o,d,_,w,C,M,k,O){const B=k.circle,U=k.seenUids,q=this.boxCells[C];if(null!==q){const Y=this.bboxes;for(const oe of q)if(!U.box[oe]){U.box[oe]=!0;const se=4*oe;if(this._circleAndRectCollide(B.x,B.y,B.radius,Y[se+0],Y[se+1],Y[se+2],Y[se+3])&&(!O||O(this.boxKeys[oe])))return M.push(!0),!0}}const X=this.circleCells[C];if(null!==X){const Y=this.circles;for(const oe of X)if(!U.circle[oe]){U.circle[oe]=!0;const se=3*oe;if(this._circlesCollide(Y[se],Y[se+1],Y[se+2],B.x,B.y,B.radius)&&(!O||O(this.circleKeys[oe])))return M.push(!0),!0}}}_forEachCell(o,d,_,w,C,M,k,O){const B=this._convertToXCellCoord(o),U=this._convertToYCellCoord(d),q=this._convertToXCellCoord(_),X=this._convertToYCellCoord(w);for(let Y=B;Y<=q;Y++)for(let oe=U;oe<=X;oe++)if(C.call(this,o,d,_,w,this.xCellCount*oe+Y,M,k,O))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,_,w,C,M){const k=w-o,O=C-d,B=_+M;return B*B>k*k+O*O}_circleAndRectCollide(o,d,_,w,C,M,k){const O=(M-w)/2,B=Math.abs(o-(w+O));if(B>O+_)return!1;const U=(k-C)/2,q=Math.abs(d-(C+U));if(q>U+_)return!1;if(B<=O||q<=U)return!0;const X=B-O,Y=q-U;return X*X+Y*Y<=_*_}}const Gt=Math.tan(85*Math.PI/180);function Ct(m,o,d,_,w){const C=p.create$1();return o?(p.scale$1(C,C,[1/w,1/w,1]),d||p.rotateZ(C,C,_.angle)):p.multiply(C,_.labelPlaneMatrix,m),C}function xn(m,o,d,_,w){if(o){const C=p.clone$1(m);return p.scale$1(C,C,[w,w,1]),d||p.rotateZ(C,C,-_.angle),C}return _.glCoordMatrix}function cr(m,o,d=0){const _=[m.x,m.y,d,1];d?p.transformMat4(_,_,o):Dr(_,_,o);const w=_[3];return{point:new p.pointGeometry(_[0]/w,_[1]/w),signedDistanceFromCamera:w}}function Vt(m,o){return Math.min(.5+m/o*.5,1.5)}function An(m,o){const d=m[0]/m[3],_=m[1]/m[3];return d>=-o[0]&&d<=o[0]&&_>=-o[1]&&_<=o[1]}function mt(m,o,d,_,w,C,M,k,O){const B=_?m.textSizeData:m.iconSizeData,U=p.evaluateSizeForZoom(B,d.transform.zoom),q=[256/d.width*2+1,256/d.height*2+1],X=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;X.clear();const Y=m.lineVertexArray,oe=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,se=d.transform.width/d.transform.height;let pe=!1;for(let ie=0;ie<oe.length;ie++){const ae=oe.get(ie);if(ae.writingMode!==p.WritingMode.vertical||pe||0!==ie&&oe.get(ie-1).writingMode===p.WritingMode.horizontal||(pe=!0),ae.hidden||ae.writingMode===p.WritingMode.vertical&&!pe){Br(ae.numGlyphs,X);continue}pe=!1;const fe=new p.pointGeometry(ae.tileAnchorX,ae.tileAnchorY),_e=O?O(fe):0,we=[fe.x,fe.y,_e],ce=[...we,1];if(p.transformMat4(ce,ce,o),!An(ce,q)){Br(ae.numGlyphs,X);continue}const Se=Vt(d.transform.cameraToCenterDistance,ce[3]),je=p.evaluateSizeForFeature(B,U,ae),We=M?je/Se:je*Se,Te=cr(new p.pointGeometry(we[0],we[1]),w,we[2]);if(Te.signedDistanceFromCamera<=0){Br(ae.numGlyphs,X);continue}let ze={};const ct=M?null:O,ht=fn(ae,We,!1,k,o,w,C,m.glyphOffsetArray,Y,X,Te.point,fe,ze,se,ct);pe=ht.useVertical,ct&&ht.needsFlipping&&(ze={}),(ht.notEnoughRoom||pe||ht.needsFlipping&&fn(ae,We,!0,k,o,w,C,m.glyphOffsetArray,Y,X,Te.point,fe,ze,se,ct).notEnoughRoom)&&Br(ae.numGlyphs,X)}_?m.text.dynamicLayoutVertexBuffer.updateData(X):m.icon.dynamicLayoutVertexBuffer.updateData(X)}function la(m,o,d,_,w,C,M,k,O,B,U,q,X){const Y=k.glyphStartIndex+k.numGlyphs,oe=k.lineStartIndex,se=k.lineStartIndex+k.lineLength,pe=o.getoffsetX(k.glyphStartIndex),ie=o.getoffsetX(Y-1),ae=Qn(m*pe,d,_,w,C,M,k.segment,oe,se,O,B,U,q,X,!0);if(!ae)return null;const fe=Qn(m*ie,d,_,w,C,M,k.segment,oe,se,O,B,U,q,X,!0);return fe?{first:ae,last:fe}:null}function Rn(m,o,d,_){return m.writingMode===p.WritingMode.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*_?{useVertical:!0}:m.writingMode===p.WritingMode.vertical?o.y<d.y?{needsFlipping:!0}:null:0!==m.flipState&&function(w,C,M){const k=(C.x-w.x)*M;return 0===k||Math.abs((C.y-w.y)/k)>Gt}(o,d,_)?1===m.flipState?{needsFlipping:!0}:null:o.x>d.x?{needsFlipping:!0}:null}function fn(m,o,d,_,w,C,M,k,O,B,U,q,X,Y,oe){const se=o/24,pe=m.lineOffsetX*se,ie=m.lineOffsetY*se;let ae;if(m.numGlyphs>1){const fe=m.glyphStartIndex+m.numGlyphs,_e=m.lineStartIndex,we=m.lineStartIndex+m.lineLength,ce=la(se,k,pe,ie,d,U,q,m,O,C,X,oe,!1);if(!ce)return{notEnoughRoom:!0};const Se=cr(ce.first.point,M).point,je=cr(ce.last.point,M).point;if(_&&!d){const We=Rn(m,Se,je,Y);if(m.flipState=We&&We.needsFlipping?1:2,We)return We}ae=[ce.first];for(let We=m.glyphStartIndex+1;We<fe-1;We++)ae.push(Qn(se*k.getoffsetX(We),pe,ie,d,U,q,m.segment,_e,we,O,C,X,oe,!1,!1));ae.push(ce.last)}else{if(_&&!d){const _e=cr(q,w).point,we=m.lineStartIndex+m.segment+1,ce=new p.pointGeometry(O.getx(we),O.gety(we)),Se=cr(ce,w),je=Rn(m,_e,Se.signedDistanceFromCamera>0?Se.point:Ut(q,ce,_e,1,w,void 0),Y);if(m.flipState=je&&je.needsFlipping?1:2,je)return je}const fe=Qn(se*k.getoffsetX(m.glyphStartIndex),pe,ie,d,U,q,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,O,C,X,oe,!1,!1);if(!fe)return{notEnoughRoom:!0};ae=[fe]}for(const fe of ae)p.addDynamicAttributes(B,fe.point,fe.angle);return{}}function Nl(m,o,d){const _={x:m.x,y:m.y,z:0};if(!d)return cr(_,o,_.z);const w=d(m);return cr(new p.pointGeometry(_.x,_.y),o,_.z+w)}function Ut(m,o,d,_,w,C){const M=Nl(m.add(m.sub(o)._unit()),w,C).point,k=d.sub(M);return d.add(k._mult(_/k.mag()))}function Qn(m,o,d,_,w,C,M,k,O,B,U,q,X,Y,oe){const se=_?m-o:m+o;let pe=se>0?1:-1,ie=0;_&&(pe*=-1,ie=Math.PI),pe<0&&(ie+=Math.PI);let ae=pe>0?k+M:k+M+1,fe=w,_e=w,we=0,ce=0;const Se=Math.abs(se),je=[],We=[];let Te=C;const ze=()=>{const sn=ae-pe;return 0===we?C:new p.pointGeometry(B.getx(sn),B.gety(sn))},ct=()=>Ut(ze(),Te,_e,Se-we+1,U,X);for(;we+ce<=Se;){if(ae+=pe,ae<k||ae>=O)return null;if(_e=fe,je.push(fe),Y&&We.push(Te||ze()),fe=q[ae],void 0===fe){Te=new p.pointGeometry(B.getx(ae),B.gety(ae));const sn=Nl(Te,U,X);fe=sn.signedDistanceFromCamera>0?q[ae]=sn.point:ct()}else Te=null;we+=ce,ce=_e.dist(fe)}oe&&X&&(Te=Te||new p.pointGeometry(B.getx(ae),B.gety(ae)),q[ae]=fe=void 0===q[ae]?fe:ct(),ce=_e.dist(fe));const ht=(Se-we)/ce,ut=fe.sub(_e),tt=ut.mult(ht)._add(_e);d&&tt._add(ut._unit()._perp()._mult(d*pe));const ft=ie+Math.atan2(fe.y-_e.y,fe.x-_e.x);return je.push(tt),Y&&(Te=Te||new p.pointGeometry(B.getx(ae),B.gety(ae)),We.push(function(sn,kt,Mi){const ai=1-Mi;return new p.pointGeometry(sn.x*ai+kt.x*Mi,sn.y*ai+kt.y*Mi)}(We.length>0?We[We.length-1]:Te,Te,ht))),{point:tt,angle:ft,path:je,tilePath:We}}const ca=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Br(m,o){for(let d=0;d<m;d++){const _=o.length;o.resize(_+4),o.float32.set(ca,3*_)}}function Dr(m,o,d){const _=o[0],w=o[1];return m[0]=d[0]*_+d[4]*w+d[12],m[1]=d[1]*_+d[5]*w+d[13],m[3]=d[3]*_+d[7]*w+d[15],m}const $t=100;class hl{constructor(o,d,_=new lt(o.width+200,o.height+200,25),w=new lt(o.width+200,o.height+200,25)){this.transform=o,this.grid=_,this.ignoredGrid=w,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+$t,this.screenBottomBoundary=o.height+$t,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,_,w,C,M,k){let O=d.projectedAnchorZ;d.elevation&&(O+=d.elevation);const B=this.projectAndGetPerspectiveRatio(M,d.projectedAnchorX,d.projectedAnchorY,O,d.tileID),U=C*B.perspectiveRatio,q=(d.x1*o+_.x-d.padding)*U+B.point.x,X=(d.y1*o+_.y-d.padding)*U+B.point.y,Y=(d.x2*o+_.x+d.padding)*U+B.point.x,oe=(d.y2*o+_.y+d.padding)*U+B.point.y,se=B.perspectiveRatio<=.55||B.aboveHorizon;return!this.isInsideGrid(q,X,Y,oe)||!w&&this.grid.hitTest(q,X,Y,oe,k)||se?{box:[],offscreen:!1}:{box:[q,X,Y,oe],offscreen:this.isOffscreen(q,X,Y,oe)}}placeCollisionCircles(o,d,_,w,C,M,k,O,B,U,q,X,Y,oe){const se=[],pe=this.transform.elevation,ie=pe?ct=>pe.getAtTileOffset(oe,ct.x,ct.y):ct=>0,ae=new p.pointGeometry(d.tileAnchorX,d.tileAnchorY),fe=ie(ae),_e=this.projectAndGetPerspectiveRatio(M,ae.x,ae.y,fe,oe),{perspectiveRatio:we}=_e,ce=(U?C/we:C*we)/p.ONE_EM,Se=cr(ae,k,fe).point,je=_e.signedDistanceFromCamera>0?la(ce,w,d.lineOffsetX*ce,d.lineOffsetY*ce,!1,Se,ae,d,_,k,{},pe&&!U?ie:null,U&&!!pe):null;let We=!1,Te=!1,ze=!0;if(je&&!_e.aboveHorizon){const ct=.5*X*we+Y,ht=new p.pointGeometry(-100,-100),ut=new p.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),tt=new aa,ft=je.first,sn=je.last;let kt=[];for(let Zt=ft.path.length-1;Zt>=1;Zt--)kt.push(ft.path[Zt]);for(let Zt=1;Zt<sn.path.length;Zt++)kt.push(sn.path[Zt]);const Mi=2.5*ct;if(O){const Zt=kt.map(pe?(an,bi)=>{const Co=ie(bi<ft.path.length-1?ft.tilePath[ft.path.length-1-bi]:sn.tilePath[bi-ft.path.length+2]);return cr(an,O,Co)}:an=>cr(an,O));kt=Zt.some(an=>an.signedDistanceFromCamera<=0)?[]:Zt.map(an=>an.point)}let ai=[];if(kt.length>0){const Zt=kt[0].clone(),an=kt[0].clone();for(let bi=1;bi<kt.length;bi++)Zt.x=Math.min(Zt.x,kt[bi].x),Zt.y=Math.min(Zt.y,kt[bi].y),an.x=Math.max(an.x,kt[bi].x),an.y=Math.max(an.y,kt[bi].y);ai=Zt.x>=ht.x&&an.x<=ut.x&&Zt.y>=ht.y&&an.y<=ut.y?[kt]:an.x<ht.x||Zt.x>ut.x||an.y<ht.y||Zt.y>ut.y?[]:p.clipLine([kt],ht.x,ht.y,ut.x,ut.y)}for(const Zt of ai){tt.reset(Zt,.25*ct);let an=0;an=tt.length<=.5*ct?1:Math.ceil(tt.paddedLength/Mi)+1;for(let bi=0;bi<an;bi++){const Co=bi/Math.max(an-1,1),zo=tt.lerp(Co),io=zo.x+$t,Eo=zo.y+$t;se.push(io,Eo,ct,0);const Vs=io-ct,Bo=Eo-ct,pn=io+ct,ui=Eo+ct;if(ze=ze&&this.isOffscreen(Vs,Bo,pn,ui),Te=Te||this.isInsideGrid(Vs,Bo,pn,ui),!o&&this.grid.hitTestCircle(io,Eo,ct,q)&&(We=!0,!B))return{circles:[],offscreen:!1,collisionDetected:We}}}}return{circles:!B&&We||!Te?[]:se,offscreen:ze,collisionDetected:We}}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let _=1/0,w=1/0,C=-1/0,M=-1/0;for(const U of o){const q=new p.pointGeometry(U.x+$t,U.y+$t);_=Math.min(_,q.x),w=Math.min(w,q.y),C=Math.max(C,q.x),M=Math.max(M,q.y),d.push(q)}const k=this.grid.query(_,w,C,M).concat(this.ignoredGrid.query(_,w,C,M)),O={},B={};for(const U of k){const q=U.key;if(void 0===O[q.bucketInstanceId]&&(O[q.bucketInstanceId]={}),O[q.bucketInstanceId][q.featureIndex])continue;const X=[new p.pointGeometry(U.x1,U.y1),new p.pointGeometry(U.x2,U.y1),new p.pointGeometry(U.x2,U.y2),new p.pointGeometry(U.x1,U.y2)];p.polygonIntersectsPolygon(d,X)&&(O[q.bucketInstanceId][q.featureIndex]=!0,void 0===B[q.bucketInstanceId]&&(B[q.bucketInstanceId]=[]),B[q.bucketInstanceId].push(q.featureIndex))}return B}insertCollisionBox(o,d,_,w,C){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:C},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,_,w,C){const M=d?this.ignoredGrid:this.grid,k={bucketInstanceId:_,featureIndex:w,collisionGroupID:C};for(let O=0;O<o.length;O+=4)M.insertCircle(k,o[O],o[O+1],o[O+2])}projectAndGetPerspectiveRatio(o,d,_,w,C){const M=[d,_,w||0,1];let k=!1;if(w||this.transform.pitch>0){p.transformMat4(M,M,o);let O=!1;this.fogState&&C&&(O=function(B,U,q,X,Y,oe){const se=oe.calculateFogTileMatrix(Y),pe=[U,q,X];return p.transformMat4$1(pe,pe,se),ka(B,pe,oe.pitch,oe._fov)}(this.fogState,d,_,w||0,C.toUnwrapped(),this.transform)>.9),k=M[2]>M[3]||O}else Dr(M,M,o);return{point:new p.pointGeometry((M[0]/M[3]+1)/2*this.transform.width+$t,(-M[1]/M[3]+1)/2*this.transform.height+$t),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/M[3]*.5,1.5),signedDistanceFromCamera:M[3],aboveHorizon:k}}isOffscreen(o,d,_,w){return _<$t||o>=this.screenRightBoundary||w<$t||d>this.screenBottomBoundary}isInsideGrid(o,d,_,w){return _>=0&&o<this.gridRightBoundary&&w>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=p.identity([]);return p.translate(o,o,[-100,-100,0]),o}}class wt{constructor(o,d,_,w){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):w&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class cn{constructor(o,d,_,w,C){this.text=new wt(o?o.text:null,d,_,C),this.icon=new wt(o?o.icon:null,d,w,C)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ni{constructor(o,d,_){this.text=o,this.icon=d,this.skipFade=_}}class vo{constructor(){this.invProjMatrix=p.create$1(),this.viewportMatrix=p.create$1(),this.circles=[]}}class Is{constructor(o,d,_,w,C){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=_,this.bucketIndex=w,this.tileID=C}}class Li{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:_=>_.collisionGroupID===d}}return this.collisionGroups[o]}}function ur(m,o,d,_,w){const{horizontalAlign:C,verticalAlign:M}=p.getAnchorAlignment(m),k=-(C-.5)*o,O=-(M-.5)*d,B=p.evaluateVariableOffset(m,_);return new p.pointGeometry(k+B[0]*w,O+B[1]*w)}function Ei(m,o,d,_,w){const C=new p.pointGeometry(m,o);return d&&C._rotate(_?w:-w),C}class Ji{constructor(o,d,_,w,C){this.transform=o.clone(),this.collisionIndex=new hl(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Li(_),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,_,w){const C=_.getBucket(d),M=_.latestFeatureIndex;if(!C||!M||d.id!==C.layerIds[0])return;const k=_.collisionBoxArray,O=C.layers[0].layout,B=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),U=_.tileSize/p.EXTENT,q=this.transform.calculateProjMatrix(_.tileID.toUnwrapped()),X="map"===O.get("text-pitch-alignment"),Y="map"===O.get("text-rotation-alignment"),oe=ni(_,1,this.transform.zoom),se=Ct(q,X,Y,this.transform,oe);let pe=null;if(X){const ae=xn(q,X,Y,this.transform,oe);pe=p.multiply([],this.transform.labelPlaneMatrix,ae)}this.retainedQueryData[C.bucketInstanceId]=new Is(C.bucketInstanceId,M,C.sourceLayerIndex,C.index,_.tileID);const ie={bucket:C,layout:O,posMatrix:q,textLabelPlaneMatrix:se,labelToScreenMatrix:pe,scale:B,textPixelRatio:U,holdingForFade:_.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:p.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(w)for(const ae of C.sortKeyRanges){const{sortKey:fe,symbolInstanceStart:_e,symbolInstanceEnd:we}=ae;o.push({sortKey:fe,symbolInstanceStart:_e,symbolInstanceEnd:we,parameters:ie})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:ie})}attemptAnchorPlacement(o,d,_,w,C,M,k,O,B,U,q,X,Y,oe,se,pe,ie,ae){const fe=[X.textOffset0,X.textOffset1],_e=ur(o,_,w,fe,C),we=this.collisionIndex.placeCollisionBox(C,d,Ei(_e.x,_e.y,M,k,this.transform.angle),q,O,B,U.predicate);if((!pe||0!==this.collisionIndex.placeCollisionBox(oe.getSymbolInstanceIconSize(ae,this.transform.zoom,Y),pe,Ei(_e.x,_e.y,M,k,this.transform.angle),q,O,B,U.predicate).box.length)&&we.box.length>0){let ce;return this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(ce=this.prevPlacement.variableOffsets[X.crossTileID].anchor),this.variableOffsets[X.crossTileID]={textOffset:fe,width:_,height:w,anchor:o,textScale:C,prevAnchor:ce},this.markUsedJustification(oe,o,X,se),oe.allowVerticalPlacement&&(this.markUsedOrientation(oe,se,X),this.placedOrientations[X.crossTileID]=se),{shift:_e,placedGlyphBoxes:we}}}placeLayerBucketPart(o,d,_,w){const{bucket:C,layout:M,posMatrix:k,textLabelPlaneMatrix:O,labelToScreenMatrix:B,textPixelRatio:U,holdingForFade:q,collisionBoxArray:X,partiallyEvaluatedTextSize:Y,partiallyEvaluatedIconSize:oe,collisionGroup:se}=o.parameters,pe=M.get("text-optional"),ie=M.get("icon-optional"),ae=M.get("text-allow-overlap"),fe=M.get("icon-allow-overlap"),_e="map"===M.get("text-rotation-alignment"),we="map"===M.get("text-pitch-alignment"),ce="none"!==M.get("icon-text-fit"),Se="viewport-y"===M.get("symbol-z-order"),je=ae&&(fe||!C.hasIconData()||ie),We=fe&&(ae||!C.hasTextData()||pe);!C.collisionArrays&&X&&C.deserializeCollisionBoxes(X),_&&w&&C.updateCollisionDebugBuffers(this.transform.zoom,X);const Te=(ze,ct,ht)=>{if(d[ze.crossTileID])return;if(q)return void(this.placements[ze.crossTileID]=new Ni(!1,!1,!1));let ut=!1,tt=!1,ft=!0,sn=null,kt={box:null,offscreen:null},Mi={box:null,offscreen:null},ai=null,Zt=null,an=null,bi=0,Co=0,zo=0;ht.textFeatureIndex?bi=ht.textFeatureIndex:ze.useRuntimeCollisionCircles&&(bi=ze.featureIndex),ht.verticalTextFeatureIndex&&(Co=ht.verticalTextFeatureIndex);const io=pn=>{pn.tileID=this.retainedQueryData[C.bucketInstanceId].tileID,(this.transform.elevation||pn.elevation)&&(pn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[C.bucketInstanceId].tileID,pn.tileAnchorX,pn.tileAnchorY):0)},Eo=ht.textBox;if(Eo){io(Eo);const pn=En=>{let ri=p.WritingMode.horizontal;if(C.allowVerticalPlacement&&!En&&this.prevPlacement){const gr=this.prevPlacement.placedOrientations[ze.crossTileID];gr&&(this.placedOrientations[ze.crossTileID]=gr,ri=gr,this.markUsedOrientation(C,ri,ze))}return ri},ui=(En,ri)=>{if(C.allowVerticalPlacement&&ze.numVerticalGlyphVertices>0&&ht.verticalTextBox){for(const gr of C.writingModes)if(gr===p.WritingMode.vertical?(kt=ri(),Mi=kt):kt=En(),kt&&kt.box&&kt.box.length)break}else kt=En()};if(M.get("text-variable-anchor")){let En=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ze.crossTileID]){const jn=this.prevPlacement.variableOffsets[ze.crossTileID];En.indexOf(jn.anchor)>0&&(En=En.filter(Ki=>Ki!==jn.anchor),En.unshift(jn.anchor))}const ri=(jn,Ki,Vo)=>{const ro=C.getSymbolInstanceTextSize(Y,ze,this.transform.zoom,ct),Oc=(jn.x2-jn.x1)*ro+2*jn.padding,Od=(jn.y2-jn.y1)*ro+2*jn.padding,eh=ce&&!fe?Ki:null;eh&&io(eh);let Fc={box:[],offscreen:!1};const Fd=ae?2*En.length:En.length;for(let Yt=0;Yt<Fd;++Yt){const th=this.attemptAnchorPlacement(En[Yt%En.length],jn,Oc,Od,ro,_e,we,U,k,se,Yt>=En.length,ze,ct,C,Vo,eh,Y,oe);if(th&&(Fc=th.placedGlyphBoxes,Fc&&Fc.box&&Fc.box.length)){ut=!0,sn=th.shift;break}}return Fc};ui(()=>ri(Eo,ht.iconBox,p.WritingMode.horizontal),()=>{const jn=ht.verticalTextBox;return jn&&io(jn),C.allowVerticalPlacement&&!(kt&&kt.box&&kt.box.length)&&ze.numVerticalGlyphVertices>0&&jn?ri(jn,ht.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null}}),kt&&(ut=kt.box,ft=kt.offscreen);const gr=pn(kt&&kt.box);if(!ut&&this.prevPlacement){const jn=this.prevPlacement.variableOffsets[ze.crossTileID];jn&&(this.variableOffsets[ze.crossTileID]=jn,this.markUsedJustification(C,jn.anchor,ze,gr))}}else{const En=(ri,gr)=>{const jn=C.getSymbolInstanceTextSize(Y,ze,this.transform.zoom,ct),Ki=this.collisionIndex.placeCollisionBox(jn,ri,new p.pointGeometry(0,0),ae,U,k,se.predicate);return Ki&&Ki.box&&Ki.box.length&&(this.markUsedOrientation(C,gr,ze),this.placedOrientations[ze.crossTileID]=gr),Ki};ui(()=>En(Eo,p.WritingMode.horizontal),()=>{const ri=ht.verticalTextBox;return C.allowVerticalPlacement&&ze.numVerticalGlyphVertices>0&&ri?(io(ri),En(ri,p.WritingMode.vertical)):{box:null,offscreen:null}}),pn(kt&&kt.box&&kt.box.length)}}if(ai=kt,ut=ai&&ai.box&&ai.box.length>0,ft=ai&&ai.offscreen,ze.useRuntimeCollisionCircles){const pn=C.text.placedSymbolArray.get(ze.centerJustifiedTextSymbolIndex>=0?ze.centerJustifiedTextSymbolIndex:ze.verticalPlacedTextSymbolIndex),ui=p.evaluateSizeForFeature(C.textSizeData,Y,pn),En=M.get("text-padding");Zt=this.collisionIndex.placeCollisionCircles(ae,pn,C.lineVertexArray,C.glyphOffsetArray,ui,k,O,B,_,we,se.predicate,ze.collisionCircleDiameter*ui/p.ONE_EM,En,this.retainedQueryData[C.bucketInstanceId].tileID),ut=ae||Zt.circles.length>0&&!Zt.collisionDetected,ft=ft&&Zt.offscreen}if(ht.iconFeatureIndex&&(zo=ht.iconFeatureIndex),ht.iconBox){const pn=ui=>{io(ui);const En=ce&&sn?Ei(sn.x,sn.y,_e,we,this.transform.angle):new p.pointGeometry(0,0),ri=C.getSymbolInstanceIconSize(oe,this.transform.zoom,ct);return this.collisionIndex.placeCollisionBox(ri,ui,En,fe,U,k,se.predicate)};Mi&&Mi.box&&Mi.box.length&&ht.verticalIconBox?(an=pn(ht.verticalIconBox),tt=an.box.length>0):(an=pn(ht.iconBox),tt=an.box.length>0),ft=ft&&an.offscreen}const Vs=pe||0===ze.numHorizontalGlyphVertices&&0===ze.numVerticalGlyphVertices,Bo=ie||0===ze.numIconVertices;if(Vs||Bo?Bo?Vs||(tt=tt&&ut):ut=tt&&ut:tt=ut=tt&&ut,ut&&ai&&ai.box&&this.collisionIndex.insertCollisionBox(ai.box,M.get("text-ignore-placement"),C.bucketInstanceId,Mi&&Mi.box&&Co?Co:bi,se.ID),tt&&an&&this.collisionIndex.insertCollisionBox(an.box,M.get("icon-ignore-placement"),C.bucketInstanceId,zo,se.ID),Zt&&(ut&&this.collisionIndex.insertCollisionCircles(Zt.circles,M.get("text-ignore-placement"),C.bucketInstanceId,bi,se.ID),_)){const pn=C.bucketInstanceId;let ui=this.collisionCircleArrays[pn];void 0===ui&&(ui=this.collisionCircleArrays[pn]=new vo);for(let En=0;En<Zt.circles.length;En+=4)ui.circles.push(Zt.circles[En+0]),ui.circles.push(Zt.circles[En+1]),ui.circles.push(Zt.circles[En+2]),ui.circles.push(Zt.collisionDetected?1:0)}this.placements[ze.crossTileID]=new Ni(ut||je,tt||We,ft||C.justReloaded),d[ze.crossTileID]=!0};if(Se){const ze=C.getSortedSymbolIndexes(this.transform.angle);for(let ct=ze.length-1;ct>=0;--ct){const ht=ze[ct];Te(C.symbolInstances.get(ht),ht,C.collisionArrays[ht])}}else for(let ze=o.symbolInstanceStart;ze<o.symbolInstanceEnd;ze++)Te(C.symbolInstances.get(ze),ze,C.collisionArrays[ze]);if(_&&C.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[C.bucketInstanceId];p.invert(ze.invProjMatrix,k),ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,d,_,w){let C;C=w===p.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(d)];const M=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];for(const k of M)k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=C>=0&&k!==C?0:_.crossTileID)}markUsedOrientation(o,d,_){const w=d===p.WritingMode.horizontal||d===p.WritingMode.horizontalOnly?d:0,C=d===p.WritingMode.vertical?d:0,M=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];for(const k of M)o.text.placedSymbolArray.get(k).placedOrientation=w;_.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=C)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let _=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const w=d?d.symbolFadeChange(o):1,C=d?d.opacities:{},M=d?d.variableOffsets:{},k=d?d.placedOrientations:{};for(const O in this.placements){const B=this.placements[O],U=C[O];U?(this.opacities[O]=new cn(U,w,B.text,B.icon),_=_||B.text!==U.text.placed||B.icon!==U.icon.placed):(this.opacities[O]=new cn(null,w,B.text,B.icon,B.skipFade),_=_||B.text||B.icon)}for(const O in C){const B=C[O];if(!this.opacities[O]){const U=new cn(B,w,!1,!1);U.isHidden()||(this.opacities[O]=U,_=_||B.text.placed||B.icon.placed)}}for(const O in M)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=M[O]);for(const O in k)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=k[O]);_?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const _={};for(const w of d){const C=w.getBucket(o);C&&w.latestFeatureIndex&&o.id===C.layerIds[0]&&this.updateBucketOpacities(C,_,w.collisionBoxArray)}}updateBucketOpacities(o,d,_){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const w=o.layers[0].layout,C=new cn(null,0,!1,!1,!0),M=w.get("text-allow-overlap"),k=w.get("icon-allow-overlap"),O=w.get("text-variable-anchor"),B="map"===w.get("text-rotation-alignment"),U="map"===w.get("text-pitch-alignment"),q="none"!==w.get("icon-text-fit"),X=new cn(null,0,M&&(k||!o.hasIconData()||w.get("icon-optional")),k&&(M||!o.hasTextData()||w.get("text-optional")),!0);!o.collisionArrays&&_&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(_);const Y=(oe,se,pe)=>{for(let ie=0;ie<se/4;ie++)oe.opacityVertexArray.emplaceBack(pe)};for(let oe=0;oe<o.symbolInstances.length;oe++){const se=o.symbolInstances.get(oe),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:ie,crossTileID:ae}=se;let fe=this.opacities[ae];d[ae]?fe=C:fe||(fe=X,this.opacities[ae]=fe),d[ae]=!0;const _e=se.numIconVertices>0,we=this.placedOrientations[se.crossTileID],ce=we===p.WritingMode.vertical,Se=we===p.WritingMode.horizontal||we===p.WritingMode.horizontalOnly;if(pe>0||ie>0){const je=Ti(fe.text);Y(o.text,pe,ce?On:je),Y(o.text,ie,Se?On:je);const We=fe.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach(ct=>{ct>=0&&(o.text.placedSymbolArray.get(ct).hidden=We||ce?1:0)}),se.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=We||Se?1:0);const Te=this.variableOffsets[se.crossTileID];Te&&this.markUsedJustification(o,Te.anchor,se,we);const ze=this.placedOrientations[se.crossTileID];ze&&(this.markUsedJustification(o,"left",se,ze),this.markUsedOrientation(o,ze,se))}if(_e){const je=Ti(fe.icon);se.placedIconSymbolIndex>=0&&(Y(o.icon,se.numIconVertices,ce?On:je),o.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=fe.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(Y(o.icon,se.numVerticalIconVertices,Se?On:je),o.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const je=o.collisionArrays[oe];if(je){let We=new p.pointGeometry(0,0);if(je.textBox||je.verticalTextBox){let ze=!0;if(O){const ct=this.variableOffsets[ae];ct?(We=ur(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textScale),B&&We._rotate(U?this.transform.angle:-this.transform.angle)):ze=!1}je.textBox&&ua(o.textCollisionBox.collisionVertexArray,fe.text.placed,!ze||ce,We.x,We.y),je.verticalTextBox&&ua(o.textCollisionBox.collisionVertexArray,fe.text.placed,!ze||Se,We.x,We.y)}const Te=Boolean(!Se&&je.verticalIconBox);je.iconBox&&ua(o.iconCollisionBox.collisionVertexArray,fe.icon.placed,Te,q?We.x:0,q?We.y:0),je.verticalIconBox&&ua(o.iconCollisionBox.collisionVertexArray,fe.icon.placed,!Te,q?We.x:0,q?We.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=oe.invProjMatrix,o.placementViewportMatrix=oe.viewportMatrix,o.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const _=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*_>o}setStale(){this.stale=!0}}function ua(m,o,d,_,w){m.emplaceBack(o?1:0,d?1:0,_||0,w||0),m.emplaceBack(o?1:0,d?1:0,_||0,w||0),m.emplaceBack(o?1:0,d?1:0,_||0,w||0),m.emplaceBack(o?1:0,d?1:0,_||0,w||0)}const zn=Math.pow(2,25),Na=Math.pow(2,24),za=Math.pow(2,17),Wu=Math.pow(2,16),cs=Math.pow(2,9),Un=Math.pow(2,8),mn=Math.pow(2,1);function Ti(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const o=m.placed?1:0,d=Math.floor(127*m.opacity);return d*zn+o*Na+d*za+o*Wu+d*cs+o*Un+d*mn+o}const On=0;class bn{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&void 0!==o.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,_,w,C){const M=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(M,w,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((k,O)=>k.sortKey-O.sortKey));this._currentPartIndex<M.length;){const k=M[this._currentPartIndex];if(d.placeLayerBucketPart(k,this._seenCrossTileIDs,_,0===k.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class ha{constructor(o,d,_,w,C,M,k,O){this.placement=new Ji(o,C,M,k,O),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,d,_){const w=p.exported.now(),C=()=>{const M=p.exported.now()-w;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=d[o[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if("symbol"===M.type&&(!M.minzoom||M.minzoom<=k)&&(!M.maxzoom||M.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new bn(M)),this._inProgressLayer.continuePlacement(_[M.source],this.placement,this._showCollisionBoxes,M,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ps=512/p.EXTENT/2;class zl{constructor(o,d,_){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let w=0;w<d.length;w++){const C=d.get(w),M=C.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:C.crossTileID,coord:this.getScaledCoordinates(C,o)})}}getScaledCoordinates(o,d){const _=Ps/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*p.EXTENT+o.tileAnchorX)*_),y:Math.floor((d.canonical.y*p.EXTENT+o.tileAnchorY)*_)}}findMatches(o,d,_){const w=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let C=0;C<o.length;C++){const M=o.get(C);if(M.crossTileID)continue;const k=this.indexedSymbolInstances[M.key];if(!k)continue;const O=this.getScaledCoordinates(M,d);for(const B of k)if(Math.abs(B.coord.x-O.x)<=w&&Math.abs(B.coord.y-O.y)<=w&&!_[B.crossTileID]){_[B.crossTileID]=!0,M.crossTileID=B.crossTileID;break}}}}class da{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Bl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(0!==d)for(const _ in this.indexes){const w=this.indexes[_],C={};for(const M in w){const k=w[M];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+d),C[k.tileID.key]=k}this.indexes[_]=C}this.lng=o}addBucket(o,d,_){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let C=0;C<d.symbolInstances.length;C++)d.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const w=this.usedCrossTileIDs[o.overscaledZ];for(const C in this.indexes){const M=this.indexes[C];if(Number(C)>o.overscaledZ)for(const k in M){const O=M[k];O.tileID.isChildOf(o)&&O.findMatches(d.symbolInstances,o,w)}else{const k=M[o.scaledTo(Number(C)).key];k&&k.findMatches(d.symbolInstances,o,w)}}for(let C=0;C<d.symbolInstances.length;C++){const M=d.symbolInstances.get(C);M.crossTileID||(M.crossTileID=_.generate(),w[M.crossTileID]=!0)}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new zl(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const _ in d.indexedSymbolInstances)for(const w of d.indexedSymbolInstances[_])delete this.usedCrossTileIDs[o][w.crossTileID]}removeStaleBuckets(o){let d=!1;for(const _ in this.indexes){const w=this.indexes[_];for(const C in w)o[w[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,w[C]),delete w[C],d=!0)}return d}}class Yr{constructor(){this.layerIndexes={},this.crossTileIDs=new da,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,_){let w=this.layerIndexes[o.id];void 0===w&&(w=this.layerIndexes[o.id]=new Bl);let C=!1;const M={};w.handleWrapJump(_);for(const k of d){const O=k.getBucket(o);O&&o.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(k.tileID,O,this.crossTileIDs)&&(C=!0),M[O.bucketInstanceId]=!0)}return w.removeStaleBuckets(M)&&(C=!0),C}pruneUnusedLayers(o){const d={};o.forEach(_=>{d[_]=!0});for(const _ in this.layerIndexes)d[_]||delete this.layerIndexes[_]}}const zi=(m,o)=>p.emitValidationErrors(m,o&&o.filter(d=>"source.canvas"!==d.identifier)),ks=p.pick(xe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Qi=p.pick(xe,["setCenter","setZoom","setBearing","setPitch"]),Ih=function(){const m={},o=p.spec.$version;for(const d in p.spec.$root){const _=p.spec.$root[d];if(_.required){let w=null;w="version"===d?o:"array"===_.type?[]:{},null!=w&&(m[d]=w)}}return m}(),Vl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Jr extends p.Evented{constructor(o,d={}){super(),this.map=o,this.dispatcher=new Dt(it(),this),this.imageManager=new as,this.imageManager.setEventedParent(this),this.glyphManager=new p.GlyphManager(o._requestManager,d.localFontFamily?p.LocalGlyphMode.all:d.localIdeographFontFamily?p.LocalGlyphMode.ideographs:p.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.lineAtlas=new p.LineAtlas(256,512),this.crossTileSymbolIndex=new Yr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());const _=this;this._rtlTextPluginCallback=Jr.registerForPluginStateChange(w=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(C,M)=>{if(p.triggerPluginCompletionEvent(C),M&&M.every(k=>k))for(const k in _._sourceCaches){const O=_._sourceCaches[k],B=O.getSource().type;"vector"!==B&&"geojson"!==B||O.reload()}})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const C=this.getSource(w.sourceId);if(C&&C.vectorLayerIds)for(const M in this._layers){const k=this._layers[M];k.source===C.id&&this._validateLayer(k)}})}loadURL(o,d={}){this.fire(new p.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof d.validate?d.validate:!p.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,d.accessToken);const w=this.map._requestManager.transformRequest(o,p.ResourceType.Style);this._request=p.getJSON(w,(C,M)=>{this._request=null,C?this.fire(new p.ErrorEvent(C)):M&&this._load(M,_)})}loadJSON(o,d={}){this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.exported.frame(()=>{this._request=null,this._load(o,!1!==d.validate)})}loadEmpty(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(Ih,!1)}_updateLayerCount(o,d){const _=d?1:-1;o.is3D()&&(this._num3DLayers+=_),"circle"===o.type&&(this._numCircleLayers+=_),"symbol"===o.type&&(this._numSymbolLayers+=_)}_load(o,d){if(d&&zi(this,p.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o;for(const w in o.sources)this.addSource(w,o.sources[w],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const _=xt(this.stylesheet.layers);this._order=_.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of _)w=p.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ci(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}_loadSprite(o){this._spriteRequest=function(d,_,w){let C,M,k;const O=p.exported.devicePixelRatio>1?"@2x":"";let B=p.getJSON(_.transformRequest(_.normalizeSpriteURL(d,O,".json"),p.ResourceType.SpriteJSON),(X,Y)=>{B=null,k||(k=X,C=Y,q())}),U=p.getImage(_.transformRequest(_.normalizeSpriteURL(d,O,".png"),p.ResourceType.SpriteImage),(X,Y)=>{U=null,k||(k=X,M=Y,q())});function q(){if(k)w(k);else if(C&&M){const X=p.exported.getImageData(M),Y={};for(const oe in C){const{width:se,height:pe,x:ie,y:ae,sdf:fe,pixelRatio:_e,stretchX:we,stretchY:ce,content:Se}=C[oe],je=new p.RGBAImage({width:se,height:pe});p.RGBAImage.copy(X,je,{x:ie,y:ae},{x:0,y:0},{width:se,height:pe}),Y[oe]={data:je,pixelRatio:_e,sdf:fe,stretchX:we,stretchY:ce,content:Se}}w(null,Y)}}return{cancel(){B&&(B.cancel(),B=null),U&&(U.cancel(),U=null)}}}(o,this.map._requestManager,(d,_)=>{if(this._spriteRequest=null,d)this.fire(new p.ErrorEvent(d));else if(_)for(const w in _)this.imageManager.addImage(w,_[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new p.Event("data",{dataType:"style"}))})}_validateLayer(o){const d=this.getSource(o.source);if(!d)return;const _=o.sourceLayer;_&&("geojson"===d.type||d.vectorLayerIds&&-1===d.vectorLayerIds.indexOf(_))&&this.fire(new p.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const d=[];for(const _ of o){const w=this._layers[_];"custom"!==w.type&&d.push(w.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&Vl[o.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(w.length||C.length)&&this._updateWorkerLayers(w,C);for(const M in this._updatedSources){const k=this._updatedSources[M];"reload"===k?this._reloadSource(M):"clear"===k&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const _={};for(const w in this._sourceCaches){const C=this._sourceCaches[w];_[w]=C.used,C.used=!1}for(const w of this._order){const C=this._layers[w];if(C.recalculate(o,this._availableImages),!C.isHidden(o.zoom)){const k=this._getLayerSourceCache(C);k&&(k.used=!0)}const M=this.map.painter;if(M){const k=C.getProgramIds();if(!k)continue;const O=C.getProgramConfiguration(o.zoom);for(const B of k)M.useProgram(B,O)}}for(const w in _){const C=this._sourceCaches[w];_[w]!==C.used&&C.getSource().fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new p.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),zi(this,p.validateStyle(o)))return!1;(o=p.clone$2(o)).layers=xt(o.layers);const d=function(w,C){if(!w)return[{command:xe.setStyle,args:[C]}];let M=[];try{if(!Qe(w.version,C.version))return[{command:xe.setStyle,args:[C]}];Qe(w.center,C.center)||M.push({command:xe.setCenter,args:[C.center]}),Qe(w.zoom,C.zoom)||M.push({command:xe.setZoom,args:[C.zoom]}),Qe(w.bearing,C.bearing)||M.push({command:xe.setBearing,args:[C.bearing]}),Qe(w.pitch,C.pitch)||M.push({command:xe.setPitch,args:[C.pitch]}),Qe(w.sprite,C.sprite)||M.push({command:xe.setSprite,args:[C.sprite]}),Qe(w.glyphs,C.glyphs)||M.push({command:xe.setGlyphs,args:[C.glyphs]}),Qe(w.transition,C.transition)||M.push({command:xe.setTransition,args:[C.transition]}),Qe(w.light,C.light)||M.push({command:xe.setLight,args:[C.light]}),Qe(w.fog,C.fog)||M.push({command:xe.setFog,args:[C.fog]});const k={},O=[];!function(q,X,Y,oe){let se;for(se in X=X||{},q=q||{})q.hasOwnProperty(se)&&(X.hasOwnProperty(se)||vt(se,Y,oe));for(se in X)X.hasOwnProperty(se)&&(q.hasOwnProperty(se)?Qe(q[se],X[se])||("geojson"===q[se].type&&"geojson"===X[se].type&&Nt(q,X,se)?Y.push({command:xe.setGeoJSONSourceData,args:[se,X[se].data]}):qt(se,X,Y,oe)):Ne(se,X,Y))}(w.sources,C.sources,O,k);const B=[];w.layers&&w.layers.forEach(q=>{k[q.source]?M.push({command:xe.removeLayer,args:[q.id]}):B.push(q)});let U=w.terrain;U&&k[U.source]&&(M.push({command:xe.setTerrain,args:[void 0]}),U=void 0),M=M.concat(O),Qe(U,C.terrain)||M.push({command:xe.setTerrain,args:[C.terrain]}),function(q,X,Y){X=X||[];const oe=(q=q||[]).map(rn),se=X.map(rn),pe=q.reduce(kn,{}),ie=X.reduce(kn,{}),ae=oe.slice(),fe=Object.create(null);let _e,we,ce,Se,je,We,Te;for(_e=0,we=0;_e<oe.length;_e++)ce=oe[_e],ie.hasOwnProperty(ce)?we++:(Y.push({command:xe.removeLayer,args:[ce]}),ae.splice(ae.indexOf(ce,we),1));for(_e=0,we=0;_e<se.length;_e++)ce=se[se.length-1-_e],ae[ae.length-1-_e]!==ce&&(pe.hasOwnProperty(ce)?(Y.push({command:xe.removeLayer,args:[ce]}),ae.splice(ae.lastIndexOf(ce,ae.length-we),1)):we++,We=ae[ae.length-_e],Y.push({command:xe.addLayer,args:[ie[ce],We]}),ae.splice(ae.length-_e,0,ce),fe[ce]=!0);for(_e=0;_e<se.length;_e++)if(ce=se[_e],Se=pe[ce],je=ie[ce],!fe[ce]&&!Qe(Se,je))if(Qe(Se.source,je.source)&&Qe(Se["source-layer"],je["source-layer"])&&Qe(Se.type,je.type)){for(Te in vn(Se.layout,je.layout,Y,ce,null,xe.setLayoutProperty),vn(Se.paint,je.paint,Y,ce,null,xe.setPaintProperty),Qe(Se.filter,je.filter)||Y.push({command:xe.setFilter,args:[ce,je.filter]}),Qe(Se.minzoom,je.minzoom)&&Qe(Se.maxzoom,je.maxzoom)||Y.push({command:xe.setLayerZoomRange,args:[ce,je.minzoom,je.maxzoom]}),Se)Se.hasOwnProperty(Te)&&"layout"!==Te&&"paint"!==Te&&"filter"!==Te&&"metadata"!==Te&&"minzoom"!==Te&&"maxzoom"!==Te&&(0===Te.indexOf("paint.")?vn(Se[Te],je[Te],Y,ce,Te.slice(6),xe.setPaintProperty):Qe(Se[Te],je[Te])||Y.push({command:xe.setLayerProperty,args:[ce,Te,je[Te]]}));for(Te in je)je.hasOwnProperty(Te)&&!Se.hasOwnProperty(Te)&&"layout"!==Te&&"paint"!==Te&&"filter"!==Te&&"metadata"!==Te&&"minzoom"!==Te&&"maxzoom"!==Te&&(0===Te.indexOf("paint.")?vn(Se[Te],je[Te],Y,ce,Te.slice(6),xe.setPaintProperty):Qe(Se[Te],je[Te])||Y.push({command:xe.setLayerProperty,args:[ce,Te,je[Te]]}))}else Y.push({command:xe.removeLayer,args:[ce]}),We=ae[ae.lastIndexOf(ce)+1],Y.push({command:xe.addLayer,args:[je,We]})}(B,C.layers,M)}catch(k){console.warn("Unable to compute style diff:",k),M=[{command:xe.setStyle,args:[C]}]}return M}(this.serialize(),o).filter(w=>!(w.command in Qi));if(0===d.length)return!1;const _=d.filter(w=>!(w.command in ks));if(_.length>0)throw new Error(`Unimplemented: ${_.map(w=>w.command).join(", ")}.`);return d.forEach(w=>{"setTransition"!==w.command&&this[w.command].apply(this,w.args)}),this.stylesheet=o,!0}addImage(o,d){if(this.getImage(o))return this.fire(new p.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new p.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,_={}){if(this._checkLoaded(),void 0!==this.getSource(o))throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(p.validateStyle.source,`sources.${o}`,d,null,_))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const w=W(o,d,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:w.serialize(),sourceId:o}));const C=M=>{const k=(M?"symbol:":"other:")+o,O=this._sourceCaches[k]=new p.SourceCache(k,w,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[o]=O,O.style=this,O.onAdd(this.map)};C(!1),"vector"!==d.type&&"geojson"!==d.type||C(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const d=this.getSource(o);if(void 0===d)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===o)return this.fire(new p.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new p.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(o);for(const w of _)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getSource(o).setData(d),this._changed=!0}getSource(o){const d=this._getSourceCache(o);return d&&d.getSource()}addLayer(o,d,_={}){this._checkLoaded();const w=o.id;if(this.getLayer(w))return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let C;if("custom"===o.type){if(zi(this,p.validateCustomStyleLayer(o)))return;C=p.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(w,o.source),o=p.clone$2(o),o=p.extend(o,{source:w})),this._validate(p.validateStyle.layer,`layers.${w}`,o,{arrayIndex:-1},_))return;C=p.createStyleLayer(o),this._validateLayer(C),C.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const M=d?this._order.indexOf(d):this._order.length;if(d&&-1===M)return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(M,0,w),this._layerOrderChanged=!0,this._layers[w]=C;const k=this._getLayerSourceCache(C);if(this._removedLayers[w]&&C.source&&k&&"custom"!==C.type){const O=this._removedLayers[w];delete this._removedLayers[w],O.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",k.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const _=this._order.indexOf(o);this._order.splice(_,1);const w=d?this._order.indexOf(d):this._order.length;d&&-1===w?this.fire(new p.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(w,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,_){this._checkLoaded();const w=this.getLayer(o);w?w.minzoom===d&&w.maxzoom===_||(null!=d&&(w.minzoom=d),null!=_&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,d,_={}){this._checkLoaded();const w=this.getLayer(o);if(w){if(!Qe(w.filter,d))return null==d?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(p.validateStyle.filter,`layers.${w.id}.filter`,d,null,_)||(w.filter=p.clone$2(d),this._updateLayer(w)))}else this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){return p.clone$2(this.getLayer(o).filter)}setLayoutProperty(o,d,_,w={}){this._checkLoaded();const C=this.getLayer(o);C?Qe(C.getLayoutProperty(d),_)||(C.setLayoutProperty(d,_,w),this._updateLayer(C)):this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,d){const _=this.getLayer(o);if(_)return _.getLayoutProperty(d);this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,d,_,w={}){this._checkLoaded();const C=this.getLayer(o);C?Qe(C.getPaintProperty(d),_)||(C.setPaintProperty(d,_,w)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const _=o.source,w=o.sourceLayer,C=this.getSource(_);if(void 0===C)return void this.fire(new p.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const M=C.type;if("geojson"===M&&w)return void this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!w)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===o.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(_);for(const O of k)O.setFeatureState(w,o.id,d)}removeFeatureState(o,d){this._checkLoaded();const _=o.source,w=this.getSource(_);if(void 0===w)return void this.fire(new p.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const C=w.type,M="vector"===C?o.sourceLayer:void 0;if("vector"===C&&!M)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&"string"!=typeof o.id&&"number"!=typeof o.id)return void this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(_);for(const O of k)O.removeFeatureState(M,o.id,d)}getFeatureState(o){this._checkLoaded();const d=o.source,_=o.sourceLayer,w=this.getSource(d);if(void 0!==w){if("vector"!==w.type||_)return void 0===o.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(_,o.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const d in this._sourceCaches){const _=this._sourceCaches[d].getSource();o[_.id]||(o[_.id]=_.serialize())}return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o,layers:this._serializeLayers(this._order)},d=>void 0!==d)}_updateLayer(o){this._updatedLayers[o.id]=!0;const d=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&d&&"raster"!==d.getSource().type&&(this._updatedSources[o.source]="reload",d.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=M=>"fill-extrusion"===this._layers[M].type,_={},w=[];for(let M=this._order.length-1;M>=0;M--){const k=this._order[M];if(d(k)){_[k]=M;for(const O of o){const B=O[k];if(B)for(const U of B)w.push(U)}}}w.sort((M,k)=>k.intersectionZ-M.intersectionZ);const C=[];for(let M=this._order.length-1;M>=0;M--){const k=this._order[M];if(d(k))for(let O=w.length-1;O>=0;O--){const B=w[O].feature;if(_[B.layer.id]<M)break;C.push(B),w.pop()}else for(const O of o){const B=O[k];if(B)for(const U of B)C.push(U.feature)}}return C}queryRenderedFeatures(o,d,_){d&&d.filter&&this._validate(p.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const w={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const O of d.layers){const B=this._layers[O];if(!B)return this.fire(new p.ErrorEvent(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];w[B.source]=!0}}const C=[];d.availableImages=this._availableImages;const M=d&&d.layers?d.layers.some(O=>{const B=this.getLayer(O);return B&&B.is3D()}):this.has3DLayers(),k=nn.createFromScreenPoints(o,_);for(const O in this._sourceCaches){const B=this._sourceCaches[O].getSource().id;d.layers&&!w[B]||C.push(le(this._sourceCaches[O],this._layers,this._serializedLayers,k,d,_,M,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(O,B,U,q,X,Y,oe){const se={},pe=Y.queryRenderedSymbols(q),ie=[];for(const ae of Object.keys(pe).map(Number))ie.push(oe[ae]);ie.sort(ve);for(const ae of ie){const fe=ae.featureIndex.lookupSymbolFeatures(pe[ae.bucketInstanceId],B,ae.bucketIndex,ae.sourceLayerIndex,X.filter,X.layers,X.availableImages,O);for(const _e in fe){const we=se[_e]=se[_e]||[],ce=fe[_e];ce.sort((Se,je)=>{const We=ae.featureSortOrder;if(We){const Te=We.indexOf(Se.featureIndex);return We.indexOf(je.featureIndex)-Te}return je.featureIndex-Se.featureIndex});for(const Se of ce)we.push(Se)}}for(const ae in se)se[ae].forEach(fe=>{const _e=fe.feature,we=U(O[ae]).getFeatureState(_e.layer["source-layer"],_e.id);_e.source=_e.layer.source,_e.layer["source-layer"]&&(_e.sourceLayer=_e.layer["source-layer"]),_e.state=we});return se}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(o,d){d&&d.filter&&this._validate(p.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const _=this._getSourceCaches(o);let w=[];for(const C of _)w=w.concat(ge(C,d));return w}addSourceType(o,d,_){return Jr.getSourceType(o)?_(new Error(`A source type called "${o}" already exists.`)):(Jr.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const _=this.light.getLight();let w=!1;for(const M in o)if(!Qe(o[M],_[M])){w=!0;break}if(!w)return;const C={now:p.exported.now(),transition:p.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(C)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(o){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof o.source){const d="terrain-dem-src";this.addSource(d,o.source),o=p.clone$2(o),o=p.extend(o,{source:d})}if(!this._validate(p.validateStyle.terrain,"terrain",o)){if(this.terrain){const d=this.terrain,_=d.get();for(const w in o)if(!Qe(o[w],_[w])){d.set(o),this.stylesheet.terrain=o;const C={now:p.exported.now(),transition:p.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(C);break}}else this._createTerrain(o);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(o){const d=this.fog=new tn(o);this.stylesheet.fog=o;const _={now:p.exported.now(),transition:p.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,_=d.get();for(const w in o)if(!Qe(o[w],_[w])){d.set(o),this.stylesheet.fog=o;const C={now:p.exported.now(),transition:p.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(C);break}}else this._createFog(o);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(_=>this.isLayerDraped(this._layers[_])),d=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o){const d=this.terrain=new Zi(o);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const _={now:p.exported.now(),transition:p.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(_)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];"fill-extrusion"===d.type&&this._updateLayer(d)}}_validate(o,d,_,w,C={}){return(!C||!1!==C.validate)&&zi(this,o.call(p.validateStyle,p.extend({key:d,style:this.serialize(),value:_,styleSpec:p.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const d=this._getSourceCaches(o);for(const _ of d)_.clearTiles()}_reloadSource(o){const d=this._getSourceCaches(o);for(const _ of d)_.resume(),_.reload()}_updateSources(o){for(const d in this._sourceCaches)this._sourceCaches[d].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,_,w,C=!1){let M=!1,k=!1;const O={};for(const B of this._order){const U=this._layers[B];if("symbol"!==U.type)continue;if(!O[U.source]){const X=this._getLayerSourceCache(U);if(!X)continue;O[U.source]=X.getRenderableIds(!0).map(Y=>X.getTileByID(Y)).sort((Y,oe)=>oe.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(oe.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(U,O[U.source],o.center.lng);M=M||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new p.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.exported.now(),o.zoom))&&(this.pauseablePlacement=new ha(o,this._order,C,d,_,w,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.exported.now()),k=!0),M&&this.pauseablePlacement.placement.setStale()),k||M)for(const B of this._order){const U=this._layers[B];"symbol"===U.type&&this.placement.updateLayerOpacities(U,O[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,_){this.imageManager.getImages(d.icons,_),this._updateTilesForChangedImages();const w=C=>{C&&C.setDependencies(d.tileID.key,d.type,d.icons)};w(this._otherSourceCaches[d.source]),w(this._symbolSourceCaches[d.source])}getGlyphs(o,d,_){this.glyphManager.getGlyphs(d.stacks,_)}getResource(o,d,_){return p.makeRequest(d,_)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return"symbol"===o.type?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Jr.getSourceType=function(m){return $[m]},Jr.setSourceType=function(m,o){$[m]=o},Jr.registerForPluginStateChange=p.registerForPluginStateChange;var dl="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",er="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let fa={},Lo={};fa=Mt("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec3 elevationVector(vec2 pos) {vec2 uv=pos/8192.0;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif",!0),Lo=Mt("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const Et=Mt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),It=dl;var tr={background:Mt("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Mt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Mt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Mt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Mt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Mt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Mt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Mt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Mt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Mt("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Mt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Mt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Mt("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Mt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Mt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:Mt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Mt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:Mt("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Mt("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",er),skyboxGradient:Mt("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",er),skyboxCapture:Mt("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mt("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);}"),globeAtmosphere:Mt("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying float v_depth;void main() {gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Mt(m,o,d){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,C=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),M=m.match(w),k=o.match(w),O=dl.match(w);let B=k?k.concat(M):M;d||(fa.staticUniforms&&(B=fa.staticUniforms.concat(B)),Lo.staticUniforms&&(B=Lo.staticUniforms.concat(B))),B&&(B=B.concat(O));const U={};return{fragmentSource:m=m.replace(_,(q,X,Y,oe,se)=>(U[se]=!0,"define"===X?`\n#ifndef HAS_UNIFORM_u_${se}\nvarying ${Y} ${oe} ${se};\n#else\nuniform ${Y} ${oe} u_${se};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${se}\n    ${Y} ${oe} ${se} = u_${se};\n#endif\n`)),vertexSource:o=o.replace(_,(q,X,Y,oe,se)=>{const pe="float"===oe?"vec2":"vec4",ie=se.match(/color/)?"color":pe;return U[se]?"define"===X?`\n#ifndef HAS_UNIFORM_u_${se}\nuniform lowp float u_${se}_t;\nattribute ${Y} ${pe} a_${se};\nvarying ${Y} ${oe} ${se};\n#else\nuniform ${Y} ${oe} u_${se};\n#endif\n`:"vec4"===ie?`\n#ifndef HAS_UNIFORM_u_${se}\n    ${se} = a_${se};\n#else\n    ${Y} ${oe} ${se} = u_${se};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${se}\n    ${se} = unpack_mix_${ie}(a_${se}, u_${se}_t);\n#else\n    ${Y} ${oe} ${se} = u_${se};\n#endif\n`:"define"===X?`\n#ifndef HAS_UNIFORM_u_${se}\nuniform lowp float u_${se}_t;\nattribute ${Y} ${pe} a_${se};\n#else\nuniform ${Y} ${oe} u_${se};\n#endif\n`:"vec4"===ie?`\n#ifndef HAS_UNIFORM_u_${se}\n    ${Y} ${oe} ${se} = a_${se};\n#else\n    ${Y} ${oe} ${se} = u_${se};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${se}\n    ${Y} ${oe} ${se} = unpack_mix_${ie}(a_${se}, u_${se}_t);\n#else\n    ${Y} ${oe} ${se} = u_${se};\n#endif\n`}),staticAttributes:C,staticUniforms:B}}class Qr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,_,w,C,M,k,O){this.context=o;let B=this.boundPaintVertexBuffers.length!==w.length;for(let U=0;!B&&U<w.length;U++)this.boundPaintVertexBuffers[U]!==w[U]&&(B=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===d&&this.boundLayoutVertexBuffer===_&&!B&&this.boundIndexBuffer===C&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===O?(o.bindVertexArrayOES.set(this.vao),k&&k.bind(),C&&C.dynamicDraw&&C.bind(),O&&O.bind()):this.freshBind(d,_,w,C,M,k,O)}freshBind(o,d,_,w,C,M,k){let O;const B=o.numAttributes,U=this.context,q=U.gl;if(U.extVertexArrayObject)this.vao&&this.destroy(),this.vao=U.extVertexArrayObject.createVertexArrayOES(),U.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=w,this.boundVertexOffset=C,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=k;else{O=U.currentNumAttributes||0;for(let X=B;X<O;X++)q.disableVertexAttribArray(X)}d.enableAttributes(q,o);for(const X of _)X.enableAttributes(q,o);M&&M.enableAttributes(q,o),k&&k.enableAttributes(q,o),d.bind(),d.setVertexAttribPointers(q,o,C);for(const X of _)X.bind(),X.setVertexAttribPointers(q,o,C);M&&(M.bind(),M.setVertexAttribPointers(q,o,C)),w&&w.bind(),k&&(k.bind(),k.setVertexAttribPointers(q,o,C)),U.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Vr(m,o){const d=Math.pow(2,o.canonical.z),_=o.canonical.y;return[new p.MercatorCoordinate(0,_/d).toLngLat().lat,new p.MercatorCoordinate(0,(_+1)/d).toLngLat().lat]}function wc(m,o,d,_,w,C,M){const k=m.context,O=k.gl,B=d.fbo;if(!B)return;m.prepareDrawTile(o);const U=m.useProgram("hillshade");k.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,B.colorAttachment.get());const q=((X,Y,oe,se)=>{const pe=oe.paint.get("hillshade-shadow-color"),ie=oe.paint.get("hillshade-highlight-color"),ae=oe.paint.get("hillshade-accent-color");let fe=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===oe.paint.get("hillshade-illumination-anchor")&&(fe-=X.transform.angle);const _e=!X.options.moving;return{u_matrix:se||X.transform.calculateProjMatrix(Y.tileID.toUnwrapped(),_e),u_image:0,u_latrange:Vr(0,Y.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),fe],u_shadow:pe,u_highlight:ie,u_accent:ae}})(m,d,_,m.terrain?o.projMatrix:null);m.prepareDrawProgram(k,U,o.toUnwrapped()),U.draw(k,O.TRIANGLES,w,C,M,p.CullFaceMode.disabled,q,_.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Wi(m,o,d){if(!o.needsDEMTextureUpload)return;const _=m.context,w=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(d.stride);const C=d.getPixels();o.demTexture?o.demTexture.update(C,{premultiply:!1}):o.demTexture=new p.Texture(_,C,w.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function et(m,o,d,_,w,C){const M=m.context,k=M.gl;if(!o.dem)return;const O=o.dem;if(M.activeTexture.set(k.TEXTURE1),Wi(m,o,O),!o.demTexture)return;o.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const B=O.dim;M.activeTexture.set(k.TEXTURE0);let U=o.fbo;if(!U){const q=new p.Texture(M,{width:B,height:B,data:null},k.RGBA);q.bind(k.LINEAR,k.CLAMP_TO_EDGE),U=o.fbo=M.createFramebuffer(B,B,!0),U.colorAttachment.set(q.texture)}M.bindFramebuffer.set(U.framebuffer),M.viewport.set([0,0,B,B]),m.useProgram("hillshadePrepare").draw(M,k.TRIANGLES,_,w,C,p.CullFaceMode.disabled,((q,X)=>{const Y=X.stride,oe=p.create$1();return p.ortho(oe,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(oe,oe,[0,-p.EXTENT,0]),{u_matrix:oe,u_image:1,u_dimension:[Y,Y],u_zoom:q.overscaledZ,u_unpack:X.unpackVector}})(o.tileID,O),d.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),o.needsHillshadePrepare=!1}const Wt=(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_image0:new p.Uniform1i(m,o.u_image0),u_skirt_height:new p.Uniform1f(m,o.u_skirt_height)}),ii=(m,o)=>({u_matrix:m,u_image0:0,u_skirt_height:o}),nr=new class{constructor(){this.operations={}}newMorphing(m,o,d,_,w){if(m in this.operations){const C=this.operations[m];C.to.tileID.key!==d.tileID.key&&(C.queued=d)}else this.operations[m]={startTime:_,phase:0,duration:w,from:o,to:d,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const o=this.operations[m];return{from:o.from,to:o.to,phase:o.phase}}update(m){for(const o in this.operations){const d=this.operations[o];for(d.phase=(m-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,m)){delete this.operations[o];break}}}_nextOp(m,o){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=o,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Rs={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Zn(m,o){const d=1<<m.z;return!o&&(0===m.x||m.x===d-1)||0===m.y||m.y===d-1}const us=m=>({u_matrix:m});function yi(m,o,d,_,w){if(w>0){const C=p.exported.now(),M=(C-m.timeAdded)/w,k=o?(C-o.timeAdded)/w:-1,O=d.getSource(),B=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),U=!o||Math.abs(o.tileID.overscaledZ-B)>Math.abs(m.tileID.overscaledZ-B),q=U&&m.refreshedUponExpiration?1:p.clamp(U?M:1-k,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}class fl extends p.SourceCache{constructor(o){const d=W("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new Dt(it(),null),o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,_){if(o.freezeTileCoverage)return;this.transform=o;const w=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,M)=>{if(C[M.key]="",!this._tiles[M.key]){const k=new p.Tile(M,this._source.tileSize*M.overscaleFactor(),o.tileZoom);k.state="loaded",this._tiles[M.key]=k}return C},{});for(const C in this._tiles)C in w||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(o){const d=this.proxyCachedFBO[o];if(void 0!==d){const _=Object.values(d);this.renderCachePool.push(..._),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Yo extends p.OverscaledTileID{constructor(o,d,_){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=_}}class Lt extends p.Elevation{constructor(o,d){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,w,C]=function(O){const B=new p.StructArrayLayout4i8,U=new p.StructArrayLayout3ui6,q=131;B.reserve(17161),U.reserve(33800);const X=p.EXTENT/128,Y=p.EXTENT+X/2,oe=Y+X;for(let pe=-X;pe<oe;pe+=X)for(let ie=-X;ie<oe;ie+=X){const ae=ie<0||ie>Y||pe<0||pe>Y?24575:0,fe=p.clamp(Math.round(ie),0,p.EXTENT),_e=p.clamp(Math.round(pe),0,p.EXTENT);B.emplaceBack(fe+ae,_e,fe,_e)}const se=(pe,ie)=>{const ae=ie*q+pe;U.emplaceBack(ae+1,ae,ae+q),U.emplaceBack(ae+q,ae+q+1,ae+1)};for(let pe=1;pe<129;pe++)for(let ie=1;ie<129;ie++)se(ie,pe);return[0,129].forEach(pe=>{for(let ie=0;ie<130;ie++)se(ie,pe),se(pe,ie)}),[B,U,32768]}(),M=o.context;this.gridBuffer=M.createVertexBuffer(_,yn.members),this.gridIndexBuffer=M.createIndexBuffer(w),this.gridSegments=p.SegmentVector.simpleSegment(0,0,_.length,w.length),this.gridNoSkirtSegments=p.SegmentVector.simpleSegment(0,0,_.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new fl(d.map),this.orthoMatrix=p.create$1(),p.ortho(this.orthoMatrix,0,p.EXTENT,0,p.EXTENT,0,1);const k=M.gl;this._overlapStencilMode=new p.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency()}update(o,d,_){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const w=o.terrain.properties;this.sourceCache=o._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const C=()=>{this.sourceCache.used&&p.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.sourceCache.getSource().tileSize/128,k=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(d,M*k,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),d.updateElevation(!_),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==o.efficiency&&p.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&"source"===o.dataType?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):"style"===o.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=d.getIds().map(O=>{const B=d.getTileByID(O).tileID;return B.projMatrix=_.calculateProjMatrix(B.toUnwrapped()),B});(function(O,B){const U=B.transform.pointCoordinate(B.transform.getCameraPoint()),q=new p.pointGeometry(U.x,U.y);O.sort((X,Y)=>{if(Y.overscaledZ-X.overscaledZ)return Y.overscaledZ-X.overscaledZ;const oe=new p.pointGeometry(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),se=new p.pointGeometry(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),pe=q.mult(1<<X.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(oe)-pe.distSqr(se)})})(w,this.painter),this._previousZoom=_.zoom;const C=this.proxyToSource||{};this.proxyToSource={},w.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const O in M){const B=M[O];if(!B.used||(B!==this.sourceCache&&(this._findCoveringTileCache[B.id]={}),this._setupProxiedCoordsForOrtho(B,o[O],C),B.usedForTerrain))continue;const U=o[O];B.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[d.id]=w.map(O=>new Yo(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=p.exported.now();const k={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const B=this.terrainTileForTile[O.key];if(!B)continue;const U=B.tileID.key;U in k||(this._visibleDemTiles.push(B),k[U]=U)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const _=this._findTileCoveringTileID(d,this.sourceCache);_&&(this.terrainTileForTile[d.key]=_)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const _ in this.terrainTileForTile){const w=this.terrainTileForTile[_],C=w.dem;!C||w.demTexture&&!w.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),Wi(this.painter,w,C))}}_prepareDemTileUniforms(o,d,_,w){if(!d||null==d.demTexture)return!1;const C=o.tileID.canonical,M=Math.pow(2,d.tileID.canonical.z-C.z),k=w||"";return _[`u_dem_tl${k}`]=[C.x*M%1,C.y*M%1],_[`u_dem_scale${k}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let o=0;const d=this._visibleDemTiles.reduce((_,w)=>{if(!w.dem)return _;const C=w.dem.tree.minimums[0];return C>0&&o++,_+C},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const _=this._getLoadedAreaMinimum(),w={width:1,height:1,data:new Uint8Array(p.DEMData.pack(_,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(w,{premultiply:!1}):C=this._emptyDEMTexture=new p.Texture(o,w,d.RGBA,{premultiply:!1}),C}setupElevationDraw(o,d,_){const w=this.painter.context,C=w.gl,M=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:p.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var k;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let O=null,B=null,U=1;if(_&&_.morphing&&this._useVertexMorphing){const q=_.morphing.srcDemTile,X=_.morphing.dstDemTile;U=_.morphing.phase,q&&X&&(this._prepareDemTileUniforms(o,q,M,"_prev")&&(B=q),this._prepareDemTileUniforms(o,X,M)&&(O=X))}if(B&&O?(w.activeTexture.set(C.TEXTURE2),O.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),w.activeTexture.set(C.TEXTURE4),B.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),M.u_dem_lerp=U):(O=this.terrainTileForTile[o.tileID.key],w.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(o,O,M)?O.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST)),_&&_.useDepthForOcclusion&&(w.activeTexture.set(C.TEXTURE3),this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),_&&_.useMeterToDem&&O){const q=(1<<O.tileID.canonical.z)*p.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=q}_&&_.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),d.setTerrainUniformValues(w,M)}renderToBackBuffer(o){const d=this.painter,_=this.painter.context;0!==o.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),this.renderingToTexture=!1,function(w,C,M,k,O){const B=w.context,U=B.gl;let q,X;const Y=w.options.showTerrainWireframe?2:0,oe=(fe,_e)=>{if(X===fe)return;const we=[Rs[fe]];_e&&we.push(Rs[Y]),q=w.useProgram("terrainRaster",null,we),X=fe},se=w.colorModeForRenderPass(),pe=new p.DepthMode(U.LEQUAL,p.DepthMode.ReadWrite,w.depthRangeFor3D);nr.update(O);const ie=w.transform,ae=6*Math.pow(1.5,22-ie.zoom)*C.exaggeration();(Y?[!1,!0]:[!1]).forEach(fe=>{X=-1;const _e=fe?U.LINES:U.TRIANGLES,[we,ce]=fe?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const We of k){const Te=M.getTile(We),ze=p.StencilMode.disabled,ct=C.prevTerrainTileForTile[We.key],ht=C.terrainTileForTile[We.key];je=ht,null!=(Se=ct)&&null!=je&&Se.hasData()&&je.hasData()&&null!=Se.demTexture&&null!=je.demTexture&&Se.tileID.key!==je.tileID.key&&nr.newMorphing(We.key,ct,ht,O,250),B.activeTexture.set(U.TEXTURE0),Te.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const ut=nr.getMorphValuesForProxy(We.key),tt=ut?1:0;let ft;ut&&(ft={morphing:{srcDemTile:ut.from,dstDemTile:ut.to,phase:p.easeCubicInOut(ut.phase)}});const sn=ii(We.projMatrix,Zn(We.canonical,ie.renderWorldCopies)?ae/10:ae);oe(tt,fe),C.setupElevationDraw(Te,q,ft),w.prepareDrawProgram(B,q,We.toUnwrapped()),q.draw(B,_e,pe,ze,se,p.CullFaceMode.backCCW,sn,"terrain_raster",C.gridBuffer,we,ce)}var Se,je})}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,o.splice(0,o.length))}renderBatch(o){if(0===this._drapedRenderBatches.length)return o+1;this.renderingToTexture=!0;const d=this.painter,_=this.painter.context,w=this.proxySourceCache,C=this.proxiedCoords[w.id],M=this._drapedRenderBatches.shift(),k=[],O=d.style.order;let B=0;for(const U of C){const q=w.getTileByID(U.proxyTileKey),X=w.proxyCachedFBO[U.key]?w.proxyCachedFBO[U.key][o]:void 0,Y=void 0!==X?w.renderCache[X]:this.pool[B++],oe=void 0!==X;if(q.texture=Y.tex,oe&&!Y.dirty){k.push(q.tileID);continue}let se;_.bindFramebuffer.set(Y.fb.framebuffer),this.renderedToTile=!1,Y.dirty&&(_.clear({color:p.Color.transparent}),Y.dirty=!1);for(let pe=M.start;pe<=M.end;++pe){const ie=d.style._layers[O[pe]];if(ie.isHidden(d.transform.zoom))continue;const ae=d.style._getLayerSourceCache(ie),fe=ae?this.proxyToSource[U.key][ae.id]:[U];if(!fe)continue;const _e=fe;_.viewport.set([0,0,Y.fb.width,Y.fb.height]),se!==(ae?ae.id:null)&&(this._setupStencil(Y,fe,ie,ae),se=ae?ae.id:null),d.renderLayer(d,ae,ie,_e)}this.renderedToTile?(Y.dirty=!0,k.push(q.tileID)):oe||--B,5===B&&(B=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),M.end+1}postRender(){}renderCacheEfficiency(o){const d=o.order.length;if(0===d)return{efficiency:100};let _,w=0,C=0,M=!1;for(let k=0;k<d;++k){const O=o._layers[o.order[k]];this._style.isLayerDraped(O)?(M&&++w,++C):M||(M=!0,_=O.id)}return 0===C?{efficiency:100}:{efficiency:100*(1-w/C),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),0===o?o:(o-30)*this._exaggeration}raycast(o,d,_){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const M=C.tileID,k=Math.pow(2,M.overscaledZ),{x:O,y:B}=M.canonical,U=O/k,q=(O+1)/k,X=B/k,Y=(B+1)/k;return{minx:U,miny:X,maxx:q,maxy:Y,t:C.dem.tree.raycastRoot(U,X,q,Y,o,d,_),tile:C}});w.sort((C,M)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const C of w){if(null==C.t)return null;const M=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,o,d,_);if(null!=M)return M}return null}_createFBO(){const o=this.painter.context,d=o.gl,_=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const w=new p.Texture(o,{width:_[0],height:_[1],data:null},d.RGBA);w.bind(d.LINEAR,d.CLAMP_TO_EDGE);const C=o.createFramebuffer(_[0],_[1],!1);return C.colorAttachment.set(w.texture),C.depthAttachment=new Ft(o,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:C,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._layers[o],_=d.isHidden(this.painter.transform.zoom),w=d.getCrossfadeParameters(),C=!!w&&1!==w.t,M=d.hasTransition();return"custom"!==d.type&&!_&&(C||M)})}_clearRasterFadeFromRenderCache(){let o=!1;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d]._source instanceof Tr){o=!0;break}if(o)for(let d=0;d<this._style.order.length;++d){const _=this._style._layers[this._style.order[d]],w=_.isHidden(this.painter.transform.zoom),C=this._style._getLayerSourceCache(_);if("raster"!==_.type||w||!C)continue;const M=_.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const O=this.proxyToSource[k.key][C.id];if(O)for(const B of O){const U=yi(C.getTile(B),C.findLoadedParent(B,0),C,this.painter.transform,M);(1!==U.opacity||0!==U.mix)&&this._clearRenderCacheForTile(C.id,B)}}}}_setupDrapedRenderBatches(){const o=this._style.order,d=o.length;if(0===d)return;const _=[];let w,C=0,M=this._style._layers[o[C]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++C<d;)M=this._style._layers[o[C]];for(;C<d;++C){const k=this._style._layers[o[C]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?void 0===w&&(w=C):void 0!==w&&(_.push({start:w,end:C-1}),w=void 0))}void 0!==w&&_.push({start:w,end:C-1}),this._drapedRenderBatches=_}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const M=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let k=0;k<M.length;++k){const O=Object.values(M[k]);d.renderCachePool.push(...O)}}return}this._clearRasterFadeFromRenderCache();const _=this.proxyCoords,w=this._tilesDirty;for(let M=_.length-1;M>=0;M--){const k=_[M];if(d.getTileByID(k.key),void 0!==d.proxyCachedFBO[k.key]){const O=o[k.key],B=this.proxyToSource[k.key];let U=0;for(const q in B){const X=B[q],Y=O[q];if(!Y||Y.length!==X.length||X.some((oe,se)=>oe!==Y[se]||w[q]&&w[q].hasOwnProperty(oe.key))){U=-1;break}++U}for(const q in d.proxyCachedFBO[k.key])d.renderCache[d.proxyCachedFBO[k.key][q]].dirty=U<0||U!==Object.values(O).length}}const C=[...this._drapedRenderBatches];C.sort((M,k)=>k.end-k.start-(M.end-M.start));for(const M of C)for(const k of _){if(d.proxyCachedFBO[k.key])continue;let O=d.renderCachePool.pop();void 0===O&&d.renderCache.length<50&&(O=d.renderCache.length,d.renderCache.push(this._createFBO())),void 0!==O&&(d.proxyCachedFBO[k.key]={},d.proxyCachedFBO[k.key][M.start]=O,d.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,_,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,M=C.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let k;if(_.isTileClipped())k=d.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):p.StencilMode.disabled}_renderTileClippingMasks(o,d){const _=this.painter,w=this.painter.context,C=w.gl;_._tileClippingMaskIDs={},w.setColorMode(p.ColorMode.disabled),w.setDepthMode(p.DepthMode.disabled);const M=_.useProgram("clippingMask");for(const k of o){const O=_._tileClippingMaskIDs[k.key]=--d;M.draw(w,C.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:C.ALWAYS,mask:0},O,255,C.KEEP,C.KEEP,C.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,us(k.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const _=[o.x,o.y,1,1];p.transformMat4(_,_,d.pixelMatrixInverse),p.scale$2(_,_,1/_[3]),_[0]/=d.worldSize,_[1]/=d.worldSize;const w=d._camera.position,C=p.mercatorZfromAltitude(1,d.center.lat),M=[w[0],w[1],w[2]/C,0],k=p.subtract([],_.slice(0,3),M);p.normalize(k,k);const O=this.raycast(M,k,this._exaggeration);return null!==O&&O?(p.scaleAndAdd(M,M,k,O),M[3]=M[2],M[2]*=C,M):null}drawDepth(){const o=this.painter,d=o.context,_=this.proxySourceCache,w=Math.ceil(o.width),C=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===C||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const M=d.gl,k=d.createFramebuffer(w,C,!0);d.activeTexture.set(M.TEXTURE0);const O=new p.Texture(d,{width:w,height:C,data:null},M.RGBA);O.bind(M.NEAREST,M.CLAMP_TO_EDGE),k.colorAttachment.set(O.texture);const B=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,w,C);k.depthAttachment.set(B),this._depthFBO=k,this._depthTexture=O}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,w,C]),function(M,k,O,B){const U=M.context,q=U.gl;U.clear({depth:1});const X=M.useProgram("terrainDepth"),Y=new p.DepthMode(q.LESS,p.DepthMode.ReadWrite,M.depthRangeFor3D);for(const oe of B){const se=O.getTile(oe),pe=ii(oe.projMatrix,0);k.setupElevationDraw(se,X),X.draw(U,q.TRIANGLES,Y,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.backCCW,pe,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(o,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,d,_){if(o.getSource()instanceof Q)return this._setupProxiedCoordsForImageSource(o,d,_);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const w=this.proxiedCoords[o.id]=[],C=this.proxyCoords;for(let k=0;k<C.length;k++){const O=C[k],B=this._findTileCoveringTileID(O,o);if(B){const U=this._createProxiedId(O,B,_[O.key]&&_[O.key][o.id]);w.push(U),this.proxyToSource[O.key][o.id]=[U]}}let M=!1;for(let k=0;k<d.length;k++){const O=o.getTile(d[k]);if(!O||!O.hasData())continue;const B=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==O.tileID.canonical.z){const U=this.proxyToSource[B.tileID.key][o.id],q=this._createProxiedId(B.tileID,O,_[B.tileID.key]&&_[B.tileID.key][o.id]);U?U.splice(U.length-1,0,q):this.proxyToSource[B.tileID.key][o.id]=[q],w.push(q),M=!0}}this._sourceTilesOverlap[o.id]=M}_setupProxiedCoordsForImageSource(o,d,_){if(!o.getSource().loaded())return;const w=this.proxiedCoords[o.id]=[],C=this.proxyCoords,M=o.getSource(),k=new p.pointGeometry(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),O=M.coordinates.map(p.MercatorCoordinate.fromLngLat).reduce((U,q)=>(U.min.x=Math.min(U.min.x,q.x-k.x),U.min.y=Math.min(U.min.y,q.y-k.y),U.max.x=Math.max(U.max.x,q.x-k.x),U.max.y=Math.max(U.max.y,q.y-k.y),U),{min:new p.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new p.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(U,q)=>{const X=U.wrap+U.canonical.x/(1<<U.canonical.z),Y=U.canonical.y/(1<<U.canonical.z),oe=p.EXTENT/(1<<U.canonical.z),se=q.wrap+q.canonical.x/(1<<q.canonical.z),pe=q.canonical.y/(1<<q.canonical.z);return X+oe<se+O.min.x||X>se+O.max.x||Y+oe<pe+O.min.y||Y>pe+O.max.y};for(let U=0;U<C.length;U++){const q=C[U];for(let X=0;X<d.length;X++){const Y=o.getTile(d[X]);if(!Y||!Y.hasData()||B(q,Y.tileID))continue;const oe=this._createProxiedId(q,Y,_[q.key]&&_[q.key][o.id]),se=this.proxyToSource[q.key][o.id];se?se.push(oe):this.proxyToSource[q.key][o.id]=[oe],w.push(oe)}}}_createProxiedId(o,d,_){let w=this.orthoMatrix;if(_){const C=_.find(M=>M.key===d.tileID.key);if(C)return C}if(d.tileID.key!==o.key){const C=o.canonical.z-d.tileID.canonical.z;let M,k,O;w=p.create$1();const B=d.tileID.wrap-o.wrap<<o.overscaledZ;C>0?(M=p.EXTENT>>C,k=M*((d.tileID.canonical.x<<C)-o.canonical.x+B),O=M*((d.tileID.canonical.y<<C)-o.canonical.y)):(M=p.EXTENT<<-C,k=p.EXTENT*(d.tileID.canonical.x-(o.canonical.x+B<<-C)),O=p.EXTENT*(d.tileID.canonical.y-(o.canonical.y<<-C))),p.ortho(w,0,M,0,M,0,1),p.translate(w,w,[k,O,0])}return new Yo(d.tileID,o.key,w)}_findTileCoveringTileID(o,d){let _=d.getTile(o);if(_&&_.hasData())return _;const w=this._findCoveringTileCache[d.id],C=w[o.key];if(_=C?d.getTileByID(C):null,_&&_.hasData()||null===C)return _;let M=_?_.tileID:o,k=M.overscaledZ;const O=d.getSource().minzoom,B=[];if(!C){const q=d.getSource().maxzoom;if(o.canonical.z>=q){const X=o.canonical.z-q;d.getSource().reparseOverscaled?(k=Math.max(o.canonical.z+2,d.transform.tileZoom),M=new p.OverscaledTileID(k,o.wrap,q,o.canonical.x>>X,o.canonical.y>>X)):0!==X&&(k=q,M=new p.OverscaledTileID(k,o.wrap,q,o.canonical.x>>X,o.canonical.y>>X))}M.key!==o.key&&(B.push(M.key),_=d.getTile(M))}const U=q=>{B.forEach(X=>{w[X]=q}),B.length=0};for(k-=1;k>=O&&(!_||!_.hasData());k--){_&&U(_.tileID.key);const q=M.calculateScaledKey(k);if(_=d.getTileByID(q),_&&_.hasData())break;const X=w[q];if(null===X)break;void 0===X?B.push(q):_=d.getTileByID(X)}return U(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(o){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let _=this._tilesDirty[o];_||(_=this._tilesDirty[o]={}),_[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(d){let _,w,C;const M=new p.StructArrayLayout2ui4,k=131;for(w=1;w<129;w++){for(_=1;_<129;_++)C=w*k+_,M.emplaceBack(C,C+1),M.emplaceBack(C,C+k),M.emplaceBack(C+1,C+k),128===w&&M.emplaceBack(C+k,C+k+1);M.emplaceBack(C+1,C+1+k)}return M}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=p.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function pa(m){const o=[];for(let d=0;d<m.length;d++){if(null===m[d])continue;const _=m[d].split(" ");o.push(_.pop())}return o}class hs{static cacheKey(o,d,_){let w=`${o}${_?_.cacheKey:""}`;for(const C of d)w+=`/${C}`;return w}constructor(o,d,_,w,C,M){const k=o.gl;this.program=k.createProgram();const O=pa(_.staticAttributes),B=w?w.getBinderAttributes():[],U=O.concat(B),q=_.staticUniforms?pa(_.staticUniforms):[],X=w?w.getBinderUniforms():[],Y=q.concat(X),oe=[];for(const we of Y)oe.indexOf(we)<0&&oe.push(we);let se=w?w.defines():[];se=se.concat(M.map(we=>`#define ${we}`));const pe=se.concat(Et.fragmentSource,It,Lo.fragmentSource,_.fragmentSource).join("\n"),ie=se.concat(Et.vertexSource,It,Lo.vertexSource,fa.vertexSource,_.vertexSource).join("\n"),ae=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ae,pe),k.compileShader(ae),k.attachShader(this.program,ae);const fe=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(fe,ie),k.compileShader(fe),k.attachShader(this.program,fe),this.attributes={};const _e={};this.numAttributes=U.length;for(let we=0;we<this.numAttributes;we++)U[we]&&(k.bindAttribLocation(this.program,we,U[we]),this.attributes[U[we]]=we);k.linkProgram(this.program),k.deleteShader(fe),k.deleteShader(ae);for(let we=0;we<oe.length;we++){const ce=oe[we];if(ce&&!_e[ce]){const Se=k.getUniformLocation(this.program,ce);Se&&(_e[ce]=Se)}}var we,ce;this.fixedUniforms=C(o,_e),this.binderUniforms=w?w.getUniforms(o,_e):[],-1!==M.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new p.Uniform1i(we=o,(ce=_e).u_dem),u_dem_prev:new p.Uniform1i(we,ce.u_dem_prev),u_dem_unpack:new p.Uniform4f(we,ce.u_dem_unpack),u_dem_tl:new p.Uniform2f(we,ce.u_dem_tl),u_dem_scale:new p.Uniform1f(we,ce.u_dem_scale),u_dem_tl_prev:new p.Uniform2f(we,ce.u_dem_tl_prev),u_dem_scale_prev:new p.Uniform1f(we,ce.u_dem_scale_prev),u_dem_size:new p.Uniform1f(we,ce.u_dem_size),u_dem_lerp:new p.Uniform1f(we,ce.u_dem_lerp),u_exaggeration:new p.Uniform1f(we,ce.u_exaggeration),u_depth:new p.Uniform1i(we,ce.u_depth),u_depth_size_inv:new p.Uniform2f(we,ce.u_depth_size_inv),u_meter_to_dem:new p.Uniform1f(we,ce.u_meter_to_dem),u_label_plane_matrix_inv:new p.UniformMatrix4f(we,ce.u_label_plane_matrix_inv),u_tile_tl_up:new p.Uniform3f(we,ce.u_tile_tl_up),u_tile_tr_up:new p.Uniform3f(we,ce.u_tile_tr_up),u_tile_br_up:new p.Uniform3f(we,ce.u_tile_br_up),u_tile_bl_up:new p.Uniform3f(we,ce.u_tile_bl_up),u_tile_up_scale:new p.Uniform1f(we,ce.u_tile_up_scale)}),-1!==M.indexOf("FOG")&&(this.fogUniforms=((we,ce)=>({u_fog_matrix:new p.UniformMatrix4f(we,ce.u_fog_matrix),u_fog_range:new p.Uniform2f(we,ce.u_fog_range),u_fog_color:new p.Uniform4f(we,ce.u_fog_color),u_fog_horizon_blend:new p.Uniform1f(we,ce.u_fog_horizon_blend),u_fog_temporal_offset:new p.Uniform1f(we,ce.u_fog_temporal_offset)}))(o,_e))}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in d)_[w].set(d[w])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in d)_[w].location&&_[w].set(d[w])}}draw(o,d,_,w,C,M,k,O,B,U,q,X,Y,oe,se,pe){const ie=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(_),o.setStencilMode(w),o.setColorMode(C),o.setCullFace(M);for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(k[fe]);oe&&oe.setUniforms(o,this.binderUniforms,X,{zoom:Y});const ae={[ie.LINES]:2,[ie.TRIANGLES]:3,[ie.LINE_STRIP]:1}[d];for(const fe of q.get()){const _e=fe.vaos||(fe.vaos={});(_e[O]||(_e[O]=new Qr)).bind(o,this,B,oe?oe.getPaintVertexBuffers():[],U,fe.vertexOffset,se,pe),ie.drawElements(d,fe.primitiveLength*ae,ie.UNSIGNED_SHORT,fe.primitiveOffset*ae*2)}}}function Ul(m,o,d){const _=1/ni(d,1,o.transform.tileZoom),w=Math.pow(2,d.tileID.overscaledZ),C=d.tileSize*Math.pow(2,o.transform.tileZoom)/w,M=C*(d.tileID.canonical.x+d.tileID.wrap*w),k=C*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[_,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[M>>16,k>>16],u_pixel_coord_lower:[65535&M,65535&k]}}const ma=(m,o,d,_)=>{const w=o.style.light,C=w.properties.get("position"),M=[C.x,C.y,C.z],k=p.create$2();"viewport"===w.properties.get("anchor")&&(p.fromRotation(k,-o.transform.angle),p.transformMat3(M,M,k));const O=w.properties.get("color");return{u_matrix:m,u_lightpos:M,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+d,u_opacity:_}},Sr=(m,o,d,_,w,C,M)=>p.extend(ma(m,o,d,_),Ul(C,o,M),{u_height_factor:-Math.pow(2,w.overscaledZ)/M.tileSize/8}),ds=m=>({u_matrix:m}),Oo=(m,o,d,_)=>p.extend(ds(m),Ul(d,o,_)),xo=(m,o)=>({u_matrix:m,u_world:o}),en=(m,o,d,_,w)=>p.extend(Oo(m,o,d,_),{u_world:w}),Ls=(m,o,d,_)=>{const w=m.transform;let C;if("map"===_.paint.get("circle-pitch-alignment")){const M=ni(d,1,w.zoom);C=[M,M]}else C=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_matrix:m.translatePosMatrix(o.projMatrix,d,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:p.exported.devicePixelRatio,u_extrude_scale:C}},Cc=m=>{const o=[];return"map"===m.paint.get("circle-pitch-alignment")&&o.push("PITCH_WITH_MAP"),"map"===m.paint.get("circle-pitch-scale")&&o.push("SCALE_WITH_MAP"),o},Jo=(m,o,d)=>{const _=p.EXTENT/d.tileSize;return{u_matrix:m,u_camera_to_center_distance:o.cameraToCenterDistance,u_extrude_scale:[o.pixelsToGLUnits[0]/_,o.pixelsToGLUnits[1]/_]}},eo=(m,o,d=1)=>({u_matrix:m,u_color:o,u_overlay:0,u_overlay_scale:d}),ga=(m,o,d,_)=>({u_matrix:m,u_extrude_scale:ni(o,1,d),u_intensity:_}),Ba=(m,o,d,_,w,C)=>{const M=m.transform,k={u_matrix:Va(m,o,d,w),u_ratio:1/ni(o,1,M.zoom),u_device_pixel_ratio:p.exported.devicePixelRatio,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:C,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(wo(d)){const O=Xi(o,m.transform);k.u_texsize=o.lineAtlasTexture.size,k.u_scale=[O,_.fromScale,_.toScale],k.u_mix=_.t}return k},fs=(m,o,d,_,w)=>{const C=m.transform,M=Xi(o,C);return{u_matrix:Va(m,o,d,w),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ni(o,1,C.zoom),u_device_pixel_ratio:p.exported.devicePixelRatio,u_image:0,u_scale:[M,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}};function Xi(m,o){return 1/ni(m,1,o.tileZoom)}function Va(m,o,d,_){return m.translatePosMatrix(_||o.tileID.projMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const bo=m=>{const o=[];return wo(m)&&o.push("RENDER_LINE_DASH"),m.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT"),o};function wo(m){const o=m.paint.get("line-dasharray").value;return o.value||"constant"!==o.kind}const _a=(m,o,d,_,w)=>{return{u_matrix:m,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:_.mix,u_opacity:_.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(M=w.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(C=w.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:jl(w.paint.get("raster-hue-rotate"))};var C,M};function jl(m){m*=Math.PI/180;const o=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const $l=(m,o,d,_,w,C,M,k,O,B)=>{const U=w.transform;return{u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:U.width/U.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:M,u_coord_matrix:k,u_is_text:+O,u_pitch_with_map:+_,u_texsize:B,u_texture:0}},Di=(m,o,d,_,w,C,M,k,O,B,U)=>{const{cameraToCenterDistance:q,_pitch:X}=w.transform;return p.extend($l(m,o,d,_,w,C,M,k,O,B),{u_gamma_scale:_?q*Math.cos(w.terrain?0:X):1,u_device_pixel_ratio:p.exported.devicePixelRatio,u_is_halo:+U})},pl=(m,o,d,_,w,C,M,k,O,B)=>p.extend(Di(m,o,d,_,w,C,M,k,!0,O,!0),{u_texsize_icon:B,u_texture_icon:1}),Pd=(m,o,d)=>({u_matrix:m,u_opacity:o,u_color:d}),ml=(m,o,d,_,w,C)=>p.extend(function(M,k,O,B){const U=O.imageManager.getPattern(M.from.toString()),q=O.imageManager.getPattern(M.to.toString()),{width:X,height:Y}=O.imageManager.getPixelSize(),oe=Math.pow(2,B.tileID.overscaledZ),se=B.tileSize*Math.pow(2,O.transform.tileZoom)/oe,pe=se*(B.tileID.canonical.x+B.tileID.wrap*oe),ie=se*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[X,Y],u_mix:k.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/ni(B,1,O.transform.tileZoom),u_pixel_coord_upper:[pe>>16,ie>>16],u_pixel_coord_lower:[65535&pe,65535&ie]}}(_,C,d,w),{u_matrix:m,u_opacity:o}),hu={fillExtrusion:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_lightpos:new p.Uniform3f(m,o.u_lightpos),u_lightintensity:new p.Uniform1f(m,o.u_lightintensity),u_lightcolor:new p.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new p.Uniform1f(m,o.u_vertical_gradient),u_opacity:new p.Uniform1f(m,o.u_opacity)}),fillExtrusionPattern:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_lightpos:new p.Uniform3f(m,o.u_lightpos),u_lightintensity:new p.Uniform1f(m,o.u_lightintensity),u_lightcolor:new p.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new p.Uniform1f(m,o.u_vertical_gradient),u_height_factor:new p.Uniform1f(m,o.u_height_factor),u_image:new p.Uniform1i(m,o.u_image),u_texsize:new p.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(m,o.u_scale),u_fade:new p.Uniform1f(m,o.u_fade),u_opacity:new p.Uniform1f(m,o.u_opacity)}),fill:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix)}),fillPattern:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_image:new p.Uniform1i(m,o.u_image),u_texsize:new p.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(m,o.u_scale),u_fade:new p.Uniform1f(m,o.u_fade)}),fillOutline:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_world:new p.Uniform2f(m,o.u_world)}),fillOutlinePattern:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_world:new p.Uniform2f(m,o.u_world),u_image:new p.Uniform1i(m,o.u_image),u_texsize:new p.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(m,o.u_scale),u_fade:new p.Uniform1f(m,o.u_fade)}),circle:(m,o)=>({u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_extrude_scale:new p.Uniform2f(m,o.u_extrude_scale),u_device_pixel_ratio:new p.Uniform1f(m,o.u_device_pixel_ratio),u_matrix:new p.UniformMatrix4f(m,o.u_matrix)}),collisionBox:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_extrude_scale:new p.Uniform2f(m,o.u_extrude_scale)}),collisionCircle:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_inv_matrix:new p.UniformMatrix4f(m,o.u_inv_matrix),u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_viewport_size:new p.Uniform2f(m,o.u_viewport_size)}),debug:(m,o)=>({u_color:new p.UniformColor(m,o.u_color),u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_overlay:new p.Uniform1i(m,o.u_overlay),u_overlay_scale:new p.Uniform1f(m,o.u_overlay_scale)}),clippingMask:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix)}),heatmap:(m,o)=>({u_extrude_scale:new p.Uniform1f(m,o.u_extrude_scale),u_intensity:new p.Uniform1f(m,o.u_intensity),u_matrix:new p.UniformMatrix4f(m,o.u_matrix)}),heatmapTexture:(m,o)=>({u_image:new p.Uniform1i(m,o.u_image),u_color_ramp:new p.Uniform1i(m,o.u_color_ramp),u_opacity:new p.Uniform1f(m,o.u_opacity)}),hillshade:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_image:new p.Uniform1i(m,o.u_image),u_latrange:new p.Uniform2f(m,o.u_latrange),u_light:new p.Uniform2f(m,o.u_light),u_shadow:new p.UniformColor(m,o.u_shadow),u_highlight:new p.UniformColor(m,o.u_highlight),u_accent:new p.UniformColor(m,o.u_accent)}),hillshadePrepare:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_image:new p.Uniform1i(m,o.u_image),u_dimension:new p.Uniform2f(m,o.u_dimension),u_zoom:new p.Uniform1f(m,o.u_zoom),u_unpack:new p.Uniform4f(m,o.u_unpack)}),line:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_ratio:new p.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(m,o.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(m,o.u_units_to_pixels),u_dash_image:new p.Uniform1i(m,o.u_dash_image),u_gradient_image:new p.Uniform1i(m,o.u_gradient_image),u_image_height:new p.Uniform1f(m,o.u_image_height),u_texsize:new p.Uniform2f(m,o.u_texsize),u_scale:new p.Uniform3f(m,o.u_scale),u_mix:new p.Uniform1f(m,o.u_mix)}),linePattern:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_texsize:new p.Uniform2f(m,o.u_texsize),u_ratio:new p.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(m,o.u_device_pixel_ratio),u_image:new p.Uniform1i(m,o.u_image),u_units_to_pixels:new p.Uniform2f(m,o.u_units_to_pixels),u_scale:new p.Uniform3f(m,o.u_scale),u_fade:new p.Uniform1f(m,o.u_fade)}),raster:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_tl_parent:new p.Uniform2f(m,o.u_tl_parent),u_scale_parent:new p.Uniform1f(m,o.u_scale_parent),u_buffer_scale:new p.Uniform1f(m,o.u_buffer_scale),u_fade_t:new p.Uniform1f(m,o.u_fade_t),u_opacity:new p.Uniform1f(m,o.u_opacity),u_image0:new p.Uniform1i(m,o.u_image0),u_image1:new p.Uniform1i(m,o.u_image1),u_brightness_low:new p.Uniform1f(m,o.u_brightness_low),u_brightness_high:new p.Uniform1f(m,o.u_brightness_high),u_saturation_factor:new p.Uniform1f(m,o.u_saturation_factor),u_contrast_factor:new p.Uniform1f(m,o.u_contrast_factor),u_spin_weights:new p.Uniform3f(m,o.u_spin_weights)}),symbolIcon:(m,o)=>({u_is_size_zoom_constant:new p.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(m,o.u_size_t),u_size:new p.Uniform1f(m,o.u_size),u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(m,o.u_pitch),u_rotate_symbol:new p.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(m,o.u_fade_change),u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new p.Uniform1i(m,o.u_is_text),u_pitch_with_map:new p.Uniform1i(m,o.u_pitch_with_map),u_texsize:new p.Uniform2f(m,o.u_texsize),u_texture:new p.Uniform1i(m,o.u_texture)}),symbolSDF:(m,o)=>({u_is_size_zoom_constant:new p.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(m,o.u_size_t),u_size:new p.Uniform1f(m,o.u_size),u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(m,o.u_pitch),u_rotate_symbol:new p.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(m,o.u_fade_change),u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new p.Uniform1i(m,o.u_is_text),u_pitch_with_map:new p.Uniform1i(m,o.u_pitch_with_map),u_texsize:new p.Uniform2f(m,o.u_texsize),u_texture:new p.Uniform1i(m,o.u_texture),u_gamma_scale:new p.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(m,o.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(m,o.u_is_halo)}),symbolTextAndIcon:(m,o)=>({u_is_size_zoom_constant:new p.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(m,o.u_size_t),u_size:new p.Uniform1f(m,o.u_size),u_camera_to_center_distance:new p.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(m,o.u_pitch),u_rotate_symbol:new p.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(m,o.u_fade_change),u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new p.Uniform1i(m,o.u_is_text),u_pitch_with_map:new p.Uniform1i(m,o.u_pitch_with_map),u_texsize:new p.Uniform2f(m,o.u_texsize),u_texsize_icon:new p.Uniform2f(m,o.u_texsize_icon),u_texture:new p.Uniform1i(m,o.u_texture),u_texture_icon:new p.Uniform1i(m,o.u_texture_icon),u_gamma_scale:new p.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(m,o.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(m,o.u_is_halo)}),background:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_opacity:new p.Uniform1f(m,o.u_opacity),u_color:new p.UniformColor(m,o.u_color)}),backgroundPattern:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_opacity:new p.Uniform1f(m,o.u_opacity),u_image:new p.Uniform1i(m,o.u_image),u_pattern_tl_a:new p.Uniform2f(m,o.u_pattern_tl_a),u_pattern_br_a:new p.Uniform2f(m,o.u_pattern_br_a),u_pattern_tl_b:new p.Uniform2f(m,o.u_pattern_tl_b),u_pattern_br_b:new p.Uniform2f(m,o.u_pattern_br_b),u_texsize:new p.Uniform2f(m,o.u_texsize),u_mix:new p.Uniform1f(m,o.u_mix),u_pattern_size_a:new p.Uniform2f(m,o.u_pattern_size_a),u_pattern_size_b:new p.Uniform2f(m,o.u_pattern_size_b),u_scale_a:new p.Uniform1f(m,o.u_scale_a),u_scale_b:new p.Uniform1f(m,o.u_scale_b),u_pixel_coord_upper:new p.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(m,o.u_pixel_coord_lower),u_tile_units_to_pixels:new p.Uniform1f(m,o.u_tile_units_to_pixels)}),terrainRaster:Wt,terrainDepth:Wt,skybox:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_sun_direction:new p.Uniform3f(m,o.u_sun_direction),u_cubemap:new p.Uniform1i(m,o.u_cubemap),u_opacity:new p.Uniform1f(m,o.u_opacity),u_temporal_offset:new p.Uniform1f(m,o.u_temporal_offset)}),skyboxGradient:(m,o)=>({u_matrix:new p.UniformMatrix4f(m,o.u_matrix),u_color_ramp:new p.Uniform1i(m,o.u_color_ramp),u_center_direction:new p.Uniform3f(m,o.u_center_direction),u_radius:new p.Uniform1f(m,o.u_radius),u_opacity:new p.Uniform1f(m,o.u_opacity),u_temporal_offset:new p.Uniform1f(m,o.u_temporal_offset)}),skyboxCapture:(m,o)=>({u_matrix_3f:new p.UniformMatrix3f(m,o.u_matrix_3f),u_sun_direction:new p.Uniform3f(m,o.u_sun_direction),u_sun_intensity:new p.Uniform1f(m,o.u_sun_intensity),u_color_tint_r:new p.Uniform4f(m,o.u_color_tint_r),u_color_tint_m:new p.Uniform4f(m,o.u_color_tint_m),u_luminance:new p.Uniform1f(m,o.u_luminance)})};let ps;function gl(m,o,d,_,w,C,M){const k=m.context,O=k.gl,B=m.useProgram("collisionBox"),U=[];let q=0,X=0;for(let fe=0;fe<_.length;fe++){const _e=_[fe],we=o.getTile(_e),ce=we.getBucket(d);if(!ce)continue;let Se=_e.projMatrix;0===w[0]&&0===w[1]||(Se=m.translatePosMatrix(_e.projMatrix,we,w,C));const je=M?ce.textCollisionBox:ce.iconCollisionBox,We=ce.collisionCircleArray;if(We.length>0){const Te=p.create$1(),ze=Se;p.mul$1(Te,ce.placementInvProjMatrix,m.transform.glCoordMatrix),p.mul$1(Te,Te,ce.placementViewportMatrix),U.push({circleArray:We,circleOffset:X,transform:ze,invTransform:Te}),q+=We.length/4,X=q}je&&(m.terrain&&m.terrain.setupElevationDraw(we,B),B.draw(k,O.LINES,p.DepthMode.disabled,p.StencilMode.disabled,m.colorModeForRenderPass(),p.CullFaceMode.disabled,Jo(Se,m.transform,we),d.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,m.transform.zoom,null,je.collisionVertexBuffer,je.collisionVertexBufferExt))}if(!M||!U.length)return;const Y=m.useProgram("collisionCircle"),oe=new p.StructArrayLayout2f1f2i16;oe.resize(4*q),oe._trim();let se=0;for(const fe of U)for(let _e=0;_e<fe.circleArray.length/4;_e++){const we=4*_e,ce=fe.circleArray[we+0],Se=fe.circleArray[we+1],je=fe.circleArray[we+2],We=fe.circleArray[we+3];oe.emplace(se++,ce,Se,je,We,0),oe.emplace(se++,ce,Se,je,We,1),oe.emplace(se++,ce,Se,je,We,2),oe.emplace(se++,ce,Se,je,We,3)}(!ps||ps.length<2*q)&&(ps=function(fe){const _e=2*fe,we=new p.StructArrayLayout3ui6;we.resize(_e),we._trim();for(let ce=0;ce<_e;ce++){const Se=6*ce;we.uint16[Se+0]=4*ce+0,we.uint16[Se+1]=4*ce+1,we.uint16[Se+2]=4*ce+2,we.uint16[Se+3]=4*ce+2,we.uint16[Se+4]=4*ce+3,we.uint16[Se+5]=4*ce+0}return we}(q));const pe=k.createIndexBuffer(ps,!0),ie=k.createVertexBuffer(oe,p.collisionCircleLayout.members,!0);for(const fe of U){const _e={u_matrix:fe.transform,u_inv_matrix:fe.invTransform,u_camera_to_center_distance:(ae=m.transform).cameraToCenterDistance,u_viewport_size:[ae.width,ae.height]};Y.draw(k,O.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,m.colorModeForRenderPass(),p.CullFaceMode.disabled,_e,d.id,ie,pe,p.SegmentVector.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,m.transform.zoom,null,null,null)}var ae;ie.destroy(),pe.destroy()}const _l=p.identity(new Float32Array(16));function Xu(m,o,d,_,w,C){const{horizontalAlign:M,verticalAlign:k}=p.getAnchorAlignment(m),O=-(M-.5)*o,B=-(k-.5)*d,U=p.evaluateVariableOffset(m,_);return new p.pointGeometry((O/w+U[0])*C,(B/w+U[1])*C)}function Hl(m,o,d,_,w,C,M,k,O,B,U,q){const X=m.text.placedSymbolArray,Y=m.text.dynamicLayoutVertexArray,oe=m.icon.dynamicLayoutVertexArray,se={};Y.clear();for(let pe=0;pe<X.length;pe++){const ie=X.get(pe),ae=m.allowVerticalPlacement&&!ie.placedOrientation,fe=ie.hidden||!ie.crossTileID||ae?null:_[ie.crossTileID];if(fe){const _e=new p.pointGeometry(ie.tileAnchorX,ie.tileAnchorY),we=q(_e),ce=cr(_e,d?k:M,we),Se=Vt(C.cameraToCenterDistance,ce.signedDistanceFromCamera);let je=w.evaluateSizeForFeature(m.textSizeData,B,ie)*Se/p.ONE_EM;d&&(je*=m.tilePixelRatio/O);const{width:We,height:Te,anchor:ze,textOffset:ct,textScale:ht}=fe,ut=Xu(ze,We,Te,ct,ht,je),tt=d?cr(_e.add(ut),M,we).point:ce.point.add(o?ut.rotate(-C.angle):ut),ft=m.allowVerticalPlacement&&ie.placedOrientation===p.WritingMode.vertical?Math.PI/2:0;for(let sn=0;sn<ie.numGlyphs;sn++)p.addDynamicAttributes(Y,tt,ft);U&&ie.associatedIconIndex>=0&&(se[ie.associatedIconIndex]={shiftedAnchor:tt,angle:ft})}else Br(ie.numGlyphs,Y)}if(U){oe.clear();const pe=m.icon.placedSymbolArray;for(let ie=0;ie<pe.length;ie++){const ae=pe.get(ie);if(ae.hidden)Br(ae.numGlyphs,oe);else{const fe=se[ie];if(fe)for(let _e=0;_e<ae.numGlyphs;_e++)p.addDynamicAttributes(oe,fe.shiftedAnchor,fe.angle);else Br(ae.numGlyphs,oe)}}m.icon.dynamicLayoutVertexBuffer.updateData(oe)}m.text.dynamicLayoutVertexBuffer.updateData(Y)}function yl(m,o,d){return d.iconsInText&&o?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Os(m,o,d,_,w,C,M,k,O,B,U,q){const X=m.context,Y=X.gl,oe=m.transform,se="map"===k,pe="map"===O,ie=se&&"point"!==d.layout.get("symbol-placement"),ae=se&&!pe&&!ie,fe=void 0!==d.layout.get("symbol-sort-key").constantOr(1);let _e=!1;const we=m.depthModeForSublayer(0,p.DepthMode.ReadOnly),ce=d.layout.get("text-variable-anchor"),Se=[],je=m.terrain&&pe?["PITCH_WITH_MAP_TERRAIN"]:null;for(const We of _){const Te=o.getTile(We),ze=Te.getBucket(d);if(!ze)continue;const ct=w?ze.text:ze.icon;if(!ct||!ct.segments.get().length)continue;const ht=ct.programConfigurations.get(d.id),ut=w||ze.sdfIcons,tt=w?ze.textSizeData:ze.iconSizeData,ft=pe||0!==oe.pitch,sn=m.useProgram(yl(ut,w,ze),ht,je),kt=p.evaluateSizeForZoom(tt,oe.zoom);let Mi,ai,Zt,an,bi=[0,0],Co=null;if(w){if(ai=Te.glyphAtlasTexture,Zt=Y.LINEAR,Mi=Te.glyphAtlasTexture.size,ze.iconsInText){bi=Te.imageAtlasTexture.size,Co=Te.imageAtlasTexture;const Vo="composite"===tt.kind||"camera"===tt.kind;an=ft||m.options.rotating||m.options.zooming||Vo?Y.LINEAR:Y.NEAREST}}else{const Vo=1!==d.layout.get("icon-size").constantOr(0)||ze.iconsNeedLinear;ai=Te.imageAtlasTexture,Zt=ut||m.options.rotating||m.options.zooming||Vo||ft?Y.LINEAR:Y.NEAREST,Mi=Te.imageAtlasTexture.size}const zo=ni(Te,1,m.transform.zoom),io=Ct(We.projMatrix,pe,se,m.transform,zo),Eo=m.terrain&&pe&&ie?p.invert(new Float32Array(16),io):_l,Vs=xn(We.projMatrix,pe,se,m.transform,zo),Bo=ce&&ze.hasTextData(),pn="none"!==d.layout.get("icon-text-fit")&&Bo&&ze.hasIconData();if(ie){const Vo=oe.elevation;mt(ze,We.projMatrix,m,w,io,Vs,pe,B,Vo?ro=>Vo.getAtTileOffset(We,ro.x,ro.y):null)}const ui=m.translatePosMatrix(We.projMatrix,Te,C,M),En=ie||w&&ce||pn?_l:io,ri=m.translatePosMatrix(Vs,Te,C,M,!0),gr=ut&&0!==d.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1);let jn;jn=ut?ze.iconsInText?pl(tt.kind,kt,ae,pe,m,ui,En,ri,Mi,bi):Di(tt.kind,kt,ae,pe,m,ui,En,ri,w,Mi,!0):$l(tt.kind,kt,ae,pe,m,ui,En,ri,w,Mi);const Ki={program:sn,buffers:ct,uniformValues:jn,atlasTexture:ai,atlasTextureIcon:Co,atlasInterpolation:Zt,atlasInterpolationIcon:an,isSDF:ut,hasHalo:gr,tile:Te,labelPlaneMatrixInv:Eo};if(fe&&ze.canOverlap){_e=!0;const Vo=ct.segments.get();for(const ro of Vo)Se.push({segments:new p.SegmentVector([ro]),sortKey:ro.sortKey,state:Ki})}else Se.push({segments:ct.segments,sortKey:0,state:Ki})}_e&&Se.sort((We,Te)=>We.sortKey-Te.sortKey);for(const We of Se){const Te=We.state;if(m.terrain&&m.terrain.setupElevationDraw(Te.tile,Te.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:Te.labelPlaneMatrixInv}),X.activeTexture.set(Y.TEXTURE0),Te.atlasTexture.bind(Te.atlasInterpolation,Y.CLAMP_TO_EDGE),Te.atlasTextureIcon&&(X.activeTexture.set(Y.TEXTURE1),Te.atlasTextureIcon&&Te.atlasTextureIcon.bind(Te.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),Te.isSDF){const ze=Te.uniformValues;Te.hasHalo&&(ze.u_is_halo=1,Fs(Te.buffers,We.segments,d,m,Te.program,we,U,q,ze)),ze.u_is_halo=0}Fs(Te.buffers,We.segments,d,m,Te.program,we,U,q,Te.uniformValues)}}function Fs(m,o,d,_,w,C,M,k,O){const B=_.context;w.draw(B,B.gl.TRIANGLES,C,M,k,p.CullFaceMode.disabled,O,d.id,m.layoutVertexBuffer,m.indexBuffer,o,d.paint,_.transform.zoom,m.programConfigurations.get(d.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function vl(m,o,d,_,w,C,M){const k=m.context.gl,O=d.paint.get("fill-pattern"),B=O&&O.constantOr(1),U=d.getCrossfadeParameters();let q,X,Y,oe,se;M?(X=B&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=k.LINES):(X=B?"fillPattern":"fill",q=k.TRIANGLES);for(const pe of _){const ie=o.getTile(pe);if(B&&!ie.patternsLoaded())continue;const ae=ie.getBucket(d);if(!ae)continue;m.prepareDrawTile(pe);const fe=ae.programConfigurations.get(d.id),_e=m.useProgram(X,fe);B&&(m.context.activeTexture.set(k.TEXTURE0),ie.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),fe.updatePaintBuffers(U));const we=O.constantOr(null);if(we&&ie.imageAtlas){const Se=ie.imageAtlas,je=Se.patternPositions[we.to.toString()],We=Se.patternPositions[we.from.toString()];je&&We&&fe.setConstantPatternPositions(je,We)}const ce=m.translatePosMatrix(pe.projMatrix,ie,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(M){oe=ae.indexBuffer2,se=ae.segments2;const Se=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];Y="fillOutlinePattern"===X&&B?en(ce,m,U,ie,Se):xo(ce,Se)}else oe=ae.indexBuffer,se=ae.segments,Y=B?Oo(ce,m,U,ie):ds(ce);m.prepareDrawProgram(m.context,_e,pe.toUnwrapped()),_e.draw(m.context,q,w,m.stencilModeForClipping(pe),C,p.CullFaceMode.disabled,Y,d.id,ae.layoutVertexBuffer,oe,se,d.paint,m.transform.zoom,fe)}}function Gl(m,o,d,_,w,C,M){const k=m.context,O=k.gl,B=d.paint.get("fill-extrusion-pattern"),U=B.constantOr(1),q=d.getCrossfadeParameters(),X=d.paint.get("fill-extrusion-opacity");for(const Y of _){const oe=o.getTile(Y),se=oe.getBucket(d);if(!se)continue;const pe=se.programConfigurations.get(d.id),ie=m.useProgram(U?"fillExtrusionPattern":"fillExtrusion",pe);if(m.terrain){const ce=m.terrain;if(!se.enableTerrain)continue;if(ce.setupElevationDraw(oe,ie,{useMeterToDem:!0}),Ku(k,o,Y,se,d,ce),!se.centroidVertexBuffer){const Se=ie.attributes.a_centroid_pos;void 0!==Se&&O.vertexAttrib2f(Se,0,0)}}U&&(m.context.activeTexture.set(O.TEXTURE0),oe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),pe.updatePaintBuffers(q));const ae=B.constantOr(null);if(ae&&oe.imageAtlas){const ce=oe.imageAtlas,Se=ce.patternPositions[ae.to.toString()],je=ce.patternPositions[ae.from.toString()];Se&&je&&pe.setConstantPatternPositions(Se,je)}const fe=m.translatePosMatrix(Y.projMatrix,oe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),_e=d.paint.get("fill-extrusion-vertical-gradient"),we=U?Sr(fe,m,_e,X,Y,q,oe):ma(fe,m,_e,X);m.prepareDrawProgram(k,ie,Y.toUnwrapped()),ie.draw(k,k.gl.TRIANGLES,w,C,M,p.CullFaceMode.backCCW,we,d.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,d.paint,m.transform.zoom,pe,m.terrain?se.centroidVertexBuffer:null)}}function Ku(m,o,d,_,w,C){const M=[ie=>{let ae=ie.canonical.x-1,fe=ie.wrap;return ae<0&&(ae=(1<<ie.canonical.z)-1,fe--),new p.OverscaledTileID(ie.overscaledZ,fe,ie.canonical.z,ae,ie.canonical.y)},ie=>{let ae=ie.canonical.x+1,fe=ie.wrap;return ae===1<<ie.canonical.z&&(ae=0,fe++),new p.OverscaledTileID(ie.overscaledZ,fe,ie.canonical.z,ae,ie.canonical.y)},ie=>new p.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,(0===ie.canonical.y?1<<ie.canonical.z:ie.canonical.y)-1),ie=>new p.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,ie.canonical.y===(1<<ie.canonical.z)-1?0:ie.canonical.y+1)],k=ie=>{const ae=o.getSource().maxzoom,fe=Se=>{const je=o.getTileByID(Se);if(je&&je.hasData())return je.getBucket(w)};let _e,we,ce;return(ie.overscaledZ===ie.canonical.z||ie.overscaledZ>=ae)&&(_e=fe(ie.key)),ie.overscaledZ>=ae&&(we=fe(ie.calculateScaledKey(ie.overscaledZ+1))),ie.overscaledZ>ae&&(ce=fe(ie.calculateScaledKey(ie.overscaledZ-1))),_e||we||ce},O=[0,0,0],B=(ie,ae)=>(O[0]=Math.min(ie.min.y,ae.min.y),O[1]=Math.max(ie.max.y,ae.max.y),O[2]=p.EXTENT-ae.min.x>ie.max.x?ae.min.x-p.EXTENT:ie.max.x,O),U=(ie,ae)=>(O[0]=Math.min(ie.min.x,ae.min.x),O[1]=Math.max(ie.max.x,ae.max.x),O[2]=p.EXTENT-ae.min.y>ie.max.y?ae.min.y-p.EXTENT:ie.max.y,O),q=[(ie,ae)=>B(ie,ae),(ie,ae)=>B(ae,ie),(ie,ae)=>U(ie,ae),(ie,ae)=>U(ae,ie)],X=new p.pointGeometry(0,0);let Y,oe,se;const pe=(ie,ae,fe,_e,we)=>{const ce=[[_e?fe:ie,_e?ie:fe,0],[_e?fe:ae,_e?ae:fe,0]],Se=we<0?p.EXTENT+we:we,je=[_e?Se:(ie+ae)/2,_e?(ie+ae)/2:Se,0];return 0===fe&&we<0||0!==fe&&we>0?C.getForTilePoints(se,[je],!0,oe):ce.push(je),C.getForTilePoints(d,ce,!0,Y),Math.max(ce[0][2],ce[1][2],je[2])/C.exaggeration()};for(let ie=0;ie<4;ie++){const ae=_.borders[ie];if(0===ae.length&&(_.borderDone[ie]=!0),_.borderDone[ie])continue;const fe=se=M[ie](d),_e=k(fe);if(!(_e&&_e.enableTerrain&&(oe=C.findDEMTileFor(fe),oe&&oe.dem)))continue;if(!Y){const je=C.findDEMTileFor(d);if(!je||!je.dem)return;Y=je}const we=(ie<2?1:5)-ie,ce=_e.borders[we];let Se=0;for(let je=0;je<ae.length;je++){const We=_.featuresOnBorder[ae[je]],Te=We.borders[ie];let ze;for(;Se<ce.length&&(ze=_e.featuresOnBorder[ce[Se]],!(ze.borders[we][1]>Te[0]+3));)_e.borderDone[we]||_e.encodeCentroid(void 0,ze,!1),Se++;if(ze&&Se<ce.length){const ct=Se;let ht=0;for(;!(ze.borders[we][0]>Te[1]-3)&&(ht++,++Se!==ce.length);)ze=_e.featuresOnBorder[ce[Se]];if(ze=_e.featuresOnBorder[ce[ct]],We.intersectsCount()>1||ze.intersectsCount()>1||1!==ht){1!==ht&&(Se=ct),_.encodeCentroid(void 0,We,!1),_e.borderDone[we]||_e.encodeCentroid(void 0,ze,!1);continue}const ut=q[ie](We,ze),tt=ie%2?p.EXTENT-1:0;X.x=pe(ut[0],Math.min(p.EXTENT-1,ut[1]),tt,ie<2,ut[2]),X.y=0,_.encodeCentroid(X,We,!1),_e.borderDone[we]||_e.encodeCentroid(X,ze,!1)}else _.encodeCentroid(void 0,We,!1)}_.borderDone[ie]=_.needsCentroidUpdate=!0,_e.borderDone[we]||(_e.borderDone[we]=_e.needsCentroidUpdate=!0)}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(m)}const on=new p.Color(1,0,0,1),du=new p.Color(0,1,0,1),Zl=new p.Color(0,0,1,1),fu=new p.Color(1,0,1,1),Ur=new p.Color(0,1,1,1);function pu(m,o,d,_){xl(m,0,o+d/2,m.transform.width,d,_)}function Yu(m,o,d,_){xl(m,o-d/2,0,d,m.transform.height,_)}function xl(m,o,d,_,w,C){const M=m.context,k=M.gl;k.enable(k.SCISSOR_TEST),k.scissor(o*p.exported.devicePixelRatio,d*p.exported.devicePixelRatio,_*p.exported.devicePixelRatio,w*p.exported.devicePixelRatio),M.clear({color:C}),k.disable(k.SCISSOR_TEST)}function ms(m,o,d){const _=m.context,w=_.gl,C=d.projMatrix,M=m.useProgram("debug"),k=o.getTileByID(d.key);m.terrain&&m.terrain.setupElevationDraw(k,M);const O=p.DepthMode.disabled,B=p.StencilMode.disabled,U=m.colorModeForRenderPass(),q="$debug";_.activeTexture.set(w.TEXTURE0),m.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),M.draw(_,w.LINE_STRIP,O,B,U,p.CullFaceMode.disabled,eo(C,p.Color.red),q,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments);const X=k.latestRawTileData,Y=Math.floor((X&&X.byteLength||0)/1024),oe=o.getTile(d).tileSize,se=512/Math.min(oe,512)*(d.overscaledZ/m.transform.zoom)*.5;let pe=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(pe+=` => ${d.overscaledZ}`),function(ie,ae){ie.initDebugOverlayCanvas();const fe=ie.debugOverlayCanvas,_e=ie.context.gl,we=ie.debugOverlayCanvas.getContext("2d");we.clearRect(0,0,fe.width,fe.height),we.shadowColor="white",we.shadowBlur=2,we.lineWidth=1.5,we.strokeStyle="white",we.textBaseline="top",we.font="bold 36px Open Sans, sans-serif",we.fillText(ae,5,5),we.strokeText(ae,5,5),ie.debugOverlayTexture.update(fe),ie.debugOverlayTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE)}(m,`${pe} ${Y}kb`),M.draw(_,w.TRIANGLES,O,B,p.ColorMode.alphaBlended,p.CullFaceMode.disabled,eo(C,p.Color.transparent,se),q,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments)}const bl=p.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ci}=bl;function hr(m,o,d,_){m.emplaceBack(o,d,_)}class Ua{constructor(o){this.vertexArray=new p.StructArrayLayout3f12,this.indices=new p.StructArrayLayout3ui6,hr(this.vertexArray,-1,-1,1),hr(this.vertexArray,1,-1,1),hr(this.vertexArray,-1,1,1),hr(this.vertexArray,1,1,1),hr(this.vertexArray,-1,-1,-1),hr(this.vertexArray,1,-1,-1),hr(this.vertexArray,-1,1,-1),hr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,ci),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=p.SegmentVector.simpleSegment(0,0,36,12)}}function gs(m,o,d,_,w,C){const M=m.gl,k=o.paint.get("sky-atmosphere-color"),O=o.paint.get("sky-atmosphere-halo-color"),B=o.paint.get("sky-atmosphere-sun-intensity"),U={u_matrix_3f:p.fromMat4([],_),u_sun_direction:w,u_sun_intensity:B,u_color_tint_r:[(oe=k).r,oe.g,oe.b,oe.a],u_color_tint_m:[(se=O).r,se.g,se.b,se.a],u_luminance:5e-5};var oe,se;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+C,o.skyboxTexture,0),d.draw(m,M.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.frontCW,U,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const ql={symbol:function(m,o,d,_,w){if("translucent"!==m.renderPass)return;const C=p.StencilMode.disabled,M=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(k,O,B,U,q,X,Y){const oe=O.transform,se="map"===q,pe="map"===X;for(const ie of k){const ae=U.getTile(ie),fe=ae.getBucket(B);if(!fe||!fe.text||!fe.text.segments.get().length)continue;const _e=p.evaluateSizeForZoom(fe.textSizeData,oe.zoom),we=ni(ae,1,O.transform.zoom),ce=Ct(ie.projMatrix,pe,se,O.transform,we),Se="none"!==B.layout.get("icon-text-fit")&&fe.hasIconData();if(_e){const je=Math.pow(2,oe.zoom-ae.tileID.overscaledZ),We=oe.elevation;Hl(fe,se,pe,Y,p.symbolSize,oe,ce,ie.projMatrix,je,_e,Se,We?Te=>We.getAtTileOffset(ie,Te.x,Te.y):Te=>0)}}}(_,m,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),w),0!==d.paint.get("icon-opacity").constantOr(1)&&Os(m,o,d,_,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),C,M),0!==d.paint.get("text-opacity").constantOr(1)&&Os(m,o,d,_,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),C,M),o.map.showCollisionBoxes&&(gl(m,o,d,_,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),gl(m,o,d,_,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,d,_){if("translucent"!==m.renderPass)return;const w=d.paint.get("circle-opacity"),C=d.paint.get("circle-stroke-width"),M=d.paint.get("circle-stroke-opacity"),k=void 0!==d.layout.get("circle-sort-key").constantOr(1);if(0===w.constantOr(1)&&(0===C.constantOr(1)||0===M.constantOr(1)))return;const O=m.context,B=O.gl,U=m.depthModeForSublayer(0,p.DepthMode.ReadOnly),q=p.StencilMode.disabled,X=m.colorModeForRenderPass(),Y=[];for(let oe=0;oe<_.length;oe++){const se=_[oe],pe=o.getTile(se),ie=pe.getBucket(d);if(!ie)continue;const ae=ie.programConfigurations.get(d.id),fe=Cc(d),_e={programConfiguration:ae,program:m.useProgram("circle",ae,fe),layoutVertexBuffer:ie.layoutVertexBuffer,indexBuffer:ie.indexBuffer,uniformValues:Ls(m,se,pe,d),tile:pe};if(k){const we=ie.segments.get();for(const ce of we)Y.push({segments:new p.SegmentVector([ce]),sortKey:ce.sortKey,state:_e})}else Y.push({segments:ie.segments,sortKey:0,state:_e})}k&&Y.sort((oe,se)=>oe.sortKey-se.sortKey);for(const oe of Y){const{programConfiguration:se,program:pe,layoutVertexBuffer:ie,indexBuffer:ae,uniformValues:fe,tile:_e}=oe.state,we=oe.segments;m.terrain&&m.terrain.setupElevationDraw(_e,pe,{useDepthForOcclusion:!0}),m.prepareDrawProgram(O,pe,_e.tileID.toUnwrapped()),pe.draw(O,B.TRIANGLES,U,q,X,p.CullFaceMode.disabled,fe,d.id,ie,ae,we,d.paint,m.transform.zoom,se)}},heatmap:function(m,o,d,_){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const w=m.context,C=w.gl,M=p.StencilMode.disabled,k=new p.ColorMode([C.ONE,C.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(O,B,U){const q=O.gl;O.activeTexture.set(q.TEXTURE1),O.viewport.set([0,0,B.width/4,B.height/4]);let X=U.heatmapFbo;if(X)q.bindTexture(q.TEXTURE_2D,X.colorAttachment.get()),O.bindFramebuffer.set(X.framebuffer);else{const Y=q.createTexture();q.bindTexture(q.TEXTURE_2D,Y),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),X=U.heatmapFbo=O.createFramebuffer(B.width/4,B.height/4,!1),function(oe,se,pe,ie){const ae=oe.gl;ae.texImage2D(ae.TEXTURE_2D,0,ae.RGBA,se.width/4,se.height/4,0,ae.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:ae.UNSIGNED_BYTE,null),ie.colorAttachment.set(pe)}(O,B,Y,X)}})(w,m,d),w.clear({color:p.Color.transparent});for(let O=0;O<_.length;O++){const B=_[O];if(o.hasRenderableParent(B))continue;const U=o.getTile(B),q=U.getBucket(d);if(!q)continue;const X=q.programConfigurations.get(d.id),Y=m.useProgram("heatmap",X),{zoom:oe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(U,Y),m.prepareDrawProgram(w,Y,B.toUnwrapped()),Y.draw(w,C.TRIANGLES,p.DepthMode.disabled,M,k,p.CullFaceMode.disabled,ga(B.projMatrix,U,oe,d.paint.get("heatmap-intensity")),d.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,d.paint,m.transform.zoom,X)}w.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(w,C){const M=w.context,k=M.gl,O=C.heatmapFbo;if(!O)return;M.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get()),M.activeTexture.set(k.TEXTURE1);let B=C.colorRampTexture;B||(B=C.colorRampTexture=new p.Texture(M,C.colorRamp,k.RGBA)),B.bind(k.LINEAR,k.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(M,k.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,w.colorModeForRenderPass(),p.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,C.paint,w.transform.zoom)}(m,d))},line:function(m,o,d,_){if("translucent"!==m.renderPass)return;const w=d.paint.get("line-opacity"),C=d.paint.get("line-width");if(0===w.constantOr(1)||0===C.constantOr(1))return;const M=m.depthModeForSublayer(0,p.DepthMode.ReadOnly),k=m.colorModeForRenderPass(),O=d.paint.get("line-dasharray"),B=O.constantOr(1),U=d.layout.get("line-cap"),q=d.paint.get("line-pattern"),X=q.constantOr(1),Y=d.paint.get("line-gradient"),oe=d.getCrossfadeParameters(),se=X?"linePattern":"line",pe=m.context,ie=pe.gl;for(const ae of _){const fe=o.getTile(ae);if(X&&!fe.patternsLoaded())continue;const _e=fe.getBucket(d);if(!_e)continue;m.prepareDrawTile(ae);const we=_e.programConfigurations.get(d.id),ce=bo(d),Se=m.useProgram(se,we,ce),je=q.constantOr(null);if(je&&fe.imageAtlas){const ht=fe.imageAtlas,ut=ht.patternPositions[je.to.toString()],tt=ht.patternPositions[je.from.toString()];ut&&tt&&we.setConstantPatternPositions(ut,tt)}const We=O.constantOr(null),Te=U.constantOr(null);if(!X&&We&&Te&&fe.lineAtlas){const ht=fe.lineAtlas,ut=ht.getDash(We.to,Te),tt=ht.getDash(We.from,Te);ut&&tt&&we.setConstantPatternPositions(ut,tt)}const ze=m.terrain?ae.projMatrix:null,ct=X?fs(m,fe,d,oe,ze):Ba(m,fe,d,oe,ze,_e.lineClipsArray.length);if(Y){const ht=_e.gradients[d.id];let ut=ht.texture;if(d.gradientVersion!==ht.version){let tt=256;if(d.stepInterpolant){const ft=o.getSource().maxzoom,sn=ae.canonical.z===ft?Math.ceil(1<<m.transform.maxZoom-ae.canonical.z):1;tt=p.clamp(p.nextPowerOfTwo(_e.maxLineLength/p.EXTENT*1024*sn),256,pe.maxTextureSize)}ht.gradient=p.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:tt,image:ht.gradient||void 0,clips:_e.lineClipsArray}),ht.texture?ht.texture.update(ht.gradient):ht.texture=new p.Texture(pe,ht.gradient,ie.RGBA),ht.version=d.gradientVersion,ut=ht.texture}pe.activeTexture.set(ie.TEXTURE1),ut.bind(d.stepInterpolant?ie.NEAREST:ie.LINEAR,ie.CLAMP_TO_EDGE)}B&&(pe.activeTexture.set(ie.TEXTURE0),fe.lineAtlasTexture.bind(ie.LINEAR,ie.REPEAT),we.updatePaintBuffers(oe)),X&&(pe.activeTexture.set(ie.TEXTURE0),fe.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),we.updatePaintBuffers(oe)),m.prepareDrawProgram(pe,Se,ae.toUnwrapped()),Se.draw(pe,ie.TRIANGLES,M,m.stencilModeForClipping(ae),k,p.CullFaceMode.disabled,ct,d.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,d.paint,m.transform.zoom,we,_e.layoutVertexBuffer2)}},fill:function(m,o,d,_){const w=d.paint.get("fill-color"),C=d.paint.get("fill-opacity");if(0===C.constantOr(1))return;const M=m.colorModeForRenderPass(),k=d.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!k.constantOr(1)&&1===w.constantOr(p.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(m.renderPass===O){const B=m.depthModeForSublayer(1,"opaque"===m.renderPass?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly);vl(m,o,d,_,B,M,!1)}if("translucent"===m.renderPass&&d.paint.get("fill-antialias")){const B=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,p.DepthMode.ReadOnly);vl(m,o,d,_,B,M,!0)}},"fill-extrusion":function(m,o,d,_){const w=d.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===m.renderPass){const C=new p.DepthMode(m.context.gl.LEQUAL,p.DepthMode.ReadWrite,m.depthRangeFor3D);if(1!==w||d.paint.get("fill-extrusion-pattern").constantOr(1))Gl(m,o,d,_,C,p.StencilMode.disabled,p.ColorMode.disabled),Gl(m,o,d,_,C,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const M=m.colorModeForRenderPass();Gl(m,o,d,_,C,p.StencilMode.disabled,M)}}},hillshade:function(m,o,d,_){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const w=m.context,C=m.depthModeForSublayer(0,p.DepthMode.ReadOnly),M=m.colorModeForRenderPass(),k=m.terrain&&m.terrain.renderingToTexture,[O,B]="translucent"!==m.renderPass||k?[{},_]:m.stencilConfigForOverlap(_);for(const U of B){const q=o.getTile(U);if(q.needsHillshadePrepare&&"offscreen"===m.renderPass)et(m,q,d,C,p.StencilMode.disabled,M);else if("translucent"===m.renderPass){const X=k&&m.terrain?m.terrain.stencilModeForRTTOverlap(U):O[U.overscaledZ];wc(m,U,q,d,C,X,M)}}w.viewport.set([0,0,m.width,m.height])},raster:function(m,o,d,_,w,C){if("translucent"!==m.renderPass||0===d.paint.get("raster-opacity")||!_.length)return;const M=m.context,k=M.gl,O=o.getSource(),B=m.useProgram("raster"),U=m.colorModeForRenderPass(),q=m.terrain&&m.terrain.renderingToTexture,[X,Y]=O instanceof Q||q?[{},_]:m.stencilConfigForOverlap(_),oe=Y[Y.length-1].overscaledZ,se=!m.options.moving;for(const pe of Y){const ie=q?p.DepthMode.disabled:m.depthModeForSublayer(pe.overscaledZ-oe,1===d.paint.get("raster-opacity")?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly,k.LESS),ae=pe.toUnwrapped(),fe=o.getTile(pe);if(q&&(!fe||!fe.hasData()))continue;const _e=q?pe.projMatrix:m.transform.calculateProjMatrix(ae,se),we=m.terrain&&q?m.terrain.stencilModeForRTTOverlap(pe):X[pe.overscaledZ],ce=C?0:d.paint.get("raster-fade-duration");fe.registerFadeDuration(ce);const Se=o.findLoadedParent(pe,0),je=yi(fe,Se,o,m.transform,ce);let We,Te;m.terrain&&m.terrain.prepareDrawTile(pe);const ze="nearest"===d.paint.get("raster-resampling")?k.NEAREST:k.LINEAR;M.activeTexture.set(k.TEXTURE0),fe.texture.bind(ze,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(k.TEXTURE1),Se?(Se.texture.bind(ze,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),We=Math.pow(2,Se.tileID.overscaledZ-fe.tileID.overscaledZ),Te=[fe.tileID.canonical.x*We%1,fe.tileID.canonical.y*We%1]):fe.texture.bind(ze,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST);const ct=_a(_e,Te||[0,0],We||1,je,d);m.prepareDrawProgram(M,B,ae),O instanceof Q?B.draw(M,k.TRIANGLES,ie,p.StencilMode.disabled,U,p.CullFaceMode.disabled,ct,d.id,O.boundsBuffer,m.quadTriangleIndexBuffer,O.boundsSegments):B.draw(M,k.TRIANGLES,ie,we,U,p.CullFaceMode.disabled,ct,d.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,o,d,_){const w=d.paint.get("background-color"),C=d.paint.get("background-opacity");if(0===C)return;const M=m.context,k=M.gl,O=m.transform,B=O.tileSize,U=d.paint.get("background-pattern");if(m.isPatternMissing(U))return;const q=!U&&1===w.a&&1===C&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==q)return;const X=p.StencilMode.disabled,Y=m.depthModeForSublayer(0,"opaque"===q?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly),oe=m.colorModeForRenderPass(),se=m.useProgram(U?"backgroundPattern":"background"),pe=_||O.coveringTiles({tileSize:B});U&&(M.activeTexture.set(k.TEXTURE0),m.imageManager.bind(m.context));const ie=d.getCrossfadeParameters();for(const ae of pe){const fe=ae.toUnwrapped(),_e=_?ae.projMatrix:m.transform.calculateProjMatrix(fe);m.prepareDrawTile(ae);const we=U?ml(_e,C,m,U,{tileID:ae,tileSize:B},ie):Pd(_e,C,w);m.prepareDrawProgram(M,se,fe),se.draw(M,k.TRIANGLES,Y,X,oe,p.CullFaceMode.disabled,we,d.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},sky:function(m,o,d){const _=d.paint.get("sky-opacity");if(0===_)return;const w=m.context,C=d.paint.get("sky-type"),M=new p.DepthMode(w.gl.LEQUAL,p.DepthMode.ReadOnly,[0,1]),k=m.frameCounter/1e3%1;"atmosphere"===C?"offscreen"===m.renderPass?d.needsSkyboxCapture(m)&&(function(O,B,U,q){const X=O.context,Y=X.gl;let oe=B.skyboxFbo;if(!oe){oe=B.skyboxFbo=X.createFramebuffer(32,32,!1),B.skyboxGeometry=new Ua(X),B.skyboxTexture=X.gl.createTexture(),Y.bindTexture(Y.TEXTURE_CUBE_MAP,B.skyboxTexture),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MAG_FILTER,Y.LINEAR);for(let ae=0;ae<6;++ae)Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,Y.RGBA,32,32,0,Y.RGBA,Y.UNSIGNED_BYTE,null)}X.bindFramebuffer.set(oe.framebuffer),X.viewport.set([0,0,32,32]);const se=B.getCenter(O,!0),pe=O.useProgram("skyboxCapture"),ie=new Float64Array(16);p.identity(ie),p.rotateY(ie,ie,.5*-Math.PI),gs(X,B,pe,ie,se,0),p.identity(ie),p.rotateY(ie,ie,.5*Math.PI),gs(X,B,pe,ie,se,1),p.identity(ie),p.rotateX(ie,ie,.5*-Math.PI),gs(X,B,pe,ie,se,2),p.identity(ie),p.rotateX(ie,ie,.5*Math.PI),gs(X,B,pe,ie,se,3),p.identity(ie),gs(X,B,pe,ie,se,4),p.identity(ie),p.rotateY(ie,ie,Math.PI),gs(X,B,pe,ie,se,5),X.viewport.set([0,0,O.width,O.height])}(m,d),d.markSkyboxValid(m)):"sky"===m.renderPass&&function(O,B,U,q,X){const Y=O.context,oe=Y.gl,se=O.transform,pe=O.useProgram("skybox");Y.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_CUBE_MAP,B.skyboxTexture);const ie={u_matrix:se.skyboxMatrix,u_sun_direction:B.getCenter(O,!1),u_cubemap:0,u_opacity:q,u_temporal_offset:X};O.prepareDrawProgram(Y,pe),pe.draw(Y,oe.TRIANGLES,U,p.StencilMode.disabled,O.colorModeForRenderPass(),p.CullFaceMode.backCW,ie,"skybox",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(m,d,M,_,k):"gradient"===C&&"sky"===m.renderPass&&function(O,B,U,q,X){const Y=O.context,oe=Y.gl,se=O.transform,pe=O.useProgram("skyboxGradient");B.skyboxGeometry||(B.skyboxGeometry=new Ua(Y)),Y.activeTexture.set(oe.TEXTURE0);let ie=B.colorRampTexture;ie||(ie=B.colorRampTexture=new p.Texture(Y,B.colorRamp,oe.RGBA)),ie.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const ae=(fe=se.skyboxMatrix,_e=B.getCenter(O,!1),we=B.paint.get("sky-gradient-radius"),ce=q,Se=X,{u_matrix:fe,u_color_ramp:0,u_center_direction:_e,u_radius:p.degToRad(we),u_opacity:ce,u_temporal_offset:Se});var fe,_e,we,ce,Se;O.prepareDrawProgram(Y,pe),pe.draw(Y,oe.TRIANGLES,U,p.StencilMode.disabled,O.colorModeForRenderPass(),p.CullFaceMode.backCW,ae,"skyboxGradient",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(m,d,M,_,k)},debug:function(m,o,d){for(let _=0;_<d.length;_++)ms(m,o,d[_])},custom:function(m,o,d){const _=m.context,w=d.implementation;if("offscreen"===m.renderPass){const C=w.prerender;C&&(m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),C.call(w,_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState())}else if("translucent"===m.renderPass){m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),_.setStencilMode(p.StencilMode.disabled);const C="3d"===w.renderingMode?new p.DepthMode(m.context.gl.LEQUAL,p.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,p.DepthMode.ReadOnly);_.setDepthMode(C),w.render(_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState(),_.bindFramebuffer.set(null)}}};class Wl{constructor(o,d){this.context=new Bt(o),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=p.SourceCache.maxUnderzooming+p.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Yr,this.gpuTimers={},this.frameCounter=0}updateTerrain(o,d){const _=!!o&&!!o.terrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Lt(this,o));const w=this._terrain;this.transform.elevation=_?w:null,w.update(o,this.transform,d)}_updateFog(o){const d=o.fog;if(!d||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,w]=d.getFovAdjustedRange(this.transform._fov);if(_>w)return void(this.transform.fogCullDistSq=null);const C=_+.78*(w-_);this.transform.fogCullDistSq=C*C}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,d){if(this.width=o*p.exported.devicePixelRatio,this.height=d*p.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const o=this.context,d=new p.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(p.EXTENT,0),d.emplaceBack(0,p.EXTENT),d.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(d,p.posAttributes.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);const _=new p.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(p.EXTENT,0),_.emplaceBack(0,p.EXTENT),_.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=o.createVertexBuffer(_,p.posAttributes.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);const w=new p.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(p.EXTENT,0,p.EXTENT,0),w.emplaceBack(0,p.EXTENT,0,p.EXTENT),w.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(w,yn.members),this.rasterBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);const C=new p.StructArrayLayout2i4;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(-1,1),C.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(C,p.posAttributes.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);const M=new p.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(M);const k=new p.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(k),this.emptyTexture=new p.Texture(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA),this.identityMat=p.create$1();const O=this.context.gl;this.stencilClearMode=new p.StencilMode({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(p.window.performance.now())}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(o,d.TRIANGLES,p.DepthMode.disabled,this.stencilClearMode,p.ColorMode.disabled,p.CullFaceMode.disabled,us(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d,_){if(!(d&&this.currentStencilSource!==d.id&&o.isTileClipped()&&_&&_.length))return;this.currentStencilSource=d.id;const w=this.context,C=w.gl;this.nextStencilID+_.length>256&&this.clearStencil(),w.setColorMode(p.ColorMode.disabled),w.setDepthMode(p.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of _){const O=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;M.draw(w,C.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:C.ALWAYS,mask:0},O,255,C.KEEP,C.KEEP,C.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,us(k.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new p.StencilMode({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new p.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,_=o.sort((M,k)=>k.overscaledZ-M.overscaledZ),w=_[_.length-1].overscaledZ,C=_[0].overscaledZ-w+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const M={};for(let k=0;k<C;k++)M[k+w]=new p.StencilMode({func:d.GEQUAL,mask:255},k+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=C,[M,_]}return[{[w]:p.StencilMode.disabled},_]}colorModeForRenderPass(){const o=this.context.gl;if(this._showOverdrawInspector){const d=1/8;return new p.ColorMode([o.CONSTANT_COLOR,o.ONE],new p.Color(d,d,d,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?p.ColorMode.unblended:p.ColorMode.alphaBlended}depthModeForSublayer(o,d,_){if(!this.opaquePassEnabledForLayer())return p.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new p.DepthMode(_||this.context.gl.LEQUAL,d,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(p.exported.now()),this.imageManager.beginFrame();const _=this.style.order,w=this.style._sourceCaches;for(const B in w){const U=w[B];U.used&&U.prepare(this.context)}const C={},M={},k={};for(const B in w){const U=w[B];C[B]=U.getVisibleCoordinates(),M[B]=C[B].slice().reverse(),k[B]=U.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<_.length;B++)if(this.style._layers[_[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),!p.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const B of _){const U=this.style._layers[B],q=o._getLayerSourceCache(U);if(!U.hasOffscreenPass()||U.isHidden(this.transform.zoom))continue;const X=q?M[q.id]:void 0;("custom"===U.type||U.isSky()||X&&X.length)&&this.renderLayer(this,q,U,X)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let O=p.Color.transparent;if(this.style.fog&&(O=this.style.fog.properties.get("color")),this.context.clear({color:d.showOverdrawInspector?p.Color.black:O,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[_[this.currentLayer]],U=o._getLayerSourceCache(B);if(B.isSky())continue;const q=U?M[U.id]:void 0;this._renderTileClippingMasks(B,U,q),this.renderLayer(this,U,B,q)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const B=this.style._layers[_[this.currentLayer]],U=o._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,U,B,U?M[U.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const B=this.style._layers[_[this.currentLayer]],U=o._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const q=U?("symbol"===B.type?k:M)[U.id]:void 0;this._renderTileClippingMasks(B,U,U?C[U.id]:void 0),this.renderLayer(this,U,B,q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let B=null;p.values(this.style._layers).forEach(U=>{const q=o._getLayerSourceCache(U);q&&!U.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<q.getSource().maxzoom)&&(B=q)}),B&&this.options.showTileBoundaries&&ql.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const U=B.transform.padding;pu(B,B.transform.height-(U.top||0),3,on),pu(B,U.bottom||0,3,du),Yu(B,U.left||0,3,Zl),Yu(B,B.transform.width-(U.right||0),3,fu);const q=B.transform.centerPoint;var X,Y,oe,se;xl(X=B,(Y=q.x)-1,(oe=B.transform.height-q.y)-10,2,20,se=Ur),xl(X,Y-10,oe-1,20,2,se)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%p.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(p.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,d,_,w){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||w&&w.length)&&(this.id=_.id,this.gpuTimingStart(_),ql[_.type](o,d,_,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let _=this.gpuTimers[o.id];_||(_=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),_.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,_.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const d={};for(const _ in o){const w=o[_],C=this.context.extTimerQuery,M=C.getQueryObjectEXT(w.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(w.query),d[_]=M}return d}translatePosMatrix(o,d,_,w,C){if(!_[0]&&!_[1])return o;const M=C?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(M){const B=Math.sin(M),U=Math.cos(M);_=[_[0]*U-_[1]*B,_[0]*B+_[1]*U]}const k=[C?_[0]:ni(d,_[0],this.transform.zoom),C?_[1]:ni(d,_[1],this.transform.zoom),0],O=new Float32Array(16);return p.translate(O,o,k),O}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),_=this.imageManager.getPattern(o.to.toString());return!d||!_}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,d=this.style&&this.style.fog,_=[];return this.terrain&&!this.terrain.renderingToTexture&&_.push("TERRAIN"),d&&!o&&0!==d.getOpacity(this.transform.pitch)&&_.push("FOG"),o&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(o,d,_){this.cache=this.cache||{};const w=_||[],C=this.currentGlobalDefines().concat(w),M=hs.cacheKey(o,C,d);return this.cache[M]||(this.cache[M]=new hs(this.context,o,tr[o],d,hu[o],C)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(o){this.terrain&&this.terrain.prepareDrawTile(o)}prepareDrawProgram(o,d,_){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const C=w.getOpacity(this.transform.pitch);0!==C&&d.setFogUniformValues(o,((M,k,O,B)=>{const U=k.properties.get("color"),q=M.frameCounter/1e3%1,X=[U.r/U.a,U.g/U.a,U.b/U.a,B];return{u_fog_matrix:O?M.transform.calculateFogTileMatrix(O):M.identityMat,u_fog_range:k.getFovAdjustedRange(M.transform._fov),u_fog_color:X,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:q}})(this,w,_,C))}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&0!==o.getOpacity(this.transform.pitch)}}class Ns{constructor(o=0,d=0,_=0,w=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(_)||_<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=_,this.right=w}interpolate(o,d,_){return null!=d.top&&null!=o.top&&(this.top=p.number(o.top,d.top,_)),null!=d.bottom&&null!=o.bottom&&(this.bottom=p.number(o.bottom,d.bottom,_)),null!=d.left&&null!=o.left&&(this.left=p.number(o.left,d.left,_)),null!=d.right&&null!=o.right&&(this.right=p.number(o.right,d.right,_)),this}getCenter(o,d){const _=p.clamp((this.left+o-this.right)/2,0,o),w=p.clamp((this.top+d-this.bottom)/2,0,d);return new p.pointGeometry(_,w)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Ns(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function dr(m,o){return[m[4*o],m[4*o+1],m[4*o+2],m[4*o+3]]}function Ec(m,o,d){m[4*o+0]=d[0],m[4*o+1]=d[1],m[4*o+2]=d[2],m[4*o+3]=d[3]}function jr(m,o){const d=dr(m,3);p.fromQuat(m,o),Ec(m,3,d)}function Xl(m,o){Ec(m,3,[o[0],o[1],o[2],1])}function zs(m,o){const d=p.identity$1([]);return p.rotateZ$1(d,d,-o),p.rotateX$1(d,d,-m),d}function Mr(m,o){const d=[m[0],m[1],0],_=[o[0],o[1],0];if(p.length(d)>=1e-15){const M=p.normalize([],d);p.scale(_,M,p.dot(_,M)),o[0]=_[0],o[1]=_[1]}const w=p.cross([],o,m);if(p.len(w)<1e-15)return null;const C=Math.atan2(-w[1],w[0]);return zs(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),C)}class Bs{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){this._position=this._renderWorldCopies?function(d){if(!d)return;const _=Array.isArray(d)?new p.MercatorCoordinate(d[0],d[1],d[2]):d;return _.x=p.wrap(_.x,0,1),_}(o):o}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(o)):0,w=this.position,C=p.MercatorCoordinate.fromLngLat(o,_),M=[C.x-w.x,C.y-w.y,C.z-w.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Mr(M,d)}setPitchBearing(o,d){this.orientation=zs(p.degToRad(o),p.degToRad(-d))}}class Kl{constructor(o,d){this._transform=p.identity([]),this._orientation=p.identity$1([]),d&&(this._orientation=d,jr(this._transform,this._orientation)),o&&Xl(this._transform,o)}get mercatorPosition(){const o=this.position;return new p.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=dr(this._transform,3);return[o[0],o[1],o[2]]}set position(o){Xl(this._transform,o)}get orientation(){return this._orientation}set orientation(o){this._orientation=o,jr(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=zs(o,d),jr(this._transform,this._orientation)}forward(){const o=dr(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=dr(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=dr(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const _=new Float64Array(16);return p.invert(_,this.getWorldToCamera(o,d)),_}getWorldToCameraPosition(o,d,_){const w=this.position;p.scale(w,w,-o);const C=new Float64Array(16);return p.fromScaling(C,[_,_,_]),p.translate(C,C,w),C[10]*=d,C}getWorldToCamera(o,d){const _=new Float64Array(16),w=new Float64Array(4),C=this.position;return p.conjugate(w,this._orientation),p.scale(C,C,-o),p.fromQuat(_,w),p.translate(_,_,C),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=d,_[9]*=d,_[10]*=d,_[11]*=d,_}getCameraToClipPerspective(o,d,_,w){const C=new Float64Array(16);return p.perspective(C,o,d,_,w),C}getDistanceToElevation(o){const d=0===o?0:p.mercatorZfromAltitude(o,this.position[1]),_=this.forward();return(d-this.position[2])/_[2]}clone(){return new Kl([...this.position],[...this.orientation])}}class _s{constructor(o,d,_,w,C){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===C||C,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=null==_?0:_,this._maxPitch=null==w?60:w,this.setMaxBounds(),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ns,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new Kl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const o=new _s(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o.tileSize=this.tileSize,o.latRange=this.latRange,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._cameraZoom=this._cameraZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,o?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(o){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),o&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return p.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return p.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new p.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-p.wrap(o,-180,180)*Math.PI/180;var _,w,C,M,k,O,B,U,q,X;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(_=new p.ARRAY_TYPE(4),p.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),w=this.rotationMatrix,M=this.angle,k=(C=this.rotationMatrix)[0],O=C[1],B=C[2],U=C[3],q=Math.sin(M),X=Math.cos(M),w[0]=k*X+B*q,w[1]=O*X+U*q,w[2]=k*-q+B*X,w[3]=O*-q+U*X)}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=p.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const o=this._elevation.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(this.center),-1);return-1===o?(this._cameraZoom=null,!1):(this._centerAltitude=o,!0)}_updateCameraOnTerrain(){const o=this.cameraToCenterDistance/this.worldSize,d=p.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(d+o)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let w=0,C=0;for(let M=0;M<d.length;M++){const k=new p.pointGeometry(d[M][0]*this.width,_+d[M][1]*(this.height-_)),O=o.pointCoordinate(k);if(!O)continue;const B=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);w+=O[3]*B,C+=B}return 0===C?NaN:w/C}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const o=this._cameraZoom,d=this._elevation.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(this.center)),_=p.mercatorZfromAltitude(d,this.center.lat),w=this._mercatorZfromZoom(o),C=this._mercatorZfromZoom(this._maxZoom),M=Math.max(w-_,C);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let _;_=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const w=p.length(p.sub([],this._camera.position,_));return p.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!p.exactEquals(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const _=[o.position.x,o.position.y,o.position.z];p.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new Bs;return d.position=new p.MercatorCoordinate(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this._renderWorldCopies,d}_setCameraOrientation(o){if(!p.length$1(o))return!1;p.normalize$1(o,o);const d=p.transformQuat([],[0,0,-1],o),_=p.transformQuat([],[0,-1,0],o);if(_[2]<0)return!1;const w=Mr(d,_);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;o[2]=p.clamp(o[2],w/_,w/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,_){this._unmodified=!1,this._edgeInsets.interpolate(o,d,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new p.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const _=this.pointCoordinate(new p.pointGeometry(0,0)),w=this.pointCoordinate(new p.pointGeometry(this.width,0)),C=this.pointCoordinate(new p.pointGeometry(this.width,this.height)),M=this.pointCoordinate(new p.pointGeometry(0,this.height)),k=Math.floor(Math.min(_.x,w.x,C.x,M.x)),O=Math.floor(Math.max(_.x,w.x,C.x,M.x)),B=1;for(let U=k-B;U<=O+B;U++)0!==U&&d.push(new p.UnwrappedTileID(U,o))}return d}coveringTiles(o){let d=this.coveringZoomLevel(o);const _=d,w=this.elevation&&!o.isTerrainDEM;if(void 0!==o.minzoom&&d<o.minzoom)return[];void 0!==o.maxzoom&&d>o.maxzoom&&(d=o.maxzoom);const C=p.MercatorCoordinate.fromLngLat(this.center),M=1<<d,k=[M*C.x,M*C.y,0],O=ar.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d),B=this.pointCoordinate(this.getCameraPoint()),U=M*p.mercatorZfromAltitude(1,this.center.lat),q=this._camera.position[2]/p.mercatorZfromAltitude(1,this.center.lat),X=[M*B.x,M*B.y,q],Y=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),oe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?d:0,se=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,pe=o.isTerrainDEM?-se:this._elevation?this._elevation.getMinElevationBelowMSL():0,ie=Te=>({aabb:new Po([Te*M,0,pe],[(Te+1)*M,M,se]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),ae=[];let fe=[];const _e=d,we=o.reparseOverscaled?_:d,ce=Te=>{if(!this._elevation||!Te.tileID)return;const ze=this._elevation.getMinMaxForTile(Te.tileID),ct=Te.aabb;ze?(ct.min[2]=ze.min,ct.max[2]=ze.max,ct.center[2]=(ct.min[2]+ct.max[2])/2):(Te.shouldSplit=We(Te),Te.shouldSplit||(ct.min[2]=ct.max[2]=ct.center[2]=this._centerAltitude))},Se=Te=>Te*Te,je=Se((q-this._centerAltitude)*U),We=Te=>{if(Te.zoom<oe)return!0;if(Te.zoom===_e)return!1;if(null!=Te.shouldSplit)return Te.shouldSplit;const ze=Te.aabb.distanceX(X),ct=Te.aabb.distanceY(X);let ht=je;w&&(ht=Se(Te.aabb.distanceZ(X)*U));const ut=ze*ze+ct*ct+ht;return ut<Se((1<<_e-Te.zoom)*Y*((tt,ft)=>{if(ft*Se(.707)<tt)return 1;const sn=Math.sqrt(ft/tt);return sn/(1.4144271570014144+(Math.pow(1.1,sn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ht,je),ut))};if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)ae.push(ie(-Te)),ae.push(ie(Te));for(ae.push(ie(0));ae.length>0;){const Te=ae.pop(),ze=Te.x,ct=Te.y;let ht=Te.fullyVisible;if(!ht){const ut=Te.aabb.intersects(O);if(0===ut)continue;ht=2===ut}if(Te.zoom!==_e&&We(Te))for(let ut=0;ut<4;ut++){const tt=(ze<<1)+ut%2,ft=(ct<<1)+(ut>>1),sn={aabb:Te.aabb.quadrant(ut),zoom:Te.zoom+1,x:tt,y:ft,wrap:Te.wrap,fullyVisible:ht,tileID:void 0,shouldSplit:void 0};w&&(sn.tileID=new p.OverscaledTileID(Te.zoom+1===_e?we:Te.zoom+1,Te.wrap,Te.zoom+1,tt,ft),ce(sn)),ae.push(sn)}else{const ut=Te.zoom===_e?we:Te.zoom;if(o.minzoom&&o.minzoom>ut)continue;const tt=k[0]-(.5+ze+(Te.wrap<<Te.zoom))*(1<<d-Te.zoom),ft=k[1]-.5-ct,sn=Te.tileID?Te.tileID:new p.OverscaledTileID(ut,Te.wrap,Te.zoom,ze,ct);fe.push({tileID:sn,distanceSq:tt*tt+ft*ft})}}if(this.fogCullDistSq){const Te=this.fogCullDistSq,ze=this.horizonLineFromTop();fe=fe.filter(ct=>{const ht=[0,0,0,1],ut=[p.EXTENT,p.EXTENT,0,1],tt=this.calculateFogTileMatrix(ct.tileID.toUnwrapped());p.transformMat4(ht,ht,tt),p.transformMat4(ut,ut,tt);const ft=p.getAABBPointSquareDist(ht,ut);if(0===ft)return!0;let sn=!1;const kt=this._elevation;if(kt&&ft>Te&&0!==ze){const Mi=this.calculateProjMatrix(ct.tileID.toUnwrapped());let ai;o.isTerrainDEM||(ai=kt.getMinMaxForTile(ct.tileID)),ai||(ai={min:pe,max:se});const Zt=p.furthestTileCorner(this.bearing),an=[Zt[0]*p.EXTENT,Zt[1]*p.EXTENT,ai.max];p.transformMat4$1(an,an,Mi),sn=(1-an[1])*this.height*.5<ze}return ft<Te||sn})}return fe.sort((Te,ze)=>Te.distanceSq-ze.distanceSq).map(Te=>Te.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=p.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new p.pointGeometry(p.mercatorXfromLng(o.lng)*this.worldSize,p.mercatorYfromLat(d)*this.worldSize)}unproject(o){return new p.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(o,d){const _=this.pointCoordinate(d),w=this.pointCoordinate(this.centerPoint),C=this.locationCoordinate(o),M=new p.MercatorCoordinate(C.x-(_.x-w.x),C.y-(_.y-w.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(o){this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o){return this._coordinatePoint(this.locationCoordinate(o),!1)}locationPoint3D(o){return this._coordinatePoint(this.locationCoordinate(o),!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o){return p.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o.toLngLat()}pointRayIntersection(o,d){const _=null!=d?d:this._centerAltitude,w=[o.x,o.y,0,1],C=[o.x,o.y,1,1];p.transformMat4(w,w,this.pixelMatrixInverse),p.transformMat4(C,C,this.pixelMatrixInverse);const M=C[3];p.scale$2(w,w,1/w[3]),p.scale$2(C,C,1/M);const k=w[2],O=C[2];return{p0:w,p1:C,t:k===O?0:(_-k)/(O-k)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],_=[o.x,o.y,1,1];return p.transformMat4(d,d,this.pixelMatrixInverse),p.transformMat4(_,_,this.pixelMatrixInverse),p.scale$2(d,d,1/d[3]),p.scale$2(_,_,1/_[3]),d[2]=p.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,_[2]=p.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,p.scale$2(d,d,1/this.worldSize),p.scale$2(_,_,1/this.worldSize),new sl([d[0],d[1],d[2]],p.normalize([],p.sub([],_,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:_,t:w}=o,C=p.mercatorZfromAltitude(d[2],this._center.lat),M=p.mercatorZfromAltitude(_[2],this._center.lat);return new p.MercatorCoordinate(p.number(d[0],_[0],w)/this.worldSize,p.number(d[1],_[1],w)/this.worldSize,p.number(C,M,w))}pointCoordinate(o,d=this._centerAltitude){const _=this.horizonLineFromTop(!1),w=new p.pointGeometry(o.x,Math.max(_,o.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(w,d))}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);const d=this.elevation;let _=this.elevation.pointCoordinate(o);if(_)return new p.MercatorCoordinate(_[0],_[1],_[2]);let w=0,C=this.horizonLineFromTop();if(o.y>C)return this.pointCoordinate(o);const M=.02*C,k=o.clone();for(let O=0;O<10&&C-w>M;O++){k.y=p.number(w,C,.66);const B=d.pointCoordinate(k);B?(C=k.y,_=B):w=k.y}return _?new p.MercatorCoordinate(_[0],_[1],_[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){if(this.elevation)return!this.elevation.pointCoordinate(o);{const d=this.horizonLineFromTop();return o.y<d}}_coordinatePoint(o,d){const _=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,w=[o.x*this.worldSize,o.y*this.worldSize,_+o.toAltitude(),1];return p.transformMat4(w,w,this.pixelMatrix),w[3]>0?new p.pointGeometry(w[0]/w[3],w[1]/w[3]):new p.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(o,d){const _=new p.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),w=new p.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),C=new p.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),M=new p.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let k=this.pointCoordinate(_,o),O=this.pointCoordinate(w,o);const B=this.pointCoordinate(C,d),U=this.pointCoordinate(M,d),q=(X,Y)=>(Y.y-X.y)/(Y.x-X.x);return k.y>1&&O.y>=0?k=new p.MercatorCoordinate((1-U.y)/q(U,k)+U.x,1):k.y<0&&O.y<=1&&(k=new p.MercatorCoordinate(-U.y/q(U,k)+U.x,0)),O.y>1&&k.y>=0?O=new p.MercatorCoordinate((1-B.y)/q(B,O)+B.x,1):O.y<0&&k.y<=1&&(O=new p.MercatorCoordinate(-B.y/q(B,O)+B.x,0)),(new p.LngLatBounds).extend(this.coordinateLocation(k)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(B))}_getBounds3D(){const o=this.elevation,d=o.visibleDemTiles.reduce((_,w)=>{if(w.dem){const C=w.dem.tree;_.min=Math.min(_.min,C.minimums[0]),_.max=Math.max(_.max,C.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBounds(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,_):_}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new p.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(o){if(o){const d=o.getEast(),_=o.getWest();this.lngRange=[_,d>_?d:d+360],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()}else this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}calculatePosMatrix(o,d){const _=o.canonical,w=d/this.zoomScale(_.z),C=_.x+Math.pow(2,_.z)*o.wrap,M=p.identity(new Float64Array(16));return p.translate(M,M,[C*w,_.y*w,0]),p.scale$1(M,M,[w/p.EXTENT,w/p.EXTENT,1]),M}calculateFogTileMatrix(o){const d=o.key,_=this._fogTileMatrixCache;if(_[d])return _[d];const w=this.calculatePosMatrix(o,this.cameraWorldSize);return p.multiply(w,this.worldToFogMatrix,w),_[d]=new Float32Array(w),_[d]}calculateProjMatrix(o,d=!1){const _=o.key,w=d?this._alignedProjMatrixCache:this._projMatrixCache;if(w[_])return w[_];const C=this.calculatePosMatrix(o,this.worldSize);return p.multiply(C,d?this.alignedProjMatrix:this.projMatrix,C),w[_]=new Float32Array(C),w[_]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const d=this._camera.position,_=this._camera.forward();if(d[2]<=0||_[2]>=0)return;const w=p.mercatorZfromAltitude(1,this._center.lat);d[2]/=w,_[2]/=w,p.normalize(_,_);const C=o.raycast(d,_,o.exaggeration());if(C){const M=p.scaleAndAdd([],d,_,C),k=new p.MercatorCoordinate(M[0],M[1],p.mercatorZfromAltitude(M[2],p.latFromMercatorY(M[1]))),O=this._camera.position,B=k.z+p.length([k.x-O[0],k.y-O[1],k.z-O[2]]);this._cameraZoom=this._zoomFromMercatorZ(B),this._centerAltitude=k.toAltitude(),this._center=k.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const d=o.getAtPointOrZero(this._camera.mercatorPosition),_=this._minimumHeightOverTerrain()*Math.cos(p.degToRad(this._maxPitch)),w=p.mercatorZfromAltitude(d,this._center.lat),C=this._camera.position[2]-w;if(C<_){const M=p.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),k=this._camera.mercatorPosition,O=[M.x-k.x,M.y-k.y,M.z-k.z],B=p.length(O);O[2]-=_-C;const U=p.length(O);if(0===U)return;p.scale(O,O,B/U),this._camera.position=[M.x-O[0],M.y-O[1],M.z-O[2]],this._camera.orientation=Mr(O,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,d,_,w,C,M=1/0,k=-1/0;const O=this.size,B=this._unmodified;if(this.latRange){const Y=this.latRange;M=p.mercatorYfromLat(Y[1])*this.worldSize,k=p.mercatorYfromLat(Y[0])*this.worldSize,_=k-M<O.y?O.y/(k-M):0}if(this.lngRange){const Y=this.lngRange;o=p.mercatorXfromLng(Y[0])*this.worldSize,d=p.mercatorXfromLng(Y[1])*this.worldSize,w=d-o<O.x?O.x/(d-o):0}const U=this.point,q=Math.max(w||0,_||0);if(q)return this.center=this.unproject(new p.pointGeometry(w?(d+o)/2:U.x,_?(k+M)/2:U.y)),this.zoom+=this.scaleZoom(q),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const Y=U.y,oe=O.y/2;Y-oe<M&&(C=M+oe),Y+oe>k&&(C=k-oe)}let X=U.x;if(this.lngRange){const Y=this.worldSize/2-(o+d)/2;X=(X+Y+this.worldSize)%this.worldSize,o+=Y,d+=Y;const oe=O.x/2;X-oe<o&&(X=o+oe),X+oe>d&&(X=d-oe),X-=Y}X===U.x&&void 0===C||(this.center=this.unproject(new p.pointGeometry(X,void 0!==C?C:U.y))),this._constrainCameraAltitude(),this._unmodified=B,this._constraining=!1}_minZoomForBounds(){const o=(w,C)=>Math.log2(w/(this.tileSize*Math.abs(C[1]-C[0])));let d=0;if(this.latRange){const w=this.latRange;d=o(this.height,[p.mercatorYfromLat(w[0]),p.mercatorYfromLat(w[1])])}let _=0;if(this.lngRange){const w=this.lngRange;_=o(this.width,[p.mercatorXfromLng(w[0]),p.mercatorXfromLng(w[1])])}return Math.max(d,_)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const d=this.pixelsPerMeter;this._updateCameraState();const _=Math.PI/2+this._pitch,w=this.fovAboveCenter,C=this.elevation?this.elevation.getMinElevationBelowMSL()*d:0,M=(this._camera.position[2]*this.worldSize-C)/Math.cos(this._pitch),k=Math.sin(w)*M/Math.sin(p.clamp(Math.PI-_-w,.01,Math.PI-.01)),O=this.point,B=O.x,U=O.y,q=Math.cos(Math.PI/2-this._pitch)*k+M,X=Math.min(1.01*q,M*(1/this._horizonShift)),Y=this.height/50,oe=this._camera.getWorldToCamera(this.worldSize,d),se=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,Y,X);se[8]=2*-o.x/this.width,se[9]=2*o.y/this.height;let pe=p.mul$1([],se,oe);this.mercatorMatrix=p.scale$1([],pe,[this.worldSize,this.worldSize,this.worldSize/d]),this.projMatrix=pe,this.invProjMatrix=p.invert(new Float64Array(16),this.projMatrix);const ie=new Float32Array(16);p.identity(ie),p.scale$1(ie,ie,[1,-1,1]),p.rotateX(ie,ie,this._pitch),p.rotateZ(ie,ie,this.angle);const ae=p.perspective(new Float32Array(16),this._fov,this.width/this.height,Y,X),fe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-o.x/this.width,ae[9]=2*(o.y+fe)/this.height,this.skyboxMatrix=p.multiply(ie,ae,ie);const _e=this.width%2/2,we=this.height%2/2,ce=Math.cos(this.angle),Se=Math.sin(this.angle),je=B-Math.round(B)+ce*_e+Se*we,We=U-Math.round(U)+ce*we+Se*_e,Te=new Float64Array(pe);if(p.translate(Te,Te,[je>.5?je-1:je,We>.5?We-1:We,0]),this.alignedProjMatrix=Te,pe=p.create$1(),p.scale$1(pe,pe,[this.width/2,-this.height/2,1]),p.translate(pe,pe,[1,-1,0]),this.labelPlaneMatrix=pe,pe=p.create$1(),p.scale$1(pe,pe,[1,-1,1]),p.translate(pe,pe,[-1,-1,0]),p.scale$1(pe,pe,[2/this.width,2/this.height,1]),this.glCoordMatrix=pe,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),pe=p.invert(new Float64Array(16),this.pixelMatrix),!pe)throw new Error("failed to invert matrix");this.pixelMatrixInverse=pe,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSize,d=this.cameraPixelsPerMeter,_=this._camera.position,w=1/this.height,C=[o,o,d];p.scale(C,C,w),p.scale(_,_,-1),p.multiply$1(_,_,C);const M=p.create$1();p.translate(M,M,_),p.scale$1(M,M,C),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,w)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const o=this._camera.forward(),d=this.cameraToCenterDistance,_=this.point,w=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-p.mercatorZfromAltitude(this._centerAltitude,this.center.lat),C=this.cameraToCenterDistance/w;this._camera.position=[_.x/this.worldSize-o[0]*d/C,_.y/this.worldSize-o[1]*d/C,p.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-o[2]*d/C]}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=o[2];let w=1;_>0&&(w=Math.min((d-this._camera.position[2])/_,1)),this._camera.position=p.scaleAndAdd([],this._camera.position,o,w),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:_,bearing:w}=this._camera.getPitchBearing(),C=p.mercatorZfromAltitude(this._centerAltitude,this.center.lat),M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(p.degToRad(this._maxPitch)),k=Math.max((o[2]-C)/Math.cos(_),M),O=this._zoomFromMercatorZ(k);p.scaleAndAdd(o,o,d,k),this._pitch=p.clamp(_,p.degToRad(this.minPitch),p.degToRad(this.maxPitch)),this.angle=p.wrap(w,-Math.PI,Math.PI),this._setZoom(p.clamp(O,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new p.MercatorCoordinate(o[0],o[1],o[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}_terrainEnabled(){return!!this._elevation}isCornerOffEdge(o,d){const _=Math.min(o.x,d.x),w=Math.max(o.x,d.x),C=Math.min(o.y,d.y),M=Math.max(o.y,d.y);if(C<this.horizonLineFromTop(!1))return!0;const k=[new p.pointGeometry(_,C),new p.pointGeometry(w,M),new p.pointGeometry(_,M),new p.pointGeometry(w,C)],O=this._renderWorldCopies?-3:0,B=this._renderWorldCopies?4:1;for(const U of k){const q=this.pointRayIntersection(U);if(q.t<0)return!0;const X=this.rayIntersectionCoordinate(q);if(X.x<O||X.y<0||X.x>B||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+p.radToDeg(this.fovAboveCenter)>88||this.isCornerOffEdge(new p.pointGeometry(0,0),new p.pointGeometry(this.width,this.height))}zoomDeltaToMovement(o,d){const _=p.length(p.sub([],this._camera.position,o)),w=this._zoomFromMercatorZ(_)+d;return _-this._mercatorZfromZoom(w)}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.pointGeometry(0,o))}}function vi(m,o){let d=!1,_=null;const w=()=>{_=null,d&&(m(),_=setTimeout(w,o),d=!1)};return()=>(d=!0,_||w(),_)}class Ju{constructor(o){this._hashName=o&&encodeURIComponent(o),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=vi(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,p.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return p.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const d=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,w=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,w),M=Math.round(d.lng*C)/C,k=Math.round(d.lat*C)/C,O=this._map.getBearing(),B=this._map.getPitch();let U="";if(U+=o?`/${M}/${k}/${_}`:`${_}/${k}/${M}`,(O||B)&&(U+="/"+Math.round(10*O)/10),B&&(U+=`/${Math.round(B)}`),this._hashName){const q=this._hashName;let X=!1;const Y=p.window.location.hash.slice(1).split("&").map(oe=>{const se=oe.split("=")[0];return se===q?(X=!0,`${se}=${U}`):oe}).filter(oe=>oe);return X||Y.push(`${q}=${U}`),`#${Y.join("&")}`}return`#${U}`}_getCurrentHash(){const o=p.window.location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(d=_)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:d,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=p.window.location.href.replace(/(#.+)?$/,this.getHashString());p.window.history.replaceState(p.window.history.state,null,o)}}const ya={linearity:.3,easing:p.bezier(0,0,.3,1)},ja=p.extend({deceleration:2500,maxSpeed:1400},ya),Oi=p.extend({deceleration:20,maxSpeed:1400},ya),$a=p.extend({deceleration:1e3,maxSpeed:360},ya),Tc=p.extend({deceleration:1e3,maxSpeed:90},ya);class Ha{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=p.exported.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new p.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)d.zoom+=C.zoomDelta||0,d.bearing+=C.bearingDelta||0,d.pitch+=C.pitchDelta||0,C.panDelta&&d.pan._add(C.panDelta),C.around&&(d.around=C.around),C.pinchAround&&(d.pinchAround=C.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(d.pan.mag()){const C=to(d.pan.mag(),_,p.extend({},ja,o||{}));w.offset=d.pan.mult(C.amount/d.pan.mag()),w.center=this._map.transform.center,Ar(w,C)}if(d.zoom){const C=to(d.zoom,_,Oi);w.zoom=this._map.transform.zoom+C.amount,Ar(w,C)}if(d.bearing){const C=to(d.bearing,_,$a);w.bearing=this._map.transform.bearing+p.clamp(C.amount,-179,179),Ar(w,C)}if(d.pitch){const C=to(d.pitch,_,Tc);w.pitch=this._map.transform.pitch+C.amount,Ar(w,C)}if(w.zoom||w.bearing){const C=void 0===d.pinchAround?d.around:d.pinchAround;w.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),p.extend(w,{noMoveStart:!0})}}function Ar(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function to(m,o,d){const{maxSpeed:_,linearity:w,deceleration:C}=d,M=p.clamp(m*w/(o/1e3),-_,_),k=Math.abs(M)/(C*w);return{easing:d.easing,duration:1e3*k,amount:M*(k/2)}}class fr extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,_,w={}){const C=$e.mousePos(d.getCanvasContainer(),_),M=d.unproject(C);super(o,p.extend({point:C,lngLat:M,originalEvent:_},w)),this._defaultPrevented=!1,this.target=d}}class Qo extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,_){const w="touchend"===o?_.changedTouches:_.touches,C=$e.touchPos(d.getCanvasContainer(),w),M=C.map(O=>d.unproject(O)),k=C.reduce((O,B,U,q)=>O.add(B.div(q.length)),new p.pointGeometry(0,0));super(o,{points:C,point:k,lngLats:M,lngLat:d.unproject(k),originalEvent:_}),this._defaultPrevented=!1}}class ir extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,_){super(o,{originalEvent:_}),this._defaultPrevented=!1}}class Ga{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new ir(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new fr(o.type,this._map,o))}mouseup(o){this._map.fire(new fr(o.type,this._map,o))}preclick(o){const d=p.extend({},o);d.type="preclick",this._map.fire(new fr(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new fr(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new fr(o.type,this._map,o))}mouseover(o){this._map.fire(new fr(o.type,this._map,o))}mouseout(o){this._map.fire(new fr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Qo(o.type,this._map,o))}touchmove(o){this._map.fire(new Qo(o.type,this._map,o))}touchend(o){this._map.fire(new Qo(o.type,this._map,o))}touchcancel(o){this._map.fire(new Qo(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Za{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(o){this._map.fire(new fr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new fr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wl{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&0===o.button&&($e.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const _=d;if(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)return;const w=this._startPos;this._lastPos=_,this._box||(this._box=$e.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const C=Math.min(w.x,_.x),M=Math.max(w.x,_.x),k=Math.min(w.y,_.y),O=Math.max(w.y,_.y);this._map._requestDomTask(()=>{this._box&&($e.setTransform(this._box,`translate(${C}px,${k}px)`),this._box.style.width=M-C+"px",this._box.style.height=O-k+"px")})}mouseupWindow(o,d){if(!this._active||0!==o.button)return;const _=this._startPos,w=d;if(this.reset(),$e.suppressClick(),_.x!==w.x||_.y!==w.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:C=>C.fitScreenCoordinates(_,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&($e.remove(this._box),this._box=null),$e.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new p.Event(o,{originalEvent:d}))}}function Fo(m,o){const d={};for(let _=0;_<m.length;_++)d[m[_].identifier]=o[_];return d}class Dc{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=o.timeStamp),_.length===this.numTouches&&(this.centroid=function(w){const C=new p.pointGeometry(0,0);for(const M of w)C._add(M);return C.div(w.length)}(d),this.touches=Fo(_,d)))}touchmove(o,d,_){if(this.aborted||!this.centroid)return;const w=Fo(_,d);for(const C in this.touches){const M=this.touches[C],k=w[C];(!k||k.dist(M)>30)&&(this.aborted=!0)}}touchend(o,d,_){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Cl{constructor(o){this.singleTap=new Dc(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,_){this.singleTap.touchstart(o,d,_)}touchmove(o,d,_){this.singleTap.touchmove(o,d,_)}touchend(o,d,_){const w=this.singleTap.touchend(o,d,_);if(w){const C=o.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(w)<30;if(C&&M||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Ot{constructor(){this._zoomIn=new Cl({numTouches:1,numTaps:2}),this._zoomOut=new Cl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,_){this._zoomIn.touchstart(o,d,_),this._zoomOut.touchstart(o,d,_)}touchmove(o,d,_){this._zoomIn.touchmove(o,d,_),this._zoomOut.touchmove(o,d,_)}touchend(o,d,_){const w=this._zoomIn.touchend(o,d,_),C=this._zoomOut.touchend(o,d,_);return w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(w)},{originalEvent:o})}):C?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(C)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const $r={0:1,2:2};class Sc{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const _=$e.mouseButton(o);this._correctButton(o,_)&&(this._lastPoint=d,this._eventButton=_)}mousemoveWindow(o,d){const _=this._lastPoint;if(_)if(o.preventDefault(),function(w,C){const M=$r[C];return void 0===w.buttons||(w.buttons&M)!==M}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(_,d)}mouseupWindow(o){this._lastPoint&&$e.mouseButton(o)===this._eventButton&&(this._moved&&$e.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ys extends Sc{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return 0===d&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class Mc extends Sc{_correctButton(o,d){return 0===d&&o.ctrlKey||2===d}_move(o,d){const _=.8*(d.x-o.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(o){o.preventDefault()}}class es extends Sc{_correctButton(o,d){return 0===d&&o.ctrlKey||2===d}_move(o,d){const _=-.5*(d.y-o.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(o){o.preventDefault()}}class qa{constructor(o){this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new p.pointGeometry(0,0)}touchstart(o,d,_){return this._calculateTransform(o,d,_)}touchmove(o,d,_){if(this._active&&!(_.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,d,_)}touchend(o,d,_){this._calculateTransform(o,d,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,_){_.length>0&&(this._active=!0);const w=Fo(_,d),C=new p.pointGeometry(0,0),M=new p.pointGeometry(0,0);let k=0;for(const B in w){const U=w[B],q=this._touches[B];q&&(C._add(U),M._add(U.sub(q)),k++,w[B]=U)}if(this._touches=w,k<this._minTouches||!M.mag())return;const O=M.div(k);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(k),panDelta:O}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,d,_){return{}}touchstart(o,d,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,_){if(!this._firstTwoTouches)return;o.preventDefault();const[w,C]=this._firstTwoTouches,M=c(_,d,w),k=c(_,d,C);if(!M||!k)return;const O=this._aroundCenter?null:M.add(k).div(2);return this._move([M,k],O,o)}touchend(o,d,_){if(!this._firstTwoTouches)return;const[w,C]=this._firstTwoTouches,M=c(_,d,w),k=c(_,d,C);M&&k||(this._active&&$e.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function c(m,o,d){for(let _=0;_<m.length;_++)if(m[_].identifier===d)return o[_]}function v(m,o){return Math.log(m/o)/Math.LN2}class T extends mu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(v(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:v(this._distance,_),pinchAround:d}}}function P(m,o){return 180*m.angleWith(o)/Math.PI}class V extends mu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:P(this._vector,_),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,_=P(o,this._startVector);return Math.abs(_)<d}}function J(m){return Math.abs(m.y)>Math.abs(m.x)}class me extends mu{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(o){this._lastPoints=o,J(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,_){const w=o[0].sub(this._lastPoints[0]),C=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,C,_.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+C.y)/2*-.5}}gestureBeginsVertically(o,d,_){if(void 0!==this._valid)return this._valid;const w=o.mag()>=2,C=d.mag()>=2;if(!w&&!C)return;if(!w||!C)return void 0===this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const M=o.y>0==d.y>0;return J(o)&&J(d)&&M}}const Le={panStep:100,bearingStep:15,pitchStep:10};class Be{constructor(){const o=Le;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,_=0,w=0,C=0,M=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?_=-1:(o.preventDefault(),C=-1);break;case 39:o.shiftKey?_=1:(o.preventDefault(),C=1);break;case 38:o.shiftKey?w=1:(o.preventDefault(),M=-1);break;case 40:o.shiftKey?w=-1:(o.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(_=0,w=0),{cameraAnimation:k=>{const O=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:Me,zoom:d?Math.round(O)+d*(o.shiftKey?2:1):O,bearing:k.getBearing()+_*this._bearingStep,pitch:k.getPitch()+w*this._pitchStep,offset:[-C*this._panStep,-M*this._panStep],center:k.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Me(m){return m*(2-m)}const gt=4.000244140625;class Tt{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,p.bindAll(["_onTimeout"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=o&&"center"===o.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;let d=o.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const _=p.exported.now(),w=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==d&&d%gt==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(w*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=$e.mousePos(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform,d=()=>o._terrainEnabled()?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(0!==this._delta){const O="wheel"===this._type&&Math.abs(this._delta)>gt?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&0!==B&&(B=1/B);const U=d(),q=Math.pow(2,U),X="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):q;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(X*B))),"wheel"===this._type&&(this._startZoom=d(),this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:d(),w=this._startZoom,C=this._easing;let M,k=!1;if("wheel"===this._type&&w&&C){const O=Math.min((p.exported.now()-this._lastWheelEventTime)/200,1),B=C(O);M=p.number(w,_,B),O<1?this._frameId||(this._frameId=!0):k=!0}else M=_,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:M-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=p.ease;if(this._prevEase){const _=this._prevEase,w=(p.exported.now()-_.start)/_.duration,C=_.easing(w+.01)-_.easing(w),M=.27/Math.sqrt(C*C+1e-4)*.01,k=Math.sqrt(.0729-M*M);d=p.bezier(M,k,.25,1)}return this._prevEase={start:p.exported.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}}class un{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ei{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(o.shiftKey?-1:1),around:_.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(){this._tap=new Cl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,d,_){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=d[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(o,d,_))}touchmove(o,d,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const w=d[0],C=w.y-this._swipePoint.y;return this._swipePoint=w,o.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(o,d,_)}touchend(o,d,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(o,d,_)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class El{constructor(o,d,_){this._el=o,this._mousePan=d,this._touchPan=_}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class no{constructor(o,d,_){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class No{constructor(o,d,_,w){this._el=o,this._touchZoom=d,this._touchRotate=_,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Yl=m=>m.zoom||m.drag||m.pitch||m.rotate;class gu extends p.Event{}class Qu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const _=p.sub([],d,o);this.radius=p.length(_[2]<0?p.div([],_,this.constants):[_[0],_[1],0])}projectRay(o){p.div(o,o,this.constants),p.normalize(o,o),p.mul$2(o,o,this.constants);const d=p.scale([],o,this.radius);if(d[2]>0){const _=p.scale([],[0,0,1],p.dot(d,[0,0,1])),w=p.scale([],p.normalize([],[d[0],d[1],0]),this.radius),C=p.add([],d,p.scale([],p.sub([],p.add([],w,_),d),2));d[0]=C[0],d[1]=C[1]}return d}}function va(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Jl{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ha(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Qu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),p.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[p.window,"blur",void 0]];for(const[w,C,M]of this._listeners)$e.addEventListener(w,C,w===p.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[o,d,_]of this._listeners)$e.removeEventListener(o,d,o===p.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(o){const d=this._map,_=d.getCanvasContainer();this._add("mapEvent",new Ga(d,o));const w=d.boxZoom=new wl(d,o);this._add("boxZoom",w);const C=new Ot,M=new ei;d.doubleClickZoom=new un(M,C),this._add("tapZoom",C),this._add("clickZoom",M);const k=new pr;this._add("tapDragZoom",k);const O=d.touchPitch=new me;this._add("touchPitch",O);const B=new Mc(o),U=new es(o);d.dragRotate=new no(o,B,U),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const q=new ys(o),X=new qa(o);d.dragPan=new El(_,q,X),this._add("mousePan",q),this._add("touchPan",X,["touchZoom","touchRotate"]);const Y=new V,oe=new T;d.touchZoomRotate=new No(_,oe,Y,k),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Za(d));const se=d.scrollZoom=new Tt(d,this);this._add("scrollZoom",se,["mousePan"]);const pe=d.keyboard=new Be;this._add("keyboard",pe);for(const ie of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ie]&&d[ie].enable(o[ie])}_add(o,d,_){this._handlers.push({handlerName:o,handler:d,allowed:_}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Yl(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,d,_){for(const w in o)if(w!==_&&(!d||d.indexOf(w)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const _ of o)this._el.contains(_.target)&&d.push(_);return d}handleEvent(o,d){this._updatingCamera=!0;const _="renderFrame"===o.type,w=_?void 0:o,C={needsRenderFrame:!1},M={},k={},O=o.touches?this._getMapTouches(o.touches):void 0,B=O?$e.touchPos(this._el,O):_?void 0:$e.mousePos(this._el,o);for(const{handlerName:X,handler:Y,allowed:oe}of this._handlers){if(!Y.isEnabled())continue;let se;this._blockedByActive(k,oe,X)?Y.reset():Y[d||o.type]&&(se=Y[d||o.type](o,B,O),this.mergeHandlerResult(C,M,se,X,w),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||Y.isActive())&&(k[X]=Y)}const U={};for(const X in this._previousActiveHandlers)k[X]||(U[X]=w);this._previousActiveHandlers=k,(Object.keys(U).length||va(C))&&(this._changes.push([C,M,U]),this._triggerRenderFrame()),(Object.keys(k).length||va(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=C;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(o,d,_,w,C){if(!_)return;p.extend(o,_);const M={handlerName:w,originalEvent:_.originalEvent||C};void 0!==_.zoomDelta&&(d.zoom=M),void 0!==_.panDelta&&(d.drag=M),void 0!==_.pitchDelta&&(d.pitch=M),void 0!==_.bearingDelta&&(d.rotate=M)}_applyChanges(){const o={},d={},_={};for(const[w,C,M]of this._changes)w.panDelta&&(o.panDelta=(o.panDelta||new p.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(o.around=w.around),void 0!==w.aroundCoord&&(o.aroundCoord=w.aroundCoord),void 0!==w.pinchAround&&(o.pinchAround=w.pinchAround),w.noInertia&&(o.noInertia=w.noInertia),p.extend(d,C),p.extend(_,M);this._updateMapTransform(o,d,_),this._changes=[]}_updateMapTransform(o,d,_){const w=this._map,C=w.transform,M=ae=>[ae.x,ae.y,ae.z];if((ae=>{const fe=this._eventsInProgress.drag;return fe&&!this._handlersById[fe.handlerName].isActive()})()&&!va(o)){const ae=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",ae!==C.zoom&&this._map._update(!0)}if(!va(o))return this._fireEvents(d,_,!0);let{panDelta:k,zoomDelta:O,bearingDelta:B,pitchDelta:U,around:q,aroundCoord:X,pinchAround:Y}=o;void 0!==Y&&(q=Y),(ae=>d.drag&&!this._eventsInProgress.drag)()&&q&&(this._dragOrigin=M(C.pointCoordinate3D(q)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",w._stop(!0),q=q||w.transform.centerPoint,B&&(C.bearing+=B),U&&(C.pitch+=U),C._updateCameraState();const oe=[0,0,0];if(k){const ae=C.screenPointToMercatorRay(q),fe=C.screenPointToMercatorRay(q.sub(k)),_e=this._trackingEllipsoid.projectRay(ae.dir),we=this._trackingEllipsoid.projectRay(fe.dir);oe[0]=we[0]-_e[0],oe[1]=we[1]-_e[1]}const se=C.zoom,pe=[0,0,0];if(O){const ae=M(X||C.pointCoordinate3D(q)),fe={dir:p.normalize([],p.sub([],ae,C._camera.position))},_e=C.screenPointToMercatorRay(C.centerPoint);if(fe.dir[2]<0){const we=p.altitudeFromMercatorZ(ae[2],ae[1]),ce=C.rayIntersectionCoordinate(C.pointRayIntersection(C.centerPoint,we)),Se=C.zoomDeltaToMovement(M(ce),O)*(_e.dir[2]/fe.dir[2]);p.scale(pe,fe.dir,Se)}else if(C._terrainEnabled()){const we=C.zoomDeltaToMovement(ae,O);p.scale(pe,fe.dir,we)}}const ie=p.add(oe,oe,pe);C._translateCameraConstrained(ie),O&&Math.abs(C.zoom-se)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,_,!0)}_fireEvents(o,d,_){const w=Yl(this._eventsInProgress),C=Yl(o),M={};for(const U in o){const{originalEvent:q}=o[U];this._eventsInProgress[U]||(M[`${U}start`]=q),this._eventsInProgress[U]=o[U]}!w&&C&&this._fireEvent("movestart",C.originalEvent);for(const U in M)this._fireEvent(U,M[U]);C&&this._fireEvent("move",C.originalEvent);for(const U in o){const{originalEvent:q}=o[U];this._fireEvent(U,q)}const k={};let O;for(const U in this._eventsInProgress){const{handlerName:q,originalEvent:X}=this._eventsInProgress[U];this._handlersById[q].isActive()||(delete this._eventsInProgress[U],O=d[q]||X,k[`${U}end`]=O)}for(const U in k)this._fireEvent(U,k[U]);const B=Yl(this._eventsInProgress);if(_&&(w||C)&&!B){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=X=>0!==X&&-this._bearingSnap<X&&X<this._bearingSnap;U?(q(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:O})):(this._map.fire(new p.Event("moveend",{originalEvent:O})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new p.Event(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new gu("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Wa extends p.Evented{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}getCenter(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,_){return o=p.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,p.extend({offset:o},d),_)}panTo(o,d,_){return this.easeTo(p.extend({center:o},d),_)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,_){return this.easeTo(p.extend({zoom:o},d),_)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,_){return this.easeTo(p.extend({bearing:o},d),_)}resetNorth(o,d){return this.rotateTo(0,p.extend({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=p.LngLatBounds.convert(o);const _=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),_,d)}_extendCameraOptions(o){const d={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=p.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){const _=o.padding;o.padding={top:_,bottom:_,right:_,left:_}}return o.padding=p.extend(d,o.padding),o}_cameraForBoxAndBearing(o,d,_,w){const C=this._extendCameraOptions(w),M=this.transform,k=M.padding,O=M.project(p.LngLat.convert(o)),B=M.project(p.LngLat.convert(d)),U=O.rotate(-p.degToRad(_)),q=B.rotate(-p.degToRad(_)),X=new p.pointGeometry(Math.max(U.x,q.x),Math.max(U.y,q.y)),Y=new p.pointGeometry(Math.min(U.x,q.x),Math.min(U.y,q.y)),oe=X.sub(Y),se=(M.width-(k.left+k.right+C.padding.left+C.padding.right))/oe.x,pe=(M.height-(k.top+k.bottom+C.padding.top+C.padding.bottom))/oe.y;if(pe<0||se<0)return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ie=Math.min(M.scaleZoom(M.scale*Math.min(se,pe)),C.maxZoom),ae="number"==typeof C.offset.x?new p.pointGeometry(C.offset.x,C.offset.y):p.pointGeometry.convert(C.offset),fe=new p.pointGeometry((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(_*Math.PI/180),_e=ae.add(fe).mult(M.scale/M.zoomScale(ie));return{center:M.unproject(O.add(B).div(2).sub(_e)),zoom:ie,bearing:_}}_cameraForBox(o,d,_,w,C){const M=this._extendCameraOptions(C);_=_||0,w=w||0,o=p.LngLat.convert(o),d=p.LngLat.convert(d);const k=this.transform.clone();k.padding=M.padding;const O=this.getFreeCameraOptions(),B=new p.LngLat(.5*(o.lng+d.lng),.5*(o.lat+d.lat)),U=.5*(_+w);if(k._camera.position[2]<p.mercatorZfromAltitude(U,B.lat))return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");O.lookAtPoint(B),k.setFreeCameraOptions(O);const q=p.MercatorCoordinate.fromLngLat(o),X=p.MercatorCoordinate.fromLngLat(d),Y=k.pointRayIntersection(k.centerPoint,U),oe=[(se=k.rayIntersectionCoordinate(Y)).x,se.y,se.z];var se;const pe=k.screenPointToMercatorRay(k.centerPoint);let ie,ae=0;do{const fe=Math.floor(k.zoom),_e=1<<fe,we=Math.min(_e*q.x,_e*X.x),ce=Math.min(_e*q.y,_e*X.y),Se=Math.max(_e*q.x,_e*X.x),je=Math.max(_e*q.y,_e*X.y),We=new Po([we,ce,_],[Se,je,w]),Te=ar.fromInvProjectionMatrix(k.invProjMatrix,k.worldSize,fe);if(2!==We.intersects(Te)){ie&&(k._camera.position=p.scaleAndAdd([],k._camera.position,pe.dir,-ie),k._updateStateFromCamera());break}const ze=p.sub([],k._camera.position,oe);ie=.5*p.length(ze),k._camera.position=p.scaleAndAdd([],k._camera.position,pe.dir,ie);try{k._updateStateFromCamera()}catch(ct){return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++ae<10);return{center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}}fitBounds(o,d,_){return this._fitInternal(this.cameraForBounds(o,d),d,_)}_raycastElevationBox(o,d){const _=this.transform.elevation;if(!_)return;const w=new p.pointGeometry(o.x,d.y),C=new p.pointGeometry(d.x,o.y),M=_.pointCoordinate(o);if(!M)return;const k=_.pointCoordinate(d);if(!k)return;const O=_.pointCoordinate(w);if(!O)return;const B=_.pointCoordinate(C);if(!B)return;const U=new p.MercatorCoordinate(M[0],M[1]).toLngLat(),q=new p.MercatorCoordinate(k[0],k[1]).toLngLat(),X=new p.MercatorCoordinate(O[0],O[1]).toLngLat(),Y=new p.MercatorCoordinate(B[0],B[1]).toLngLat(),oe=Math.min(U.lng,Math.min(q.lng,Math.min(X.lng,Y.lng))),se=Math.min(U.lat,Math.min(q.lat,Math.min(X.lat,Y.lat))),pe=Math.max(U.lng,Math.max(q.lng,Math.max(X.lng,Y.lng))),ie=Math.max(U.lat,Math.max(q.lat,Math.max(X.lat,Y.lat))),ae=Math.min(M[3],Math.min(k[3],Math.min(O[3],B[3]))),fe=Math.max(M[3],Math.max(k[3],Math.max(O[3],B[3])));return{minLngLat:new p.LngLat(oe,se),maxLngLat:new p.LngLat(pe,ie),minAltitude:ae,maxAltitude:fe}}fitScreenCoordinates(o,d,_,w,C){let M,k,O,B;const U=p.pointGeometry.convert(o),q=p.pointGeometry.convert(d),X=this._raycastElevationBox(U,q);if(X)M=X.minLngLat,k=X.maxLngLat,O=X.minAltitude,B=X.maxAltitude;else{if(this.transform.isCornerOffEdge(U,q))return this;M=this.transform.pointLocation(U),k=this.transform.pointLocation(q)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(p.pointGeometry.convert(o)),this.transform.pointLocation(p.pointGeometry.convert(d)),_,w):this._cameraForBox(M,k,O,B,w),w,C)}_fitInternal(o,d,_){return o?(delete(d=p.extend(o,d)).padding,d.linear?this.easeTo(d,_):this.flyTo(d,_)):this}jumpTo(o,d){this.stop();const _=this.transform;let w=!1,C=!1,M=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),void 0!==o.center&&(_.center=p.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(C=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(M=!0,_.pitch=+o.pitch),null==o.padding||_.isPaddingEqual(o.padding)||(_.padding=o.padding),this.fire(new p.Event("movestart",d)).fire(new p.Event("move",d)),w&&this.fire(new p.Event("zoomstart",d)).fire(new p.Event("zoom",d)).fire(new p.Event("zoomend",d)),C&&this.fire(new p.Event("rotatestart",d)).fire(new p.Event("rotate",d)).fire(new p.Event("rotateend",d)),M&&this.fire(new p.Event("pitchstart",d)).fire(new p.Event("pitch",d)).fire(new p.Event("pitchend",d)),this.fire(new p.Event("moveend",d))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){this.stop();const _=this.transform,w=_.zoom,C=_.pitch,M=_.bearing;_.setFreeCameraOptions(o);const k=w!==_.zoom,O=C!==_.pitch,B=M!==_.bearing;return this.fire(new p.Event("movestart",d)).fire(new p.Event("move",d)),k&&this.fire(new p.Event("zoomstart",d)).fire(new p.Event("zoom",d)).fire(new p.Event("zoomend",d)),B&&this.fire(new p.Event("rotatestart",d)).fire(new p.Event("rotate",d)).fire(new p.Event("rotateend",d)),O&&this.fire(new p.Event("pitchstart",d)).fire(new p.Event("pitch",d)).fire(new p.Event("pitchend",d)),this.fire(new p.Event("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),(!1===(o=p.extend({offset:[0,0],duration:500,easing:p.ease},o)).animate||!o.essential&&p.exported.prefersReducedMotion)&&(o.duration=0);const _=this.transform,w=this.getZoom(),C=this.getBearing(),M=this.getPitch(),k=this.getPadding(),O="zoom"in o?+o.zoom:w,B="bearing"in o?this._normalizeBearing(o.bearing,C):C,U="pitch"in o?+o.pitch:M,q="padding"in o?o.padding:_.padding,X=p.pointGeometry.convert(o.offset);let Y=_.centerPoint.add(X);const oe=_.pointLocation(Y),se=p.LngLat.convert(o.center||oe);this._normalizeCenter(se);const pe=_.project(oe),ie=_.project(se).sub(pe),ae=_.zoomScale(O-w);let fe,_e;o.around&&(fe=p.LngLat.convert(o.around),_e=_.locationPoint(fe));const we={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||O!==w,this._rotating=this._rotating||C!==B,this._pitching=this._pitching||U!==M,this._padding=!_.isPaddingEqual(q),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,we),this._ease(ce=>{if(this._zooming&&(_.zoom=p.number(w,O,ce)),this._rotating&&(_.bearing=p.number(C,B,ce)),this._pitching&&(_.pitch=p.number(M,U,ce)),this._padding&&(_.interpolatePadding(k,q,ce),Y=_.centerPoint.add(X)),fe)_.setLocationAtPoint(fe,_e);else{const Se=_.zoomScale(_.zoom-w),je=O>w?Math.min(2,ae):Math.max(.5,ae),We=Math.pow(je,1-ce),Te=_.unproject(pe.add(ie.mult(ce*We)).mult(Se));_.setLocationAtPoint(_.renderWorldCopies?Te.wrap():Te,Y)}this._fireMoveEvents(d)},ce=>{_.recenterOnTerrain(),this._afterEase(d,ce)},o),this}_prepareEase(o,d,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||_.moving||this.fire(new p.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new p.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new p.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new p.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new p.Event("move",o)),this._zooming&&this.fire(new p.Event("zoom",o)),this._rotating&&this.fire(new p.Event("rotate",o)),this._pitching&&this.fire(new p.Event("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId,this.transform.cameraElevationReference="ground";const _=this._zooming,w=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new p.Event("zoomend",o)),w&&this.fire(new p.Event("rotateend",o)),C&&this.fire(new p.Event("pitchend",o)),this.fire(new p.Event("moveend",o))}flyTo(o,d){if(!o.essential&&p.exported.prefersReducedMotion){const tt=p.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(tt,d)}this.stop(),o=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},o);const _=this.transform,w=this.getZoom(),C=this.getBearing(),M=this.getPitch(),k=this.getPadding(),O="zoom"in o?p.clamp(+o.zoom,_.minZoom,_.maxZoom):w,B="bearing"in o?this._normalizeBearing(o.bearing,C):C,U="pitch"in o?+o.pitch:M,q="padding"in o?o.padding:_.padding,X=_.zoomScale(O-w),Y=p.pointGeometry.convert(o.offset);let oe=_.centerPoint.add(Y);const se=_.pointLocation(oe),pe=p.LngLat.convert(o.center||se);this._normalizeCenter(pe);const ie=_.project(se),ae=_.project(pe).sub(ie);let fe=o.curve;const _e=Math.max(_.width,_.height),we=_e/X,ce=ae.mag();if("minZoom"in o){const tt=p.clamp(Math.min(o.minZoom,w,O),_.minZoom,_.maxZoom),ft=_e/_.zoomScale(tt-w);fe=Math.sqrt(ft/ce*2)}const Se=fe*fe;function je(tt){const ft=(we*we-_e*_e+(tt?-1:1)*Se*Se*ce*ce)/(2*(tt?we:_e)*Se*ce);return Math.log(Math.sqrt(ft*ft+1)-ft)}function We(tt){return(Math.exp(tt)-Math.exp(-tt))/2}function Te(tt){return(Math.exp(tt)+Math.exp(-tt))/2}const ze=je(0);let ct=function(tt){return Te(ze)/Te(ze+fe*tt)},ht=function(tt){return _e*((Te(ze)*(We(ft=ze+fe*tt)/Te(ft))-We(ze))/Se)/ce;var ft},ut=(je(1)-ze)/fe;if(Math.abs(ce)<1e-6||!isFinite(ut)){if(Math.abs(_e-we)<1e-6)return this.easeTo(o,d);const tt=we<_e?-1:1;ut=Math.abs(Math.log(we/_e))/fe,ht=function(){return 0},ct=function(ft){return Math.exp(tt*fe*ft)}}return o.duration="duration"in o?+o.duration:1e3*ut/("screenSpeed"in o?+o.screenSpeed/fe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=C!==B,this._pitching=U!==M,this._padding=!_.isPaddingEqual(q),this._prepareEase(d,!1),this._ease(tt=>{const ft=tt*ut,sn=1/ct(ft);_.zoom=1===tt?O:w+_.scaleZoom(sn),this._rotating&&(_.bearing=p.number(C,B,tt)),this._pitching&&(_.pitch=p.number(M,U,tt)),this._padding&&(_.interpolatePadding(k,q,tt),oe=_.centerPoint.add(Y));const kt=1===tt?pe:_.unproject(ie.add(ae.mult(ht(ft))).mult(sn));_.setLocationAtPoint(_.renderWorldCopies?kt.wrap():kt,oe),_._updateCenterElevation(),this._fireMoveEvents(d)},()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}if(!o){const _=this.handlers;_&&_.stop(!1)}return this}_ease(o,d,_){!1===_.animate||0===_.duration?(o(1),d()):(this._easeStart=p.exported.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((p.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=p.wrap(o,-180,180);const _=Math.abs(o-d);return Math.abs(o-360-d)<_&&(o-=360),Math.abs(o+360-d)<_&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const _=o.lng-d.center.lng;o.lng+=_>180?-360:_<-180?360:0}}class xi{constructor(o={}){this.options=o,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact;return this._map=o,this._container=$e.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=$e.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$e.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){$e.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const _=this._map._getUIString(`AttributionControl.${d}`);o.title=_,o.setAttribute("aria-label",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(o){const _=d.reduce((w,C,M)=>(C.value&&(w+=`${C.key}=${C.value}${M<d.length-1?"&":""}`),w),"?");o.href=`${p.config.FEEDBACK_URL}/${_}${this._map._hash?this._map._hash.getHashString(!0):""}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||"metadata"!==o.sourceDataType&&"visibility"!==o.sourceDataType&&"style"!==o.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(w=>"string"!=typeof w?"":w)):"string"==typeof this.options.customAttribution&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const d=this._map.style._sourceCaches;for(const w in d){const C=d[w];if(C.used){const M=C.getSource();M.attribution&&o.indexOf(M.attribution)<0&&o.push(M.attribution)}}o.sort((w,C)=>w.length-C.length),o=o.filter((w,C)=>{for(let M=C+1;M<o.length;M++)if(o[M].indexOf(w)>=0)return!1;return!0});const _=o.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,o.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class xa{constructor(){p.bindAll(["_updateLogo"],this),p.bindAll(["_updateCompact"],this)}onAdd(o){this._map=o,this._container=$e.create("div","mapboxgl-ctrl");const d=$e.create("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){$e.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&"metadata"!==o.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(0===Object.entries(o).length)return!0;for(const d in o){const _=o[d].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class _u{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,_=d?this._queue.concat(d):this._queue;for(const w of _)if(w.id===o)return void(w.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const _ of d)if(!_.cancelled&&(_.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ac(m,o,d){if(m=new p.LngLat(m.lng,m.lat),o){const _=new p.LngLat(m.lng-360,m.lat),w=new p.LngLat(m.lng+360,m.lat),C=360*Math.ceil(Math.abs(m.lng-d.center.lng)/360),M=d.locationPoint(m).distSqr(o),k=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint(_).distSqr(o)<M&&(k||Math.abs(_.lng-d.center.lng)<C)?m=_:d.locationPoint(w).distSqr(o)<M&&(k||Math.abs(w.lng-d.center.lng)<C)&&(m=w)}for(;Math.abs(m.lng-d.center.lng)>180;){const _=d.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}const Xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ka extends p.Evented{constructor(o,d){if(super(),(o instanceof p.window.HTMLElement||d)&&(o=p.extend({element:o},d)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=p.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=$e.create("div"),this._element.setAttribute("aria-label","Map marker");const w=$e.createNS("http://www.w3.org/2000/svg","svg"),C=41,M=27;w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height",`${C}px`),w.setAttributeNS(null,"width",`${M}px`),w.setAttributeNS(null,"viewBox",`0 0 ${M} ${C}`);const k=$e.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"stroke","none"),k.setAttributeNS(null,"stroke-width","1"),k.setAttributeNS(null,"fill","none"),k.setAttributeNS(null,"fill-rule","evenodd");const O=$e.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");const B=$e.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(3.0, 29.0)"),B.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of U){const _e=$e.createNS("http://www.w3.org/2000/svg","ellipse");_e.setAttributeNS(null,"opacity","0.04"),_e.setAttributeNS(null,"cx","10.5"),_e.setAttributeNS(null,"cy","5.80029008"),_e.setAttributeNS(null,"rx",fe.rx),_e.setAttributeNS(null,"ry",fe.ry),B.appendChild(_e)}const q=$e.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);const X=$e.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(X);const Y=$e.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const oe=$e.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(oe);const se=$e.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),se.setAttributeNS(null,"fill","#FFFFFF");const pe=$e.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ie=$e.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#000000"),ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962");const ae=$e.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),pe.appendChild(ie),pe.appendChild(ae),O.appendChild(B),O.appendChild(q),O.appendChild(Y),O.appendChild(se),O.appendChild(pe),w.appendChild(O),w.setAttributeNS(null,"height",C*this._scale+"px"),w.setAttributeNS(null,"width",M*this._scale+"px"),this._element.appendChild(w),this._offset=p.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const _=this._element.classList;for(const w in Xa)_.remove(`mapboxgl-marker-anchor-${w}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),$e.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=p.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const d=38.1,_=13.5,w=Math.sqrt(Math.pow(_,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-d],"bottom-left":[w,-1*(d-_+w)],"bottom-right":[-w,-1*(d-_+w)],left:[_,-1*(d-_)],right:[-_,-1*(d-_)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(o){const d=o.code,_=o.charCode||o.keyCode;"Space"!==d&&"Enter"!==d&&32!==_&&13!==_||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,_=this._element;this._popup&&(d===_||_.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}_evaluateOpacity(){const o=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(o))return void this._clearFadeTimer();const d=this._map.unproject(o);let _=!1;if(this._map.getTerrain()){const C=this._map.getFreeCameraOptions();if(C.position){const M=C.position.toLngLat();_=M.distanceTo(d)<.9*M.distanceTo(this._lngLat)}}const w=(1-this._map._queryFogOpacity(d))*(_?.2:1);this._element.style.opacity=`${w}`,this._popup&&this._popup._setOpacity(`${w}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(o){const d=this._map.transform;return!!o&&o.x>=0&&o.x<d.width&&o.y>=0&&o.y<d.height}_update(o){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ac(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let d="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?d=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?_="rotateX(0deg)":"map"===this._pitchAlignment&&(_=`rotateX(${this._map.getPitch()}deg)`),o&&"moveend"!==o.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&$e.setTransform(this._element,`${Xa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${d}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const o=this._map.transform,d=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&d._rotate(o.angle),"map"===this._pitchAlignment&&(d.y*=Math.cos(o._pitch)),d}getOffset(){return this._offset}setOffset(o){return this._offset=p.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new p.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Ic{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=p.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,_){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+_}}const Pc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:kc,HTMLElement:yu,ImageBitmap:Ql}=p.window,kd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function mr(m){m.parentNode&&m.parentNode.removeChild(m)}const Ya={showCompass:!0,showZoom:!0,visualizePitch:!1};class Si{constructor(o,d,_=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Mc({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,_&&(this.mousePitch=new es({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),$e.addEventListener(d,"mousedown",this.mousedown),$e.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),$e.addEventListener(d,"touchmove",this.touchmove),$e.addEventListener(d,"touchend",this.touchend),$e.addEventListener(d,"touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),$e.disableDrag()}move(o,d){const _=this.map,w=this.mouseRotate.mousemoveWindow(o,d);if(w&&w.bearingDelta&&_.setBearing(_.getBearing()+w.bearingDelta),this.mousePitch){const C=this.mousePitch.mousemoveWindow(o,d);C&&C.pitchDelta&&_.setPitch(_.getPitch()+C.pitchDelta)}}off(){const o=this.element;$e.removeEventListener(o,"mousedown",this.mousedown),$e.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),$e.removeEventListener(o,"touchmove",this.touchmove),$e.removeEventListener(o,"touchend",this.touchend),$e.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){$e.enableDrag(),$e.removeEventListener(p.window,"mousemove",this.mousemove),$e.removeEventListener(p.window,"mouseup",this.mouseup)}mousedown(o){this.down(p.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),$e.mousePos(this.element,o)),$e.addEventListener(p.window,"mousemove",this.mousemove),$e.addEventListener(p.window,"mouseup",this.mouseup)}mousemove(o){this.move(o,$e.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){1!==o.targetTouches.length?this.reset():(this._startPos=this._lastPos=$e.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){1!==o.targetTouches.length?this.reset():(this._lastPos=$e.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){0===o.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Tl,Rc=0,ec=!1;const fp={maxWidth:100,unit:"metric"};function Ld(m,o,d){const _=d&&d.maxWidth||100,w=m._container.getBoundingClientRect().height/2,C=m.unproject([0,w]),M=m.unproject([_,w]),k=C.distanceTo(M);if(d&&"imperial"===d.unit){const O=3.2808*k;O>5280?ba(o,_,O/5280,m._getUIString("ScaleControl.Miles"),m):ba(o,_,O,m._getUIString("ScaleControl.Feet"),m)}else d&&"nautical"===d.unit?ba(o,_,k/1852,m._getUIString("ScaleControl.NauticalMiles"),m):k>=1e3?ba(o,_,k/1e3,m._getUIString("ScaleControl.Kilometers"),m):ba(o,_,k,m._getUIString("ScaleControl.Meters"),m)}function ba(m,o,d,_,w){const C=function(k){const O=Math.pow(10,`${Math.floor(k)}`.length-1);let B=k/O;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(U){const q=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*q)/q}(B),O*B}(d),M=C/d;w._requestDomTask(()=>{m.style.width=o*M+"px",m.innerHTML=`${C}&nbsp;${_}`})}const vu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Lc={version:p.version,supported:zr,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:class extends Wa{constructor(m){if(null!=(m=p.extend({},kd,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _s(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._renderTaskQueue=new _u,this._domRenderTaskQueue=new _u,this._controls=[],this._markers=[],this._mapId=p.uniqueId(),this._locale=p.extend({},Pc,m.locale),this._clickTolerance=m.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Ic(0),this._requestManager=new p.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,"string"==typeof m.container){if(this._container=p.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof yu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==p.window&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1),p.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Jl(this,m),this._hash=m.hash&&new Ju("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,p.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.attributionControl&&this.addControl(new xi({customAttribution:m.customAttribution})),this._logoControl=new xa,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update("style"===o.dataType),this.fire(new p.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new p.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(m,o){if(void 0===o&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[o];return-1!==o.indexOf("bottom")?_.insertBefore(d,_.firstChild):_.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){const[o,d]=this._containerDimensions();if(o===this.transform.width&&d===this.transform.height)return this;this._resizeCanvas(o,d),this.transform.resize(o,d),this.painter.resize(Math.ceil(o),Math.ceil(d));const _=!this._moving;return _&&this.fire(new p.Event("movestart",m)).fire(new p.Event("move",m)),this.fire(new p.Event("resize",m)),_&&this.fire(new p.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(p.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=null==m?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=null==m?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=null==m?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=null==m?85:m)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint3D(p.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(p.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(m,o,d){if("mouseenter"===m||"mouseover"===m){let _=!1;return{layer:o,listener:d,delegates:{mousemove:C=>{const M=this.getLayer(o)?this.queryRenderedFeatures(C.point,{layers:[o]}):[];M.length?_||(_=!0,d.call(this,new fr(m,this,C.originalEvent,{features:M}))):_=!1},mouseout:()=>{_=!1}}}}if("mouseleave"===m||"mouseout"===m){let _=!1;return{layer:o,listener:d,delegates:{mousemove:M=>{(this.getLayer(o)?this.queryRenderedFeatures(M.point,{layers:[o]}):[]).length?_=!0:_&&(_=!1,d.call(this,new fr(m,this,M.originalEvent)))},mouseout:M=>{_&&(_=!1,d.call(this,new fr(m,this,M.originalEvent)))}}}}{const _=w=>{const C=this.getLayer(o)?this.queryRenderedFeatures(w.point,{layers:[o]}):[];C.length&&(w.features=C,d.call(this,w),delete w.features)};return{layer:o,listener:d,delegates:{[m]:_}}}}on(m,o,d){if(void 0===d)return super.on(m,o);const _=this._createDelegatedListener(m,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const w in _.delegates)this.on(w,_.delegates[w]);return this}once(m,o,d){if(void 0===d)return super.once(m,o);const _=this._createDelegatedListener(m,o,d);for(const w in _.delegates)this.once(w,_.delegates[w]);return this}off(m,o,d){return void 0===d?super.off(m,o):(this._delegatedListeners&&this._delegatedListeners[m]&&(_=>{const w=this._delegatedListeners[m];for(let C=0;C<w.length;C++){const M=w[C];if(M.layer===o&&M.listener===d){for(const k in M.delegates)this.off(k,M.delegates[k]);return w.splice(C,1),this}}})(),this)}queryRenderedFeatures(m,o){return this.style?(void 0!==o||void 0===m||m instanceof p.pointGeometry||Array.isArray(m)||(o=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(m,o){return this.style.querySourceFeatures(m,o)}queryTerrainElevation(m,o){const d=this.transform.elevation;return d?(o=p.extend({},{exaggerated:!0},o),d.getAtPoint(p.MercatorCoordinate.fromLngLat(m),null,o.exaggerated)):null}setStyle(m,o){return!1!==(o=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(m,o))}_getUIString(m){const o=this._locale[m];if(null==o)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),m&&(this.style=new Jr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,o){if("string"==typeof m){const d=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(d,p.ResourceType.Style);p.getJSON(_,(w,C)=>{w?this.fire(new p.ErrorEvent(w)):C&&this._updateDiff(C,o)})}else"object"==typeof m&&this._updateDiff(m,o)}_updateDiff(m,o){try{this.style.setState(m)&&this._update(!0)}catch(d){p.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(m,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():p.warnOnce("There is no style added to the map.")}addSource(m,o){return this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)}isSourceLoaded(m){const o=this.style&&this.style._getSourceCaches(m);if(0!==o.length)return o.every(d=>d.loaded());this.fire(new p.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const o in m){const d=m[o]._tiles;for(const _ in d){const w=d[_];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0}addSourceType(m,o,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,d)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,o,{pixelRatio:d=1,sdf:_=!1,stretchX:w,stretchY:C,content:M}={}){if(this._lazyInitEmptyStyle(),o instanceof kc||Ql&&o instanceof Ql){const{width:k,height:O,data:B}=p.exported.getImageData(o);this.style.addImage(m,{data:new p.RGBAImage({width:k,height:O},B),pixelRatio:d,stretchX:w,stretchY:C,content:M,sdf:_,version:0})}else{if(void 0===o.width||void 0===o.height)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:O,data:B}=o,U=o;this.style.addImage(m,{data:new p.RGBAImage({width:k,height:O},new Uint8Array(B)),pixelRatio:d,stretchX:w,stretchY:C,content:M,sdf:_,version:0,userImage:U}),U.onAdd&&U.onAdd(this,m)}}}updateImage(m,o){const d=this.style.getImage(m);if(!d)return this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=o instanceof kc||Ql&&o instanceof Ql?p.exported.getImageData(o):o,{width:w,height:C,data:M}=_;return void 0===w||void 0===C?this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):w!==d.data.width||C!==d.data.height?this.fire(new p.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(d.data.replace(M,!(o instanceof kc||Ql&&o instanceof Ql)),void this.style.updateImage(m,d))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){p.getImage(this._requestManager.transformRequest(m,p.ResourceType.Image),(d,_)=>{o(d,_ instanceof kc?p.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,o){return this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)}moveLayer(m,o){return this.style.moveLayer(m,o),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,o,d){return this.style.setLayerZoomRange(m,o,d),this._update(!0)}setFilter(m,o,d={}){return this.style.setFilter(m,o,d),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,o,d,_={}){return this.style.setPaintProperty(m,o,d,_),this._update(!0)}getPaintProperty(m,o){return this.style.getPaintProperty(m,o)}setLayoutProperty(m,o,d,_={}){return this.style.setLayoutProperty(m,o,d,_),this._update(!0)}getLayoutProperty(m,o){return this.style.getLayoutProperty(m,o)}setLight(m,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(p.LngLat.convert(m),this.transform):0}setFeatureState(m,o){return this.style.setFeatureState(m,o),this._update()}removeFeatureState(m,o){return this.style.removeFeatureState(m,o),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_containerDimensions(){let m=0,o=0;return this._container&&(m=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300),[m,o]}_detectMissingCSS(){"rgb(250, 128, 114)"!==p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=$e.create("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=$e.create("div","mapboxgl-canvas-container",m);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=$e.create("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions();this._resizeCanvas(d[0],d[1]);const _=this._controlContainer=$e.create("div","mapboxgl-control-container",m),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{w[C]=$e.create("div",`mapboxgl-ctrl-${C}`,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,o){const d=p.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(m),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const o=this._markers.indexOf(m);-1!==o&&this._markers.splice(o,1)}_setupPainter(){const m=p.extend({},zr.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);o?(p.storeAuthState(o,!0),this.painter=new Wl(o,this.transform),this.on("data",d=>{"source"===d.dataType&&this.painter.setTileLoadedFlag(!0)}),p.exported$1.testSupport(o)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.isMoving()&&this.loaded()?m():this._domRenderTaskQueue.add(m)}_render(m){let o;const d=this.painter.context.extTimerQuery,_=p.exported.now();this.listens("gpu-timing-frame")&&(o=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,o));let w=this._updateAverageElevation(_);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;let C=!1;const M=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,B=p.exported.now();this.style.zoomHistory.update(O,B);const U=new p.EvaluationParameters(O,{now:B,fadeDuration:M,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),q=U.crossFadingFactor();1===q&&q===this._crossFadingFactor||(C=!0,this._crossFadingFactor=q),this.style.update(U)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,M,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:M,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const O=p.exported.now()-_;d.endQueryEXT(d.TIME_ELAPSED_EXT,o),setTimeout(()=>{const B=d.getQueryObjectEXT(o,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(o),this.fire(new p.Event("gpu-timing-frame",{cpuTime:O,gpuTime:B}))},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const B=this.painter.queryGpuTimers(O);this.fire(new p.Event("gpu-timing-layer",{layerTimes:B}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(k||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(w=this._updateAverageElevation(_,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new p.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new p.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const m of this._markers)m._update()}_updateAverageElevation(m,o=!1){const d=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&d(0);if((o||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();isNaN(w)?w=0:this._averageElevationLastSampledAt=m;const C=Math.abs(_-w);if(C>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(w),d(w);this._averageElevation.easeTo(w,m,300)}else if(C>1e-4)return this._averageElevation.jumpTo(w),d(w)}return!!this._averageElevation.isEasing(m)&&d(this._averageElevation.getValue(m))}_authenticate(){p.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===p.AUTH_ERR_MSG||401===m.status)){const o=this.painter.context.gl;p.storeAuthState(o,!1),this._logoControl instanceof xa&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new p.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),p.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,_=d.createFramebuffer();function w(C){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,C,0);const M=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,M),M}return d.bindFramebuffer(d.FRAMEBUFFER,_),this._canvasPixelComparison(w(m),o.canvasCopies.map(w),o.timeStamps)}_canvasPixelComparison(m,o,d){let _=d[1]-d[0];const w=m.length/4;for(let C=0;C<o.length;C++){const M=o[C];let k=0;for(let O=0;O<M.length;O+=4)M[O]===m[O]&&M[O+1]===m[O+1]&&M[O+2]===m[O+2]&&M[O+3]===m[O+3]&&(k+=1);_+=(d[C+2]-d[C+1])*(1-k/w)}return _}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==p.window&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),mr(this._canvasContainer),mr(this._controlContainer),mr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),p.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new p.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=p.exported.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}_setCacheLimits(m,o){p.setCacheLimits(m,o)}get version(){return p.version}},NavigationControl:class{constructor(m){this.options=p.extend({},Ya,m),this._container=$e.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),$e.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),$e.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=$e.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const m=this._map.getZoom(),o=m===this._map.getMaxZoom(),d=m===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=m)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Si(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){$e.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,o){const d=$e.create("button",m,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(m,o){const d=this._map._getUIString(`NavigationControl.${o}`);m.title=d,m.setAttribute("aria-label",d)}},GeolocateControl:class extends p.Evented{constructor(m){super(),this.options=p.extend({},Rd,m),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=vi(this._updateMarkerRotation,20)}onAdd(m){var o;return this._map=m,this._container=$e.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,void 0!==Tl?o(Tl):void 0!==p.window.navigator.permissions?p.window.navigator.permissions.query({name:"geolocation"}).then(d=>{Tl="denied"!==d.state,o(Tl)}):(Tl=!!p.window.navigator.geolocation,o(Tl)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),$e.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Rc=0,ec=!1}_isOutOfMapMaxBounds(m){const o=this._map.getMaxBounds(),d=m.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",m)),this._finish()}}_updateCamera(m){const o=new p.LngLat(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,_=this._map.getBearing(),w=p.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),w,{geolocateSource:!0})}_updateMarker(m){if(m){const o=new p.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map._container.getBoundingClientRect().height/2,o=this._map.unproject([0,m]),d=this._map.unproject([100,m]),_=o.distanceTo(d)/100,w=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=`${w}px`,this._circleElement.style.height=`${w}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&ec)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=$e.create("button","mapboxgl-ctrl-geolocate",this._container),$e.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===m){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$e.create("div","mapboxgl-user-location"),this._dotElement.appendChild($e.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild($e.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ka({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=$e.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ka({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||"ACTIVE_LOCK"!==this._watchState||o.originalEvent&&"resize"===o.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new p.Event("trackuserlocationend")))})}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Rc--,ec=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Rc++,Rc>1?(m={maximumAge:6e5,timeout:0},ec=!0):(m=this.options.positionOptions,ec=!1),this._geolocationWatchID=p.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else p.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{p.window.addEventListener("ondeviceorientationabsolute"in p.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==p.window.DeviceMotionEvent&&"function"==typeof p.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(o=>{"granted"===o&&m()}).catch(console.error):m()}_clearWatch(){p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),p.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),p.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xi,ScaleControl:class{constructor(m){this.options=p.extend({},fp,m),p.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ld(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=$e.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){$e.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,Ld(this._map,this._container,this.options)}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof p.window.HTMLElement?this._container=m.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in p.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=$e.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){$e.remove(this._controlContainer),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!p.window.document.fullscreenEnabled&&!p.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=$e.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);$e.create("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden",!0),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(p.window.document.fullscreenElement||p.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends p.Evented{constructor(m){super(),this.options=p.extend(Object.create(vu),m),p.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new p.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&$e.remove(this._content),this._container&&($e.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new p.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=p.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(p.window.document.createTextNode(m))}setHTML(m){const o=p.window.document.createDocumentFragment(),d=p.window.document.createElement("body");let _;for(d.innerHTML=m;_=d.firstChild,_;)o.appendChild(_);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=$e.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._container&&this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._container&&this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let o;return this._classList.delete(m)?o=!1:(this._classList.add(m),o=!0),this._container&&this._updateClassList(),o}_createCloseButton(){this.options.closeButton&&(this._closeButton=$e.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const o=this._pos,d=this._container.offsetWidth,_=this._container.offsetHeight;let w;return w=o.y+m.bottom.y<_?["top"]:o.y>this._map.transform.height-_?["bottom"]:[],o.x<d/2?w.push("left"):o.x>this._map.transform.width-d/2&&w.push("right"),0===w.length?"bottom":w.join("-")}_updateClassList(){const m=[...this._classList];m.push("mapboxgl-popup"),this._anchor&&m.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&m.push("mapboxgl-popup-track-pointer"),this._container.className=m.join(" ")}_update(m){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=$e.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=$e.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ac(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||m){const o=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat),d=function(C){if(C||(C=new p.pointGeometry(0,0)),"number"==typeof C){const M=Math.round(Math.sqrt(.5*Math.pow(C,2)));return{center:new p.pointGeometry(0,0),top:new p.pointGeometry(0,C),"top-left":new p.pointGeometry(M,M),"top-right":new p.pointGeometry(-M,M),bottom:new p.pointGeometry(0,-C),"bottom-left":new p.pointGeometry(M,-M),"bottom-right":new p.pointGeometry(-M,-M),left:new p.pointGeometry(C,0),right:new p.pointGeometry(-C,0)}}if(C instanceof p.pointGeometry||Array.isArray(C)){const M=p.pointGeometry.convert(C);return{center:M,top:M,"top-left":M,"top-right":M,bottom:M,"bottom-left":M,"bottom-right":M,left:M,right:M}}return{center:p.pointGeometry.convert(C.center||[0,0]),top:p.pointGeometry.convert(C.top||[0,0]),"top-left":p.pointGeometry.convert(C["top-left"]||[0,0]),"top-right":p.pointGeometry.convert(C["top-right"]||[0,0]),bottom:p.pointGeometry.convert(C.bottom||[0,0]),"bottom-left":p.pointGeometry.convert(C["bottom-left"]||[0,0]),"bottom-right":p.pointGeometry.convert(C["bottom-right"]||[0,0]),left:p.pointGeometry.convert(C.left||[0,0]),right:p.pointGeometry.convert(C.right||[0,0])}}(this.options.offset),_=this._anchor=this._getAnchor(d),w=o.add(d[_]).round();this._map._requestDomTask(()=>{this._container&&_&&$e.setTransform(this._container,`${Xa[_]} translate(${w.x}px,${w.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(xu);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._content&&(this._content.style.opacity=m),this._tip&&(this._tip.style.opacity=m)}},Marker:Ka,Style:Jr,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.pointGeometry,MercatorCoordinate:p.MercatorCoordinate,FreeCameraOptions:Bs,Evented:p.Evented,config:p.config,prewarm:function(){it().acquire(be)},clearPrewarmedResources:function(){const m=Ge;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(be),Ge=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(m){p.config.ACCESS_TOKEN=m},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(m){p.config.API_URL=m},get workerCount(){return Ae.workerCount},set workerCount(m){Ae.workerCount=m},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){p.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){p.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:p.exported.setNow,restoreNow:p.exported.restoreNow};return Lc}),Go}()},247:(qu,ss,st)=>{"use strict";function Go(t){return"function"==typeof t}let Hn=!1;const Io={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Hn&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Hn=t},get useDeprecatedSynchronousErrorHandling(){return Hn}};function p(t){setTimeout(()=>{throw t},0)}const zr={closed:!0,next(t){},error(t){if(Io.useDeprecatedSynchronousErrorHandling)throw t;p(t)},complete(){}},Qt=Array.isArray||(t=>t&&"number"==typeof t.length);function Cr(t){return null!==t&&"object"==typeof t}const $e=(()=>{function t(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return t.prototype=Object.create(Error.prototype),t})();class at{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:a,_subscriptions:u}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof at)n.remove(this);else if(null!==n)for(let g=0;g<n.length;++g)n[g].remove(this);if(Go(a)){r&&(this._unsubscribe=void 0);try{a.call(this)}catch(g){e=g instanceof $e?po(g.errors):[g]}}if(Qt(u)){let g=-1,b=u.length;for(;++g<b;){const D=u[g];if(Cr(D))try{D.unsubscribe()}catch(I){e=e||[],I instanceof $e?e=e.concat(po(I.errors)):e.push(I)}}}if(e)throw new $e(e)}add(e){let n=e;if(!e)return at.EMPTY;switch(typeof e){case"function":n=new at(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof at)){const u=n;n=new at,n._subscriptions=[u]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof at){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const a=this._subscriptions;return null===a?this._subscriptions=[n]:a.push(n),n}remove(e){const n=this._subscriptions;if(n){const r=n.indexOf(e);-1!==r&&n.splice(r,1)}}}var t;function po(t){return t.reduce((e,n)=>e.concat(n instanceof $e?n.errors:n),[])}at.EMPTY=((t=new at).closed=!0,t);const mo="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class In extends at{constructor(e,n,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=zr;break;case 1:if(!e){this.destination=zr;break}if("object"==typeof e){e instanceof In?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new Ol(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new Ol(this,e,n,r)}}[mo](){return this}static create(e,n,r){const a=new In(e,n,r);return a.syncErrorThrowable=!1,a}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class Ol extends In{constructor(e,n,r,a){super(),this._parentSubscriber=e;let u,g=this;Go(n)?u=n:n&&(u=n.next,r=n.error,a=n.complete,n!==zr&&(g=Object.create(n),Go(g.unsubscribe)&&this.add(g.unsubscribe.bind(g)),g.unsubscribe=this.unsubscribe.bind(this))),this._context=g,this._next=u,this._error=r,this._complete=a}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:n}=this;Io.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:n}=this,{useDeprecatedSynchronousErrorHandling:r}=Io;if(this._error)r&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)r?(n.syncErrorValue=e,n.syncErrorThrown=!0):p(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;p(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const n=()=>this._complete.call(this._context);Io.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,n){try{e.call(this._context,n)}catch(r){if(this.unsubscribe(),Io.useDeprecatedSynchronousErrorHandling)throw r;p(r)}}__tryOrSetError(e,n,r){if(!Io.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,r)}catch(a){return Io.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=a,e.syncErrorThrown=!0,!0):(p(a),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const Po="function"==typeof Symbol&&Symbol.observable||"@@observable";function gi(t){return t}let Pn=(()=>{class t{constructor(n){this._isScalar=!1,n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,a){const{operator:u}=this,g=function(t,e,n){if(t){if(t instanceof In)return t;if(t[mo])return t[mo]()}return t||e||n?new In(t,e,n):new In(zr)}(n,r,a);if(g.add(u?u.call(g,this.source):this.source||Io.useDeprecatedSynchronousErrorHandling&&!g.syncErrorThrowable?this._subscribe(g):this._trySubscribe(g)),Io.useDeprecatedSynchronousErrorHandling&&g.syncErrorThrowable&&(g.syncErrorThrowable=!1,g.syncErrorThrown))throw g.syncErrorValue;return g}_trySubscribe(n){try{return this._subscribe(n)}catch(r){Io.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=r),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof In?n:null}return!0}(n)?n.error(r):console.warn(r)}}forEach(n,r){return new(r=Ci(r))((a,u)=>{let g;g=this.subscribe(b=>{try{n(b)}catch(D){u(D),g&&g.unsubscribe()}},u,a)})}_subscribe(n){const{source:r}=this;return r&&r.subscribe(n)}[Po](){return this}pipe(...n){return 0===n.length?this:function(t){return 0===t.length?gi:1===t.length?t[0]:function(n){return t.reduce((r,a)=>a(r),n)}}(n)(this)}toPromise(n){return new(n=Ci(n))((r,a)=>{let u;this.subscribe(g=>u=g,g=>a(g),()=>r(u))})}}return t.create=e=>new t(e),t})();function Ci(t){if(t||(t=Io.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const si=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class Zi extends at{constructor(e,n){super(),this.subject=e,this.subscriber=n,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,n=e.observers;if(this.subject=null,!n||0===n.length||e.isStopped||e.closed)return;const r=n.indexOf(this.subscriber);-1!==r&&n.splice(r,1)}}class ka extends In{constructor(e){super(e),this.destination=e}}let Pi=(()=>{class t extends Pn{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[mo](){return new ka(this)}lift(n){const r=new ll(this,this);return r.operator=n,r}next(n){if(this.closed)throw new si;if(!this.isStopped){const{observers:r}=this,a=r.length,u=r.slice();for(let g=0;g<a;g++)u[g].next(n)}}error(n){if(this.closed)throw new si;this.hasError=!0,this.thrownError=n,this.isStopped=!0;const{observers:r}=this,a=r.length,u=r.slice();for(let g=0;g<a;g++)u[g].error(n);this.observers.length=0}complete(){if(this.closed)throw new si;this.isStopped=!0;const{observers:n}=this,r=n.length,a=n.slice();for(let u=0;u<r;u++)a[u].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(n){if(this.closed)throw new si;return super._trySubscribe(n)}_subscribe(n){if(this.closed)throw new si;return this.hasError?(n.error(this.thrownError),at.EMPTY):this.isStopped?(n.complete(),at.EMPTY):(this.observers.push(n),new Zi(this,n))}asObservable(){const n=new Pn;return n.source=this,n}}return t.create=(e,n)=>new ll(e,n),t})();class ll extends Pi{constructor(e,n){super(),this.destination=e,this.source=n}next(e){const{destination:n}=this;n&&n.next&&n.next(e)}error(e){const{destination:n}=this;n&&n.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:n}=this;return n?this.source.subscribe(e):at.EMPTY}}function _i(t){return t&&"function"==typeof t.schedule}function tn(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Dt(t,e))}}class Dt{constructor(e,n){this.project=e,this.thisArg=n}call(e,n){return n.subscribe(new ni(e,this.project,this.thisArg))}}class ni extends In{constructor(e,n,r){super(e),this.project=n,this.count=0,this.thisArg=r||this}_next(e){let n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const nn=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()},Ri="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",jt=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Wr(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const ea=t=>{if(t&&"function"==typeof t[Po])return(t=>e=>{const n=t[Po]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if(jt(t))return nn(t);if(Wr(t))return(t=>e=>(t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,p),e))(t);if(t&&"function"==typeof t[Ri])return(t=>e=>{const n=t[Ri]();for(;;){let r;try{r=n.next()}catch(a){return e.error(a),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const n=`You provided ${Cr(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(n)}};function qi(t,e){return new Pn(n=>{const r=new at;let a=0;return r.add(e.schedule(function(){a!==t.length?(n.next(t[a++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function Jn(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[Po]}(t))return function(t,e){return new Pn(n=>{const r=new at;return r.add(e.schedule(()=>{const a=t[Po]();r.add(a.subscribe({next(u){r.add(e.schedule(()=>n.next(u)))},error(u){r.add(e.schedule(()=>n.error(u)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(Wr(t))return function(t,e){return new Pn(n=>{const r=new at;return r.add(e.schedule(()=>t.then(a=>{r.add(e.schedule(()=>{n.next(a),r.add(e.schedule(()=>n.complete()))}))},a=>{r.add(e.schedule(()=>n.error(a)))}))),r})}(t,e);if(jt(t))return qi(t,e);if(function(t){return t&&"function"==typeof t[Ri]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new Pn(n=>{const r=new at;let a;return r.add(()=>{a&&"function"==typeof a.return&&a.return()}),r.add(e.schedule(()=>{a=t[Ri](),r.add(e.schedule(function(){if(n.closed)return;let u,g;try{const b=a.next();u=b.value,g=b.done}catch(b){return void n.error(b)}g?n.complete():(n.next(u),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof Pn?t:new Pn(ea(t))}class ko extends In{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class go extends In{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function _o(t,e){if(e.closed)return;if(t instanceof Pn)return t.subscribe(e);let n;try{n=ea(t)(e)}catch(r){e.error(r)}return n}function Nn(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(Nn((a,u)=>Jn(t(a,u)).pipe(tn((g,b)=>e(a,g,u,b))),n)):("number"==typeof e&&(n=e),r=>r.lift(new na(t,n)))}class na{constructor(e,n=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=n}call(e,n){return n.subscribe(new cl(e,this.project,this.concurrent))}}class cl extends go{constructor(e,n,r=Number.POSITIVE_INFINITY){super(e),this.project=n,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(a){return void this.destination.error(a)}this.active++,this._innerSub(n)}_innerSub(e){const n=new ko(this),r=this.destination;r.add(n);const a=_o(e,n);a!==n&&r.add(a)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Xr(t=Number.POSITIVE_INFINITY){return Nn(gi,t)}function Er(t,e){return e?qi(t,e):new Pn(nn(t))}function ra(){return function(e){return e.lift(new Fl(e))}}class Fl{constructor(e){this.connectable=e}call(e,n){const{connectable:r}=this;r._refCount++;const a=new Fa(e,r),u=n.subscribe(a);return a.closed||(a.connection=r.connect()),u}}class Fa extends In{constructor(e,n){super(e),this.connectable=n}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const n=e._refCount;if(n<=0)return void(this.connection=null);if(e._refCount=n-1,n>1)return void(this.connection=null);const{connection:r}=this,a=e._connection;this.connection=null,a&&(!r||a===r)&&a.unsubscribe()}}class oa extends Pn{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new at,e.add(this.source.subscribe(new bc(this.getSubject(),this))),e.closed&&(this._connection=null,e=at.EMPTY)),e}refCount(){return ra()(this)}}const ul=(()=>{const t=oa.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class bc extends ka{constructor(e,n){super(e),this.connectable=n}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}}}function Xo(){return new Pi}function Ft(t){for(let e in t)if(t[e]===Ft)return e;throw Error("Could not find renamed property on target object.")}function ls(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Bt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Bt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Tr(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Ko=Ft({__forward_ref__:Ft});function yn(t){return t.__forward_ref__=yn,t.toString=function(){return Bt(this())},t}function Q(t){return $(t)?t():t}function $(t){return"function"==typeof t&&t.hasOwnProperty(Ko)&&t.__forward_ref__===yn}class re extends Error{constructor(e,n){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(e,n)),this.code=e}}function ve(t){return"string"==typeof t?t:null==t?"":String(t)}function Ee(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ve(t)}function it(t,e){const n=e?` in ${e}`:"";throw new re("201",`No provider for ${Ee(t)} found${n}`)}function Ct(t,e){null==t&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function mt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Rn(t){return{providers:t.providers||[],imports:t.imports||[]}}function fn(t){return Nl(t,Br)||Nl(t,$t)}function Nl(t,e){return t.hasOwnProperty(e)?t[e]:null}function ca(t){return t&&(t.hasOwnProperty(Dr)||t.hasOwnProperty(hl))?t[Dr]:null}const Br=Ft({\u0275prov:Ft}),Dr=Ft({\u0275inj:Ft}),$t=Ft({ngInjectableDef:Ft}),hl=Ft({ngInjectorDef:Ft});var wt=(()=>((wt=wt||{})[wt.Default=0]="Default",wt[wt.Host=1]="Host",wt[wt.Self=2]="Self",wt[wt.SkipSelf=4]="SkipSelf",wt[wt.Optional=8]="Optional",wt))();let cn;function vo(t){const e=cn;return cn=t,e}function Is(t,e,n){const r=fn(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&wt.Optional?null:void 0!==e?e:void it(Bt(t),"Injector")}function ur(t){return{toString:t}.toString()}var Ei=(()=>((Ei=Ei||{})[Ei.OnPush=0]="OnPush",Ei[Ei.Default=1]="Default",Ei))(),zn=(()=>((zn=zn||{})[zn.Emulated=0]="Emulated",zn[zn.None=2]="None",zn[zn.ShadowDom=3]="ShadowDom",zn))();const Na="undefined"!=typeof globalThis&&globalThis,za="undefined"!=typeof window&&window,Wu="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,cs="undefined"!=typeof global&&global,Un=Na||cs||za||Wu,On={},bn=[],ha=Ft({\u0275cmp:Ft}),Ps=Ft({\u0275dir:Ft}),zl=Ft({\u0275pipe:Ft}),da=Ft({\u0275mod:Ft}),Bl=Ft({\u0275loc:Ft}),Yr=Ft({\u0275fac:Ft}),zi=Ft({__NG_ELEMENT_ID__:Ft});let ks=0;function Qi(t){return ur(()=>{const n={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Ei.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||bn,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||zn.Emulated,id:"c",styles:t.styles||bn,_:null,setInput:null,schemas:t.schemas||null,tView:null},a=t.directives,u=t.features,g=t.pipes;return r.id+=ks++,r.inputs=Lo(t.inputs,n),r.outputs=Lo(t.outputs),u&&u.forEach(b=>b(r)),r.directiveDefs=a?()=>("function"==typeof a?a():a).map(Vl):null,r.pipeDefs=g?()=>("function"==typeof g?g():g).map(Jr):null,r})}function Vl(t){return tr(t)||function(t){return t[Ps]||null}(t)}function Jr(t){return function(t){return t[zl]||null}(t)}const dl={};function er(t){return ur(()=>{const e={type:t.type,bootstrap:t.bootstrap||bn,declarations:t.declarations||bn,imports:t.imports||bn,exports:t.exports||bn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(dl[t.id]=t.type),e})}function Lo(t,e){if(null==t)return On;const n={};for(const r in t)if(t.hasOwnProperty(r)){let a=t[r],u=a;Array.isArray(a)&&(u=a[1],a=a[0]),n[a]=r,e&&(e[a]=u)}return n}const Et=Qi;function tr(t){return t[ha]||null}function Vr(t,e){const n=t[da]||null;if(!n&&!0===e)throw new Error(`Type ${Bt(t)} does not have '\u0275mod' property.`);return n}function bo(t){return Array.isArray(t)&&"object"==typeof t[1]}function wo(t){return Array.isArray(t)&&!0===t[1]}function _a(t){return 0!=(8&t.flags)}function jl(t){return 2==(2&t.flags)}function $l(t){return 1==(1&t.flags)}function Di(t){return null!==t.template}function pl(t){return 0!=(512&t[2])}function ms(t,e){return t.hasOwnProperty(Yr)?t[Yr]:null}class bl{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function ci(){return hr}function hr(t){return t.type.prototype.ngOnChanges&&(t.setInput=gs),Ua}function Ua(){const t=Wl(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===On)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function gs(t,e,n,r){const a=Wl(t)||function(t,e){return t[ql]=e}(t,{previous:On,current:null}),u=a.current||(a.current={}),g=a.previous,b=this.declaredInputs[n],D=g[b];u[b]=new bl(D&&D.currentValue,e,g===On),t[r]=e}ci.ngInherit=!0;const ql="__ngSimpleChanges__";function Wl(t){return t[ql]||null}let Mr;function vi(t){return!!t.listen}const ya={createRenderer:(t,e)=>void 0!==Mr?Mr:"undefined"!=typeof document?document:void 0};function Oi(t){for(;Array.isArray(t);)t=t[0];return t}function Ha(t,e){return Oi(e[t])}function Ar(t,e){return Oi(e[t.index])}function fr(t,e){return t.data[e]}function ir(t,e){const n=e[t];return bo(n)?n:n[0]}function Za(t){return 128==(128&t[2])}function Fo(t,e){return null==e?null:t[e]}function Dc(t){t[18]=0}function Cl(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Ot={lFrame:Ic(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function es(){return Ot.bindingsEnabled}function c(){return Ot.lFrame.lView}function v(){return Ot.lFrame.tView}function P(){let t=V();for(;null!==t&&64===t.type;)t=t.parent;return t}function V(){return Ot.lFrame.currentTNode}function me(t,e){const n=Ot.lFrame;n.currentTNode=t,n.isParent=e}function Le(){return Ot.lFrame.isParent}function Tt(){return Ot.isInCheckNoChangesMode}function un(t){Ot.isInCheckNoChangesMode=t}function no(){return Ot.lFrame.bindingIndex++}function Qu(t,e){const n=Ot.lFrame;n.bindingIndex=n.bindingRootIndex=t,Jl(e)}function Jl(t){Ot.lFrame.currentDirectiveIndex=t}function xa(t){Ot.lFrame.currentQueryIndex=t}function _u(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Ac(t,e,n){if(n&wt.SkipSelf){let a=e,u=t;for(;!(a=a.parent,null!==a||n&wt.Host||(a=_u(u),null===a||(u=u[15],10&a.type))););if(null===a)return!1;e=a,t=u}const r=Ot.lFrame=Ka();return r.currentTNode=e,r.lView=t,!0}function Xa(t){const e=Ka(),n=t[1];Ot.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Ka(){const t=Ot.lFrame,e=null===t?null:t.child;return null===e?Ic(t):e}function Ic(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Pc(){const t=Ot.lFrame;return Ot.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const kc=Pc;function yu(){const t=Pc();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function mr(){return Ot.lFrame.selectedIndex}function Ya(t){Ot.lFrame.selectedIndex=t}function Si(){const t=Ot.lFrame;return fr(t.tView,t.selectedIndex)}function ba(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const u=t.data[n].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:b,ngAfterViewInit:D,ngAfterViewChecked:I,ngOnDestroy:N}=u;g&&(t.contentHooks||(t.contentHooks=[])).push(-n,g),b&&((t.contentHooks||(t.contentHooks=[])).push(n,b),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,b)),D&&(t.viewHooks||(t.viewHooks=[])).push(-n,D),I&&((t.viewHooks||(t.viewHooks=[])).push(n,I),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,I)),null!=N&&(t.destroyHooks||(t.destroyHooks=[])).push(n,N)}}function vu(t,e,n){m(t,e,3,n)}function xu(t,e,n,r){(3&t[2])===n&&m(t,e,n,r)}function Lc(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function m(t,e,n,r){const u=null!=r?r:-1,g=e.length-1;let b=0;for(let D=void 0!==r?65535&t[18]:0;D<g;D++)if("number"==typeof e[D+1]){if(b=e[D],null!=r&&b>=r)break}else e[D]<0&&(t[18]+=65536),(b<u||-1==u)&&(o(t,n,e,D),t[18]=(4294901760&t[18])+D+2),D++}function o(t,e,n,r){const a=n[r]<0,u=n[r+1],b=t[a?-n[r]:n[r]];if(a){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{u.call(b)}finally{}}}else try{u.call(b)}finally{}}const d=-1;class _{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function X(t,e,n){const r=vi(t);let a=0;for(;a<n.length;){const u=n[a];if("number"==typeof u){if(0!==u)break;a++;const g=n[a++],b=n[a++],D=n[a++];r?t.setAttribute(e,b,D,g):e.setAttributeNS(g,b,D)}else{const g=u,b=n[++a];oe(g)?r&&t.setProperty(e,g,b):r?t.setAttribute(e,g,b):e.setAttribute(g,b),a++}}return a}function Y(t){return 3===t||4===t||6===t}function oe(t){return 64===t.charCodeAt(0)}function se(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const a=e[r];"number"==typeof a?n=a:0===n||pe(t,n,a,null,-1===n||2===n?e[++r]:null)}}return t}function pe(t,e,n,r,a){let u=0,g=t.length;if(-1===e)g=-1;else for(;u<t.length;){const b=t[u++];if("number"==typeof b){if(b===e){g=-1;break}if(b>e){g=u-1;break}}}for(;u<t.length;){const b=t[u];if("number"==typeof b)break;if(b===n){if(null===r)return void(null!==a&&(t[u+1]=a));if(r===t[u+1])return void(t[u+2]=a)}u++,null!==r&&u++,null!==a&&u++}-1!==g&&(t.splice(g,0,e),u=g+1),t.splice(u++,0,n),null!==r&&t.splice(u++,0,r),null!==a&&t.splice(u++,0,a)}function ie(t){return t!==d}function ae(t){return 32767&t}function _e(t,e){let n=function(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let we=!0;function ce(t){const e=we;return we=t,e}let Te=0;function ct(t,e){const n=ut(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,ht(r.data,t),ht(e,null),ht(r.blueprint,null));const a=tt(t,e),u=t.injectorIndex;if(ie(a)){const g=ae(a),b=_e(a,e),D=b[1].data;for(let I=0;I<8;I++)e[u+I]=b[g+I]|D[g+I]}return e[u+8]=a,u}function ht(t,e){t.push(0,0,0,0,0,0,0,0,e)}function ut(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function tt(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,a=e;for(;null!==a;){const u=a[1],g=u.type;if(r=2===g?u.declTNode:1===g?a[6]:null,null===r)return d;if(n++,a=a[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return d}function ft(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(zi)&&(r=n[zi]),null==r&&(r=n[zi]=Te++);const a=255&r;e.data[t+(a>>5)]|=1<<a}(t,e,n)}function kt(t,e,n){if(n&wt.Optional)return t;it(e,"NodeInjector")}function Mi(t,e,n,r){if(n&wt.Optional&&void 0===r&&(r=null),0==(n&(wt.Self|wt.Host))){const a=t[9],u=vo(void 0);try{return a?a.get(e,r,n&wt.Optional):Is(e,r,n&wt.Optional)}finally{vo(u)}}return kt(r,e,n)}function ai(t,e,n,r=wt.Default,a){if(null!==t){const u=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(zi)?t[zi]:void 0;return"number"==typeof e?e>=0?255&e:an:e}(n);if("function"==typeof u){if(!Ac(e,t,r))return r&wt.Host?kt(a,n,r):Mi(e,n,r,a);try{const g=u(r);if(null!=g||r&wt.Optional)return g;it(n)}finally{kc()}}else if("number"==typeof u){let g=null,b=ut(t,e),D=d,I=r&wt.Host?e[16][6]:null;for((-1===b||r&wt.SkipSelf)&&(D=-1===b?tt(t,e):e[b+8],D!==d&&Vs(r,!1)?(g=e[1],b=ae(D),e=_e(D,e)):b=-1);-1!==b;){const N=e[1];if(Eo(u,b,N.data)){const Z=bi(b,e,n,g,r,I);if(Z!==Zt)return Z}D=e[b+8],D!==d&&Vs(r,e[1].data[b+8]===I)&&Eo(u,b,e)?(g=N,b=ae(D),e=_e(D,e)):b=-1}}}return Mi(e,n,r,a)}const Zt={};function an(){return new Bo(P(),c())}function bi(t,e,n,r,a,u){const g=e[1],b=g.data[t+8],N=function(t,e,n,r,a){const u=t.providerIndexes,g=e.data,b=1048575&u,D=t.directiveStart,N=u>>20,K=a?b+N:t.directiveEnd;for(let te=r?b:b+N;te<K;te++){const he=g[te];if(te<D&&n===he||te>=D&&he.type===n)return te}if(a){const te=g[D];if(te&&Di(te)&&te.type===n)return D}return null}(b,g,n,null==r?jl(b)&&we:r!=g&&0!=(3&b.type),a&wt.Host&&u===b);return null!==N?zo(e,g,N,b):Zt}function zo(t,e,n,r){let a=t[n];const u=e.data;if(function(t){return t instanceof _}(a)){const g=a;g.resolving&&function(t,e){throw new re("200",`Circular dependency in DI detected for ${t}`)}(Ee(u[n]));const b=ce(g.canSeeViewProviders);g.resolving=!0;const D=g.injectImpl?vo(g.injectImpl):null;Ac(t,r,wt.Default);try{a=t[n]=g.factory(void 0,u,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:a,ngDoCheck:u}=e.type.prototype;if(r){const g=hr(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,g),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,g)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,a),u&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,u),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,u))}(n,u[n],e)}finally{null!==D&&vo(D),ce(b),g.resolving=!1,kc()}}return a}function Eo(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Vs(t,e){return!(t&wt.Self||t&wt.Host&&e)}class Bo{constructor(e,n){this._tNode=e,this._lView=n}get(e,n){return ai(this._tNode,this._lView,e,void 0,n)}}function ui(t){return $(t)?()=>{const e=ui(Q(t));return e&&e()}:ms(t)}function En(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let a=0;for(;a<r;){const u=n[a];if(Y(u))break;if(0===u)a+=2;else if("number"==typeof u)for(a++;a<r&&"string"==typeof n[a];)a++;else{if(u===e)return n[a+1];a+=2}}}return null}(P(),t)}const gr="__parameters__",jn="__prop__metadata__";function Vo(t){return function(...n){if(t){const r=t(...n);for(const a in r)this[a]=r[a]}}}function ro(t,e,n){return ur(()=>{const r=Vo(e);function a(...u){if(this instanceof a)return r.apply(this,u),this;const g=new a(...u);return b.annotation=g,b;function b(D,I,N){const Z=D.hasOwnProperty(gr)?D[gr]:Object.defineProperty(D,gr,{value:[]})[gr];for(;Z.length<=N;)Z.push(null);return(Z[N]=Z[N]||[]).push(g),D}}return n&&(a.prototype=Object.create(n.prototype)),a.prototype.ngMetadataName=t,a.annotationCls=a,a})}function Oc(t,e,n,r){return ur(()=>{const a=Vo(e);function u(...g){if(this instanceof u)return a.apply(this,g),this;const b=new u(...g);return function(I,N){const Z=I.constructor,K=Z.hasOwnProperty(jn)?Z[jn]:Object.defineProperty(Z,jn,{value:{}})[jn];K[N]=K.hasOwnProperty(N)&&K[N]||[],K[N].unshift(b),r&&r(I,N,...g)}}return n&&(u.prototype=Object.create(n.prototype)),u.prototype.ngMetadataName=t,u.annotationCls=u,u})}class Yt{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=mt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const th=new Yt("AnalyzeForEntryComponents"),bu=Function;function Us(t,e){t.forEach(n=>Array.isArray(n)?Us(n,e):e(n))}function Rh(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Nc(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Ir(t,e,n){let r=Ca(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let a=t.length;if(a==e)t.push(n,r);else if(1===a)t.push(r,t[0]),t[0]=n;else{for(a--,t.push(t[a-1],t[a]);a>e;)t[a]=t[a-2],a--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function Ja(t,e){const n=Ca(t,e);if(n>=0)return t[1|n]}function Ca(t,e){return function(t,e,n){let r=0,a=t.length>>n;for(;a!==r;){const u=r+(a-r>>1),g=t[u<<n];if(e===g)return u<<n;g>e?a=u:r=u+1}return~(a<<n)}(t,e,1)}const wu={},Vd="__NG_DI_FLAG__",Ea="ngTempTokenPath",Ud=/\n/gm,jd="__source",$d=Ft({provide:String,useValue:Ft});let Nh;function Vc(t){const e=Nh;return Nh=t,e}function Jy(t,e=wt.Default){if(void 0===Nh)throw new Error("inject() must be called from an injection context");return null===Nh?Is(t,void 0,e):Nh.get(t,e&wt.Optional?null:void 0,e)}function pt(t,e=wt.Default){return(cn||Jy)(Q(t),e)}function Ta(t){const e=[];for(let n=0;n<t.length;n++){const r=Q(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let a,u=wt.Default;for(let g=0;g<r.length;g++){const b=r[g],D=ev(b);"number"==typeof D?-1===D?a=b.token:u|=D:a=b}e.push(pt(a,u))}else e.push(pt(r))}return e}function nh(t,e){return t[Vd]=e,t.prototype[Vd]=e,t}function ev(t){return t[Vd]}function Eu(t,e,n,r){const a=t[Ea];throw e[jd]&&a.unshift(e[jd]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let a=Bt(e);if(Array.isArray(e))a=e.map(Bt).join(" -> ");else if("object"==typeof e){let u=[];for(let g in e)if(e.hasOwnProperty(g)){let b=e[g];u.push(g+":"+("string"==typeof b?JSON.stringify(b):Bt(b)))}a=`{${u.join(", ")}}`}return`${n}${r?"("+r+")":""}[${a}]: ${t.replace(Ud,"\n  ")}`}("\n"+t.message,a,n,r),t.ngTokenPath=a,t[Ea]=null,t}const Tu=nh(ro("Inject",t=>({token:t})),-1),vs=nh(ro("Optional"),8),_r=nh(ro("SkipSelf"),4);class tc{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function $s(t){return t instanceof tc?t.changingThisBreaksApplicationSecurity:t}function Dl(t,e){const n=function(t){return t instanceof tc&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}const fv=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,pv=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var wi=(()=>((wi=wi||{})[wi.NONE=0]="NONE",wi[wi.HTML=1]="HTML",wi[wi.STYLE=2]="STYLE",wi[wi.SCRIPT=3]="SCRIPT",wi[wi.URL=4]="URL",wi[wi.RESOURCE_URL=5]="RESOURCE_URL",wi))();function rf(t){const e=function(){const t=c();return t&&t[12]}();return e?e.sanitize(wi.URL,t)||"":Dl(t,"URL")?$s(t):function(t){return(t=String(t)).match(fv)||t.match(pv)?t:"unsafe:"+t}(ve(t))}const Ip="__ngContext__";function oo(t,e){t[Ip]=e}function Pp(t){const e=function(t){return t[Ip]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function sf(t){return t.ngOriginalError}function Mv(t,...e){t.error(...e)}class $c{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),r=this._findContext(e),a=function(t){return t&&t.ngErrorLogger||Mv}(e);a(this._console,"ERROR",e),n&&a(this._console,"ORIGINAL ERROR",n),r&&a(this._console,"ERROR CONTEXT",r)}_findContext(e){return e?function(t){return t.ngDebugContext}(e)||this._findContext(sf(e)):null}_findOriginalError(e){let n=e&&sf(e);for(;n&&sf(n);)n=sf(n);return n||null}}const Fp=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Un))();function ch(t){return t.ownerDocument.defaultView}function tl(t){return t instanceof Function?t():t}var Hs=(()=>((Hs=Hs||{})[Hs.Important=1]="Important",Hs[Hs.DashCase=2]="DashCase",Hs))();function Vp(t,e){return undefined(t,e)}function Yh(t){const e=t[3];return wo(e)?e[3]:e}function uh(t){return Up(t[13])}function Gc(t){return Up(t[4])}function Up(t){for(;null!==t&&!wo(t);)t=t[4];return t}function hh(t,e,n,r,a){if(null!=r){let u,g=!1;wo(r)?u=r:bo(r)&&(g=!0,r=r[0]);const b=Oi(r);0===t&&null!==n?null==a?Wp(e,n,b):Pu(e,n,b,a||null,!0):1===t&&null!==n?Pu(e,n,b,a||null,!0):2===t?function(t,e,n){const r=Qh(t,e);r&&function(t,e,n,r){vi(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,b,g):3===t&&e.destroyNode(b),null!=u&&function(t,e,n,r,a){const u=n[7];u!==Oi(n)&&hh(e,t,r,u,a);for(let b=10;b<n.length;b++){const D=n[b];qc(D[1],D,t,e,r,u)}}(e,t,u,n,a)}}function cf(t,e,n){return vi(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Gp(t,e){const n=t[9],r=n.indexOf(e),a=e[3];1024&e[2]&&(e[2]&=-1025,Cl(a,-1)),n.splice(r,1)}function hf(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const a=r[17];null!==a&&a!==t&&Gp(a,r),e>0&&(t[n-1][4]=r[4]);const u=Nc(t,10+e);!function(t,e){qc(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const g=u[19];null!==g&&g.detachView(u[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Vg(t,e){if(!(256&e[2])){const n=e[11];vi(n)&&n.destroyNode&&qc(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return df(t[1],t);for(;e;){let n=null;if(bo(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)bo(e)&&df(e[1],e),e=e[3];null===e&&(e=t),bo(e)&&df(e[1],e),n=e&&e[4]}e=n}}(e)}}function df(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const a=e[n[r]];if(!(a instanceof _)){const u=n[r+1];if(Array.isArray(u))for(let g=0;g<u.length;g+=2){const b=a[u[g]],D=u[g+1];try{D.call(b)}finally{}}else try{u.call(a)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let a=-1;if(null!==n)for(let u=0;u<n.length-1;u+=2)if("string"==typeof n[u]){const g=n[u+1],b="function"==typeof g?g(e):Oi(e[g]),D=r[a=n[u+2]],I=n[u+3];"boolean"==typeof I?b.removeEventListener(n[u],D,I):I>=0?r[a=I]():r[a=-I].unsubscribe(),u+=2}else{const g=r[a=n[u+1]];n[u].call(g)}if(null!==r){for(let u=a+1;u<r.length;u++)r[u]();e[7]=null}}(t,e),1===e[1].type&&vi(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&wo(e[3])){n!==e[3]&&Gp(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function ff(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const a=t.data[r.directiveStart].encapsulation;if(a===zn.None||a===zn.Emulated)return null}return Ar(r,n)}(t,e.parent,n)}function Pu(t,e,n,r,a){vi(t)?t.insertBefore(e,n,r,a):e.insertBefore(n,r,a)}function Wp(t,e,n){vi(t)?t.appendChild(e,n):e.appendChild(n)}function ic(t,e,n,r,a){null!==r?Pu(t,e,n,r,a):Wp(t,e,n)}function Qh(t,e){return vi(t)?t.parentNode(e):e.parentNode}let Gg=function(t,e,n){return 40&t.type?Ar(t,n):null};function Zc(t,e,n,r){const a=ff(t,r,e),u=e[11],b=function(t,e,n){return Gg(t,e,n)}(r.parent||e[6],r,e);if(null!=a)if(Array.isArray(n))for(let D=0;D<n.length;D++)ic(u,a,n[D],b,!1);else ic(u,a,n,b,!1)}function ed(t,e){if(null!==e){const n=e.type;if(3&n)return Ar(e,t);if(4&n)return td(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return ed(t,r);{const a=t[e.index];return wo(a)?td(-1,a):Oi(a)}}if(32&n)return Vp(e,t)()||Oi(t[e.index]);{const r=Yp(t,e);return null!==r?Array.isArray(r)?r[0]:ed(Yh(t[16]),r):ed(t,e.next)}}return null}function Yp(t,e){return null!==e?t[16][6].projection[e.projection]:null}function td(t,e){const n=10+t+1;if(n<e.length){const r=e[n],a=r[1].firstChild;if(null!==a)return ed(r,a)}return e[7]}function mf(t,e,n,r,a,u,g){for(;null!=n;){const b=r[n.index],D=n.type;if(g&&0===e&&(b&&oo(Oi(b),r),n.flags|=4),64!=(64&n.flags))if(8&D)mf(t,e,n.child,r,a,u,!1),hh(e,t,a,b,u);else if(32&D){const I=Vp(n,r);let N;for(;N=I();)hh(e,t,a,N,u);hh(e,t,a,b,u)}else 16&D?nd(t,e,r,n,a,u):hh(e,t,a,b,u);n=g?n.projectionNext:n.next}}function qc(t,e,n,r,a,u){mf(n,r,t.firstChild,e,a,u,!1)}function nd(t,e,n,r,a,u){const g=n[16],D=g[6].projection[r.projection];if(Array.isArray(D))for(let I=0;I<D.length;I++)hh(e,t,a,D[I],u);else mf(t,e,D,g[3],a,u,!0)}function qg(t,e,n){vi(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Jp(t,e,n){vi(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Wg(t,e,n){let r=t.length;for(;;){const a=t.indexOf(e,n);if(-1===a)return a;if(0===a||t.charCodeAt(a-1)<=32){const u=e.length;if(a+u===r||t.charCodeAt(a+u)<=32)return a}n=a+1}}const Ru="ng-template";function Qp(t,e,n){let r=0;for(;r<t.length;){let a=t[r++];if(n&&"class"===a){if(a=t[r],-1!==Wg(a.toLowerCase(),e,0))return!0}else if(1===a){for(;r<t.length&&"string"==typeof(a=t[r++]);)if(a.toLowerCase()===e)return!0;return!1}}return!1}function Xg(t){return 4===t.type&&t.value!==Ru}function Kg(t,e,n){return e===(4!==t.type||n?t.value:Ru)}function Ov(t,e,n){let r=4;const a=t.attrs||[],u=function(t){for(let e=0;e<t.length;e++)if(Y(t[e]))return e;return t.length}(a);let g=!1;for(let b=0;b<e.length;b++){const D=e[b];if("number"!=typeof D){if(!g)if(4&r){if(r=2|1&r,""!==D&&!Kg(t,D,n)||""===D&&1===e.length){if(Zs(r))return!1;g=!0}}else{const I=8&r?D:e[++b];if(8&r&&null!==t.attrs){if(!Qp(t.attrs,I,n)){if(Zs(r))return!1;g=!0}continue}const Z=Fv(8&r?"class":D,a,Xg(t),n);if(-1===Z){if(Zs(r))return!1;g=!0;continue}if(""!==I){let K;K=Z>u?"":a[Z+1].toLowerCase();const te=8&r?K:null;if(te&&-1!==Wg(te,I,0)||2&r&&I!==K){if(Zs(r))return!1;g=!0}}}}else{if(!g&&!Zs(r)&&!Zs(D))return!1;if(g&&Zs(D))continue;g=!1,r=D|1&r}}return Zs(r)||g}function Zs(t){return 0==(1&t)}function Fv(t,e,n,r){if(null===e)return-1;let a=0;if(r||!n){let u=!1;for(;a<e.length;){const g=e[a];if(g===t)return a;if(3===g||6===g)u=!0;else{if(1===g||2===g){let b=e[++a];for(;"string"==typeof b;)b=e[++a];continue}if(4===g)break;if(0===g){a+=4;continue}}a+=u?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function rc(t,e,n=!1){for(let r=0;r<e.length;r++)if(Ov(t,e[r],n))return!0;return!1}function Qg(t,e){return t?":not("+e.trim()+")":e}function Nv(t){let e=t[0],n=1,r=2,a="",u=!1;for(;n<t.length;){let g=t[n];if("string"==typeof g)if(2&r){const b=t[++n];a+="["+g+(b.length>0?'="'+b+'"':"")+"]"}else 8&r?a+="."+g:4&r&&(a+=" "+g);else""!==a&&!Zs(g)&&(e+=Qg(u,a),a=""),r=g,u=u||!Zs(r);n++}return""!==a&&(e+=Qg(u,a)),e}const Xt={};function oi(t){vf(v(),c(),mr()+t,Tt())}function vf(t,e,n,r){if(!r)if(3==(3&e[2])){const u=t.preOrderCheckHooks;null!==u&&vu(e,u,n)}else{const u=t.preOrderHooks;null!==u&&xu(e,u,0,n)}Ya(n)}function fh(t,e){return t<<17|e<<2}function ao(t){return t>>17&32767}function xf(t){return 2|t}function Sa(t){return(131068&t)>>2}function nm(t,e){return-131069&t|e<<2}function im(t){return 1|t}function sc(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const a=n[r],u=n[r+1];if(-1!==u){const g=t.data[u];xa(a),g.contentQueries(2,e[u],u)}}}function ad(t,e,n,r,a,u,g,b,D,I){const N=e.blueprint.slice();return N[0]=a,N[2]=140|r,Dc(N),N[3]=N[15]=t,N[8]=n,N[10]=g||t&&t[10],N[11]=b||t&&t[11],N[12]=D||t&&t[12]||null,N[9]=I||t&&t[9]||null,N[6]=u,N[16]=2==e.type?t[16]:N,N}function nl(t,e,n,r,a){let u=t.data[e];if(null===u)u=function(t,e,n,r,a){const u=V(),g=Le(),D=t.data[e]=function(t,e,n,r,a,u){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:a,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?u:u&&u.parent,n,e,r,a);return null===t.firstChild&&(t.firstChild=D),null!==u&&(g?null==u.child&&null!==D.parent&&(u.child=D):null===u.next&&(u.next=D)),D}(t,e,n,r,a),Ot.lFrame.inI18n&&(u.flags|=64);else if(64&u.type){u.type=n,u.value=r,u.attrs=a;const g=function(){const t=Ot.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();u.injectorIndex=null===g?-1:g.injectorIndex}return me(u,!0),u}function Xc(t,e,n,r){if(0===n)return-1;const a=e.length;for(let u=0;u<n;u++)e.push(r),t.blueprint.push(r),t.data.push(null);return a}function xs(t,e,n){Xa(e);try{const r=t.viewQuery;null!==r&&Ii(1,r,n);const a=t.template;null!==a&&Ma(t,e,a,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&sc(t,e),t.staticViewQueries&&Ii(2,t.viewQuery,n);const u=t.components;null!==u&&function(t,e){for(let n=0;n<e.length;n++)Bn(t,e[n])}(e,u)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,yu()}}function Kc(t,e,n,r){const a=e[2];if(256==(256&a))return;Xa(e);const u=Tt();try{Dc(e),function(t){Ot.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Ma(t,e,n,2,r);const g=3==(3&a);if(!u)if(g){const I=t.preOrderCheckHooks;null!==I&&vu(e,I,null)}else{const I=t.preOrderHooks;null!==I&&xu(e,I,0,null),Lc(e,0)}if(function(t){for(let e=uh(t);null!==e;e=Gc(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const a=n[r],u=a[3];0==(1024&a[2])&&Cl(u,1),a[2]|=1024}}}(e),function(t){for(let e=uh(t);null!==e;e=Gc(e))for(let n=10;n<e.length;n++){const r=e[n],a=r[1];Za(r)&&Kc(a,r,a.template,r[8])}}(e),null!==t.contentQueries&&sc(t,e),!u)if(g){const I=t.contentCheckHooks;null!==I&&vu(e,I)}else{const I=t.contentHooks;null!==I&&xu(e,I,1),Lc(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const a=n[r];if(a<0)Ya(~a);else{const u=a,g=n[++r],b=n[++r];Qu(g,u),b(2,e[u])}}}finally{Ya(-1)}}(t,e);const b=t.components;null!==b&&function(t,e){for(let n=0;n<e.length;n++)At(t,e[n])}(e,b);const D=t.viewQuery;if(null!==D&&Ii(2,D,r),!u)if(g){const I=t.viewCheckHooks;null!==I&&vu(e,I)}else{const I=t.viewHooks;null!==I&&xu(e,I,2),Lc(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),u||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Cl(e[3],-1))}finally{yu()}}function fm(t,e,n,r){const a=e[10],u=!Tt(),g=function(t){return 4==(4&t[2])}(e);try{u&&!g&&a.begin&&a.begin(),g&&xs(t,e,r),Kc(t,e,n,r)}finally{u&&!g&&a.end&&a.end()}}function Ma(t,e,n,r,a){const u=mr(),g=2&r;try{Ya(-1),g&&e.length>20&&vf(t,e,20,Tt()),n(r,a)}finally{Ya(u)}}function Df(t,e,n){!es()||(function(t,e,n,r){const a=n.directiveStart,u=n.directiveEnd;t.firstCreatePass||ct(n,e),oo(r,e);const g=n.initialInputs;for(let b=a;b<u;b++){const D=t.data[b],I=Di(D);I&&Oe(e,n,D);const N=zo(e,t,b,n);oo(N,e),null!==g&&nt(0,b-a,N,D,0,g),I&&(ir(n.index,e)[8]=N)}}(t,e,n,Ar(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,a=n.directiveEnd,g=n.index,b=Ot.lFrame.currentDirectiveIndex;try{Ya(g);for(let D=r;D<a;D++){const I=t.data[D],N=e[D];Jl(D),(null!==I.hostBindings||0!==I.hostVars||null!==I.hostAttrs)&&ne(I,N)}}finally{Ya(-1),Jl(b)}}(t,e,n))}function Sf(t,e,n=Ar){const r=e.localNames;if(null!==r){let a=e.index+1;for(let u=0;u<r.length;u+=2){const g=r[u+1],b=-1===g?n(e,t):t[g];t[a++]=b}}}function cd(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=ud(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function ud(t,e,n,r,a,u,g,b,D,I){const N=20+r,Z=N+a,K=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Xt);return n}(N,Z),te="function"==typeof I?I():I;return K[1]={type:t,blueprint:K,template:n,queries:null,viewQuery:b,declTNode:e,data:K.slice().fill(null,N),bindingStartIndex:N,expandoStartIndex:Z,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:D,consts:te,incompleteFirstPass:!1}}function pm(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const a=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,a):n[r]=[e,a]}return n}function l(t,e,n,r,a,u,g,b){const D=Ar(e,n);let N,I=e.inputs;!b&&null!=I&&(N=I[r])?(Kn(t,n,N,r,a),jl(e)&&function(t,e){const n=ir(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),a=null!=g?g(a,e.value||"",r):a,vi(u)?u.setProperty(D,r,a):oe(r)||(D.setProperty?D.setProperty(r,a):D[r]=a))}function R(t,e,n,r){let a=!1;if(es()){const u=function(t,e,n){const r=t.directiveRegistry;let a=null;if(r)for(let u=0;u<r.length;u++){const g=r[u];rc(n,g.selectors,!1)&&(a||(a=[]),ft(ct(n,e),t,g.type),Di(g)?(ye(t,n),a.unshift(g)):a.push(g))}return a}(t,e,n),g=null===r?null:{"":-1};if(null!==u){a=!0,Pe(n,t.data.length,u.length);for(let N=0;N<u.length;N++){const Z=u[N];Z.providersResolver&&Z.providersResolver(Z)}let b=!1,D=!1,I=Xc(t,e,u.length,null);for(let N=0;N<u.length;N++){const Z=u[N];n.mergedAttrs=se(n.mergedAttrs,Z.hostAttrs),ke(t,n,e,I,Z),Ie(I,Z,g),null!==Z.contentQueries&&(n.flags|=8),(null!==Z.hostBindings||null!==Z.hostAttrs||0!==Z.hostVars)&&(n.flags|=128);const K=Z.type.prototype;!b&&(K.ngOnChanges||K.ngOnInit||K.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),b=!0),!D&&(K.ngOnChanges||K.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),D=!0),I++}!function(t,e){const r=e.directiveEnd,a=t.data,u=e.attrs,g=[];let b=null,D=null;for(let I=e.directiveStart;I<r;I++){const N=a[I],Z=N.inputs,K=null===u||Xg(e)?null:rt(Z,u);g.push(K),b=pm(Z,I,b),D=pm(N.outputs,I,D)}null!==b&&(b.hasOwnProperty("class")&&(e.flags|=16),b.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=g,e.inputs=b,e.outputs=D}(t,n)}g&&function(t,e,n){if(e){const r=t.localNames=[];for(let a=0;a<e.length;a+=2){const u=n[e[a+1]];if(null==u)throw new re("301",`Export of name '${e[a+1]}' not found!`);r.push(e[a],u)}}}(n,r,g)}return n.mergedAttrs=se(n.mergedAttrs,n.attrs),a}function F(t,e,n,r,a,u){const g=u.hostBindings;if(g){let b=t.hostBindingOpCodes;null===b&&(b=t.hostBindingOpCodes=[]);const D=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(b)!=D&&b.push(D),b.push(r,a,g)}}function ne(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function ye(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Ie(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Di(e)&&(n[""]=t)}}function Pe(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function ke(t,e,n,r,a){t.data[r]=a;const u=a.factory||(a.factory=ms(a.type)),g=new _(u,Di(a),null);t.blueprint[r]=g,n[r]=g,F(t,e,0,r,Xc(t,n,a.hostVars,Xt),a)}function Oe(t,e,n){const r=Ar(e,t),a=cd(n),u=t[10],g=hn(t,ad(t,a,null,n.onPush?64:16,r,e,u,u.createRenderer(r,n),null,null));t[e.index]=g}function Ue(t,e,n,r,a,u){const g=Ar(t,e);!function(t,e,n,r,a,u,g){if(null==u)vi(t)?t.removeAttribute(e,a,n):e.removeAttribute(a);else{const b=null==g?ve(u):g(u,r||"",a);vi(t)?t.setAttribute(e,a,b,n):n?e.setAttributeNS(n,a,b):e.setAttribute(a,b)}}(e[11],g,u,t.value,n,r,a)}function nt(t,e,n,r,a,u){const g=u[e];if(null!==g){const b=r.setInput;for(let D=0;D<g.length;){const I=g[D++],N=g[D++],Z=g[D++];null!==b?r.setInput(n,Z,I,N):n[N]=Z}}}function rt(t,e){let n=null,r=0;for(;r<e.length;){const a=e[r];if(0!==a)if(5!==a){if("number"==typeof a)break;t.hasOwnProperty(a)&&(null===n&&(n=[]),n.push(a,t[a],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Ke(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function At(t,e){const n=ir(e,t);if(Za(n)){const r=n[1];80&n[2]?Kc(r,n,r.template,n[8]):n[5]>0&&dt(n)}}function dt(t){for(let r=uh(t);null!==r;r=Gc(r))for(let a=10;a<r.length;a++){const u=r[a];if(1024&u[2]){const g=u[1];Kc(g,u,g.template,u[8])}else u[5]>0&&dt(u)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const a=ir(n[r],t);Za(a)&&a[5]>0&&dt(a)}}function Bn(t,e){const n=ir(e,t),r=n[1];(function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),xs(r,n,n[8])}function hn(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function bt(t){for(;t;){t[2]|=64;const e=Yh(t);if(pl(t)&&!e)return t;t=e}return null}function yr(t,e,n){const r=e[10];r.begin&&r.begin();try{Kc(t,e,t.template,n)}catch(a){throw vr(e,a),a}finally{r.end&&r.end()}}function Ai(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Pp(n),a=r[1];fm(a,r,a.template,n)}}(t[8])}function Ii(t,e,n){xa(0),e(t,n)}const Xn=(()=>Promise.resolve(null))();function Lr(t){return t[7]||(t[7]=[])}function Fi(t){return t.cleanup||(t.cleanup=[])}function vr(t,e){const n=t[9],r=n?n.get($c,null):null;r&&r.handleError(e)}function Kn(t,e,n,r,a){for(let u=0;u<n.length;){const g=n[u++],b=n[u++],D=e[g],I=t.data[g];null!==I.setInput?I.setInput(D,a,r,b):D[b]=a}}function Ui(t,e,n){const r=Ha(e,t);!function(t,e,n){vi(t)?t.setValue(e,n):e.textContent=n}(t[11],r,n)}function hi(t,e,n){let r=n?t.styles:null,a=n?t.classes:null,u=0;if(null!==e)for(let g=0;g<e.length;g++){const b=e[g];"number"==typeof b?u=b:1==u?a=Tr(a,b):2==u&&(r=Tr(r,b+": "+e[++g]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=a:t.classesWithoutHost=a}const $i=new Yt("INJECTOR",-1);class Hi{get(e,n=wu){if(n===wu){const r=new Error(`NullInjectorError: No provider for ${Bt(e)}!`);throw r.name="NullInjectorError",r}return n}}const Tn=new Yt("Set Injector scope."),Fr={},bs={};let qs;function Ws(){return void 0===qs&&(qs=new Hi),qs}function rl(t,e=null,n=null,r){return new To(t,n,e||Ws(),r)}class To{constructor(e,n,r,a=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const u=[];n&&Us(n,b=>this.processProvider(b,e,n)),Us([e],b=>this.processInjectorType(b,[],u)),this.records.set($i,Jc(void 0,this));const g=this.records.get(Tn);this.scope=null!=g?g.value:null,this.source=a||("object"==typeof e?null:Bt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=wu,r=wt.Default){this.assertNotDestroyed();const a=Vc(this),u=vo(void 0);try{if(!(r&wt.SkipSelf)){let b=this.records.get(e);if(void 0===b){const D=function(t){return"function"==typeof t||"object"==typeof t&&t instanceof Yt}(e)&&fn(e);b=D&&this.injectableDefInScope(D)?Jc(Aa(e),Fr):null,this.records.set(e,b)}if(null!=b)return this.hydrate(e,b)}return(r&wt.Self?Ws():this.parent).get(e,n=r&wt.Optional&&n===wu?null:n)}catch(g){if("NullInjectorError"===g.name){if((g[Ea]=g[Ea]||[]).unshift(Bt(e)),a)throw g;return Eu(g,e,"R3InjectorError",this.source)}throw g}finally{vo(u),Vc(a)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,a)=>e.push(Bt(a))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,n,r){if(!(e=Q(e)))return!1;let a=ca(e);const u=null==a&&e.ngModule||void 0,g=void 0===u?e:u,b=-1!==r.indexOf(g);if(void 0!==u&&(a=ca(u)),null==a)return!1;if(null!=a.imports&&!b){let N;r.push(g);try{Us(a.imports,Z=>{this.processInjectorType(Z,n,r)&&(void 0===N&&(N=[]),N.push(Z))})}finally{}if(void 0!==N)for(let Z=0;Z<N.length;Z++){const{ngModule:K,providers:te}=N[Z];Us(te,he=>this.processProvider(he,K,te||bn))}}this.injectorDefTypes.add(g);const D=ms(g)||(()=>new g);this.records.set(g,Jc(D,Fr));const I=a.providers;if(null!=I&&!b){const N=e;Us(I,Z=>this.processProvider(Z,N,I))}return void 0!==u&&void 0!==e.providers}processProvider(e,n,r){let a=mh(e=Q(e))?e:Q(e&&e.provide);const u=function(t,e,n){return Af(t)?Jc(void 0,t.useValue):Jc(function(t,e,n){let r;if(mh(t)){const a=Q(t);return ms(a)||Aa(a)}if(Af(t))r=()=>Q(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Ta(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>pt(Q(t.useExisting));else{const a=Q(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return ms(a)||Aa(a);r=()=>new a(...Ta(t.deps))}return r}(t),Fr)}(e);if(mh(e)||!0!==e.multi)this.records.get(a);else{let g=this.records.get(a);g||(g=Jc(void 0,Fr,!0),g.factory=()=>Ta(g.multi),this.records.set(a,g)),a=e,g.multi.push(e)}this.records.set(a,u)}hydrate(e,n){return n.value===Fr&&(n.value=bs,n.value=n.factory()),"object"==typeof n.value&&n.value&&function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=Q(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function Aa(t){const e=fn(t),n=null!==e?e.factory:ms(t);if(null!==n)return n;if(t instanceof Yt)throw new Error(`Token ${Bt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const r=function(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?");throw new Error(`Can't resolve all parameters for ${Bt(t)}: (${r.join(", ")}).`)}const n=function(t){const e=t&&(t[Br]||t[$t]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Jc(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Af(t){return null!==t&&"object"==typeof t&&$d in t}function mh(t){return"function"==typeof t}const f1=function(t,e,n){return function(t,e=null,n=null,r){const a=rl(t,e,n,r);return a._resolveInjectorDefTypes(),a}({name:n},e,t,n)};let fi=(()=>{class t{static create(n,r){return Array.isArray(n)?f1(n,r,""):f1(n.providers,n.parent,n.name||"")}}return t.THROW_IF_NOT_FOUND=wu,t.NULL=new Hi,t.\u0275prov=mt({token:t,providedIn:"any",factory:()=>pt($i)}),t.__NG_ELEMENT_ID__=-1,t})();function RM(t,e){ba(Pp(t)[1],P())}function Yi(t){let e=function(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let a;if(Di(t))a=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");a=e.\u0275dir}if(a){if(n){r.push(a);const g=t;g.inputs=Jv(t.inputs),g.declaredInputs=Jv(t.declaredInputs),g.outputs=Jv(t.outputs);const b=a.hostBindings;b&&NM(t,b);const D=a.viewQuery,I=a.contentQueries;if(D&&OM(t,D),I&&FM(t,I),ls(t.inputs,a.inputs),ls(t.declaredInputs,a.declaredInputs),ls(t.outputs,a.outputs),Di(a)&&a.data.animation){const N=t.data;N.animation=(N.animation||[]).concat(a.data.animation)}}const u=a.features;if(u)for(let g=0;g<u.length;g++){const b=u[g];b&&b.ngInherit&&b(t),b===Yi&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const a=t[r];a.hostVars=e+=a.hostVars,a.hostAttrs=se(a.hostAttrs,n=se(n,a.hostAttrs))}}(r)}function Jv(t){return t===On?{}:t===bn?[]:t}function OM(t,e){const n=t.viewQuery;t.viewQuery=n?(r,a)=>{e(r,a),n(r,a)}:e}function FM(t,e){const n=t.contentQueries;t.contentQueries=n?(r,a,u)=>{e(r,a,u),n(r,a,u)}:e}function NM(t,e){const n=t.hostBindings;t.hostBindings=n?(r,a)=>{e(r,a),n(r,a)}:e}let m_=null;function If(){if(!m_){const t=Un.Symbol;if(t&&t.iterator)m_=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(m_=r)}}}return m_}function ym(t){return!!Qv(t)&&(Array.isArray(t)||!(t instanceof Map)&&If()in t)}function Qv(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Es(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function tu(t,e,n,r){const a=c();return Es(a,no(),e)&&(v(),Ue(Si(),a,t,e,n,r)),tu}function kf(t,e,n,r){return Es(t,no(),n)?e+ve(n)+r:Xt}function e0(t,e,n,r,a,u,g,b){const D=c(),I=v(),N=t+20,Z=I.firstCreatePass?function(t,e,n,r,a,u,g,b,D){const I=e.consts,N=nl(e,t,4,g||null,Fo(I,b));R(e,n,N,Fo(I,D)),ba(e,N);const Z=N.tViews=ud(2,N,r,a,u,e.directiveRegistry,e.pipeRegistry,null,e.schemas,I);return null!==e.queries&&(e.queries.template(e,N),Z.queries=e.queries.embeddedTView(N)),N}(N,I,D,e,n,r,a,u,g):I.data[N];me(Z,!1);const K=D[11].createComment("");Zc(I,D,K,Z),oo(K,D),hn(D,D[N]=Ke(K,D,K,Z)),$l(Z)&&Df(I,D,Z),null!=g&&Sf(D,Z,b)}function Je(t,e=wt.Default){const n=c();return null===n?pt(t,e):ai(P(),n,Q(t),e)}function Do(t,e,n){const r=c();return Es(r,no(),e)&&l(v(),Si(),r,t,e,r[11],n,!1),Do}function o0(t,e,n,r,a){const g=a?"class":"style";Kn(t,n,e.inputs[g],g,r)}function H(t,e,n,r){const a=c(),u=v(),g=20+t,b=a[11],D=a[g]=cf(b,e,Ot.lFrame.currentNamespace),I=u.firstCreatePass?function(t,e,n,r,a,u,g){const b=e.consts,I=nl(e,t,2,a,Fo(b,u));return R(e,n,I,Fo(b,g)),null!==I.attrs&&hi(I,I.attrs,!1),null!==I.mergedAttrs&&hi(I,I.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,I),I}(g,u,a,0,e,n,r):u.data[g];me(I,!0);const N=I.mergedAttrs;null!==N&&X(b,D,N);const Z=I.classes;null!==Z&&Jp(b,D,Z);const K=I.styles;null!==K&&qg(b,D,K),64!=(64&I.flags)&&Zc(u,a,D,I),0===Ot.lFrame.elementDepthCount&&oo(D,a),Ot.lFrame.elementDepthCount++,$l(I)&&(Df(u,a,I),function(t,e,n){if(_a(e)){const a=e.directiveEnd;for(let u=e.directiveStart;u<a;u++){const g=t.data[u];g.contentQueries&&g.contentQueries(1,n[u],u)}}}(u,I,a)),null!==r&&Sf(a,I)}function G(){let t=P();Le()?Ot.lFrame.isParent=!1:(t=t.parent,me(t,!1));const e=t;Ot.lFrame.elementDepthCount--;const n=v();n.firstCreatePass&&(ba(n,t),_a(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&o0(n,e,c(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&o0(n,e,c(),e.stylesWithoutHost,!1)}function Fe(t,e,n,r){H(t,e,n,r),G()}function xm(t){return!!t&&"function"==typeof t.then}const y_=function(t){return!!t&&"function"==typeof t.subscribe};function Ia(t,e,n,r){const a=c(),u=v(),g=P();return function(t,e,n,r,a,u,g,b){const D=$l(r),N=t.firstCreatePass&&Fi(t),Z=e[8],K=Lr(e);let te=!0;if(3&r.type||b){const De=Ar(r,e),Ze=b?b(De):De,Ve=K.length,_t=b?St=>b(Oi(St[r.index])):r.index;if(vi(n)){let St=null;if(!b&&D&&(St=function(t,e,n,r){const a=t.cleanup;if(null!=a)for(let u=0;u<a.length-1;u+=2){const g=a[u];if(g===n&&a[u+1]===r){const b=e[7],D=a[u+2];return b.length>D?b[D]:null}"string"==typeof g&&(u+=2)}return null}(t,e,a,r.index)),null!==St)(St.__ngLastListenerFn__||St).__ngNextListenerFn__=u,St.__ngLastListenerFn__=u,te=!1;else{u=s0(r,e,Z,u,!1);const Cn=n.listen(Ze,a,u);K.push(u,Cn),N&&N.push(a,_t,Ve,Ve+1)}}else u=s0(r,e,Z,u,!0),Ze.addEventListener(a,u,g),K.push(u),N&&N.push(a,_t,Ve,g)}else u=s0(r,e,Z,u,!1);const he=r.outputs;let Re;if(te&&null!==he&&(Re=he[a])){const De=Re.length;if(De)for(let Ze=0;Ze<De;Ze+=2){const qr=e[Re[Ze]][Re[Ze+1]].subscribe(u),sr=K.length;K.push(u,qr),N&&N.push(a,r.index,sr,-(sr+1))}}}(u,a,a[11],g,t,e,!!n,r),Ia}function nw(t,e,n,r){try{return!1!==n(r)}catch(a){return vr(t,a),!1}}function s0(t,e,n,r,a){return function u(g){if(g===Function)return r;const b=2&t.flags?ir(t.index,e):e;0==(32&e[2])&&bt(b);let D=nw(e,0,r,g),I=u.__ngNextListenerFn__;for(;I;)D=nw(e,0,I,g)&&D,I=I.__ngNextListenerFn__;return a&&!1===D&&(g.preventDefault(),g.returnValue=!1),D}}function a0(t,e,n){return v_(t,"",e,"",n),a0}function v_(t,e,n,r,a){const u=c(),g=kf(u,e,n,r);return g!==Xt&&l(v(),Si(),u,t,g,u[11],a,!1),v_}function hw(t,e,n,r,a){const u=t[n+1],g=null===e;let b=r?ao(u):Sa(u),D=!1;for(;0!==b&&(!1===D||g);){const N=t[b+1];DA(t[b],e)&&(D=!0,t[b+1]=r?im(N):xf(N)),b=r?ao(N):Sa(N)}D&&(t[n+1]=r?xf(u):im(u))}function DA(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Ca(t,e)>=0}function x_(t,e){return function(t,e,n,r){const a=c(),u=v(),g=function(t){const e=Ot.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);u.firstUpdatePass&&function(t,e,n,r){const a=t.data;if(null===a[n+1]){const u=a[mr()],g=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(t.flags&(e?16:32))})(u,r)&&null===e&&!g&&(e=!1),e=function(t,e,n,r){const a=function(t){const e=Ot.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let u=r?e.residualClasses:e.residualStyles;if(null===a)0===(r?e.classBindings:e.styleBindings)&&(n=bm(n=l0(null,t,e,n,r),e.attrs,r),u=null);else{const g=e.directiveStylingLast;if(-1===g||t[g]!==a)if(n=l0(a,t,e,n,r),null===u){let D=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==Sa(r))return t[ao(r)]}(t,e,r);void 0!==D&&Array.isArray(D)&&(D=l0(null,t,e,D[1],r),D=bm(D,e.attrs,r),function(t,e,n,r){t[ao(n?e.classBindings:e.styleBindings)]=r}(t,e,r,D))}else u=function(t,e,n){let r;const a=e.directiveEnd;for(let u=1+e.directiveStylingLast;u<a;u++)r=bm(r,t[u].hostAttrs,n);return bm(r,e.attrs,n)}(t,e,r)}return void 0!==u&&(r?e.residualClasses=u:e.residualStyles=u),n}(a,u,e,r),function(t,e,n,r,a,u){let g=u?e.classBindings:e.styleBindings,b=ao(g),D=Sa(g);t[r]=n;let N,I=!1;if(Array.isArray(n)){const Z=n;N=Z[1],(null===N||Ca(Z,N)>0)&&(I=!0)}else N=n;if(a)if(0!==D){const K=ao(t[b+1]);t[r+1]=fh(K,b),0!==K&&(t[K+1]=nm(t[K+1],r)),t[b+1]=function(t,e){return 131071&t|e<<17}(t[b+1],r)}else t[r+1]=fh(b,0),0!==b&&(t[b+1]=nm(t[b+1],r)),b=r;else t[r+1]=fh(D,0),0===b?b=r:t[D+1]=nm(t[D+1],r),D=r;I&&(t[r+1]=xf(t[r+1])),hw(t,N,r,!0),hw(t,N,r,!1),function(t,e,n,r,a){const u=a?t.residualClasses:t.residualStyles;null!=u&&"string"==typeof e&&Ca(u,e)>=0&&(n[r+1]=im(n[r+1]))}(e,N,t,r,u),g=fh(b,D),u?e.classBindings=g:e.styleBindings=g}(a,u,e,n,g,r)}}(u,t,g,r),e!==Xt&&Es(a,g,e)&&function(t,e,n,r,a,u,g,b){if(!(3&e.type))return;const D=t.data,I=D[b+1];b_(function(t){return 1==(1&t)}(I)?Cw(D,e,n,a,Sa(I),g):void 0)||(b_(u)||function(t){return 2==(2&t)}(I)&&(u=Cw(D,null,n,a,b,g)),function(t,e,n,r,a){const u=vi(t);if(e)a?u?t.addClass(n,r):n.classList.add(r):u?t.removeClass(n,r):n.classList.remove(r);else{let g=-1===r.indexOf("-")?void 0:Hs.DashCase;if(null==a)u?t.removeStyle(n,r,g):n.style.removeProperty(r);else{const b="string"==typeof a&&a.endsWith("!important");b&&(a=a.slice(0,-10),g|=Hs.Important),u?t.setStyle(n,r,a,g):n.style.setProperty(r,a,b?"important":"")}}}(r,g,Ha(mr(),n),a,u))}(u,u.data[mr()],a,a[11],t,a[g+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=Bt($s(t)))),t}(e,n),r,g)}(t,e,null,!0),x_}function l0(t,e,n,r,a){let u=null;const g=n.directiveEnd;let b=n.directiveStylingLast;for(-1===b?b=n.directiveStart:b++;b<g&&(u=e[b],r=bm(r,u.hostAttrs,a),u!==t);)b++;return null!==t&&(n.directiveStylingLast=b),r}function bm(t,e,n){const r=n?1:2;let a=-1;if(null!==e)for(let u=0;u<e.length;u++){const g=e[u];"number"==typeof g?a=g:a===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ir(t,g,!!n||e[++u]))}return void 0===t?null:t}function Cw(t,e,n,r,a,u){const g=null===e;let b;for(;a>0;){const D=t[a],I=Array.isArray(D),N=I?D[1]:D,Z=null===N;let K=n[a+1];K===Xt&&(K=Z?bn:void 0);let te=Z?Ja(K,r):N===r?K:void 0;if(I&&!b_(te)&&(te=Ja(D,r)),b_(te)&&(b=te,g))return b;const he=t[a+1];a=g?ao(he):Sa(he)}if(null!==e){let D=u?e.residualClasses:e.residualStyles;null!=D&&(b=Ja(D,r))}return b}function b_(t){return void 0!==t}function de(t,e=""){const n=c(),r=v(),a=t+20,u=r.firstCreatePass?nl(r,a,1,e,null):r.data[a],g=n[a]=function(t,e){return vi(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Zc(r,n,g,u),me(u,!1)}function zu(t){return fd("",t,""),zu}function fd(t,e,n){const r=c(),a=kf(r,t,e,n);return a!==Xt&&Ui(r,mr(),a),fd}function c0(t,e,n){const r=c();return Es(r,no(),e)&&l(v(),Si(),r,t,e,r[11],n,!0),c0}const pd=void 0;var aI=["en",[["a","p"],["AM","PM"],pd],[["AM","PM"],pd,pd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pd,"{1} 'at' {0}",pd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let jf={};function Hw(t){return t in jf||(jf[t]=Un.ng&&Un.ng.common&&Un.ng.common.locales&&Un.ng.common.locales[t]),jf[t]}var yt=(()=>((yt=yt||{})[yt.LocaleId=0]="LocaleId",yt[yt.DayPeriodsFormat=1]="DayPeriodsFormat",yt[yt.DayPeriodsStandalone=2]="DayPeriodsStandalone",yt[yt.DaysFormat=3]="DaysFormat",yt[yt.DaysStandalone=4]="DaysStandalone",yt[yt.MonthsFormat=5]="MonthsFormat",yt[yt.MonthsStandalone=6]="MonthsStandalone",yt[yt.Eras=7]="Eras",yt[yt.FirstDayOfWeek=8]="FirstDayOfWeek",yt[yt.WeekendRange=9]="WeekendRange",yt[yt.DateFormat=10]="DateFormat",yt[yt.TimeFormat=11]="TimeFormat",yt[yt.DateTimeFormat=12]="DateTimeFormat",yt[yt.NumberSymbols=13]="NumberSymbols",yt[yt.NumberFormats=14]="NumberFormats",yt[yt.CurrencyCode=15]="CurrencyCode",yt[yt.CurrencySymbol=16]="CurrencySymbol",yt[yt.CurrencyName=17]="CurrencyName",yt[yt.Currencies=18]="Currencies",yt[yt.Directionality=19]="Directionality",yt[yt.PluralCase=20]="PluralCase",yt[yt.ExtraData=21]="ExtraData",yt))();const w_="en-US";let Gw=w_;function u0(t){Ct(t,"Expected localeId to be defined"),"string"==typeof t&&(Gw=t.toLowerCase().replace(/_/g,"-"))}class gC{}const yC="ngComponent";class a2{resolveComponentFactory(e){throw function(t){const e=Error(`No component factory found for ${Bt(t)}. Did you add it to @NgModule.entryComponents?`);return e[yC]=t,e}(e)}}let md=(()=>{class t{}return t.NULL=new a2,t})();function S_(...t){}function Hf(t,e){return new lo(Ar(t,e))}const u2=function(){return Hf(P(),c())};let lo=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=u2,t})();class M_{}let Bu=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>d2(),t})();const d2=function(){const t=c(),n=ir(P().index,t);return function(t){return t[11]}(bo(n)?n:t)};let y0=(()=>{class t{}return t.\u0275prov=mt({token:t,providedIn:"root",factory:()=>null}),t})();class Dm{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const xC=new Dm("12.2.7");class bC{constructor(){}supports(e){return ym(e)}create(e){return new g2(e)}}const m2=(t,e)=>e;class g2{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||m2}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,a=0,u=null;for(;n||r;){const g=!r||n&&n.currentIndex<CC(r,a,u)?n:r,b=CC(g,a,u),D=g.currentIndex;if(g===r)a--,r=r._nextRemoved;else if(n=n._next,null==g.previousIndex)a++;else{u||(u=[]);const I=b-a,N=D-a;if(I!=N){for(let K=0;K<I;K++){const te=K<u.length?u[K]:u[K]=0,he=te+K;N<=he&&he<I&&(u[K]=te+1)}u[g.previousIndex]=N-I}}b!==D&&e(g,b,D)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!ym(e))throw new Error(`Error trying to diff '${Bt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let a,u,g,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let b=0;b<this.length;b++)u=e[b],g=this._trackByFn(b,u),null!==n&&Object.is(n.trackById,g)?(r&&(n=this._verifyReinsertion(n,u,g,b)),Object.is(n.item,u)||this._addIdentityChange(n,u)):(n=this._mismatch(n,u,g,b),r=!0),n=n._next}else a=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[If()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,b=>{g=this._trackByFn(a,b),null!==n&&Object.is(n.trackById,g)?(r&&(n=this._verifyReinsertion(n,b,g,a)),Object.is(n.item,b)||this._addIdentityChange(n,b)):(n=this._mismatch(n,b,g,a),r=!0),n=n._next,a++}),this.length=a;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,a){let u;return null===e?u=this._itTail:(u=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,u,a)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,a))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,u,a)):e=this._addAfter(new _2(n,r),u,a),e}_verifyReinsertion(e,n,r,a){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==u?e=this._reinsertAfter(u,e._prev,a):e.currentIndex!=a&&(e.currentIndex=a,this._addToMoves(e,a)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const a=e._prevRemoved,u=e._nextRemoved;return null===a?this._removalsHead=u:a._nextRemoved=u,null===u?this._removalsTail=a:u._prevRemoved=a,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const a=null===n?this._itHead:n._next;return e._next=a,e._prev=n,null===a?this._itTail=e:a._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new wC),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wC),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class _2{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class y2{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class wC{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new y2,this.map.set(n,r)),r.add(e)}get(e,n){const a=this.map.get(e);return a?a.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function CC(t,e,n){const r=t.previousIndex;if(null===r)return r;let a=0;return n&&r<n.length&&(a=n[r]),r+e+a}class EC{constructor(){}supports(e){return e instanceof Map||Qv(e)}create(){return new v2}}class v2{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||Qv(e)))throw new Error(`Error trying to diff '${Bt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,a)=>{if(n&&n.key===a)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const u=this._getOrCreateRecordForKey(a,r);n=this._insertBeforeOrAppend(n,u)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const a=this._records.get(e);this._maybeAddToChanges(a,n);const u=a._prev,g=a._next;return u&&(u._next=g),g&&(g._prev=u),a._next=null,a._prev=null,a}const r=new x2(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}}class x2{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function TC(){return new gd([new bC])}let gd=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const a=r.factories.slice();n=n.concat(a)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||TC()),deps:[[t,new _r,new vs]]}}find(n){const r=this.factories.find(a=>a.supports(n));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(t){return t.name||typeof t}(n)}'`)}}return t.\u0275prov=mt({token:t,providedIn:"root",factory:TC}),t})();function DC(){return new ru([new EC])}let ru=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(r){const a=r.factories.slice();n=n.concat(a)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||DC()),deps:[[t,new _r,new vs]]}}find(n){const r=this.factories.find(a=>a.supports(n));if(r)return r;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return t.\u0275prov=mt({token:t,providedIn:"root",factory:DC}),t})();function A_(t,e,n,r,a=!1){for(;null!==n;){const u=e[n.index];if(null!==u&&r.push(Oi(u)),wo(u))for(let b=10;b<u.length;b++){const D=u[b],I=D[1].firstChild;null!==I&&A_(D[1],D,I,r)}const g=n.type;if(8&g)A_(t,e,n.child,r);else if(32&g){const b=Vp(n,e);let D;for(;D=b();)r.push(D)}else if(16&g){const b=Yp(e,n);if(Array.isArray(b))r.push(...b);else{const D=Yh(e[16]);A_(D[1],D,b,r,!0)}}n=a?n.projectionNext:n.next}return r}class Sm{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return A_(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(wo(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(hf(e,r),Nc(n,r))}this._attachedToViewContainer=!1}Vg(this._lView[1],this._lView)}onDestroy(e){!function(t,e,n,r){const a=Lr(e);null===n?a.push(r):(a.push(n),t.firstCreatePass&&Fi(t).push(r,a.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){bt(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){yr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){un(!0);try{yr(t,e,n)}finally{un(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(t,e){qc(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class w2 extends Sm{constructor(e){super(e),this._view=e}detectChanges(){Ai(this._view)}checkNoChanges(){!function(t){un(!0);try{Ai(t)}finally{un(!1)}}(this._view)}get context(){return null}}const E2=function(t){return function(t,e,n){if(jl(t)&&!n){const r=ir(t.index,e);return new Sm(r,r)}return 47&t.type?new Sm(e[16],e):null}(P(),c(),16==(16&t))};let v0=(()=>{class t{}return t.__NG_ELEMENT_ID__=E2,t})();const S2=[new EC],A2=new gd([new bC]),I2=new ru(S2),k2=function(){return function(t,e){return 4&t.type?new L2(e,t,Hf(t,e)):null}(P(),c())};let Vu=(()=>{class t{}return t.__NG_ELEMENT_ID__=k2,t})();const R2=Vu,L2=class extends R2{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e){const n=this._declarationTContainer.tViews,r=ad(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[19];return null!==u&&(r[19]=u.createEmbeddedView(n)),xs(n,r,e),new Sm(r)}};class ou{}class SC{}const N2=function(){return function(t,e){let n;const r=e[t.index];if(wo(r))n=r;else{let a;if(8&t.type)a=Oi(r);else{const u=e[11];a=u.createComment("");const g=Ar(t,e);Pu(u,Qh(u,g),a,function(t,e){return vi(t)?t.nextSibling(e):e.nextSibling}(u,g),!1)}e[t.index]=n=Ke(r,e,a,t),hn(e,n)}return new MC(n,t,e)}(P(),c())};let hc=(()=>{class t{}return t.__NG_ELEMENT_ID__=N2,t})();const B2=hc,MC=class extends B2{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Hf(this._hostTNode,this._hostLView)}get injector(){return new Bo(this._hostTNode,this._hostLView)}get parentInjector(){const e=tt(this._hostTNode,this._hostLView);if(ie(e)){const n=_e(e,this._hostLView),r=ae(e);return new Bo(n[1].data[r+8],n)}return new Bo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=AC(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){const a=e.createEmbeddedView(n||{});return this.insert(a,r),a}createComponent(e,n,r,a,u){const g=r||this.parentInjector;if(!u&&null==e.ngModule&&g){const D=g.get(ou,null);D&&(u=D)}const b=e.create(g,a,void 0,u);return this.insert(b.hostView,n),b}insert(e,n){const r=e._lView,a=r[1];if(function(t){return wo(t[3])}(r)){const N=this.indexOf(e);if(-1!==N)this.detach(N);else{const Z=r[3],K=new MC(Z,Z[6],Z[3]);K.detach(K.indexOf(e))}}const u=this._adjustIndex(n),g=this._lContainer;!function(t,e,n,r){const a=10+r,u=n.length;r>0&&(n[a-1][4]=e),r<u-10?(e[4]=n[a],Rh(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const g=e[17];null!==g&&n!==g&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(g,e);const b=e[19];null!==b&&b.insertView(t),e[2]|=128}(a,r,g,u);const b=td(u,g),D=r[11],I=Qh(D,g[7]);return null!==I&&function(t,e,n,r,a,u){r[0]=a,r[6]=e,qc(t,r,n,1,a,u)}(a,g[6],D,r,I,b),e.attachToViewContainerRef(),Rh(x0(g),u,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=AC(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=hf(this._lContainer,n);r&&(Nc(x0(this._lContainer),n),Vg(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=hf(this._lContainer,n);return r&&null!=Nc(x0(this._lContainer),n)?new Sm(r):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function AC(t){return t[8]}function x0(t){return t[8]||(t[8]=[])}const Wf={};class KC extends md{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=tr(e);return new JC(n,this.ngModule)}}function YC(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const OP=new Yt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Fp});class JC extends gC{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function(t){return t.map(Nv).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return YC(this.componentDef.inputs)}get outputs(){return YC(this.componentDef.outputs)}create(e,n,r,a){const u=(a=a||this.ngModule)?function(t,e){return{get:(n,r,a)=>{const u=t.get(n,Wf,a);return u!==Wf||r===Wf?u:e.get(n,r,a)}}}(e,a.injector):e,g=u.get(M_,ya),b=u.get(y0,null),D=g.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",N=r?function(t,e,n){if(vi(t))return t.selectRootElement(e,n===zn.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(D,r,this.componentDef.encapsulation):cf(g.createRenderer(null,this.componentDef),I,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(I)),Z=this.componentDef.onPush?576:528,K=function(t,e){return{components:[],scheduler:t||Fp,clean:Xn,playerHandler:e||null,flags:0}}(),te=ud(0,null,null,1,0,null,null,null,null,null),he=ad(null,te,K,Z,null,null,g,D,b,u);let Re,De;Xa(he);try{const Ze=function(t,e,n,r,a,u){const g=n[1];n[20]=t;const D=nl(g,20,2,"#host",null),I=D.mergedAttrs=e.hostAttrs;null!==I&&(hi(D,I,!0),null!==t&&(X(a,t,I),null!==D.classes&&Jp(a,t,D.classes),null!==D.styles&&qg(a,t,D.styles)));const N=r.createRenderer(t,e),Z=ad(n,cd(e),null,e.onPush?64:16,n[20],D,r,N,u||null,null);return g.firstCreatePass&&(ft(ct(D,n),g,e.type),ye(g,D),Pe(D,n.length,1)),hn(n,Z),n[20]=Z}(N,this.componentDef,he,g,D);if(N)if(r)X(D,N,["ng-version",xC.full]);else{const{attrs:Ve,classes:_t}=function(t){const e=[],n=[];let r=1,a=2;for(;r<t.length;){let u=t[r];if("string"==typeof u)2===a?""!==u&&e.push(u,t[++r]):8===a&&n.push(u);else{if(!Zs(a))break;a=u}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);Ve&&X(D,N,Ve),_t&&_t.length>0&&Jp(D,N,_t.join(" "))}if(De=fr(te,20),void 0!==n){const Ve=De.projection=[];for(let _t=0;_t<this.ngContentSelectors.length;_t++){const St=n[_t];Ve.push(null!=St?Array.from(St):null)}}Re=function(t,e,n,r,a){const u=n[1],g=function(t,e,n){const r=P();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),ke(t,r,e,Xc(t,e,1,null),n));const a=zo(e,t,r.directiveStart,r);oo(a,e);const u=Ar(r,e);return u&&oo(u,e),a}(u,n,e);if(r.components.push(g),t[8]=g,a&&a.forEach(D=>D(g,e)),e.contentQueries){const D=P();e.contentQueries(1,g,D.directiveStart)}const b=P();return!u.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Ya(b.index),F(n[1],b,0,b.directiveStart,b.directiveEnd,e),ne(e,g)),g}(Ze,this.componentDef,he,K,[RM]),xs(te,he,null)}finally{yu()}return new zP(this.componentType,Re,Hf(De,he),he,De)}}class zP extends class{}{constructor(e,n,r,a,u){super(),this.location=r,this._rootLView=a,this._tNode=u,this.instance=n,this.hostView=this.changeDetectorRef=new w2(a),this.componentType=e}get injector(){return new Bo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Xf=new Map;class UP extends ou{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new KC(this);const r=Vr(e),a=function(t){return t[Bl]||null}(e);a&&u0(a),this._bootstrapComponents=tl(r.bootstrap),this._r3Injector=rl(e,n,[{provide:ou,useValue:this},{provide:md,useValue:this.componentFactoryResolver}],Bt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=fi.THROW_IF_NOT_FOUND,r=wt.Default){return e===fi||e===ou||e===$i?this:this._r3Injector.get(e,n,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class R0 extends SC{constructor(e){super(),this.moduleType=e,null!==Vr(e)&&function(t){const e=new Set;!function n(r){const a=Vr(r,!0),u=a.id;null!==u&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${Bt(e)} vs ${Bt(e.name)}`)}(u,Xf.get(u),r),Xf.set(u,r));const g=tl(a.imports);for(const b of g)e.has(b)||(e.add(b),n(b))}(t)}(e)}create(e){return new UP(this.moduleType,e)}}function Ss(t,e,n){const r=function(){const t=Ot.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}()+t,a=c();return a[r]===Xt?function(t,e,n){return t[e]=n}(a,r,n?e.call(n):e()):function(t,e){return t[e]}(a,r)}function L0(t){return e=>{setTimeout(t,void 0,e)}}const Ln=class extends Pi{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){var a,u,g;let b=e,D=n||(()=>null),I=r;if(e&&"object"==typeof e){const Z=e;b=null===(a=Z.next)||void 0===a?void 0:a.bind(Z),D=null===(u=Z.error)||void 0===u?void 0:u.bind(Z),I=null===(g=Z.complete)||void 0===g?void 0:g.bind(Z)}this.__isAsync&&(D=L0(D),b&&(b=L0(b)),I&&(I=L0(I)));const N=super.subscribe({next:b,error:D,complete:I});return e instanceof at&&e.add(N),N}};Symbol;const rs=Oc("Input",t=>({bindingPropertyName:t})),co=Oc("Output",t=>({bindingPropertyName:t})),Rk=Oc("HostListener",(t,e)=>({eventName:t,args:e})),Bm=new Yt("Application Initializer");let Yf=(()=>{class t{constructor(n){this.appInits=n,this.resolve=S_,this.reject=S_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,a)=>{this.resolve=r,this.reject=a})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let a=0;a<this.appInits.length;a++){const u=this.appInits[a]();if(xm(u))n.push(u);else if(y_(u)){const g=new Promise((b,D)=>{u.subscribe({complete:b,error:D})});n.push(g)}}Promise.all(n).then(()=>{r()}).catch(a=>{this.reject(a)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(pt(Bm,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const Vm=new Yt("AppId"),$k={provide:Vm,useFactory:function(){return`${W0()}${W0()}${W0()}`},deps:[]};function W0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ME=new Yt("Platform Initializer"),z_=new Yt("Platform ID"),AE=new Yt("appBootstrapListener");let B_=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const _h=new Yt("LocaleId"),IE=new Yt("DefaultCurrencyCode");class Gk{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}const X0=function(t){return new R0(t)},Zk=X0,qk=function(t){return Promise.resolve(X0(t))},PE=function(t){const e=X0(t),r=tl(Vr(t).declarations).reduce((a,u)=>{const g=tr(u);return g&&a.push(new JC(g)),a},[]);return new Gk(e,r)},Wk=PE,Xk=function(t){return Promise.resolve(PE(t))};let vd=(()=>{class t{constructor(){this.compileModuleSync=Zk,this.compileModuleAsync=qk,this.compileModuleAndAllComponentsSync=Wk,this.compileModuleAndAllComponentsAsync=Xk}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const Jk=(()=>Promise.resolve(0))();function K0(t){"undefined"==typeof Zone?Jk.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class mi{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ln(!1),this.onMicrotaskEmpty=new Ln(!1),this.onStable=new Ln(!1),this.onError=new Ln(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!r&&n,a.shouldCoalesceRunChangeDetection=r,a.lastRequestAnimationFrameId=-1,a.nativeRequestAnimationFrame=function(){let t=Un.requestAnimationFrame,e=Un.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Un,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,J0(t),t.isCheckStableRunning=!0,Y0(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),J0(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,a,u,g,b)=>{try{return kE(t),n.invokeTask(a,u,g,b)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||t.shouldCoalesceRunChangeDetection)&&e(),RE(t)}},onInvoke:(n,r,a,u,g,b,D)=>{try{return kE(t),n.invoke(a,u,g,b,D)}finally{t.shouldCoalesceRunChangeDetection&&e(),RE(t)}},onHasTask:(n,r,a,u)=>{n.hasTask(a,u),r===a&&("microTask"==u.change?(t._hasPendingMicrotasks=u.microTask,J0(t),Y0(t)):"macroTask"==u.change&&(t.hasPendingMacrotasks=u.macroTask))},onHandleError:(n,r,a,u)=>(n.handleError(a,u),t.runOutsideAngular(()=>t.onError.emit(u)),!1)})}(a)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!mi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(mi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,a){const u=this._inner,g=u.scheduleEventTask("NgZoneEvent: "+a,e,eR,S_,S_);try{return u.runTask(g,n,r)}finally{u.cancelTask(g)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const eR={};function Y0(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function J0(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function kE(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function RE(t){t._nesting--,Y0(t)}class iR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ln,this.onMicrotaskEmpty=new Ln,this.onStable=new Ln,this.onError=new Ln}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,a){return e.apply(n,r)}}let Q0=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{mi.assertNotInAngularZone(),K0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())K0(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,a){let u=-1;r&&r>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==u),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:u,updateCb:a})}whenStable(n,r,a){if(a&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,a),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,a){return[]}}return t.\u0275fac=function(n){return new(n||t)(pt(mi))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),LE=(()=>{class t{constructor(){this._applications=new Map,ex.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return ex.findTestabilityInTree(this,n,r)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();class rR{addToWindow(e){}findTestabilityInTree(e,n,r){return null}}let ex=new rR,OE=!0,FE=!1;let pc;const zE=new Yt("AllowMultipleToken");class tx{constructor(e,n){this.name=e,this.token=n}}function BE(t,e,n=[]){const r=`Platform: ${e}`,a=new Yt(r);return(u=[])=>{let g=VE();if(!g||g.injector.get(zE,!1))if(t)t(n.concat(u).concat({provide:a,useValue:!0}));else{const b=n.concat(u).concat({provide:a,useValue:!0},{provide:Tn,useValue:"platform"});!function(t){if(pc&&!pc.destroyed&&!pc.injector.get(zE,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");pc=t.get(UE);const e=t.get(ME,null);e&&e.forEach(n=>n())}(fi.create({providers:b,name:r}))}return function(t){const e=VE();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(a)}}function VE(){return pc&&!pc.destroyed?pc:null}let UE=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const b=function(t,e){let n;return n="noop"===t?new iR:("zone.js"===t?void 0:t)||new mi({enableLongStackTrace:(FE=!0,OE),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),D=[{provide:mi,useValue:b}];return b.run(()=>{const I=fi.create({providers:D,parent:this.injector,name:n.moduleType.name}),N=n.create(I),Z=N.injector.get($c,null);if(!Z)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return b.runOutsideAngular(()=>{const K=b.onError.subscribe({next:te=>{Z.handleError(te)}});N.onDestroy(()=>{nx(this._modules,N),K.unsubscribe()})}),function(t,e,n){try{const r=n();return xm(r)?r.catch(a=>{throw e.runOutsideAngular(()=>t.handleError(a)),a}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(Z,b,()=>{const K=N.injector.get(Yf);return K.runInitializers(),K.donePromise.then(()=>(u0(N.injector.get(_h,w_)||w_),this._moduleDoBootstrap(N),N))})})}bootstrapModule(n,r=[]){const a=jE({},r);return function(t,e,n){const r=new R0(n);return Promise.resolve(r)}(0,0,n).then(u=>this.bootstrapModuleFactory(u,a))}_moduleDoBootstrap(n){const r=n.injector.get(Jf);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(a=>r.bootstrap(a));else{if(!n.instance.ngDoBootstrap)throw new Error(`The module ${Bt(n.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(pt(fi))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function jE(t,e){return Array.isArray(e)?e.reduce(jE,t):Object.assign(Object.assign({},t),e)}let Jf=(()=>{class t{constructor(n,r,a,u,g){this._zone=n,this._injector=r,this._exceptionHandler=a,this._componentFactoryResolver=u,this._initStatus=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const b=new Pn(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),D=new Pn(I=>{let N;this._zone.runOutsideAngular(()=>{N=this._zone.onStable.subscribe(()=>{mi.assertNotInAngularZone(),K0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const Z=this._zone.onUnstable.subscribe(()=>{mi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{N.unsubscribe(),Z.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return _i(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof Pn?t[0]:Xr(e)(Er(t,n))}(b,D.pipe(t=>ra()(function(t,e){return function(r){let a;a="function"==typeof t?t:function(){return t};const u=Object.create(r,ul);return u.source=r,u.subjectFactory=a,u}}(Xo)(t))))}bootstrap(n,r){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let a;a=n instanceof gC?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(a.componentType);const u=function(t){return t.isBoundToModule}(a)?void 0:this._injector.get(ou),b=a.create(fi.NULL,[],r||a.selector,u),D=b.location.nativeElement,I=b.injector.get(Q0,null),N=I&&b.injector.get(LE);return I&&N&&N.registerApplication(D,I),b.onDestroy(()=>{this.detachView(b.hostView),nx(this.components,b),N&&N.unregisterApplication(D)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;nx(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(AE,[]).concat(this._bootstrapListeners).forEach(a=>a(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(pt(mi),pt(fi),pt($c),pt(md),pt(Yf))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function nx(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class U_{}class vR{}const xR={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let bR=(()=>{class t{constructor(n,r){this._compiler=n,this._config=r||xR}load(n){return this.loadAndCompile(n)}loadAndCompile(n){let[r,a]=n.split("#");return void 0===a&&(a="default"),st(255)(r).then(u=>u[a]).then(u=>ZE(u,r,a)).then(u=>this._compiler.compileModuleAsync(u))}loadFactory(n){let[r,a]=n.split("#"),u="NgFactory";return void 0===a&&(a="default",u=""),st(255)(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(g=>g[a+u]).then(g=>ZE(g,r,a))}}return t.\u0275fac=function(n){return new(n||t)(pt(vd),pt(vR,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function ZE(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const PR=BE(null,"core",[{provide:z_,useValue:"unknown"},{provide:UE,deps:[fi]},{provide:LE,deps:[]},{provide:B_,deps:[]}]),FR=[{provide:Jf,useClass:Jf,deps:[mi,fi,$c,md,Yf]},{provide:OP,deps:[mi],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:Yf,useClass:Yf,deps:[[new vs,Bm]]},{provide:vd,useClass:vd,deps:[]},$k,{provide:gd,useFactory:function(){return A2},deps:[]},{provide:ru,useFactory:function(){return I2},deps:[]},{provide:_h,useFactory:function(t){return u0(t=t||"undefined"!=typeof $localize&&$localize.locale||w_),t},deps:[[new Tu(_h),new vs,new _r]]},{provide:IE,useValue:"USD"}];let zR=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(pt(Jf))},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({providers:FR}),t})(),Y_=null;function su(){return Y_}const $o=new Yt("DocumentToken");let wd=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({factory:NL,token:t,providedIn:"platform"}),t})();function NL(){return pt(gT)}const zL=new Yt("Location Initialized");let gT=(()=>{class t extends wd{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return su().getBaseHref(this._doc)}onPopState(n){const r=su().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=su().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,a){_T()?this._history.pushState(n,r,a):this.location.hash=a}replaceState(n,r,a){_T()?this._history.replaceState(n,r,a):this.location.hash=a}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(pt($o))},t.\u0275prov=mt({factory:BL,token:t,providedIn:"platform"}),t})();function _T(){return!!window.history.pushState}function BL(){return new gT(pt($o))}function _x(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function yT(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function ju(t){return t&&"?"!==t[0]?"?"+t:t}let tp=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({factory:VL,token:t,providedIn:"root"}),t})();function VL(t){const e=pt($o).location;return new vT(pt(wd),e&&e.origin||"")}const yx=new Yt("appBaseHref");let vT=(()=>{class t extends tp{constructor(n,r){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return _x(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+ju(this._platformLocation.search),a=this._platformLocation.hash;return a&&n?`${r}${a}`:r}pushState(n,r,a,u){const g=this.prepareExternalUrl(a+ju(u));this._platformLocation.pushState(n,r,g)}replaceState(n,r,a,u){const g=this.prepareExternalUrl(a+ju(u));this._platformLocation.replaceState(n,r,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,a;null===(a=(r=this._platformLocation).historyGo)||void 0===a||a.call(r,n)}}return t.\u0275fac=function(n){return new(n||t)(pt(wd),pt(yx,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),UL=(()=>{class t extends tp{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=_x(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,a,u){let g=this.prepareExternalUrl(a+ju(u));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.pushState(n,r,g)}replaceState(n,r,a,u){let g=this.prepareExternalUrl(a+ju(u));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,a;null===(a=(r=this._platformLocation).historyGo)||void 0===a||a.call(r,n)}}return t.\u0275fac=function(n){return new(n||t)(pt(wd),pt(yx,8))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),J_=(()=>{class t{constructor(n,r){this._subject=new Ln,this._urlChangeListeners=[],this._platformStrategy=n;const a=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=yT(xT(a)),this._platformStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+ju(r))}normalize(n){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,xT(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,r="",a=null){this._platformStrategy.pushState(a,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+ju(r)),a)}replaceState(n,r="",a=null){this._platformStrategy.replaceState(a,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+ju(r)),a)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var r,a;null===(a=(r=this._platformStrategy).historyGo)||void 0===a||a.call(r,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(a=>a(n,r))}subscribe(n,r,a){return this._subject.subscribe({next:n,error:r,complete:a})}}return t.\u0275fac=function(n){return new(n||t)(pt(tp),pt(wd))},t.normalizeQueryParams=ju,t.joinWithSlash=_x,t.stripTrailingSlash=yT,t.\u0275prov=mt({factory:jL,token:t,providedIn:"root"}),t})();function jL(){return new J_(pt(tp),pt(wd))}function xT(t){return t.replace(/\/index.html$/,"")}var uo=(()=>((uo=uo||{})[uo.Zero=0]="Zero",uo[uo.One=1]="One",uo[uo.Two=2]="Two",uo[uo.Few=3]="Few",uo[uo.Many=4]="Many",uo[uo.Other=5]="Other",uo))();const KL=function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Hw(e);if(n)return n;const r=e.split("-")[0];if(n=Hw(r),n)return n;if("en"===r)return aI;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[yt.PluralCase]};class ly{}let TO=(()=>{class t extends ly{constructor(n){super(),this.locale=n}getPluralCategory(n,r){switch(KL(r||this.locale)(n)){case uo.Zero:return"zero";case uo.One:return"one";case uo.Two:return"two";case uo.Few:return"few";case uo.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(pt(_h))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function AT(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[a,u]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(a.trim()===e)return decodeURIComponent(u)}return null}class MO{constructor(e,n,r,a){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=a}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Sx=(()=>{class t{constructor(n,r,a){this._viewContainer=n,this._template=r,this._differs=a,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(r){throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(t){return t.name||typeof t}(n)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=[];n.forEachOperation((a,u,g)=>{if(null==a.previousIndex){const b=this._viewContainer.createEmbeddedView(this._template,new MO(null,this._ngForOf,-1,-1),null===g?void 0:g),D=new IT(a,b);r.push(D)}else if(null==g)this._viewContainer.remove(null===u?void 0:u);else if(null!==u){const b=this._viewContainer.get(u);this._viewContainer.move(b,g);const D=new IT(a,b);r.push(D)}});for(let a=0;a<r.length;a++)this._perViewChange(r[a].view,r[a].record);for(let a=0,u=this._viewContainer.length;a<u;a++){const g=this._viewContainer.get(a);g.context.index=a,g.context.count=u,g.context.ngForOf=this._ngForOf}n.forEachIdentityChange(a=>{this._viewContainer.get(a.currentIndex).context.$implicit=a.item})}_perViewChange(n,r){n.context.$implicit=r.item}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(Je(hc),Je(Vu),Je(gd))},t.\u0275dir=Et({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class IT{constructor(e,n){this.record=e,this.view=n}}let iF=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({providers:[{provide:ly,useClass:TO}]}),t})();let OT=(()=>{class t{}return t.\u0275prov=mt({token:t,providedIn:"root",factory:()=>new aF(pt($o),window)}),t})();class aF{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let a=r.currentNode;for(;a;){const u=a.shadowRoot;if(u){const g=u.getElementById(e)||u.querySelector(`[name="${e}"]`);if(g)return g}a=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,a=n.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(r-u[0],a-u[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=FT(this.window.history)||FT(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function FT(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class NT{}class kx extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(t){Y_||(Y_=t)}(new kx)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=(qm=qm||document.querySelector("base"),qm?qm.getAttribute("href"):null);return null==n?null:function(t){cy=cy||document.createElement("a"),cy.setAttribute("href",t);const e=cy.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){qm=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return AT(document.cookie,e)}}let cy,qm=null;const zT=new Yt("TRANSITION_ID"),fF=[{provide:Bm,useFactory:function(t,e,n){return()=>{n.get(Yf).donePromise.then(()=>{const r=su(),a=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let u=0;u<a.length;u++)r.remove(a[u])})}},deps:[zT,$o,fi],multi:!0}];class Rx{static init(){!function(t){ex=t}(new Rx)}addToWindow(e){Un.getAngularTestability=(r,a=!0)=>{const u=e.findTestabilityInTree(r,a);if(null==u)throw new Error("Could not find testability for element.");return u},Un.getAllAngularTestabilities=()=>e.getAllTestabilities(),Un.getAllAngularRootElements=()=>e.getAllRootElements(),Un.frameworkStabilizers||(Un.frameworkStabilizers=[]),Un.frameworkStabilizers.push(r=>{const a=Un.getAllAngularTestabilities();let u=a.length,g=!1;const b=function(D){g=g||D,u--,0==u&&r(g)};a.forEach(function(D){D.whenStable(b)})})}findTestabilityInTree(e,n,r){if(null==n)return null;const a=e.getTestability(n);return null!=a?a:r?su().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let pF=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const Wm=new Yt("EventManagerPlugins");let hy=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(a=>a.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,a){return this._findPluginFor(r).addEventListener(n,r,a)}addGlobalEventListener(n,r,a){return this._findPluginFor(r).addGlobalEventListener(n,r,a)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const a=this._plugins;for(let u=0;u<a.length;u++){const g=a[u];if(g.supports(n))return this._eventNameToPlugin.set(n,g),g}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(pt(Wm),pt(mi))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();class Lx{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const a=su().getGlobalEventTarget(this._doc,e);if(!a)throw new Error(`Unsupported event target ${a} for event ${n}`);return this.addEventListener(a,n,r)}}let VT=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(a=>{this._stylesSet.has(a)||(this._stylesSet.add(a),r.add(a))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),Xm=(()=>{class t extends VT{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,a){n.forEach(u=>{const g=this._doc.createElement("style");g.textContent=u,a.push(r.appendChild(g))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(UT),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,a)=>{this._addStylesToHost(n,a,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(UT))}}return t.\u0275fac=function(n){return new(n||t)(pt($o))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function UT(t){su().remove(t)}const Ox={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Fx=/%COMP%/g;function dy(t,e,n){for(let r=0;r<e.length;r++){let a=e[r];Array.isArray(a)?dy(t,a,n):(a=a.replace(Fx,t),n.push(a))}return n}function HT(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Nx=(()=>{class t{constructor(n,r,a){this.eventManager=n,this.sharedStylesHost=r,this.appId=a,this.rendererByCompId=new Map,this.defaultRenderer=new zx(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case zn.Emulated:{let a=this.rendererByCompId.get(r.id);return a||(a=new AF(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,a)),a.applyToHost(n),a}case 1:case zn.ShadowDom:return new IF(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const a=dy(r.id,r.styles,[]);this.sharedStylesHost.addStyles(a),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(pt(hy),pt(Xm),pt(Vm))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();class zx{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,n){return n?document.createElementNS(Ox[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,r){e&&e.insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,a){if(a){n=a+":"+n;const u=Ox[a];u?e.setAttributeNS(u,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const a=Ox[r];a?e.removeAttributeNS(a,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,a){a&(Hs.DashCase|Hs.Important)?e.style.setProperty(n,r,a&Hs.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Hs.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,HT(r)):this.eventManager.addEventListener(e,n,HT(r))}}class AF extends zx{constructor(e,n,r,a){super(e),this.component=r;const u=dy(a+"-"+r.id,r.styles,[]);n.addStyles(u),this.contentAttr=function(t){return"_ngcontent-%COMP%".replace(Fx,t)}(a+"-"+r.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(Fx,t)}(a+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class IF extends zx{constructor(e,n,r,a){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=dy(a.id,a.styles,[]);for(let g=0;g<u.length;g++){const b=document.createElement("style");b.textContent=u[g],this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let PF=(()=>{class t extends Lx{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,a){return n.addEventListener(r,a,!1),()=>this.removeEventListener(n,r,a)}removeEventListener(n,r,a){return n.removeEventListener(r,a)}}return t.\u0275fac=function(n){return new(n||t)(pt($o))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const qT=["alt","control","meta","shift"],zF={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},WT={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},BF={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let VF=(()=>{class t extends Lx{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,a){const u=t.parseEventName(r),g=t.eventCallback(u.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>su().onAndCancel(n,u.domEventName,g))}static parseEventName(n){const r=n.toLowerCase().split("."),a=r.shift();if(0===r.length||"keydown"!==a&&"keyup"!==a)return null;const u=t._normalizeKey(r.pop());let g="";if(qT.forEach(D=>{const I=r.indexOf(D);I>-1&&(r.splice(I,1),g+=D+".")}),g+=u,0!=r.length||0===u.length)return null;const b={};return b.domEventName=a,b.fullKey=g,b}static getEventFullKey(n){let r="",a=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&WT.hasOwnProperty(e)&&(e=WT[e]))}return zF[e]||e}(n);return a=a.toLowerCase()," "===a?a="space":"."===a&&(a="dot"),qT.forEach(u=>{u!=a&&BF[u](n)&&(r+=u+".")}),r+=a,r}static eventCallback(n,r,a){return u=>{t.getEventFullKey(u)===n&&a.runGuarded(()=>r(u))}}static _normalizeKey(n){switch(n){case"esc":return"escape";default:return n}}}return t.\u0275fac=function(n){return new(n||t)(pt($o))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const WF=BE(PR,"browser",[{provide:z_,useValue:"browser"},{provide:ME,useValue:function(){kx.makeCurrent(),Rx.init()},multi:!0},{provide:$o,useFactory:function(){return function(t){Mr=t}(document),document},deps:[]}]),XF=[[],{provide:Tn,useValue:"root"},{provide:$c,useFactory:function(){return new $c},deps:[]},{provide:Wm,useClass:PF,multi:!0,deps:[$o,mi,z_]},{provide:Wm,useClass:VF,multi:!0,deps:[$o]},[],{provide:Nx,useClass:Nx,deps:[hy,Xm,Vm]},{provide:M_,useExisting:Nx},{provide:VT,useExisting:Xm},{provide:Xm,useClass:Xm,deps:[$o]},{provide:Q0,useClass:Q0,deps:[mi]},{provide:hy,useClass:hy,deps:[Wm,mi]},{provide:NT,useClass:pF,deps:[]},[]];let KF=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:Vm,useValue:n.appId},{provide:zT,useExisting:Vm},fF]}}}return t.\u0275fac=function(n){return new(n||t)(pt(t,12))},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({providers:XF,imports:[iF,zR]}),t})();function gn(...t){let e=t[t.length-1];return _i(e)?(t.pop(),qi(t,e)):Er(t)}function np(t,e){return Nn(t,e,1)}function Cd(t,e){return function(r){return r.lift(new rN(t,e))}}"undefined"!=typeof window&&window;class rN{constructor(e,n){this.predicate=e,this.thisArg=n}call(e,n){return n.subscribe(new oN(e,this.predicate,this.thisArg))}}class oN extends In{constructor(e,n,r){super(e),this.predicate=n,this.thisArg=r,this.count=0}_next(e){let n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}n&&this.destination.next(e)}}class KT{}class YT{}class Hu{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const a=n.slice(0,r),u=a.toLowerCase(),g=n.slice(r+1).trim();this.maybeSetNormalizedName(a,u),this.headers.has(u)?this.headers.get(u).push(g):this.headers.set(u,[g])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(n=>{let r=e[n];const a=n.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(a,r),this.maybeSetNormalizedName(n,a))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof Hu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){const n=new Hu;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Hu?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){const n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,n);const a=("a"===e.op?this.headers.get(n):void 0)||[];a.push(...r),this.headers.set(n,a);break;case"d":const u=e.value;if(u){let g=this.headers.get(n);if(!g)return;g=g.filter(b=>-1===u.indexOf(b)),0===g.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,g)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}}class sN{encodeKey(e){return JT(e)}encodeValue(e){return JT(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const lN=/%(\d[a-f0-9])/gi,cN={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function JT(t){return encodeURIComponent(t).replace(lN,(e,n)=>{var r;return null!==(r=cN[n])&&void 0!==r?r:e})}function QT(t){return`${t}`}class xh{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new sN,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(a=>{const u=a.indexOf("="),[g,b]=-1==u?[e.decodeKey(a),""]:[e.decodeKey(a.slice(0,u)),e.decodeValue(a.slice(u+1))],D=n.get(g)||[];D.push(b),n.set(g,D)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{const r=e.fromObject[n];this.map.set(n,Array.isArray(r)?r:[r])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){const n=[];return Object.keys(e).forEach(r=>{const a=e[r];Array.isArray(a)?a.forEach(u=>{n.push({param:r,value:u,op:"a"})}):n.push({param:r,value:a,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const n=new xh({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const n=("a"===e.op?this.map.get(e.param):void 0)||[];n.push(QT(e.value)),this.map.set(e.param,n);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const a=r.indexOf(QT(e.value));-1!==a&&r.splice(a,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class uN{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function eD(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function tD(t){return"undefined"!=typeof Blob&&t instanceof Blob}function nD(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Km{constructor(e,n,r,a){let u;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||a?(this.body=void 0!==r?r:null,u=a):u=r,u&&(this.reportProgress=!!u.reportProgress,this.withCredentials=!!u.withCredentials,u.responseType&&(this.responseType=u.responseType),u.headers&&(this.headers=u.headers),u.context&&(this.context=u.context),u.params&&(this.params=u.params)),this.headers||(this.headers=new Hu),this.context||(this.context=new uN),this.params){const g=this.params.toString();if(0===g.length)this.urlWithParams=n;else{const b=n.indexOf("?");this.urlWithParams=n+(-1===b?"?":b<n.length-1?"&":"")+g}}else this.params=new xh,this.urlWithParams=n}serializeBody(){return null===this.body?null:eD(this.body)||tD(this.body)||nD(this.body)||function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof xh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||nD(this.body)?null:tD(this.body)?this.body.type||null:eD(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var n;const r=e.method||this.method,a=e.url||this.url,u=e.responseType||this.responseType,g=void 0!==e.body?e.body:this.body,b=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,D=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let I=e.headers||this.headers,N=e.params||this.params;const Z=null!==(n=e.context)&&void 0!==n?n:this.context;return void 0!==e.setHeaders&&(I=Object.keys(e.setHeaders).reduce((K,te)=>K.set(te,e.setHeaders[te]),I)),e.setParams&&(N=Object.keys(e.setParams).reduce((K,te)=>K.set(te,e.setParams[te]),N)),new Km(r,a,g,{params:N,headers:I,context:Z,reportProgress:D,responseType:u,withCredentials:b})}}var fo=(()=>((fo=fo||{})[fo.Sent=0]="Sent",fo[fo.UploadProgress=1]="UploadProgress",fo[fo.ResponseHeader=2]="ResponseHeader",fo[fo.DownloadProgress=3]="DownloadProgress",fo[fo.Response=4]="Response",fo[fo.User=5]="User",fo))();class $x{constructor(e,n=200,r="OK"){this.headers=e.headers||new Hu,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Hx extends $x{constructor(e={}){super(e),this.type=fo.ResponseHeader}clone(e={}){return new Hx({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class fy extends $x{constructor(e={}){super(e),this.type=fo.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new fy({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class iD extends $x{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Gx(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Zx=(()=>{class t{constructor(n){this.handler=n}request(n,r,a={}){let u;if(n instanceof Km)u=n;else{let D,I;D=a.headers instanceof Hu?a.headers:new Hu(a.headers),a.params&&(I=a.params instanceof xh?a.params:new xh({fromObject:a.params})),u=new Km(n,r,void 0!==a.body?a.body:null,{headers:D,context:a.context,params:I,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials})}const g=gn(u).pipe(np(D=>this.handler.handle(D)));if(n instanceof Km||"events"===a.observe)return g;const b=g.pipe(Cd(D=>D instanceof fy));switch(a.observe||"body"){case"body":switch(u.responseType){case"arraybuffer":return b.pipe(tn(D=>{if(null!==D.body&&!(D.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return D.body}));case"blob":return b.pipe(tn(D=>{if(null!==D.body&&!(D.body instanceof Blob))throw new Error("Response is not a Blob.");return D.body}));case"text":return b.pipe(tn(D=>{if(null!==D.body&&"string"!=typeof D.body)throw new Error("Response is not a string.");return D.body}));case"json":default:return b.pipe(tn(D=>D.body))}case"response":return b;default:throw new Error(`Unreachable: unhandled observe type ${a.observe}}`)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new xh).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,a={}){return this.request("PATCH",n,Gx(a,r))}post(n,r,a={}){return this.request("POST",n,Gx(a,r))}put(n,r,a={}){return this.request("PUT",n,Gx(a,r))}}return t.\u0275fac=function(n){return new(n||t)(pt(KT))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();class rD{constructor(e,n){this.next=e,this.interceptor=n}handle(e){return this.interceptor.intercept(e,this.next)}}const oD=new Yt("HTTP_INTERCEPTORS");let fN=(()=>{class t{intercept(n,r){return r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const pN=/^\)\]\}',?\n/;let sD=(()=>{class t{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Pn(r=>{const a=this.xhrFactory.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((te,he)=>a.setRequestHeader(te,he.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const te=n.detectContentTypeHeader();null!==te&&a.setRequestHeader("Content-Type",te)}if(n.responseType){const te=n.responseType.toLowerCase();a.responseType="json"!==te?te:"text"}const u=n.serializeBody();let g=null;const b=()=>{if(null!==g)return g;const te=1223===a.status?204:a.status,he=a.statusText||"OK",Re=new Hu(a.getAllResponseHeaders()),De=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(a)||n.url;return g=new Hx({headers:Re,status:te,statusText:he,url:De}),g},D=()=>{let{headers:te,status:he,statusText:Re,url:De}=b(),Ze=null;204!==he&&(Ze=void 0===a.response?a.responseText:a.response),0===he&&(he=Ze?200:0);let Ve=he>=200&&he<300;if("json"===n.responseType&&"string"==typeof Ze){const _t=Ze;Ze=Ze.replace(pN,"");try{Ze=""!==Ze?JSON.parse(Ze):null}catch(St){Ze=_t,Ve&&(Ve=!1,Ze={error:St,text:Ze})}}Ve?(r.next(new fy({body:Ze,headers:te,status:he,statusText:Re,url:De||void 0})),r.complete()):r.error(new iD({error:Ze,headers:te,status:he,statusText:Re,url:De||void 0}))},I=te=>{const{url:he}=b(),Re=new iD({error:te,status:a.status||0,statusText:a.statusText||"Unknown Error",url:he||void 0});r.error(Re)};let N=!1;const Z=te=>{N||(r.next(b()),N=!0);let he={type:fo.DownloadProgress,loaded:te.loaded};te.lengthComputable&&(he.total=te.total),"text"===n.responseType&&!!a.responseText&&(he.partialText=a.responseText),r.next(he)},K=te=>{let he={type:fo.UploadProgress,loaded:te.loaded};te.lengthComputable&&(he.total=te.total),r.next(he)};return a.addEventListener("load",D),a.addEventListener("error",I),a.addEventListener("timeout",I),a.addEventListener("abort",I),n.reportProgress&&(a.addEventListener("progress",Z),null!==u&&a.upload&&a.upload.addEventListener("progress",K)),a.send(u),r.next({type:fo.Sent}),()=>{a.removeEventListener("error",I),a.removeEventListener("abort",I),a.removeEventListener("load",D),a.removeEventListener("timeout",I),n.reportProgress&&(a.removeEventListener("progress",Z),null!==u&&a.upload&&a.upload.removeEventListener("progress",K)),a.readyState!==a.DONE&&a.abort()}})}}return t.\u0275fac=function(n){return new(n||t)(pt(NT))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const qx=new Yt("XSRF_COOKIE_NAME"),Wx=new Yt("XSRF_HEADER_NAME");class aD{}let gN=(()=>{class t{constructor(n,r,a){this.doc=n,this.platform=r,this.cookieName=a,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=AT(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return t.\u0275fac=function(n){return new(n||t)(pt($o),pt(z_),pt(qx))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),Xx=(()=>{class t{constructor(n,r){this.tokenService=n,this.headerName=r}intercept(n,r){const a=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||a.startsWith("http://")||a.startsWith("https://"))return r.handle(n);const u=this.tokenService.getToken();return null!==u&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,u)})),r.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(pt(aD),pt(Wx))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),_N=(()=>{class t{constructor(n,r){this.backend=n,this.injector=r,this.chain=null}handle(n){if(null===this.chain){const r=this.injector.get(oD,[]);this.chain=r.reduceRight((a,u)=>new rD(a,u),this.backend)}return this.chain.handle(n)}}return t.\u0275fac=function(n){return new(n||t)(pt(YT),pt(fi))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),yN=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Xx,useClass:fN}]}}static withOptions(n={}){return{ngModule:t,providers:[n.cookieName?{provide:qx,useValue:n.cookieName}:[],n.headerName?{provide:Wx,useValue:n.headerName}:[]]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({providers:[Xx,{provide:oD,useExisting:Xx,multi:!0},{provide:aD,useClass:gN},{provide:qx,useValue:"XSRF-TOKEN"},{provide:Wx,useValue:"X-XSRF-TOKEN"}]}),t})(),vN=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({providers:[Zx,{provide:KT,useClass:_N},sD,{provide:YT,useExisting:sD}],imports:[[yN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();class vc extends Pi{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return n&&!n.closed&&e.next(this._value),n}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new si;return this._value}next(e){super.next(this._value=e)}}class xN extends In{notifyNext(e,n,r,a,u){this.destination.next(n)}notifyError(e,n){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class bN extends In{constructor(e,n,r){super(),this.parent=e,this.outerValue=n,this.outerIndex=r,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function wN(t,e,n,r,a=new bN(t,n,r)){if(!a.closed)return e instanceof Pn?e.subscribe(a):ea(e)(a)}const lD={};class EN{constructor(e){this.resultSelector=e}call(e,n){return n.subscribe(new TN(e,this.resultSelector))}}class TN extends xN{constructor(e,n){super(e),this.resultSelector=n,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(lD),this.observables.push(e)}_complete(){const e=this.observables,n=e.length;if(0===n)this.destination.complete();else{this.active=n,this.toRespond=n;for(let r=0;r<n;r++)this.add(wN(this,e[r],void 0,r))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,n,r){const a=this.values,g=this.toRespond?a[r]===lD?--this.toRespond:this.toRespond:0;a[r]=n,0===g&&(this.resultSelector?this._tryResultSelector(a):this.destination.next(a.slice()))}_tryResultSelector(e){let n;try{n=this.resultSelector.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const py=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function Kx(...t){return Xr(1)(gn(...t))}const ip=new Pn(t=>t.complete());function Yx(t){return t?function(t){return new Pn(e=>t.schedule(()=>e.complete()))}(t):ip}function cD(t){return new Pn(e=>{let n;try{n=t()}catch(a){return void e.error(a)}return(n?Jn(n):Yx()).subscribe(e)})}function bh(t,e){return"function"==typeof e?n=>n.pipe(bh((r,a)=>Jn(t(r,a)).pipe(tn((u,g)=>e(r,u,a,g))))):n=>n.lift(new MN(t))}class MN{constructor(e){this.project=e}call(e,n){return n.subscribe(new AN(e,this.project))}}class AN extends go{constructor(e,n){super(e),this.project=n,this.index=0}_next(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(a){return void this.destination.error(a)}this._innerSub(n)}_innerSub(e){const n=this.innerSubscription;n&&n.unsubscribe();const r=new ko(this),a=this.destination;a.add(r),this.innerSubscription=_o(e,r),this.innerSubscription!==r&&a.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const uD=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function Jx(t){return e=>0===t?Yx():e.lift(new IN(t))}class IN{constructor(e){if(this.total=e,this.total<0)throw new uD}call(e,n){return n.subscribe(new PN(e,this.total))}}class PN extends In{constructor(e,n){super(e),this.total=n,this.count=0}_next(e){const n=this.total,r=++this.count;r<=n&&(this.destination.next(e),r===n&&(this.destination.complete(),this.unsubscribe()))}}function hD(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(a){return a.lift(new RN(t,e,n))}}class RN{constructor(e,n,r=!1){this.accumulator=e,this.seed=n,this.hasSeed=r}call(e,n){return n.subscribe(new LN(e,this.accumulator,this.seed,this.hasSeed))}}class LN extends In{constructor(e,n,r,a){super(e),this.accumulator=n,this._seed=r,this.hasSeed=a,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const n=this.index++;let r;try{r=this.accumulator(this.seed,e,n)}catch(a){this.destination.error(a)}this.seed=r,this.destination.next(r)}}function Ed(t){return function(n){const r=new ON(t),a=n.lift(r);return r.caught=a}}class ON{constructor(e){this.selector=e}call(e,n){return n.subscribe(new FN(e,this.selector,this.caught))}}class FN extends go{constructor(e,n,r){super(e),this.selector=n,this.caught=r}error(e){if(!this.isStopped){let n;try{n=this.selector(e,this.caught)}catch(u){return void super.error(u)}this._unsubscribeAndRecycle();const r=new ko(this);this.add(r);const a=_o(n,r);a!==r&&this.add(a)}}}function Qx(t){return function(n){return 0===t?Yx():n.lift(new NN(t))}}class NN{constructor(e){if(this.total=e,this.total<0)throw new uD}call(e,n){return n.subscribe(new zN(e,this.total))}}class zN extends In{constructor(e,n){super(e),this.total=n,this.ring=new Array,this.count=0}_next(e){const n=this.ring,r=this.total,a=this.count++;n.length<r?n.push(e):n[a%r]=e}_complete(){const e=this.destination;let n=this.count;if(n>0){const r=this.count>=this.total?this.total:this.count,a=this.ring;for(let u=0;u<r;u++){const g=n++%r;e.next(a[g])}}e.complete()}}function dD(t=UN){return e=>e.lift(new BN(t))}class BN{constructor(e){this.errorFactory=e}call(e,n){return n.subscribe(new VN(e,this.errorFactory))}}class VN extends In{constructor(e,n){super(e),this.errorFactory=n,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(n){e=n}this.destination.error(e)}}}function UN(){return new py}function fD(t=null){return e=>e.lift(new jN(t))}class jN{constructor(e){this.defaultValue=e}call(e,n){return n.subscribe(new $N(e,this.defaultValue))}}class $N extends In{constructor(e,n){super(e),this.defaultValue=n,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function rp(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Cd((a,u)=>t(a,u,r)):gi,Jx(1),n?fD(e):dD(()=>new py))}function wh(){}function ol(t,e,n){return function(a){return a.lift(new GN(t,e,n))}}class GN{constructor(e,n,r){this.nextOrObserver=e,this.error=n,this.complete=r}call(e,n){return n.subscribe(new ZN(e,this.nextOrObserver,this.error,this.complete))}}class ZN extends In{constructor(e,n,r,a){super(e),this._tapNext=wh,this._tapError=wh,this._tapComplete=wh,this._tapError=r||wh,this._tapComplete=a||wh,Go(n)?(this._context=this,this._tapNext=n):n&&(this._context=n,this._tapNext=n.next||wh,this._tapError=n.error||wh,this._tapComplete=n.complete||wh)}_next(e){try{this._tapNext.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class WN{constructor(e){this.callback=e}call(e,n){return n.subscribe(new XN(e,this.callback))}}class XN extends In{constructor(e,n){super(e),this.add(new at(n))}}class Gu{constructor(e,n){this.id=e,this.url=n}}class eb extends Gu{constructor(e,n,r="imperative",a=null){super(e,n),this.navigationTrigger=r,this.restoredState=a}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ym extends Gu{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class pD extends Gu{constructor(e,n,r){super(e,n),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class KN extends Gu{constructor(e,n,r){super(e,n),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class YN extends Gu{constructor(e,n,r,a){super(e,n),this.urlAfterRedirects=r,this.state=a}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class JN extends Gu{constructor(e,n,r,a){super(e,n),this.urlAfterRedirects=r,this.state=a}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class QN extends Gu{constructor(e,n,r,a,u){super(e,n),this.urlAfterRedirects=r,this.state=a,this.shouldActivate=u}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ez extends Gu{constructor(e,n,r,a){super(e,n),this.urlAfterRedirects=r,this.state=a}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tz extends Gu{constructor(e,n,r,a){super(e,n),this.urlAfterRedirects=r,this.state=a}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mD{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class gD{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class nz{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iz{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rz{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oz{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _D{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Fn="primary";class sz{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function op(t){return new sz(t)}const yD="ngNavigationCancelingError";function tb(t){const e=Error("NavigationCancelingError: "+t);return e[yD]=!0,e}function lz(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const a={};for(let u=0;u<r.length;u++){const g=r[u],b=t[u];if(g.startsWith(":"))a[g.substring(1)]=b;else if(g!==b.path)return null}return{consumed:t.slice(0,r.length),posParams:a}}function au(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let a;for(let u=0;u<n.length;u++)if(a=n[u],!vD(t[a],e[a]))return!1;return!0}function vD(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((a,u)=>r[u]===a)}return t===e}function xD(t){return Array.prototype.concat.apply([],t)}function bD(t){return t.length>0?t[t.length-1]:null}function os(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function lu(t){return y_(t)?t:xm(t)?Jn(Promise.resolve(t)):gn(t)}const hz={exact:function ED(t,e,n){if(!Dd(t.segments,e.segments)||!my(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!ED(t.children[r],e.children[r],n))return!1;return!0},subset:TD},wD={exact:function(t,e){return au(t,e)},subset:function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>vD(t[n],e[n]))},ignored:()=>!0};function CD(t,e,n){return hz[n.paths](t.root,e.root,n.matrixParams)&&wD[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function TD(t,e,n){return DD(t,e,e.segments,n)}function DD(t,e,n,r){if(t.segments.length>n.length){const a=t.segments.slice(0,n.length);return!(!Dd(a,n)||e.hasChildren()||!my(a,n,r))}if(t.segments.length===n.length){if(!Dd(t.segments,n)||!my(t.segments,n,r))return!1;for(const a in e.children)if(!t.children[a]||!TD(t.children[a],e.children[a],r))return!1;return!0}{const a=n.slice(0,t.segments.length),u=n.slice(t.segments.length);return!!(Dd(t.segments,a)&&my(t.segments,a,r)&&t.children[Fn])&&DD(t.children[Fn],e,u,r)}}function my(t,e,n){return e.every((r,a)=>wD[n](t[a].parameters,r.parameters))}class Td{constructor(e,n,r){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=op(this.queryParams)),this._queryParamMap}toString(){return gz.serialize(this)}}class $n{constructor(e,n){this.segments=e,this.children=n,this.parent=null,os(n,(r,a)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return gy(this)}}class Jm{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=op(this.parameters)),this._parameterMap}toString(){return ID(this)}}function Dd(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}class nb{}class SD{parse(e){const n=new Tz(e);return new Td(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){return`${`/${Qm(e.root,!0)}`}${function(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(a=>`${_y(n)}=${_y(a)}`).join("&"):`${_y(n)}=${_y(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${function(t){return encodeURI(t)}(e.fragment)}`:""}`}}const gz=new SD;function gy(t){return t.segments.map(e=>ID(e)).join("/")}function Qm(t,e){if(!t.hasChildren())return gy(t);if(e){const n=t.children[Fn]?Qm(t.children[Fn],!1):"",r=[];return os(t.children,(a,u)=>{u!==Fn&&r.push(`${u}:${Qm(a,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function(t,e){let n=[];return os(t.children,(r,a)=>{a===Fn&&(n=n.concat(e(r,a)))}),os(t.children,(r,a)=>{a!==Fn&&(n=n.concat(e(r,a)))}),n}(t,(r,a)=>a===Fn?[Qm(t.children[Fn],!1)]:[`${a}:${Qm(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Fn]?`${gy(t)}/${n[0]}`:`${gy(t)}/(${n.join("//")})`}}function MD(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _y(t){return MD(t).replace(/%3B/gi,";")}function ib(t){return MD(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yy(t){return decodeURIComponent(t)}function AD(t){return yy(t.replace(/\+/g,"%20"))}function ID(t){return`${ib(t.path)}${function(t){return Object.keys(t).map(e=>`;${ib(e)}=${ib(t[e])}`).join("")}(t.parameters)}`}const xz=/^[^\/()?;=#]+/;function vy(t){const e=t.match(xz);return e?e[0]:""}const bz=/^[^=?&#]+/,Cz=/^[^?&#]+/;class Tz{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new $n([],{}):new $n([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[Fn]=new $n(e,n)),r}parseSegment(){const e=vy(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Jm(yy(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=vy(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const a=vy(this.remaining);a&&(r=a,this.capture(r))}e[yy(n)]=yy(r)}parseQueryParam(e){const n=function(t){const e=t.match(bz);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const g=function(t){const e=t.match(Cz);return e?e[0]:""}(this.remaining);g&&(r=g,this.capture(r))}const a=AD(n),u=AD(r);if(e.hasOwnProperty(a)){let g=e[a];Array.isArray(g)||(g=[g],e[a]=g),g.push(u)}else e[a]=u}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=vy(this.remaining),a=this.remaining[r.length];if("/"!==a&&")"!==a&&";"!==a)throw new Error(`Cannot parse url '${this.url}'`);let u;r.indexOf(":")>-1?(u=r.substr(0,r.indexOf(":")),this.capture(u),this.capture(":")):e&&(u=Fn);const g=this.parseChildren();n[u]=1===Object.keys(g).length?g[Fn]:new $n([],g),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class PD{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=rb(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=rb(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=ob(e,this._root);return n.length<2?[]:n[n.length-2].children.map(a=>a.value).filter(a=>a!==e)}pathFromRoot(e){return ob(e,this._root).map(n=>n.value)}}function rb(t,e){if(t===e.value)return e;for(const n of e.children){const r=rb(t,n);if(r)return r}return null}function ob(t,e){if(t===e.value)return[e];for(const n of e.children){const r=ob(t,n);if(r.length)return r.unshift(e),r}return[]}class Zu{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function eg(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class kD extends PD{constructor(e,n){super(e),this.snapshot=n,sb(this,e)}toString(){return this.snapshot.toString()}}function RD(t,e){const n=function(t,e){const g=new xy([],{},{},"",{},Fn,e,null,t.root,-1,{});return new OD("",new Zu(g,[]))}(t,e),r=new vc([new Jm("",{})]),a=new vc({}),u=new vc({}),g=new vc({}),b=new vc(""),D=new sp(r,a,g,b,u,Fn,e,n.root);return D.snapshot=n.root,new kD(new Zu(D,[]),n)}class sp{constructor(e,n,r,a,u,g,b,D){this.url=e,this.params=n,this.queryParams=r,this.fragment=a,this.data=u,this.outlet=g,this.component=b,this._futureSnapshot=D}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(tn(e=>op(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(tn(e=>op(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function LD(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const a=n[r],u=n[r-1];if(a.routeConfig&&""===a.routeConfig.path)r--;else{if(u.component)break;r--}}return function(t){return t.reduce((e,n)=>({params:Object.assign(Object.assign({},e.params),n.params),data:Object.assign(Object.assign({},e.data),n.data),resolve:Object.assign(Object.assign({},e.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class xy{constructor(e,n,r,a,u,g,b,D,I,N,Z){this.url=e,this.params=n,this.queryParams=r,this.fragment=a,this.data=u,this.outlet=g,this.component=b,this.routeConfig=D,this._urlSegment=I,this._lastPathIndex=N,this._resolve=Z}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=op(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=op(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class OD extends PD{constructor(e,n){super(n),this.url=e,sb(this,n)}toString(){return FD(this._root)}}function sb(t,e){e.value._routerState=t,e.children.forEach(n=>sb(t,n))}function FD(t){const e=t.children.length>0?` { ${t.children.map(FD).join(", ")} } `:"";return`${t.value}${e}`}function ab(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,au(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),au(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!au(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),au(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function lb(t,e){return au(t.params,e.params)&&function(t,e){return Dd(t,e)&&t.every((n,r)=>au(n.parameters,e[r].parameters))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||lb(t.parent,e.parent))}function by(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const a=function(t,e,n){return e.children.map(r=>{for(const a of n.children)if(t.shouldReuseRoute(r.value,a.value.snapshot))return by(t,r,a);return by(t,r)})}(t,e,n);return new Zu(r,a)}{if(t.shouldAttach(e.value)){const u=t.retrieve(e.value);if(null!==u){const g=u.route;return ND(e,g),g}}const r=function(t){return new sp(new vc(t.url),new vc(t.params),new vc(t.queryParams),new vc(t.fragment),new vc(t.data),t.outlet,t.component,t)}(e.value),a=e.children.map(u=>by(t,u));return new Zu(r,a)}}function ND(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)ND(t.children[n],e.children[n])}function wy(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function tg(t){return"object"==typeof t&&null!=t&&t.outlets}function cb(t,e,n,r,a){let u={};return r&&os(r,(g,b)=>{u[b]=Array.isArray(g)?g.map(D=>`${D}`):`${g}`}),new Td(n.root===t?e:zD(n.root,t,e),u,a)}function zD(t,e,n){const r={};return os(t.children,(a,u)=>{r[u]=a===e?n:zD(a,e,n)}),new $n(t.segments,r)}class BD{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&wy(r[0]))throw new Error("Root segment cannot have matrix parameters");const a=r.find(tg);if(a&&a!==bD(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ub{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function VD(t,e,n){if(t||(t=new $n([],{})),0===t.segments.length&&t.hasChildren())return Cy(t,e,n);const r=function(t,e,n){let r=0,a=e;const u={match:!1,pathIndex:0,commandIndex:0};for(;a<t.segments.length;){if(r>=n.length)return u;const g=t.segments[a],b=n[r];if(tg(b))break;const D=`${b}`,I=r<n.length-1?n[r+1]:null;if(a>0&&void 0===D)break;if(D&&I&&"object"==typeof I&&void 0===I.outlets){if(!jD(D,I,g))return u;r+=2}else{if(!jD(D,{},g))return u;r++}a++}return{match:!0,pathIndex:a,commandIndex:r}}(t,e,n),a=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const u=new $n(t.segments.slice(0,r.pathIndex),{});return u.children[Fn]=new $n(t.segments.slice(r.pathIndex),t.children),Cy(u,0,a)}return r.match&&0===a.length?new $n(t.segments,{}):r.match&&!t.hasChildren()?hb(t,e,n):r.match?Cy(t,0,a):hb(t,e,n)}function Cy(t,e,n){if(0===n.length)return new $n(t.segments,{});{const r=function(t){return tg(t[0])?t[0].outlets:{[Fn]:t}}(n),a={};return os(r,(u,g)=>{"string"==typeof u&&(u=[u]),null!==u&&(a[g]=VD(t.children[g],e,u))}),os(t.children,(u,g)=>{void 0===r[g]&&(a[g]=u)}),new $n(t.segments,a)}}function hb(t,e,n){const r=t.segments.slice(0,e);let a=0;for(;a<n.length;){const u=n[a];if(tg(u)){const D=Nz(u.outlets);return new $n(r,D)}if(0===a&&wy(n[0])){r.push(new Jm(t.segments[e].path,UD(n[0]))),a++;continue}const g=tg(u)?u.outlets[Fn]:`${u}`,b=a<n.length-1?n[a+1]:null;g&&b&&wy(b)?(r.push(new Jm(g,UD(b))),a+=2):(r.push(new Jm(g,{})),a++)}return new $n(r,{})}function Nz(t){const e={};return os(t,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[r]=hb(new $n([],{}),0,n))}),e}function UD(t){const e={};return os(t,(n,r)=>e[r]=`${n}`),e}function jD(t,e,n){return t==n.path&&au(e,n.parameters)}class Bz{constructor(e,n,r,a){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=a}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),ab(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const a=eg(n);e.children.forEach(u=>{const g=u.value.outlet;this.deactivateRoutes(u,a[g],r),delete a[g]}),os(a,(u,g)=>{this.deactivateRouteAndItsChildren(u,r)})}deactivateRoutes(e,n,r){const a=e.value,u=n?n.value:null;if(a===u)if(a.component){const g=r.getContext(a.outlet);g&&this.deactivateChildRoutes(e,n,g.children)}else this.deactivateChildRoutes(e,n,r);else u&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet);if(r&&r.outlet){const a=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),a=r&&e.value.component?r.children:n,u=eg(e);for(const g of Object.keys(u))this.deactivateRouteAndItsChildren(u[g],a);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,n,r){const a=eg(n);e.children.forEach(u=>{this.activateRoutes(u,a[u.value.outlet],r),this.forwardEvent(new oz(u.value.snapshot))}),e.children.length&&this.forwardEvent(new iz(e.value.snapshot))}activateRoutes(e,n,r){const a=e.value,u=n?n.value:null;if(ab(a),a===u)if(a.component){const g=r.getOrCreateContext(a.outlet);this.activateChildRoutes(e,n,g.children)}else this.activateChildRoutes(e,n,r);else if(a.component){const g=r.getOrCreateContext(a.outlet);if(this.routeReuseStrategy.shouldAttach(a.snapshot)){const b=this.routeReuseStrategy.retrieve(a.snapshot);this.routeReuseStrategy.store(a.snapshot,null),g.children.onOutletReAttached(b.contexts),g.attachRef=b.componentRef,g.route=b.route.value,g.outlet&&g.outlet.attach(b.componentRef,b.route.value),$D(b.route)}else{const b=function(t){for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(a.snapshot),D=b?b.module.componentFactoryResolver:null;g.attachRef=null,g.route=a,g.resolver=D,g.outlet&&g.outlet.activateWith(a,D),this.activateChildRoutes(e,null,g.children)}}else this.activateChildRoutes(e,null,r)}}function $D(t){ab(t.value),t.children.forEach($D)}class db{constructor(e,n){this.routes=e,this.module=n}}function Ch(t){return"function"==typeof t}function Sd(t){return t instanceof Td}const ng=Symbol("INITIAL_VALUE");function ig(){return bh(t=>function(...t){let e,n;return _i(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&Qt(t[0])&&(t=t[0]),Er(t,n).lift(new EN(e))}(t.map(e=>e.pipe(Jx(1),function(...t){const e=t[t.length-1];return _i(e)?(t.pop(),n=>Kx(t,n,e)):n=>Kx(t,n)}(ng)))).pipe(hD((e,n)=>{let r=!1;return n.reduce((a,u,g)=>a!==ng?a:(u===ng&&(r=!0),r||!1!==u&&g!==n.length-1&&!Sd(u)?a:u),e)},ng),Cd(e=>e!==ng),tn(e=>Sd(e)?e:!0===e),Jx(1)))}let HD=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,r){1&n&&Fe(0,"router-outlet")},directives:function(){return[_b]},encapsulation:2}),t})();function GD(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];Zz(r,qz(e,r))}}function Zz(t,e){t.children&&GD(t.children,e)}function qz(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function fb(t){const e=t.children&&t.children.map(fb),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Fn&&(n.component=HD),n}function Ll(t){return t.outlet||Fn}function ZD(t,e){const n=t.filter(r=>Ll(r)===e);return n.push(...t.filter(r=>Ll(r)!==e)),n}const qD={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Ey(t,e,n){var r;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},qD):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const u=(e.matcher||lz)(n,t,e);if(!u)return Object.assign({},qD);const g={};os(u.posParams,(D,I)=>{g[I]=D.path});const b=u.consumed.length>0?Object.assign(Object.assign({},g),u.consumed[u.consumed.length-1].parameters):g;return{matched:!0,consumedSegments:u.consumed,lastChild:u.consumed.length,parameters:b,positionalParamSegments:null!==(r=u.posParams)&&void 0!==r?r:{}}}function Ty(t,e,n,r,a="corrected"){if(n.length>0&&function(t,e,n){return n.some(r=>Dy(t,e,r)&&Ll(r)!==Fn)}(t,n,r)){const g=new $n(e,function(t,e,n,r){const a={};a[Fn]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const u of n)if(""===u.path&&Ll(u)!==Fn){const g=new $n([],{});g._sourceSegment=t,g._segmentIndexShift=e.length,a[Ll(u)]=g}return a}(t,e,r,new $n(n,t.children)));return g._sourceSegment=t,g._segmentIndexShift=e.length,{segmentGroup:g,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(r=>Dy(t,e,r))}(t,n,r)){const g=new $n(t.segments,function(t,e,n,r,a,u){const g={};for(const b of r)if(Dy(t,n,b)&&!a[Ll(b)]){const D=new $n([],{});D._sourceSegment=t,D._segmentIndexShift="legacy"===u?t.segments.length:e.length,g[Ll(b)]=D}return Object.assign(Object.assign({},a),g)}(t,e,n,r,t.children,a));return g._sourceSegment=t,g._segmentIndexShift=e.length,{segmentGroup:g,slicedSegments:n}}const u=new $n(t.segments,t.children);return u._sourceSegment=t,u._segmentIndexShift=e.length,{segmentGroup:u,slicedSegments:n}}function Dy(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function WD(t,e,n,r){return!!(Ll(t)===r||r!==Fn&&Dy(e,n,t))&&("**"===t.path||Ey(e,t,n).matched)}function XD(t,e,n){return 0===e.length&&!t.children[n]}class rg{constructor(e){this.segmentGroup=e||null}}class KD{constructor(e){this.urlTree=e}}function Sy(t){return new Pn(e=>e.error(new rg(t)))}function YD(t){return new Pn(e=>e.error(new KD(t)))}function Jz(t){return new Pn(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class t3{constructor(e,n,r,a,u){this.configLoader=n,this.urlSerializer=r,this.urlTree=a,this.config=u,this.allowRedirects=!0,this.ngModule=e.get(ou)}apply(){const e=Ty(this.urlTree.root,[],[],this.config).segmentGroup,n=new $n(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,n,Fn).pipe(tn(u=>this.createUrlTree(pb(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ed(u=>{if(u instanceof KD)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof rg?this.noMatchError(u):u}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Fn).pipe(tn(a=>this.createUrlTree(pb(a),e.queryParams,e.fragment))).pipe(Ed(a=>{throw a instanceof rg?this.noMatchError(a):a}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,n,r){const a=e.segments.length>0?new $n([],{[Fn]:e}):e;return new Td(a,n,r)}expandSegmentGroup(e,n,r,a){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,n,r).pipe(tn(u=>new $n([],u))):this.expandSegment(e,r,n,r.segments,a,!0)}expandChildren(e,n,r){const a=[];for(const u of Object.keys(r.children))"primary"===u?a.unshift(u):a.push(u);return Jn(a).pipe(np(u=>{const g=r.children[u],b=ZD(n,u);return this.expandSegmentGroup(e,b,g,u).pipe(tn(D=>({segment:D,outlet:u})))}),hD((u,g)=>(u[g.outlet]=g.segment,u),{}),function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Cd((a,u)=>t(a,u,r)):gi,Qx(1),n?fD(e):dD(()=>new py))}())}expandSegment(e,n,r,a,u,g){return Jn(r).pipe(np(b=>this.expandSegmentAgainstRoute(e,n,r,b,a,u,g).pipe(Ed(I=>{if(I instanceof rg)return gn(null);throw I}))),rp(b=>!!b),Ed((b,D)=>{if(b instanceof py||"EmptyError"===b.name){if(XD(n,a,u))return gn(new $n([],{}));throw new rg(n)}throw b}))}expandSegmentAgainstRoute(e,n,r,a,u,g,b){return WD(a,n,u,g)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(e,n,a,u,g):b&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,r,a,u,g):Sy(n):Sy(n)}expandSegmentAgainstRouteUsingRedirect(e,n,r,a,u,g){return"**"===a.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,a,g):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,a,u,g)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a){const u=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?YD(u):this.lineralizeSegments(r,u).pipe(Nn(g=>{const b=new $n(g,{});return this.expandSegment(e,b,n,g,a,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,a,u,g){const{matched:b,consumedSegments:D,lastChild:I,positionalParamSegments:N}=Ey(n,a,u);if(!b)return Sy(n);const Z=this.applyRedirectCommands(D,a.redirectTo,N);return a.redirectTo.startsWith("/")?YD(Z):this.lineralizeSegments(a,Z).pipe(Nn(K=>this.expandSegment(e,n,r,K.concat(u.slice(I)),g,!1)))}matchSegmentAgainstRoute(e,n,r,a,u){if("**"===r.path)return r.loadChildren?(r._loadedConfig?gn(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe(tn(K=>(r._loadedConfig=K,new $n(a,{})))):gn(new $n(a,{}));const{matched:g,consumedSegments:b,lastChild:D}=Ey(n,r,a);if(!g)return Sy(n);const I=a.slice(D);return this.getChildConfig(e,r,a).pipe(Nn(Z=>{const K=Z.module,te=Z.routes,{segmentGroup:he,slicedSegments:Re}=Ty(n,b,I,te),De=new $n(he.segments,he.children);if(0===Re.length&&De.hasChildren())return this.expandChildren(K,te,De).pipe(tn(St=>new $n(b,St)));if(0===te.length&&0===Re.length)return gn(new $n(b,{}));const Ze=Ll(r)===u;return this.expandSegment(K,De,te,Re,Ze?Fn:u,!0).pipe(tn(_t=>new $n(b.concat(_t.segments),_t.children)))}))}getChildConfig(e,n,r){return n.children?gn(new db(n.children,e)):n.loadChildren?void 0!==n._loadedConfig?gn(n._loadedConfig):this.runCanLoadGuards(e.injector,n,r).pipe(Nn(a=>a?this.configLoader.load(e.injector,n).pipe(tn(u=>(n._loadedConfig=u,u))):function(t){return new Pn(e=>e.error(tb(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(n))):gn(new db([],e))}runCanLoadGuards(e,n,r){const a=n.canLoad;return a&&0!==a.length?gn(a.map(g=>{const b=e.get(g);let D;if(function(t){return t&&Ch(t.canLoad)}(b))D=b.canLoad(n,r);else{if(!Ch(b))throw new Error("Invalid CanLoad guard");D=b(n,r)}return lu(D)})).pipe(ig(),ol(g=>{if(!Sd(g))return;const b=tb(`Redirecting to "${this.urlSerializer.serialize(g)}"`);throw b.url=g,b}),tn(g=>!0===g)):gn(!0)}lineralizeSegments(e,n){let r=[],a=n.root;for(;;){if(r=r.concat(a.segments),0===a.numberOfChildren)return gn(r);if(a.numberOfChildren>1||!a.children[Fn])return Jz(e.redirectTo);a=a.children[Fn]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreatreUrlTree(e,n,r,a){const u=this.createSegmentGroup(e,n.root,r,a);return new Td(u,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return os(e,(a,u)=>{if("string"==typeof a&&a.startsWith(":")){const b=a.substring(1);r[u]=n[b]}else r[u]=a}),r}createSegmentGroup(e,n,r,a){const u=this.createSegments(e,n.segments,r,a);let g={};return os(n.children,(b,D)=>{g[D]=this.createSegmentGroup(e,b,r,a)}),new $n(u,g)}createSegments(e,n,r,a){return n.map(u=>u.path.startsWith(":")?this.findPosParam(e,u,a):this.findOrReturn(u,r))}findPosParam(e,n,r){const a=r[n.path.substring(1)];if(!a)throw new Error(`Cannot redirect to '${e}'. Cannot find '${n.path}'.`);return a}findOrReturn(e,n){let r=0;for(const a of n){if(a.path===e.path)return n.splice(r),a;r++}return e}}function pb(t){const e={};for(const r of Object.keys(t.children)){const u=pb(t.children[r]);(u.segments.length>0||u.hasChildren())&&(e[r]=u)}return function(t){if(1===t.numberOfChildren&&t.children[Fn]){const e=t.children[Fn];return new $n(t.segments.concat(e.segments),e.children)}return t}(new $n(t.segments,e))}class JD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class My{constructor(e,n){this.component=e,this.route=n}}function r3(t,e,n){const r=t._root;return og(r,e?e._root:null,n,[r.value])}function Ay(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function og(t,e,n,r,a={canDeactivateChecks:[],canActivateChecks:[]}){const u=eg(e);return t.children.forEach(g=>{(function(t,e,n,r,a={canDeactivateChecks:[],canActivateChecks:[]}){const u=t.value,g=e?e.value:null,b=n?n.getContext(t.value.outlet):null;if(g&&u.routeConfig===g.routeConfig){const D=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Dd(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Dd(t.url,e.url)||!au(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lb(t,e)||!au(t.queryParams,e.queryParams);case"paramsChange":default:return!lb(t,e)}}(g,u,u.routeConfig.runGuardsAndResolvers);D?a.canActivateChecks.push(new JD(r)):(u.data=g.data,u._resolvedData=g._resolvedData),og(t,e,u.component?b?b.children:null:n,r,a),D&&b&&b.outlet&&b.outlet.isActivated&&a.canDeactivateChecks.push(new My(b.outlet.component,g))}else g&&sg(e,b,a),a.canActivateChecks.push(new JD(r)),og(t,null,u.component?b?b.children:null:n,r,a)})(g,u[g.value.outlet],n,r.concat([g.value]),a),delete u[g.value.outlet]}),os(u,(g,b)=>sg(g,n.getContext(b),a)),a}function sg(t,e,n){const r=eg(t),a=t.value;os(r,(u,g)=>{sg(u,a.component?e?e.children.getContext(g):null:e,n)}),n.canDeactivateChecks.push(new My(a.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,a))}class _3{}function QD(t){return new Pn(e=>e.error(t))}class v3{constructor(e,n,r,a,u,g){this.rootComponentType=e,this.config=n,this.urlTree=r,this.url=a,this.paramsInheritanceStrategy=u,this.relativeLinkResolution=g}recognize(){const e=Ty(this.urlTree.root,[],[],this.config.filter(g=>void 0===g.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,e,Fn);if(null===n)return null;const r=new xy([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Fn,this.rootComponentType,null,this.urlTree.root,-1,{}),a=new Zu(r,n),u=new OD(this.url,a);return this.inheritParamsAndData(u._root),u}inheritParamsAndData(e){const n=e.value,r=LD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(a=>this.inheritParamsAndData(a))}processSegmentGroup(e,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,n):this.processSegment(e,n,n.segments,r)}processChildren(e,n){const r=[];for(const u of Object.keys(n.children)){const g=n.children[u],b=ZD(e,u),D=this.processSegmentGroup(b,g,u);if(null===D)return null;r.push(...D)}const a=eS(r);return function(t){t.sort((e,n)=>e.value.outlet===Fn?-1:n.value.outlet===Fn?1:e.value.outlet.localeCompare(n.value.outlet))}(a),a}processSegment(e,n,r,a){for(const u of e){const g=this.processSegmentAgainstRoute(u,n,r,a);if(null!==g)return g}return XD(n,r,a)?[]:null}processSegmentAgainstRoute(e,n,r,a){if(e.redirectTo||!WD(e,n,r,a))return null;let u,g=[],b=[];if("**"===e.path){const te=r.length>0?bD(r).parameters:{};u=new xy(r,te,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,iS(e),Ll(e),e.component,e,tS(n),nS(n)+r.length,rS(e))}else{const te=Ey(n,e,r);if(!te.matched)return null;g=te.consumedSegments,b=r.slice(te.lastChild),u=new xy(g,te.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,iS(e),Ll(e),e.component,e,tS(n),nS(n)+g.length,rS(e))}const D=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(e),{segmentGroup:I,slicedSegments:N}=Ty(n,g,b,D.filter(te=>void 0===te.redirectTo),this.relativeLinkResolution);if(0===N.length&&I.hasChildren()){const te=this.processChildren(D,I);return null===te?null:[new Zu(u,te)]}if(0===D.length&&0===N.length)return[new Zu(u,[])];const Z=Ll(e)===a,K=this.processSegment(D,I,N,Z?Fn:a);return null===K?null:[new Zu(u,K)]}}function w3(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function eS(t){const e=[],n=new Set;for(const r of t){if(!w3(r)){e.push(r);continue}const a=e.find(u=>r.value.routeConfig===u.value.routeConfig);void 0!==a?(a.children.push(...r.children),n.add(a)):e.push(r)}for(const r of n){const a=eS(r.children);e.push(new Zu(r.value,a))}return e.filter(r=>!n.has(r))}function tS(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function nS(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function iS(t){return t.data||{}}function rS(t){return t.resolve||{}}function mb(t){return bh(e=>{const n=t(e);return n?Jn(n).pipe(tn(()=>e)):gn(e)})}class I3 extends class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}{}const gb=new Yt("ROUTES");class oS{constructor(e,n,r,a){this.loader=e,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=a}load(e,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const a=this.loadModuleFactory(n.loadChildren).pipe(tn(u=>{this.onLoadEndListener&&this.onLoadEndListener(n);const g=u.create(e);return new db(xD(g.injector.get(gb,void 0,wt.Self|wt.Optional)).map(fb),g)}),Ed(u=>{throw n._loader$=void 0,u}));return n._loader$=new oa(a,()=>new Pi).pipe(ra()),n._loader$}loadModuleFactory(e){return"string"==typeof e?Jn(this.loader.load(e)):lu(e()).pipe(Nn(n=>n instanceof SC?gn(n):Jn(this.compiler.compileModuleAsync(n))))}}class P3{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ap,this.attachRef=null}}class ap{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const r=this.getOrCreateContext(e);r.outlet=n,this.contexts.set(e,r)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new P3,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}class R3{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}function L3(t){throw t}function O3(t,e,n){return e.parse("/")}function sS(t,e){return gn(null)}const F3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},N3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ao=(()=>{class t{constructor(n,r,a,u,g,b,D,I){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=a,this.location=u,this.config=I,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Pi,this.errorHandler=L3,this.malformedUriErrorHandler=O3,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:sS,afterPreactivation:sS},this.urlHandlingStrategy=new R3,this.routeReuseStrategy=new I3,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=g.get(ou),this.console=g.get(B_);const K=g.get(mi);this.isNgZoneEnabled=K instanceof mi&&mi.isInAngularZone(),this.resetConfig(I),this.currentUrlTree=new Td(new $n([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new oS(b,D,te=>this.triggerEvent(new mD(te)),te=>this.triggerEvent(new gD(te))),this.routerState=RD(this.currentUrlTree,this.rootComponentType),this.transitions=new vc({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const r=this.events;return n.pipe(Cd(a=>0!==a.id),tn(a=>Object.assign(Object.assign({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),bh(a=>{let u=!1,g=!1;return gn(a).pipe(ol(b=>{this.currentNavigation={id:b.id,initialUrl:b.currentRawUrl,extractedUrl:b.extractedUrl,trigger:b.source,extras:b.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),bh(b=>{const D=this.browserUrlTree.toString(),I=!this.navigated||b.extractedUrl.toString()!==D||D!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||I)&&this.urlHandlingStrategy.shouldProcessUrl(b.rawUrl))return Iy(b.source)&&(this.browserUrlTree=b.extractedUrl),gn(b).pipe(bh(Z=>{const K=this.transitions.getValue();return r.next(new eb(Z.id,this.serializeUrl(Z.extractedUrl),Z.source,Z.restoredState)),K!==this.transitions.getValue()?ip:Promise.resolve(Z)}),function(t,e,n,r){return bh(a=>function(t,e,n,r,a){return new t3(t,e,n,r,a).apply()}(t,e,n,a.extractedUrl,r).pipe(tn(u=>Object.assign(Object.assign({},a),{urlAfterRedirects:u}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),ol(Z=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Z.urlAfterRedirects})}),function(t,e,n,r,a){return Nn(u=>function(t,e,n,r,a="emptyOnly",u="legacy"){try{const g=new v3(t,e,n,r,a,u).recognize();return null===g?QD(new _3):gn(g)}catch(g){return QD(g)}}(t,e,u.urlAfterRedirects,n(u.urlAfterRedirects),r,a).pipe(tn(g=>Object.assign(Object.assign({},u),{targetSnapshot:g}))))}(this.rootComponentType,this.config,Z=>this.serializeUrl(Z),this.paramsInheritanceStrategy,this.relativeLinkResolution),ol(Z=>{"eager"===this.urlUpdateStrategy&&(Z.extras.skipLocationChange||this.setBrowserUrl(Z.urlAfterRedirects,Z),this.browserUrlTree=Z.urlAfterRedirects);const K=new YN(Z.id,this.serializeUrl(Z.extractedUrl),this.serializeUrl(Z.urlAfterRedirects),Z.targetSnapshot);r.next(K)}));if(I&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:K,extractedUrl:te,source:he,restoredState:Re,extras:De}=b,Ze=new eb(K,this.serializeUrl(te),he,Re);r.next(Ze);const Ve=RD(te,this.rootComponentType).snapshot;return gn(Object.assign(Object.assign({},b),{targetSnapshot:Ve,urlAfterRedirects:te,extras:Object.assign(Object.assign({},De),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=b.rawUrl,this.browserUrlTree=b.urlAfterRedirects,b.resolve(null),ip}),mb(b=>{const{targetSnapshot:D,id:I,extractedUrl:N,rawUrl:Z,extras:{skipLocationChange:K,replaceUrl:te}}=b;return this.hooks.beforePreactivation(D,{navigationId:I,appliedUrlTree:N,rawUrlTree:Z,skipLocationChange:!!K,replaceUrl:!!te})}),ol(b=>{const D=new JN(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(b.urlAfterRedirects),b.targetSnapshot);this.triggerEvent(D)}),tn(b=>Object.assign(Object.assign({},b),{guards:r3(b.targetSnapshot,b.currentSnapshot,this.rootContexts)})),function(t,e){return Nn(n=>{const{targetSnapshot:r,currentSnapshot:a,guards:{canActivateChecks:u,canDeactivateChecks:g}}=n;return 0===g.length&&0===u.length?gn(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return Jn(t).pipe(Nn(a=>function(t,e,n,r,a){const u=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return u&&0!==u.length?gn(u.map(b=>{const D=Ay(b,e,a);let I;if(function(t){return t&&Ch(t.canDeactivate)}(D))I=lu(D.canDeactivate(t,e,n,r));else{if(!Ch(D))throw new Error("Invalid CanDeactivate guard");I=lu(D(t,e,n,r))}return I.pipe(rp())})).pipe(ig()):gn(!0)}(a.component,a.route,n,e,r)),rp(a=>!0!==a,!0))}(g,r,a,t).pipe(Nn(b=>b&&function(t){return"boolean"==typeof t}(b)?function(t,e,n,r){return Jn(e).pipe(np(a=>Kx(function(t,e){return null!==t&&e&&e(new nz(t)),gn(!0)}(a.route.parent,r),function(t,e){return null!==t&&e&&e(new rz(t)),gn(!0)}(a.route,r),function(t,e,n){const r=e[e.length-1],u=e.slice(0,e.length-1).reverse().map(g=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(g)).filter(g=>null!==g).map(g=>cD(()=>gn(g.guards.map(D=>{const I=Ay(D,g.node,n);let N;if(function(t){return t&&Ch(t.canActivateChild)}(I))N=lu(I.canActivateChild(r,t));else{if(!Ch(I))throw new Error("Invalid CanActivateChild guard");N=lu(I(r,t))}return N.pipe(rp())})).pipe(ig())));return gn(u).pipe(ig())}(t,a.path,n),function(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?gn(r.map(u=>cD(()=>{const g=Ay(u,e,n);let b;if(function(t){return t&&Ch(t.canActivate)}(g))b=lu(g.canActivate(e,t));else{if(!Ch(g))throw new Error("Invalid CanActivate guard");b=lu(g(e,t))}return b.pipe(rp())}))).pipe(ig()):gn(!0)}(t,a.route,n))),rp(a=>!0!==a,!0))}(r,u,t,e):gn(b)),tn(b=>Object.assign(Object.assign({},n),{guardsResult:b})))})}(this.ngModule.injector,b=>this.triggerEvent(b)),ol(b=>{if(Sd(b.guardsResult)){const I=tb(`Redirecting to "${this.serializeUrl(b.guardsResult)}"`);throw I.url=b.guardsResult,I}const D=new QN(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(b.urlAfterRedirects),b.targetSnapshot,!!b.guardsResult);this.triggerEvent(D)}),Cd(b=>!!b.guardsResult||(this.restoreHistory(b),this.cancelNavigationTransition(b,""),!1)),mb(b=>{if(b.guards.canActivateChecks.length)return gn(b).pipe(ol(D=>{const I=new ez(D.id,this.serializeUrl(D.extractedUrl),this.serializeUrl(D.urlAfterRedirects),D.targetSnapshot);this.triggerEvent(I)}),bh(D=>{let I=!1;return gn(D).pipe(function(t,e){return Nn(n=>{const{targetSnapshot:r,guards:{canActivateChecks:a}}=n;if(!a.length)return gn(n);let u=0;return Jn(a).pipe(np(g=>function(t,e,n,r){return function(t,e,n,r){const a=Object.keys(t);if(0===a.length)return gn({});const u={};return Jn(a).pipe(Nn(g=>function(t,e,n,r){const a=Ay(t,e,r);return lu(a.resolve?a.resolve(e,n):a(e,n))}(t[g],e,n,r).pipe(ol(b=>{u[g]=b}))),Qx(1),Nn(()=>Object.keys(u).length===a.length?gn(u):ip))}(t._resolve,t,e,r).pipe(tn(u=>(t._resolvedData=u,t.data=Object.assign(Object.assign({},t.data),LD(t,n).resolve),null)))}(g.route,r,t,e)),ol(()=>u++),Qx(1),Nn(g=>u===a.length?gn(n):ip))})}(this.paramsInheritanceStrategy,this.ngModule.injector),ol({next:()=>I=!0,complete:()=>{I||(this.restoreHistory(D),this.cancelNavigationTransition(D,"At least one route resolver didn't emit any value."))}}))}),ol(D=>{const I=new tz(D.id,this.serializeUrl(D.extractedUrl),this.serializeUrl(D.urlAfterRedirects),D.targetSnapshot);this.triggerEvent(I)}))}),mb(b=>{const{targetSnapshot:D,id:I,extractedUrl:N,rawUrl:Z,extras:{skipLocationChange:K,replaceUrl:te}}=b;return this.hooks.afterPreactivation(D,{navigationId:I,appliedUrlTree:N,rawUrlTree:Z,skipLocationChange:!!K,replaceUrl:!!te})}),tn(b=>{const D=function(t,e,n){const r=by(t,e._root,n?n._root:void 0);return new kD(r,e)}(this.routeReuseStrategy,b.targetSnapshot,b.currentRouterState);return Object.assign(Object.assign({},b),{targetRouterState:D})}),ol(b=>{this.currentUrlTree=b.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(b.urlAfterRedirects,b.rawUrl),this.routerState=b.targetRouterState,"deferred"===this.urlUpdateStrategy&&(b.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,b),this.browserUrlTree=b.urlAfterRedirects)}),((t,e,n)=>tn(r=>(new Bz(e,r.targetRouterState,r.currentRouterState,n).activate(t),r)))(this.rootContexts,this.routeReuseStrategy,b=>this.triggerEvent(b)),ol({next(){u=!0},complete(){u=!0}}),function(t){return e=>e.lift(new WN(t))}(()=>{if(!u&&!g){const b=`Navigation ID ${a.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(a),this.cancelNavigationTransition(a,b)):this.cancelNavigationTransition(a,b)}this.currentNavigation=null}),Ed(b=>{if(g=!0,function(t){return t&&t[yD]}(b)){const D=Sd(b.url);D||(this.navigated=!0,this.restoreHistory(a,!0));const I=new pD(a.id,this.serializeUrl(a.extractedUrl),b.message);r.next(I),D?setTimeout(()=>{const N=this.urlHandlingStrategy.merge(b.url,this.rawUrlTree),Z={skipLocationChange:a.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Iy(a.source)};this.scheduleNavigation(N,"imperative",null,Z,{resolve:a.resolve,reject:a.reject,promise:a.promise})},0):a.resolve(!1)}else{this.restoreHistory(a,!0);const D=new KN(a.id,this.serializeUrl(a.extractedUrl),b);r.next(D);try{a.resolve(this.errorHandler(b))}catch(I){a.reject(I)}}return ip}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}getTransition(){const n=this.transitions.value;return n.urlAfterRedirects=this.browserUrlTree,n}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r=this.extractLocationChangeInfoFromEvent(n);this.shouldScheduleNavigation(this.lastLocationChangeInfo,r)&&setTimeout(()=>{const{source:a,state:u,urlTree:g}=r,b={replaceUrl:!0};if(u){const D=Object.assign({},u);delete D.navigationId,delete D.\u0275routerPageId,0!==Object.keys(D).length&&(b.state=D)}this.scheduleNavigation(g,a,u,b)},0),this.lastLocationChangeInfo=r}))}extractLocationChangeInfoFromEvent(n){var r;return{source:"popstate"===n.type?"popstate":"hashchange",urlTree:this.parseUrl(n.url),state:(null===(r=n.state)||void 0===r?void 0:r.navigationId)?n.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(n,r){if(!n)return!0;const a=r.urlTree.toString()===n.urlTree.toString();return r.transitionId!==n.transitionId||!a||!("hashchange"===r.source&&"popstate"===n.source||"popstate"===r.source&&"hashchange"===n.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){GD(n),this.config=n.map(fb),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:a,queryParams:u,fragment:g,queryParamsHandling:b,preserveFragment:D}=r,I=a||this.routerState.root,N=D?this.currentUrlTree.fragment:g;let Z=null;switch(b){case"merge":Z=Object.assign(Object.assign({},this.currentUrlTree.queryParams),u);break;case"preserve":Z=this.currentUrlTree.queryParams;break;default:Z=u||null}return null!==Z&&(Z=this.removeEmptyProps(Z)),function(t,e,n,r,a){if(0===n.length)return cb(e.root,e.root,e,r,a);const u=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new BD(!0,0,t);let e=0,n=!1;const r=t.reduce((a,u,g)=>{if("object"==typeof u&&null!=u){if(u.outlets){const b={};return os(u.outlets,(D,I)=>{b[I]="string"==typeof D?D.split("/"):D}),[...a,{outlets:b}]}if(u.segmentPath)return[...a,u.segmentPath]}return"string"!=typeof u?[...a,u]:0===g?(u.split("/").forEach((b,D)=>{0==D&&"."===b||(0==D&&""===b?n=!0:".."===b?e++:""!=b&&a.push(b))}),a):[...a,u]},[]);return new BD(n,e,r)}(n);if(u.toRoot())return cb(e.root,new $n([],{}),e,r,a);const g=function(t,e,n){if(t.isAbsolute)return new ub(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const u=n.snapshot._urlSegment;return new ub(u,u===e.root,0)}const r=wy(t.commands[0])?0:1;return function(t,e,n){let r=t,a=e,u=n;for(;u>a;){if(u-=a,r=r.parent,!r)throw new Error("Invalid number of '../'");a=r.segments.length}return new ub(r,!1,a-u)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(u,e,t),b=g.processChildren?Cy(g.segmentGroup,g.index,u.commands):VD(g.segmentGroup,g.index,u.commands);return cb(g.segmentGroup,b,e,r,a)}(I,this.currentUrlTree,n,Z,null!=N?N:null)}navigateByUrl(n,r={skipLocationChange:!1}){const a=Sd(n)?n:this.parseUrl(n),u=this.urlHandlingStrategy.merge(a,this.rawUrlTree);return this.scheduleNavigation(u,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(a){r=this.malformedUriErrorHandler(a,this.urlSerializer,n)}return r}isActive(n,r){let a;if(a=!0===r?Object.assign({},F3):!1===r?Object.assign({},N3):r,Sd(n))return CD(this.currentUrlTree,n,a);const u=this.parseUrl(n);return CD(this.currentUrlTree,u,a)}removeEmptyProps(n){return Object.keys(n).reduce((r,a)=>{const u=n[a];return null!=u&&(r[a]=u),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new Ym(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,a,u,g){var b,D;if(this.disposed)return Promise.resolve(!1);const I=this.getTransition(),N=Iy(r)&&I&&!Iy(I.source),te=(this.lastSuccessfulId===I.id||this.currentNavigation?I.rawUrl:I.urlAfterRedirects).toString()===n.toString();if(N&&te)return Promise.resolve(!0);let he,Re,De;g?(he=g.resolve,Re=g.reject,De=g.promise):De=new Promise((_t,St)=>{he=_t,Re=St});const Ze=++this.navigationId;let Ve;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(a=this.location.getState()),Ve=a&&a.\u0275routerPageId?a.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?null!==(b=this.browserPageId)&&void 0!==b?b:0:(null!==(D=this.browserPageId)&&void 0!==D?D:0)+1):Ve=0,this.setTransition({id:Ze,targetPageId:Ve,source:r,restoredState:a,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:u,resolve:he,reject:Re,promise:De,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),De.catch(_t=>Promise.reject(_t))}setBrowserUrl(n,r){const a=this.urlSerializer.serialize(n),u=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(a)||r.extras.replaceUrl?this.location.replaceState(a,"",u):this.location.go(a,"",u)}restoreHistory(n,r=!1){var a,u;if("computed"===this.canceledNavigationResolution){const g=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(a=this.currentNavigation)||void 0===a?void 0:a.finalUrl)||0===g?this.currentUrlTree===(null===(u=this.currentNavigation)||void 0===u?void 0:u.finalUrl)&&0===g&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(g)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r){const a=new pD(n.id,this.serializeUrl(n.extractedUrl),r);this.triggerEvent(a),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return t.\u0275fac=function(n){return new(n||t)(pt(bu),pt(nb),pt(ap),pt(J_),pt(fi),pt(U_),pt(vd),pt(void 0))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function Iy(t){return"imperative"!==t}let ag=(()=>{class t{constructor(n,r,a,u,g){this.router=n,this.route=r,this.commands=[],this.onChanges=new Pi,null==a&&u.setAttribute(g.nativeElement,"tabindex","0")}ngOnChanges(n){this.onChanges.next(this)}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:[]}onClick(){const n={skipLocationChange:cp(this.skipLocationChange),replaceUrl:cp(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,n),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:cp(this.preserveFragment)})}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao),Je(sp),En("tabindex"),Je(Bu),Je(lo))},t.\u0275dir=Et({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(n,r){1&n&&Ia("click",function(){return r.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ci]}),t})(),lp=(()=>{class t{constructor(n,r,a){this.router=n,this.route=r,this.locationStrategy=a,this.commands=[],this.onChanges=new Pi,this.subscription=n.events.subscribe(u=>{u instanceof Ym&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:[]}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,r,a,u,g){if(0!==n||r||a||u||g||"string"==typeof this.target&&"_self"!=this.target)return!0;const b={skipLocationChange:cp(this.skipLocationChange),replaceUrl:cp(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,b),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:cp(this.preserveFragment)})}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao),Je(sp),Je(tp))},t.\u0275dir=Et({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,r){1&n&&Ia("click",function(u){return r.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&n&&(c0("href",r.href,rf),tu("target",r.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ci]}),t})();function cp(t){return""===t||!!t}let _b=(()=>{class t{constructor(n,r,a,u,g){this.parentContexts=n,this.location=r,this.resolver=a,this.changeDetector=g,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ln,this.deactivateEvents=new Ln,this.name=u||Fn,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const g=(r=r||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),b=this.parentContexts.getOrCreateContext(this.name).children,D=new U3(n,b,this.location.injector);this.activated=this.location.createComponent(g,this.location.length,D),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)(Je(ap),Je(hc),Je(md),En("name"),Je(v0))},t.\u0275dir=Et({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class U3{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===sp?this.route:e===ap?this.childContexts:this.parent.get(e,n)}}class aS{}class lS{preload(e,n){return gn(null)}}let cS=(()=>{class t{constructor(n,r,a,u,g){this.router=n,this.injector=u,this.preloadingStrategy=g,this.loader=new oS(r,a,I=>n.triggerEvent(new mD(I)),I=>n.triggerEvent(new gD(I)))}setUpPreloading(){this.subscription=this.router.events.pipe(Cd(n=>n instanceof Ym),np(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(ou);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const a=[];for(const u of r)if(u.loadChildren&&!u.canLoad&&u._loadedConfig){const g=u._loadedConfig;a.push(this.processRoutes(g.module,g.routes))}else u.loadChildren&&!u.canLoad?a.push(this.preloadConfig(n,u)):u.children&&a.push(this.processRoutes(n,u.children));return Jn(a).pipe(Xr(),tn(u=>{}))}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?gn(r._loadedConfig):this.loader.load(n.injector,r)).pipe(Nn(u=>(r._loadedConfig=u,this.processRoutes(u.module,u.routes)))))}}return t.\u0275fac=function(n){return new(n||t)(pt(Ao),pt(U_),pt(vd),pt(fi),pt(aS))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})(),yb=(()=>{class t{constructor(n,r,a={}){this.router=n,this.viewportScroller=r,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof eb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Ym&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof _D&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.router.triggerEvent(new _D(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(pt(Ao),pt(OT),pt(void 0))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();const Md=new Yt("ROUTER_CONFIGURATION"),uS=new Yt("ROUTER_FORROOT_GUARD"),$3=[J_,{provide:nb,useClass:SD},{provide:Ao,useFactory:function(t,e,n,r,a,u,g,b={},D,I){const N=new Ao(null,t,e,n,r,a,u,xD(g));return D&&(N.urlHandlingStrategy=D),I&&(N.routeReuseStrategy=I),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(b,N),b.enableTracing&&N.events.subscribe(Z=>{var K,te;null===(K=console.group)||void 0===K||K.call(console,`Router Event: ${Z.constructor.name}`),console.log(Z.toString()),console.log(Z),null===(te=console.groupEnd)||void 0===te||te.call(console)}),N},deps:[nb,ap,J_,fi,U_,vd,gb,Md,[class{},new vs],[class{},new vs]]},ap,{provide:sp,useFactory:function(t){return t.routerState.root},deps:[Ao]},{provide:U_,useClass:bR},cS,lS,class{preload(e,n){return n().pipe(Ed(()=>gn(null)))}},{provide:Md,useValue:{enableTracing:!1}}];function H3(){return new tx("Router",Ao)}let hS=(()=>{class t{constructor(n,r){}static forRoot(n,r){return{ngModule:t,providers:[$3,dS(n),{provide:uS,useFactory:q3,deps:[[Ao,new vs,new _r]]},{provide:Md,useValue:r||{}},{provide:tp,useFactory:Z3,deps:[wd,[new Tu(yx),new vs],Md]},{provide:yb,useFactory:G3,deps:[Ao,OT,Md]},{provide:aS,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:lS},{provide:tx,multi:!0,useFactory:H3},[vb,{provide:Bm,multi:!0,useFactory:Y3,deps:[vb]},{provide:fS,useFactory:J3,deps:[vb]},{provide:AE,multi:!0,useExisting:fS}]]}}static forChild(n){return{ngModule:t,providers:[dS(n)]}}}return t.\u0275fac=function(n){return new(n||t)(pt(uS,8),pt(Ao,8))},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({}),t})();function G3(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new yb(t,e,n)}function Z3(t,e,n={}){return n.useHash?new UL(t,e):new vT(t,e)}function q3(t){return"guarded"}function dS(t){return[{provide:th,multi:!0,useValue:t},{provide:gb,multi:!0,useValue:t}]}let vb=(()=>{class t{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Pi}appInitializer(){return this.injector.get(zL,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const a=new Promise(b=>r=b),u=this.injector.get(Ao),g=this.injector.get(Md);return"disabled"===g.initialNavigation?(u.setUpLocationChangeListener(),r(!0)):"enabled"===g.initialNavigation||"enabledBlocking"===g.initialNavigation?(u.hooks.afterPreactivation=()=>this.initNavigation?gn(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),u.initialNavigation()):r(!0),a})}bootstrapListener(n){const r=this.injector.get(Md),a=this.injector.get(cS),u=this.injector.get(yb),g=this.injector.get(Ao),b=this.injector.get(Jf);n===b.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&g.initialNavigation(),a.setUpPreloading(),u.init(),g.resetRootComponentType(b.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(n){return new(n||t)(pt(fi))},t.\u0275prov=mt({token:t,factory:t.\u0275fac}),t})();function Y3(t){return t.appInitializer.bind(t)}function J3(t){return t.bootstrapListener.bind(t)}const fS=new Yt("Router Initializer");let eB=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["app-readme"]],decls:132,vars:0,consts:[["id","readme"],[1,"tituloEncabezado"],[1,"container"],[1,"row"],[1,"col-12","mt-4","col-sm-6"],[1,"resaltado"],["href","https://aron1984.github.io/test-escuelas/","target","_blank"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"Readme"),G(),H(4,"p"),de(5,"En esta secci\xf3n contar\xe9 c\xf3mo est\xe1n confeccionadas las secciones de este portafolio."),G(),H(6,"p"),de(7,"La idea de cada p\xe1gina, las funciones, librer\xedas y herramientas utilizadas."),G(),G(),H(8,"div",2),H(9,"div",3),H(10,"div",4),H(11,"h3"),de(12,"About (home)"),G(),H(13,"p"),de(14,"Esta p\xe1gina esta creada con "),H(15,"span",5),de(16,"Angular, bootstrap, jQuery, jQueryUI"),G(),de(17,", y "),H(18,"span",5),de(19,"Fontweasome."),G(),G(),H(20,"p"),de(21,"Una base de datos en Firebase, conexi\xf3n a servicios de mapas "),H(22,"span",5),de(23,"Mapbox"),G(),de(24," y "),H(25,"span",5),de(26,"Leaflet"),G(),de(27,"."),G(),H(28,"p"),de(29,"Informacion en archivos Json; y GeoJson para vincular con los mapas."),G(),H(30,"p"),de(31,"Finalmente, hice un redise\xf1o de los \xedconos de softwares y herramientas que manejo. Tambi\xe9n dise\xf1\xe9 las im\xe1genes de toda la web."),G(),H(32,"h6"),de(33,"Encabezado"),G(),H(34,"p"),de(35,"Para este simple slider, utililc\xe9 "),H(36,"span",5),de(37,"Bootstrap"),G(),de(38,", lo confiugr\xe9 desde la hoja de estilos para que se adapte a distintas resoluciones."),G(),H(39,"p"),de(40,"La imagen de fondo fue creada y editada para que quede en equilibrio visual con el resto de la web."),G(),H(41,"h6"),de(42,'Secci\xf3n "PROFILE"'),G(),H(43,"p"),de(44,"En esta secci\xf3n utilic\xe9 "),H(45,"span",5),de(46,"Firebase"),G(),de(47," con una peque\xf1a base de datos, con informaci\xf3n de pefil."),G(),H(48,"p"),de(49,"Los iconos en este caso, son propios del proyecto alojados junto al banco de imagenes y datos."),G(),H(50,"h6"),de(51,'Secci\xf3n "Tools & Skills"'),G(),H(52,"p"),de(53,"En esta secci\xf3n presento los iconos de las herramientasa que utilizo habitualmente en mis proyectos web. Los iconos los trabaj\xe9 en "),H(54,"span",5),de(55,"Illustrator"),G(),de(56,", y los exporte como .svg; forman parte del banco de imagenes y datos de este proyecto."),G(),Fe(57,"hr"),H(58,"h3"),de(59,"Formulario de contacto"),G(),H(60,"p"),de(61,"Existen varias formas de hacer un formulario, Angular lo proporciona y de hecho lo he aplicado en los cursos que tom\xe9."),G(),H(62,"p"),de(63,'Para agregar otra "herramienta" a mis conocimientos, utilic\xe9 el servicio que ofrece '),H(64,"span",5),de(65,"formsubmit.co"),G(),de(66,", y con las clases de "),H(67,"span",5),de(68,"Bootstrap"),G(),de(69," configur\xe9 el control del env\xedo."),G(),Fe(70,"hr"),G(),H(71,"div",4),H(72,"h3"),de(73,"CV"),G(),H(74,"p"),de(75,"Para esta secci\xf3n utilic\xe9 una idea standar de c\xf3nfiguraci\xf3n de CV, y al igual que toda la web, est\xe1 dise\xf1ada bajo la premisa "),H(76,"span",5),de(77,"Mobile First"),G(),de(78,"."),G(),H(79,"p"),de(80,"Los iconos de los t\xedtulos los agregu\xe9 mediante "),H(81,"span",5),de(82,"Fontweasome"),G(),de(83,"; el progress bar de "),H(84,"span",5),de(85,"Bootstrap"),G(),de(86," que me permite mostrarte mi nivel de manejo de esas herramientas, tanto de progamaci\xf3n web, dise\xf1o, dibujo y geograf\xeda SIG."),G(),H(87,"p"),de(88,"Los iconos de las herramientas los redise\xf1e para esta web, con la intenci\xf3n de mostrarte el trabajo \xedntegro de dise\xf1o, y habilidades en "),H(89,"span",5),de(90,"Illustrator"),G(),de(91,"."),G(),Fe(92,"hr"),H(93,"h3"),de(94,"Projects"),G(),H(95,"p"),de(96,"En esta p\xe1gina presento mis proyectos haciendo uso de las CARDS de "),H(97,"span",5),de(98,"Bootstrap"),G(),de(99,". Por\xe1s dirigirte a las p\xe1ginas de mis proyectos alojadas en GitHub Pages."),G(),Fe(100,"hr"),H(101,"h3"),de(102,"Geography"),G(),H(103,"p"),de(104,"Lo referido a Geograf\xeda, con el uso de mapas webs como "),H(105,"span",5),de(106,"Leaflet"),G(),de(107," y "),H(108,"span",5),de(109,"MapBox"),G(),de(110," lo organic\xe9 en este secci\xf3n."),G(),H(111,"p"),de(112,"Por mi formaci\xf3n como Licenciado en Geograf\xeda, con estudios posteriores en Sistemas de Informaci\xf3n Geogr\xe1fica y Teledetecci\xf3n, decid\xed mostrar estos proyectos aparte. Habitualmente utilizo QGIS para mi trabajo, manejando informaci\xf3n vectorial en formatos .shp, conectando con servidores de mapas, e imagenes satelitales GeoTiff."),G(),H(113,"p"),de(114,"Esto me permite digitalizar infomaci\xf3n, bajo distintas proyecciones cartogr\xe1ficas, esportar dicha informaci\xf3n geogr\xe1fica y poder utilzarla en estos mapa web."),G(),H(115,"p"),de(116,"C\xf3mo ejemplo utilic\xe9 unos simples datos, con distintas funciones que nos ofrece "),H(117,"span",5),de(118,"Leaflet"),G(),de(119," y "),H(120,"span",5),de(121,"MapBox"),G(),de(122,", PopUp, Layers, Tiles, etc."),G(),H(123,"p"),de(124,"Pero la mejor manera de ver esto funcionando es clickeando este "),H(125,"a",6),de(126,"link"),G(),de(127,", que te llevar\xe1 a una "),H(128,"span",5),de(129,"GitHub Page"),G(),de(130," de mi repositorio."),G(),Fe(131,"hr"),G(),G(),G(),G())},styles:[""]}),t})();function Py(t,e){return new Pn(n=>{const r=t.length;if(0===r)return void n.complete();const a=new Array(r);let u=0,g=0;for(let b=0;b<r;b++){const D=Jn(t[b]);let I=!1;n.add(D.subscribe({next:N=>{I||(I=!0,g++),a[b]=N},error:N=>n.error(N),complete:()=>{u++,(u===r||!I)&&(g===r&&n.next(e?e.reduce((N,Z,K)=>(N[Z]=a[K],N),{}):a),n.complete())}}))}})}function TS(t){return null!=t}function DS(t){const e=xm(t)?Jn(t):t;return y_(e),e}function SS(t){let e={};return t.forEach(n=>{e=null!=n?Object.assign(Object.assign({},e),n):e}),0===Object.keys(e).length?null:e}function MS(t,e){return e.map(n=>n(t))}function AS(t){return t.map(e=>function(t){return!t.validate}(e)?e:n=>e.validate(n))}function bb(t){return null!=t?function(t){if(!t)return null;const e=t.filter(TS);return 0==e.length?null:function(n){return SS(MS(n,e))}}(AS(t)):null}function wb(t){return null!=t?function(t){if(!t)return null;const e=t.filter(TS);return 0==e.length?null:function(n){return function(...t){if(1===t.length){const e=t[0];if(Qt(e))return Py(e,null);if(Cr(e)&&Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);return Py(n.map(r=>e[r]),n)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Py(t=1===t.length&&Qt(t[0])?t[0]:t,null).pipe(tn(n=>e(...n)))}return Py(t,null)}(MS(n,e).map(DS)).pipe(tn(SS))}}(AS(t)):null}let NS=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=bb(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=wb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,r){return!!this.control&&this.control.hasError(n,r)}getError(n,r){return this.control?this.control.getError(n,r):null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=Et({type:t}),t})(),Qs=(()=>{class t extends NS{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=function(t){return ur(()=>{const e=t.prototype.constructor,n=e[Yr]||ui(e),r=Object.prototype;let a=Object.getPrototypeOf(t.prototype).constructor;for(;a&&a!==r;){const u=a[Yr]||ui(a);if(u&&u!==n)return u;a=Object.getPrototypeOf(a)}return u=>new u})}(t)))(r||t)}}(),t.\u0275dir=Et({type:t,features:[Yi]}),t})();let BS=(()=>{class t extends class{constructor(e){this._cd=e}is(e){var n,r,a;return"submitted"===e?!!(null===(n=this._cd)||void 0===n?void 0:n.submitted):!!(null===(a=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===a?void 0:a[e])}}{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(Je(Qs,10))},t.\u0275dir=Et({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){2&n&&x_("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))("ng-submitted",r.is("submitted"))},features:[Yi]}),t})(),XS=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=Et({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),YS=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({}),t})();const Ob=new Yt("NgModelWithFormControlWarning");let pM=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({imports:[[YS]]}),t})(),qB=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Ob,useValue:n.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({imports:[pM]}),t})(),WB=(()=>{class t{constructor(n){this.router=n}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao))},t.\u0275cmp=Qi({type:t,selectors:[["app-contact"]],decls:48,vars:0,consts:[["id","contact"],[1,"tituloEncabezado"],[1,"container"],[1,"row"],[1,"col-12","col-md-6","mt-4"],["id","redes"],["href","https://github.com/aron1984","target","_blank"],["src","assets/img/icons/github_A_web.svg","alt","GitHub","title","GitHub"],["href","www.linkedin.com/in/alejandro-ronconi","target","_blank"],["src","assets/img/icons/linkedin_A_web.svg","alt","Linkedin","title","Linkedin"],["href","https://www.instagram.com/alejoronconi/","target","_blank"],["src","assets/img/icons/instagram_A_web.svg","alt","Instagram","title","Instagram"],[1,"col-12","col-md-6","mt-5"],["target","_blank","action","https://formsubmit.co/alejoronconi.art@gmail.com","method","POST",1,"row","g-3","needs-validation","was-validated"],[1,"col-12"],[1,"form-group","mt-2"],["type","text","id","message","name","message","placeholder","Escribe tu mensaje","cols","30","rows","5","required","",1,"form-control"],[1,"col-6"],["type","text","name","name","id","name","placeholder","Name","required","",1,"form-control"],["type","text","name","lastname","id","lastname","placeholder","Last Name","required","",1,"form-control"],[1,"col"],["type","email","name","email","id","email","placeholder","Email Address","required","",1,"form-control"],["type","submit","name","sendMessage","id","sendMessage",1,"btn","btn-dark","btn","btn-block"],["type","hidden","name","_next","value","https://aron1984.github.io/thanks/"],["type","hidden","name","_subject","value","Mensaje desde PortafolioWeb Alejandro Ronconi"],["type","hidden","name","_autoresponse","value","Gracias por escribirme, en breve me pondr\xe9 en conacto."],["type","hidden","name","_template","value","table"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"RONCONI ALEJANDRO"),G(),H(4,"p"),de(5,"Web developer & Lic. en Geograf\xeda & Dise\xf1ador Gr\xe1fico."),G(),G(),H(6,"div",2),H(7,"div",3),H(8,"div",4),H(9,"h2"),de(10,"Contact"),G(),H(11,"p"),de(12,"You can get in touch directly from this reactive form made with Angular."),Fe(13,"br"),de(14," You can also contact me or follow me through my social networks."),G(),H(15,"div",5),H(16,"div"),H(17,"a",6),Fe(18,"img",7),G(),H(19,"a",8),Fe(20,"img",9),G(),H(21,"a",10),Fe(22,"img",11),G(),G(),G(),G(),H(23,"div",12),H(24,"form",13),H(25,"div",3),H(26,"div",14),H(27,"div",15),Fe(28,"textarea",16),G(),G(),G(),H(29,"div",3),H(30,"div",17),H(31,"div",15),Fe(32,"input",18),G(),G(),H(33,"div",17),H(34,"div",15),Fe(35,"input",19),G(),G(),G(),H(36,"div",3),H(37,"div",20),H(38,"div",15),Fe(39,"input",21),G(),G(),G(),H(40,"div",3),H(41,"div",20),H(42,"button",22),de(43,"Send"),G(),G(),Fe(44,"input",23),G(),Fe(45,"input",24),Fe(46,"input",25),Fe(47,"input",26),G(),G(),G(),G(),G())},directives:[XS,BS],styles:[""]}),t})();let jb=(()=>{class t{constructor(n){this.http=n,this.persona=[],this.project=[],console.log("servicio de infoPagina listo"),this.url="https://portafolio-html-afca8-default-rtdb.firebaseio.com/",this.cargarPersona(),this.getProject()}cargarPersona(){this.http.get("https://portafolio-html-afca8-default-rtdb.firebaseio.com/person.json").subscribe(n=>{console.log(n),this.persona=n,console.log(this.persona)},n=>{console.log(n)})}getProject(){this.http.get(this.url+"projects.json").subscribe(n=>{this.project=n},n=>{console.log(n)})}}return t.\u0275fac=function(n){return new(n||t)(pt(Zx))},t.\u0275prov=mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function KB(t,e){if(1&t&&(H(0,"div",5),H(1,"div",6),Fe(2,"img",18),H(3,"div",8),H(4,"h5",9),de(5),G(),H(6,"h3",10),de(7),G(),H(8,"p",10),de(9),G(),H(10,"p",10),de(11),G(),H(12,"p",10),de(13),G(),G(),H(14,"div",12),H(15,"small",13),de(16),G(),G(),G(),G()),2&t){const n=e.$implicit;oi(2),v_("src","assets/img/",n.url,".png",rf),a0("alt",n.name),oi(3),zu(n.name),oi(2),zu(n.category),oi(2),zu(n.descrip),oi(2),fd("@",n.insta,""),oi(2),zu(n.web),oi(3),fd("Designed in ",n.anio,"")}}let YB=(()=>{class t{constructor(n){this.infoProject=n,this.proyectos=[],this.proyectos=this.infoProject.project,console.log(this.proyectos)}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(jb))},t.\u0275cmp=Qi({type:t,selectors:[["app-porjects"]],decls:72,vars:1,consts:[["id","project"],[1,"tituloEncabezado"],[1,"container"],[1,"cardsProjects"],[1,"row","row-cols-1","row-cols-md-3","g-4"],[1,"col"],[1,"card","h-100","pt-1"],["src","assets/img/escuelas_mapa_1.jpg","alt","",1,"card-img-top","mt-2"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["href","https://aron1984.github.io/test-escuelas/","target","_blank"],[1,"card-footer"],[1,"text-muted"],["src","assets/img/escuelas_gmaps.jpg","alt","",1,"card-img-top","mt-2"],["href","https://www.google.com/maps/d/viewer?mid=1BvO0yX2qyzyZPUyQOWto8SPchfFWNIMj&ll=-31.993396438340575%2C-59.23563177971387&z=7","target","_blank"],["src","","alt","",1,"card-img-top","mt-2"],["class","col",4,"ngFor","ngForOf"],[1,"card-img-top","mt-2",3,"src","alt"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"Projects"),G(),H(4,"p"),de(5,"I share with you a quick list of my latest projects in different areas."),G(),G(),H(6,"div",2),H(7,"div",3),H(8,"h3"),de(9,"GitHub Pages"),G(),H(10,"p"),de(11,"Puedes visitar navegar por mis proyectos en repositorio."),G(),H(12,"div",4),H(13,"div",5),H(14,"div",6),Fe(15,"img",7),H(16,"div",8),H(17,"h5",9),de(18,"Mapa con Leaflet"),G(),H(19,"h6",10),de(20,"Web maps"),G(),H(21,"p",10),de(22,"Contribuci\xf3n I.S.P.E.E. Relevamiento y georreferencia de los establecimientos educativos de la provincia de Entre R\xedos."),G(),Fe(23,"p",10),H(24,"p",10),H(25,"a",11),de(26,"Link de GitHub Pages"),G(),G(),G(),H(27,"div",12),H(28,"small",13),de(29,"Designed in Octubre 2021"),G(),G(),G(),G(),H(30,"div",5),H(31,"div",6),Fe(32,"img",14),H(33,"div",8),H(34,"h5",9),de(35,"Mapa con Google My Maps"),G(),H(36,"h6",10),de(37,"Web maps"),G(),H(38,"p",10),de(39,"Google My Maps. Informaci\xf3n creada en QGIS, importada desde google maps."),G(),Fe(40,"p",10),H(41,"p",10),H(42,"a",15),de(43,"Link My Map"),G(),G(),G(),H(44,"div",12),H(45,"small",13),de(46,"Designed in Agosto 2021"),G(),G(),G(),G(),H(47,"div",5),H(48,"div",6),Fe(49,"img",16),H(50,"div",8),H(51,"h5",9),de(52,"Portafolio ejemplo"),G(),H(53,"h6",10),de(54,"Web JavaScript"),G(),H(55,"p",10),de(56,"Pr\xe1ctica de curso Angular. Creaci\xf3n de un portafolio aplicando Bootstrap, Firebase, Fontweasome, jQuery."),G(),Fe(57,"p",10),H(58,"p",10),de(59,"Link de GitHub Pages"),G(),G(),H(60,"div",12),H(61,"small",13),de(62,"Designed in Agosto 2021"),G(),G(),G(),G(),G(),G(),H(63,"div",3),H(64,"h3"),de(65,"My works"),G(),H(66,"p"),de(67,"Puedes visitar navegar por las webs de cada carta para ver mi trabajo funcionando."),G(),H(68,"div",4),e0(69,KB,17,8,"div",17),G(),G(),G(),H(70,"p"),de(71,"La informaci\xf3n de los proyectos presentados en las CARDAS de bootstrap, son solicitadas a una base de datos en FIREBASE a modo de ejemplo."),G(),G()),2&n&&(oi(69),Do("ngForOf",r.infoProject.project))},directives:[Sx],styles:[""]}),t})();const JB=function(){return["/contact"]};let QB=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["app-welcome"]],decls:44,vars:2,consts:[[1,"container"],["id","welcome"],["id","slider"],["id","carouselExampleIndicators","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-indicators"],["type","button","data-bs-target","#carouselExampleIndicators","data-bs-slide-to","0","aria-current","true","aria-label","Slide 1",1,"active"],["type","button","data-bs-target","#carouselExampleIndicators","data-bs-slide-to","1","aria-label","Slide 2"],["type","button","data-bs-target","#carouselExampleIndicators","data-bs-slide-to","2","aria-label","Slide 3"],[1,"carousel-inner"],[1,"carousel-item","active","text-sm-start","text-md-center"],[1,"pe-md-5","ps-md-5","pt-md-5"],[1,"carousel-item","text-sm-center","text-md-center"],[1,"carousel-item","text-sm-end","text-md-center"],["type","button","data-bs-target","#carouselExampleIndicators","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleIndicators","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],["type","button","id","boton-general",3,"routerLink"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"Hi, this is my portfolio."),Fe(4,"br"),de(5," My name is "),H(6,"span"),de(7,"Alejandro"),G(),de(8,". "),G(),H(9,"div",2),H(10,"div",3),H(11,"div",4),Fe(12,"button",5),Fe(13,"button",6),Fe(14,"button",7),G(),H(15,"div",8),H(16,"div",9),H(17,"h3",10),de(18,"I am a "),H(19,"span"),de(20,"web developer"),G(),de(21,", I trained in graphic design and illustration. I also have a degree in Geography, specialized in GIS. "),G(),G(),H(22,"div",11),H(23,"h3",10),de(24,"I consider myself a Fullstack developer, although "),H(25,"span"),de(26,"I like the front-end"),G(),de(27," a little more because of the design knowledge I acquired. "),G(),G(),H(28,"div",12),H(29,"h3",10),de(30,"I am an illustrator, cartoonist and comics. I was trained in "),H(31,"span"),de(32,"graphic design"),G(),de(33,", oriented to logos and environments Some are complemented by 3D design."),G(),G(),G(),H(34,"button",13),Fe(35,"span",14),H(36,"span",15),de(37,"Previous"),G(),G(),H(38,"button",16),Fe(39,"span",17),H(40,"span",15),de(41,"Next"),G(),G(),G(),H(42,"button",18),de(43,"Contact me"),G(),G(),G(),G()),2&n&&(oi(42),Do("routerLink",Ss(1,JB)))},directives:[ag],styles:[""]}),t})();var Id=st(958);const mM_mapboxKey="pk.eyJ1Ijoicm9uY29uaWFsZWphbmRybyIsImEiOiJja3Vrb2Y1YmczOWRpMnhvOGg0YnkyeTJ6In0.V2a3wyayn5ggeniAqYhjSQ",eV=function(){return["/geography"]};let tV=(()=>{class t{constructor(n){this.router=n}ngOnInit(){Id.accessToken=mM_mapboxKey,this.mapa1=new Id.Map({container:"map-mb",style:"mapbox://styles/ronconialejandro/ckukr9xij8ei319nyp7shtvnc",center:[-60.486567,-31.741975],zoom:11}),new Id.Marker({color:"#49ca69",draggable:!0}).setLngLat([-60.486567,-31.741975]).addTo(this.mapa1)}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao))},t.\u0275cmp=Qi({type:t,selectors:[["app-map"]],decls:9,vars:2,consts:[["id","geolocation"],[1,"fw-bold","display-6"],["id","map-mb"],["type","button",1,"buttonmore",3,"routerLink"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"h4",1),de(2,"Geolocation"),G(),Fe(3,"div",2),H(4,"p"),H(5,"span"),de(6,"Map designed in MapBox"),G(),G(),H(7,"button",3),de(8,"More details of the map"),G(),G()),2&n&&(oi(7),Do("routerLink",Ss(1,eV)))},directives:[ag],styles:["#map-mb[_ngcontent-%COMP%]{margin-top:2rem;width:100%;height:20rem}"]}),t})();function nV(t,e){if(1&t&&(H(0,"div",39),H(1,"h3",6),de(2,"PROFILE"),G(),H(3,"div",40),H(4,"div",41),Fe(5,"i",42),G(),H(6,"div",43),H(7,"span",44),de(8),G(),G(),G(),H(9,"div",40),H(10,"div",41),Fe(11,"i",45),G(),H(12,"div",43),H(13,"p"),de(14),G(),G(),G(),H(15,"div",40),H(16,"div",41),Fe(17,"i",46),G(),H(18,"div",43),H(19,"p"),de(20),Fe(21,"img",47),G(),G(),G(),H(22,"div",40),H(23,"div",41),Fe(24,"i",48),G(),H(25,"div",43),H(26,"p"),de(27),G(),G(),G(),Fe(28,"br"),H(29,"h5"),de(30,"Interests"),G(),H(31,"div",40),H(32,"div",49),H(33,"p"),Fe(34,"i",50),de(35,"\xa0Web developer, studying to be a good fullstack developer."),G(),H(36,"p"),Fe(37,"i",51),de(38,"\xa0Graphic design. I like to design logos and web pages and much more."),G(),H(39,"p"),Fe(40,"i",52),de(41,"\xa0Drawing and illustration, super heroes comic, simpson style, cartoon."),G(),H(42,"p"),Fe(43,"i",53),de(44,"\xa0As a Graduate in Geography I am interested and I am in constant contact with Geographic Information Systems (GIS). I am currently studying the integration of maps in web applications."),Fe(45,"br"),H(46,"span",54),de(47,"Then I leave a screenshot of and link to a device about it."),G(),G(),G(),G(),G()),2&t){const n=e.$implicit;oi(8),zu(n.name),oi(6),zu(n.birth),oi(6),fd("",n.location,", "),oi(7),zu(n.email)}}let iV=(()=>{class t{constructor(n){this.infowe=n,console.log(this.infowe)}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(jb))},t.\u0275cmp=Qi({type:t,selectors:[["app-profile"]],decls:78,vars:1,consts:[["id","profile",1,"sector"],[1,"container"],[1,"row","align-items-start"],["class","pe-3 col-sm-6 col-md-6 pe-md-5",4,"ngFor","ngForOf"],[1,"col-sm-6","col-md-6"],["id","tools",1,"mb-2","mb-md-2"],[1,"fw-bold","display-6"],[1,"row","row-cols-12"],[1,"col-12"],[1,"col-3","col-sm-2","col-lg-1"],["src","assets/img/icons/angular_A_web.svg","title","Angular","alt","Angular"],["src","assets/img/icons/javascript_A_web.svg","title","JavaScript","alt","Javascript"],["src","assets/img/icons/typescript_A_web.svg","title","Typescript","alt","Typescript"],["src","assets/img/icons/html5_A_web.svg","title","Html5","alt","Html5"],["src","assets/img/icons/css3_A_web.svg","title","Css3","alt","Css3"],["src","assets/img/icons/jquery_A_web.svg","title","jQuery","alt","jQuery"],["src","assets/img/icons/jqueryui_A_web.svg","title","jQuery UI","alt","AjQuery Ui"],["src","assets/img/icons/bootstrap_A_web.svg","title","Bootstrap","alt","Bootstrap"],["src","assets/img/icons/vscode_web.svg","title","VSCode","alt","VSCode"],["src","assets/img/icons/git_A_web.svg","title","Git","alt","Git"],["src","assets/img/icons/github_A_web.svg","title","GitHub","alt","Github"],["src","assets/img/icons/firebase_A_web.svg","title","Firebase","alt","Firebase"],[1,"col-3","col-md-2","col-lg-1"],["src","assets/img/icons/nodejs_A_web.svg","title","NodeJS","alt","NodeJS"],["src","assets/img/icons/robomongo_A_web.svg","title","Demonio","alt","Demonio"],["src","assets/img/icons/mongodb_A_web.svg","title","MongoDB","alt","MongoDB"],["src","assets/img/icons/postman_A_web.svg","title","PostMan","alt","PostMan"],["id","tools",1,"row","row-cols-12"],["src","assets/img/icons/illustrator_A_web.svg","title","Illustrator","alt","Illustrator"],["src","assets/img/icons/photoshop_A_web.svg","title","Photoshop","alt","Photoshop"],["src","assets/img/icons/clipstudio_A_web.svg","title","Clip Studio Paint","alt","Clip Studio Paint"],["src","assets/img/icons/blender_A_web.svg","title","Blender","alt","Blender"],["src","assets/img/icons/qgis_A_web.svg","title","QGIS","alt","QGIS"],["src","assets/img/icons/googleearth_A_web.svg","title","Google Earth","alt","Google Earth"],["src","assets/img/icons/googlemaps_A_web.svg","title","Google Maps","alt","Google Maps"],["src","assets/img/icons/openleyer_A_web.svg","title","Open Layer","alt","Open Lyer"],["src","assets/img/icons/mapbox_A_web.svg","title","MapBox","alt","Map Box"],["src","assets/img/icons/leaflet_A_web.svg","title","Leaflet","alt","Leaflet"],["type","button","href","#",1,"buttonmore","mt-2","mt-md-3"],[1,"pe-3","col-sm-6","col-md-6","pe-md-5"],[1,"row"],[1,"col-1"],[1,"fas","fa-user-astronaut"],[1,"col-11","ps-0"],[1,"bname"],[1,"fas","fa-birthday-cake"],[1,"fas","fa-map-marker-alt"],["src","assets/img/icons/arg_03.png","title","","alt","Argentina",2,"width","1.5rem","vertical-align","middle"],[1,"far","fa-envelope"],[1,"col"],[1,"fas","fa-code"],[1,"far","fa-object-ungroup"],[1,"fas","fa-broom"],[1,"fas","fa-map-marked-alt"],[1,"text-muted"]],template:function(n,r){1&n&&(H(0,"section",0),H(1,"div",1),H(2,"div",2),e0(3,nV,48,4,"div",3),H(4,"div",4),Fe(5,"app-map"),G(),G(),H(6,"div",5),H(7,"h3",6),de(8,"Tools & Skills"),G(),H(9,"h4"),de(10,"Web developer"),G(),H(11,"div",7),H(12,"div",8),H(13,"div",7),H(14,"div",9),Fe(15,"img",10),G(),H(16,"div",9),Fe(17,"img",11),G(),H(18,"div",9),Fe(19,"img",12),G(),H(20,"div",9),Fe(21,"img",13),G(),H(22,"div",9),Fe(23,"img",14),G(),H(24,"div",9),Fe(25,"img",15),G(),H(26,"div",9),Fe(27,"img",16),G(),H(28,"div",9),Fe(29,"img",17),G(),H(30,"div",9),Fe(31,"img",18),G(),H(32,"div",9),Fe(33,"img",19),G(),H(34,"div",9),Fe(35,"img",20),G(),H(36,"div",9),Fe(37,"img",21),G(),H(38,"div",22),Fe(39,"img",23),G(),H(40,"div",22),Fe(41,"img",24),G(),H(42,"div",22),Fe(43,"img",25),G(),H(44,"div",22),Fe(45,"img",26),G(),G(),G(),G(),H(46,"h4"),de(47,"Design & illustration"),G(),H(48,"div",27),H(49,"div",8),H(50,"div",7),H(51,"div",9),Fe(52,"img",28),G(),H(53,"div",9),Fe(54,"img",29),G(),H(55,"div",9),Fe(56,"img",30),G(),H(57,"div",9),Fe(58,"img",31),G(),G(),G(),G(),H(59,"h4"),de(60,"Maps, Geography & GIS"),G(),H(61,"div",27),H(62,"div",8),H(63,"div",7),H(64,"div",9),Fe(65,"img",32),G(),H(66,"div",9),Fe(67,"img",33),G(),H(68,"div",9),Fe(69,"img",34),G(),H(70,"div",9),Fe(71,"img",35),G(),H(72,"div",9),Fe(73,"img",36),G(),H(74,"div",9),Fe(75,"img",37),G(),G(),G(),G(),G(),H(76,"button",38),de(77,"More details of my skils"),G(),G(),G()),2&n&&(oi(3),Do("ngForOf",r.infowe.persona))},directives:[Sx,tV],styles:[""]}),t})(),gM=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["app-home"]],decls:4,vars:0,consts:[["id","cabecera"],["id","cuerpo"]],template:function(n,r){1&n&&(H(0,"section",0),Fe(1,"app-welcome"),G(),H(2,"section",1),Fe(3,"app-profile"),G())},directives:[QB,iV],styles:[""]}),t})();var wr=st(216);const rV={type:"FeatureCollection",name:"cines_parana",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:[{type:"Feature",properties:{id:1,name:"Cine C\xedrculo Paran\xe1",direccion:"Andr\xe9s Pazos 339",url:"cine_circulo"},geometry:{type:"Point",coordinates:[-60.52487785564138,-31.733216169914318]}},{type:"Feature",properties:{id:2,name:"Cine Rex Paran\xe1",direccion:"Monte Caseros 266",url:"cine_rex"},geometry:{type:"Point",coordinates:[-60.53060069489106,-31.735428750822436]}},{type:"Feature",properties:{id:3,name:"Inst. Audiovisual ER",direccion:"Greg. Mat. de San Mart\xedn 880",url:"instituto_audiovisual"},geometry:{type:"Point",coordinates:[-60.52322348027746,-31.721803854549616]}}]};var oV={type:"FeatureCollection",features:[{type:"Feature",properties:{stroke:"#ff0000","stroke-width":2,"stroke-opacity":1},geometry:{type:"LineString",coordinates:[[-60.51799535751343,-31.751963237730276],[-60.51838159561157,-31.752802558772512],[-60.51896095275879,-31.752674836496084],[-60.51999092102051,-31.75181726807662],[-60.518252849578865,-31.743989308339962],[-60.51557064056396,-31.74533963300635],[-60.512845516204834,-31.746142519419855],[-60.50743818283081,-31.748660618016956],[-60.505378246307366,-31.74964594230588],[-60.49694538116455,-31.755283985174962],[-60.49402713775635,-31.741452834457313],[-60.484693050384514,-31.742857940082473],[-60.48424243927002,-31.74298567590043],[-60.483663082122796,-31.742912684026027]]}}]},sV={type:"FeatureCollection",features:[{type:"Feature",properties:{stroke:"#ff0000","stroke-width":2,"stroke-opacity":1,color:"#00ff","fill-opacity":.5,name:"Barrio ATRAA III"},geometry:{type:"Polygon",coordinates:[[[-60.48752546310425,-31.739299514342942],[-60.48855543136596,-31.74378858272216],[-60.48741817474365,-31.743952812805443],[-60.484950542449944,-31.744372510584032],[-60.48415660858154,-31.740540416791994],[-60.48580884933472,-31.740303186726738],[-60.48563718795776,-31.739554995617915],[-60.48752546310425,-31.739299514342942]]]}}]};let aV=(()=>{class t{constructor(n,r){this.http=n,this.infowe=r}ngOnInit(){Id.accessToken=mM_mapboxKey,this.mapa=new Id.Map({container:"mapa-mapbox",style:"mapbox://styles/ronconialejandro/ckukqivcb474l19mw85tohnq7",center:[-60.486567,-31.741975],zoom:13}),new Id.Marker({color:"#16c4f0",draggable:!0}).setLngLat([-60.486567,-31.741975]).addTo(this.mapa),new Id.Popup({closeOnClick:!1}).setLngLat([-60.486567,-31.741975]).setHTML("<h4>Hello World!</h4><p>Welcome to my web site.</p>").addTo(this.mapa);var a=wr.icon({iconUrl:"assets/img/icon_map1_web.svg",iconSize:[38,38],iconAnchor:[40,50],popupAnchor:[-3,-50],shadowSize:[68,95],shadowAnchor:[22,94]}),u=wr.marker([-31.741975,-60.486567],{icon:a}).bindPopup("Map created with Leaflett.<br> Easily customizable -  by Alejandro.").openPopup(),g=wr.marker([-31.73319,-60.52961],{icon:a,draggable:!0,title:"This marker is movable.",opacity:.5}).bindPopup('This marker is movable.<br>Try to move it all over the map.<p><img class="imgPopup" src="assets/img/wolverine_original.jpg"></p>').openPopup(),b=wr.circle([-31.73319,-60.52961],{color:"#1565C0",fillColor:"#000000",fillOpacity:.5,radius:1200}),D=wr.layerGroup([b,g,u]);let N={pointToLayer:function(sr,xc){var Ah=wr.icon({iconUrl:"assets/img/film.svg",iconSize:[20,20],iconAnchor:[15,20],popupAnchor:[-3,-25]});return wr.marker(xc,{icon:Ah})},onEachFeature:function(sr,xc){xc.bindPopup("<h3>"+sr.properties.name+"</h3><p>Direcci\xf3n: "+sr.properties.direccion+'</p><p><img class="imgPopup" src="assets/img/'+sr.properties.url+'.jpg"></p>')}};var K=wr.geoJSON(rV,N),he=wr.geoJSON(oV,{style:function(sr){return{color:sr.properties.stroke}}}),Ze=wr.geoJSON(sV,{style:function(sr){return{color:sr.properties.color,fillColor:sr.properties.stroke}},onEachFeature:function(sr,xc){xc.bindPopup("<h5>"+sr.properties.name+"</h5S>")}}),Ve=wr.layerGroup([K,he,Ze]),_t=wr.tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'}),St=wr.map("mapa-leaflet",{center:[-31.741975,-60.486567],zoom:13,layers:[_t,D]});wr.control.layers({"Mapa base":_t},{Places:D,Examples:Ve}).addTo(St)}}return t.\u0275fac=function(n){return new(n||t)(Je(Zx),Je(jb))},t.\u0275cmp=Qi({type:t,selectors:[["app-mapa"]],decls:49,vars:0,consts:[["id","geograpyPage"],[1,"tituloEncabezado"],[1,"container"],[1,"mapaTitle"],[1,"row","row-cols-12"],[1,"col-md-6","col-12"],["id","mapa-mapbox"],[1,"row","row-col-12"],[1,"col-12","col-md-6","order-2","order-md-1"],[1,"col-12","col-md-6","order-1","order-md-2"],["id","mapa-leaflet"],[1,"separador"],[1,"col"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"Geography"),G(),H(4,"p"),de(5,"In this section I will show you some works related to my knowledge of Geography and GIS, subjects in which I have graduated from UADER and specialized in UNC, CONAE, etc."),G(),G(),H(6,"div",2),H(7,"div",3),H(8,"h2"),de(9,"Map using Mapbox"),G(),G(),H(10,"div",4),H(11,"div",5),Fe(12,"div",6),G(),H(13,"div",5),H(14,"p"),de(15," En este ejemplo de "),H(16,"span"),de(17,"Mapbox"),G(),de(18," vemos un emplazamiento de geometr\xeda punto, con un popup. Adem\xe1s, a\xf1ad\xed una capa de tres puntos que fueron importadas en "),H(19,"span"),de(20,"Mapbox"),G(),de(21," desde un archivo GeoJson generado (Digitalizado) en QGIS. "),G(),H(22,"p"),de(23,"N\xf3tese que el marcador principal se puede mover por el mapa (Faltar\xeda a\xf1adir una funci\xf3n que nos diga las coordenadas de ese marcador)."),G(),G(),G(),H(24,"div",3),H(25,"h2"),de(26,"Map using Leaflet"),G(),G(),H(27,"div",7),H(28,"div",8),H(29,"p"),de(30,"En cambio, en "),H(31,"span"),de(32,"Leaflet"),G(),de(33," lo que hice fue generar dos simples marcadores con codigo JavaScript, seteando las coordenas, el s\xedmbolo, y el popup; pero uno de ellos lo podemos desplazar con el mouse. Adem\xe1s cre\xe9 esos c\xedrculos, como zona de influencia a modo de ejemplo."),G(),H(34,"p"),de(35,"Tambi\xe9n use la variante de archivo "),H(36,"span"),de(37,"GeoJson"),G(),de(38,", pero en este caso convirti\xe9ndolo en una variable. Y desde otro componente (uso Angular), lo import\xe9. Seti\xe9 las propiedades (estilos de simbolog\xeda) y se a\xf1adieron al mapa."),G(),G(),H(39,"div",9),Fe(40,"div",10),G(),G(),Fe(41,"hr",11),H(42,"div",3),H(43,"h2"),de(44,"Maps created with QGIS"),G(),H(45,"p"),de(46,"Una colecci\xf3n de mapas de distintos temas utilizando QGIS. En cada CARDS mencionar\xe9 los porgramos que utilic\xe9 para crearlos."),G(),G(),H(47,"div",7),Fe(48,"div",12),G(),G(),G())},styles:[""]}),t})();const cV=function(){return["/home"]},uV=[{path:"",component:gM},{path:"home",component:gM},{path:"cv",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["app-cv"]],decls:240,vars:0,consts:[["id","cv"],[1,"tituloEncabezado"],[1,"container"],[1,"row"],[1,"col-md-4","mt-4","col-12"],[1,"fas","fa-address-card"],[1,"col-1"],[1,"fas","fa-user-astronaut"],[1,"col-10"],[1,"far","fa-envelope"],[1,"col-1","ml-2"],[1,"fas","fa-map-marker-alt"],[1,"fas","fa-birthday-cake"],[1,"far","fa-map"],[1,"fas","fa-angle-right"],[1,"fas","fa-layer-group"],[1,"ms-4"],[1,"progress",2,"height","3px"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","95%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","80%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","70%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","85%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","75%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","50%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","65%"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","90%"],["role","progressbar","aria-valuenow","70","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","70%"],["role","progressbar","aria-valuenow","92","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","92%"],["role","progressbar","aria-valuenow","85","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info",2,"width","85%"],[1,"fas","fa-clipboard-check"],[1,"fas","fa-icons"],[1,"col-md-8","mt-4","col-12"],[1,"col-8"],[1,"col-4"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"RONCONI ALEJANDRO"),G(),H(4,"p"),de(5,"Web developer & Lic. en Geograf\xeda & Dise\xf1ador Gr\xe1fico."),G(),G(),H(6,"div",2),H(7,"div",3),H(8,"div",4),H(9,"h4"),Fe(10,"i",5),de(11," Datos personales."),G(),Fe(12,"hr"),H(13,"div",3),Fe(14,"div",6),H(15,"div",6),Fe(16,"i",7),G(),H(17,"div",8),H(18,"h6"),de(19," Alejandro Ronconi"),G(),G(),G(),H(20,"div",3),Fe(21,"div",6),H(22,"div",6),Fe(23,"i",9),G(),H(24,"div",8),H(25,"h6"),de(26," ronconialejandro@gmail.com"),G(),G(),G(),H(27,"div",3),Fe(28,"div",6),H(29,"div",10),Fe(30,"i",11),G(),H(31,"div",8),H(32,"h6"),de(33," Paran\xe1 - Entre R\xedos"),G(),G(),G(),H(34,"div",3),Fe(35,"div",6),H(36,"div",6),Fe(37,"i",12),G(),H(38,"div",8),H(39,"h6"),de(40," Mayo del 1984"),G(),G(),G(),H(41,"div",3),Fe(42,"div",6),H(43,"div",6),Fe(44,"i",13),G(),H(45,"div",8),H(46,"h6"),de(47," Argentina"),G(),G(),G(),Fe(48,"hr"),H(49,"h4"),Fe(50,"i",11),de(51," Mis redes"),G(),H(52,"ul"),H(53,"li"),Fe(54,"i",14),de(55," github.com"),G(),H(56,"li"),Fe(57,"i",14),de(58," linkedin"),G(),H(59,"li"),Fe(60,"i",14),de(61," instagram"),G(),H(62,"li"),Fe(63,"i",14),de(64," artstation"),G(),G(),H(65,"h4"),Fe(66,"i",15),de(67," Competencias."),G(),H(68,"h6",16),de(69,"Developer"),G(),H(70,"ul"),H(71,"li"),Fe(72,"i",14),de(73," Angular"),G(),H(74,"div",17),Fe(75,"div",18),G(),H(76,"li"),Fe(77,"i",14),de(78," Bootstrap"),G(),H(79,"div",17),Fe(80,"div",19),G(),H(81,"li"),Fe(82,"i",14),de(83," JavaScript"),G(),H(84,"div",17),Fe(85,"div",19),G(),H(86,"li"),Fe(87,"i",14),de(88," jQuery & jQuery UI"),G(),H(89,"div",17),Fe(90,"div",20),G(),H(91,"li"),Fe(92,"i",14),de(93," Html 5"),G(),H(94,"div",17),Fe(95,"div",21),G(),H(96,"li"),Fe(97,"i",14),de(98," CSS 3"),G(),H(99,"div",17),Fe(100,"div",22),G(),H(101,"li"),Fe(102,"i",14),de(103," Firebase"),G(),H(104,"div",17),Fe(105,"div",23),G(),H(106,"li"),Fe(107,"i",14),de(108," Node JS"),G(),H(109,"div",17),Fe(110,"div",23),G(),H(111,"li"),Fe(112,"i",14),de(113," Git & GitHub"),G(),H(114,"div",17),Fe(115,"div",24),G(),H(116,"li"),Fe(117,"i",14),de(118," Leafet"),G(),H(119,"div",17),Fe(120,"div",21),G(),H(121,"li"),Fe(122,"i",14),de(123," MapBox"),G(),H(124,"div",17),Fe(125,"div",22),G(),G(),H(126,"h6",16),de(127,"Software desing & GIS"),G(),H(128,"ul"),H(129,"li"),Fe(130,"i",14),de(131," Photoshop"),G(),H(132,"div",17),Fe(133,"div",18),G(),H(134,"li"),Fe(135,"i",14),de(136," Illustrator"),G(),H(137,"div",17),Fe(138,"div",22),G(),H(139,"li"),Fe(140,"i",14),de(141," Clip Studio Paint (Drawing)"),G(),H(142,"div",17),Fe(143,"div",25),G(),H(144,"li"),Fe(145,"i",14),de(146," Blender (3D)"),G(),H(147,"div",17),Fe(148,"div",26),G(),H(149,"li"),Fe(150,"i",14),de(151," QGIS"),G(),H(152,"div",17),Fe(153,"div",27),G(),H(154,"li"),Fe(155,"i",14),de(156," Google My Maps"),G(),H(157,"div",17),Fe(158,"div",28),G(),H(159,"li"),Fe(160,"i",14),de(161," Google Earth"),G(),H(162,"div",17),Fe(163,"div",25),G(),G(),Fe(164,"hr"),H(165,"h4"),Fe(166,"i",29),de(167," Idiomas"),G(),H(168,"ul"),H(169,"li"),Fe(170,"i",14),de(171," Ingles b\xe1sico"),G(),G(),Fe(172,"hr"),H(173,"h4"),Fe(174,"i",30),de(175," Pasatiempos e Inter\xe9s"),G(),H(176,"ul"),H(177,"li"),Fe(178,"i",14),de(179," Comics, arte, dise\xf1o."),G(),H(180,"li"),Fe(181,"i",14),de(182," Reggae & rock"),G(),H(183,"li"),Fe(184,"i",14),de(185," Padel"),G(),G(),G(),H(186,"div",31),H(187,"h3"),de(188,"Perfil"),G(),H(189,"p"),de(190,"Si bien tengo el t\xedtulo universitario de Lic. en Geograf\xeda, y algunas especializaciones en Sistemas de Informaci\xf3n Geogr\xe1fica; estudi\xe9 dise\xf1o web, dise\xf1o gr\xe1fico y naturalmente c\xf3mo hobby estudi\xe9 dibujo (c\xf3mic de super h\xe9roes). M\xe1s recientemente retom\xe9 mi formaci\xf3n en desarrollo web (2021), comenc\xe9 con JavaScript, TypeScript como lenguaje de base, Bootstrap y Angular como framework."),G(),H(191,"p"),de(192,"Estoy tomando cursos pagos y gratuitos en Udemy constantemente."),G(),H(193,"p"),de(194,"Mi conocimiento de herramientas de dibujo y dise\xf1o, c\xf3mo son Photoshop e Illustrator, han ayudado a avanzar r\xe1pido en el dise\xf1o web, y s\xf3lo centrarme en la parte exclusiva de programaci\xf3n. C\xf3mo tambi\xe9n el conocimiento adquirido en relaci\xf3n composici\xf3n y equilibrio del dibujo y dise\xf1o."),G(),H(195,"p"),de(196,"Inevitablemente las formaciones en Geograf\xeda SIG, dise\xf1o, dibujo, programaci\xf3n se unen en el manejo y dise\xf1o de Mapas Webs."),G(),H(197,"p"),de(198,"Todo esto puedes verlo en funcionamiento en mi p\xe1gina web."),G(),Fe(199,"hr"),H(200,"h3"),de(201,"Formaci\xf3n"),G(),H(202,"div",3),H(203,"div",32),H(204,"h6"),de(205,"Lic. en Geograf\xeda"),G(),H(206,"p"),de(207,"Carrera universitaria UADER FHAyCS - Paran\xe1, Entre R\xedos."),G(),G(),H(208,"div",33),H(209,"h6"),de(210,"Diciembre 2010"),G(),G(),G(),H(211,"div",3),H(212,"div",32),H(213,"h6"),de(214,"Web Developer"),G(),H(215,"p"),de(216,"Formaci\xf3n que comenc\xe9 por el a\xf1o 2009, primero en Dise\xf1o Web; despu\xe9s en PHP. WordPress para proyectos personales en a\xf1os posteriores."),Fe(217,"br"),de(218," Actualmente especializandome en JavaScript, Angular, Bootstrap, Firebase, Leaflet."),G(),G(),H(219,"div",33),H(220,"h6"),de(221,"Diciembre 2021"),G(),G(),G(),H(222,"div",3),H(223,"div",32),H(224,"h6"),de(225,"Dise\xf1ador Gr\xe1fico"),G(),Fe(226,"p"),G(),H(227,"div",33),H(228,"h6"),de(229,"Julio 2019"),G(),G(),G(),H(230,"p"),de(231,"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Voluptatum provident repellat earum vitae maiores possimus officia laboriosam sed illum sequi, magnam perferendis nihil animi reprehenderit pariatur doloribus doloremque molestiae. Molestiae!"),G(),Fe(232,"hr"),H(233,"h3"),de(234,"Habilidades"),G(),H(235,"p"),de(236,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Earum fugit eaque natus ipsum suscipit, repellendus molestias repudiandae illo maiores ut et quam corrupti beatae quia architecto reiciendis, distinctio soluta nam?"),G(),Fe(237,"hr"),G(),G(),G(),H(238,"p"),de(239,"La informaci\xf3n de los proyectos presentados en las CARDAS de bootstrap, son solicitadas a una base de datos en FIREBASE a modo de ejemplo."),G(),G())},styles:[""]}),t})()},{path:"readme",component:eB},{path:"projects",component:YB},{path:"geography",component:aV},{path:"contact",component:WB},{path:"thanks",component:(()=>{class t{constructor(n){this.router=n}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao))},t.\u0275cmp=Qi({type:t,selectors:[["app-thanks"]],decls:22,vars:2,consts:[["id","thanks"],[1,"tituloEncabezado"],[1,"container"],[1,"row"],[1,"col-12","mt-5","text-center"],[1,"mt-5","mb-2"],[1,"mt-5"],[1,"resaltado",3,"routerLink"]],template:function(n,r){1&n&&(H(0,"div",0),H(1,"div",1),H(2,"h2"),de(3,"RONCONI ALEJANDRO"),G(),H(4,"p"),de(5,"Web developer & Lic. en Geograf\xeda & Dise\xf1ador Gr\xe1fico."),G(),G(),H(6,"div",2),H(7,"div",3),H(8,"div",4),H(9,"h2"),de(10,"\xa1MENSAJE EVIADO!"),G(),Fe(11,"hr",5),H(12,"h5",6),de(13,"Muchas gracias por contactarme."),G(),H(14,"div",6),H(15,"p"),de(16,"En breve me pondr\xe9 en contacto contigo."),G(),H(17,"p"),de(18,"Que tengas un buen d\xeda! "),G(),H(19,"p"),H(20,"a",7),de(21,"VOLVER AL INICIO"),G(),G(),G(),G(),G(),G(),G()),2&n&&(oi(20),Do("routerLink",Ss(1,cV)))},directives:[lp],styles:[""]}),t})()},{path:"**",pathMatch:"full",redirectTo:""}];let hV=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({imports:[[hS.forRoot(uV)],hS]}),t})();function _n(t,e,n,r){var g,a=arguments.length,u=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var b=t.length-1;b>=0;b--)(g=t[b])&&(u=(a<3?g(u):a>3?g(e,n,u):g(e,n))||u);return a>3&&u&&Object.defineProperty(e,n,u),u}function Jt(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var Ho=function(){function t(){}return t.mapToArray=function(e){var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push(e[r]);return n},t.handleEvent=function(e,n,r){0<n.observers.length&&e.run(function(){n.emit(r)})},t}(),Mh=function(){function t(e,n){this.element=e,this.zone=n,this.DEFAULT_ZOOM=1,this.DEFAULT_CENTER=(0,wr.latLng)(38.907192,-77.036871),this.DEFAULT_FPZ_OPTIONS={},this.fitBoundsOptions=this.DEFAULT_FPZ_OPTIONS,this.panOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomPanOptions=this.DEFAULT_FPZ_OPTIONS,this.options={},this.mapReady=new Ln,this.zoomChange=new Ln,this.centerChange=new Ln,this.onClick=new Ln,this.onDoubleClick=new Ln,this.onMouseDown=new Ln,this.onMouseUp=new Ln,this.onMouseMove=new Ln,this.onMouseOver=new Ln,this.onMouseOut=new Ln,this.onMapMove=new Ln,this.onMapMoveStart=new Ln,this.onMapMoveEnd=new Ln,this.onMapZoom=new Ln,this.onMapZoomStart=new Ln,this.onMapZoomEnd=new Ln}return t.prototype.ngOnInit=function(){var e=this;this.zone.runOutsideAngular(function(){e.map=(0,wr.map)(e.element.nativeElement,e.options),e.addMapEventListeners()}),null!=this.center&&null!=this.zoom&&this.setView(this.center,this.zoom),null!=this.fitBounds&&this.setFitBounds(this.fitBounds),null!=this.maxBounds&&this.setMaxBounds(this.maxBounds),null!=this.minZoom&&this.setMinZoom(this.minZoom),null!=this.maxZoom&&this.setMaxZoom(this.maxZoom),this.doResize(),this.mapReady.emit(this.map)},t.prototype.ngOnChanges=function(e){e.zoom&&e.center&&null!=this.zoom&&null!=this.center?this.setView(e.center.currentValue,e.zoom.currentValue):e.zoom?this.setZoom(e.zoom.currentValue):e.center&&this.setCenter(e.center.currentValue),e.fitBounds&&this.setFitBounds(e.fitBounds.currentValue),e.maxBounds&&this.setMaxBounds(e.maxBounds.currentValue),e.minZoom&&this.setMinZoom(e.minZoom.currentValue),e.maxZoom&&this.setMaxZoom(e.maxZoom.currentValue)},t.prototype.getMap=function(){return this.map},t.prototype.onResize=function(){this.delayResize()},t.prototype.addMapEventListeners=function(){var e=this;this.map.on("click",function(n){return Ho.handleEvent(e.zone,e.onClick,n)}),this.map.on("dblclick",function(n){return Ho.handleEvent(e.zone,e.onDoubleClick,n)}),this.map.on("mousedown",function(n){return Ho.handleEvent(e.zone,e.onMouseDown,n)}),this.map.on("mouseup",function(n){return Ho.handleEvent(e.zone,e.onMouseUp,n)}),this.map.on("mouseover",function(n){return Ho.handleEvent(e.zone,e.onMouseOver,n)}),this.map.on("mouseout",function(n){return Ho.handleEvent(e.zone,e.onMouseOut,n)}),this.map.on("mousemove",function(n){return Ho.handleEvent(e.zone,e.onMouseMove,n)}),this.map.on("zoomstart",function(n){return Ho.handleEvent(e.zone,e.onMapZoomStart,n)}),this.map.on("zoom",function(n){return Ho.handleEvent(e.zone,e.onMapZoom,n)}),this.map.on("zoomend",function(n){return Ho.handleEvent(e.zone,e.onMapZoomEnd,n)}),this.map.on("movestart",function(n){return Ho.handleEvent(e.zone,e.onMapMoveStart,n)}),this.map.on("move",function(n){return Ho.handleEvent(e.zone,e.onMapMove,n)}),this.map.on("moveend",function(n){return Ho.handleEvent(e.zone,e.onMapMoveEnd,n)}),this.map.on("zoomend moveend",function(){var n=e.map.getZoom();n!==e.zoom&&(e.zoom=n,Ho.handleEvent(e.zone,e.zoomChange,n));var r=e.map.getCenter();(null!=r||null!=e.center)&&((null==r||null==e.center)&&r!==e.center||r.lat!==e.center.lat||r.lng!==e.center.lng)&&(e.center=r,Ho.handleEvent(e.zone,e.centerChange,r))})},t.prototype.doResize=function(){var e=this;this.zone.runOutsideAngular(function(){e.map.invalidateSize({})})},t.prototype.delayResize=function(){null!=this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.doResize.bind(this),200)},t.prototype.setView=function(e,n){this.map&&null!=e&&null!=n&&this.map.setView(e,n,this.zoomPanOptions)},t.prototype.setZoom=function(e){this.map&&null!=e&&this.map.setZoom(e,this.zoomOptions)},t.prototype.setCenter=function(e){this.map&&null!=e&&this.map.panTo(e,this.panOptions)},t.prototype.setFitBounds=function(e){this.map&&null!=e&&this.map.fitBounds(e,this.fitBoundsOptions)},t.prototype.setMaxBounds=function(e){this.map&&null!=e&&this.map.setMaxBounds(e)},t.prototype.setMinZoom=function(e){this.map&&null!=e&&this.map.setMinZoom(e)},t.prototype.setMaxZoom=function(e){this.map&&null!=e&&this.map.setMaxZoom(e)},_n([rs("leafletFitBoundsOptions"),Jt("design:type",Object)],t.prototype,"fitBoundsOptions",void 0),_n([rs("leafletPanOptions"),Jt("design:type",Object)],t.prototype,"panOptions",void 0),_n([rs("leafletZoomOptions"),Jt("design:type",Object)],t.prototype,"zoomOptions",void 0),_n([rs("leafletZoomPanOptions"),Jt("design:type",Object)],t.prototype,"zoomPanOptions",void 0),_n([rs("leafletOptions"),Jt("design:type",Object)],t.prototype,"options",void 0),_n([co("leafletMapReady"),Jt("design:type",Object)],t.prototype,"mapReady",void 0),_n([rs("leafletZoom"),Jt("design:type",Number)],t.prototype,"zoom",void 0),_n([co("leafletZoomChange"),Jt("design:type",Object)],t.prototype,"zoomChange",void 0),_n([rs("leafletCenter"),Jt("design:type",wr.LatLng)],t.prototype,"center",void 0),_n([co("leafletCenterChange"),Jt("design:type",Object)],t.prototype,"centerChange",void 0),_n([rs("leafletFitBounds"),Jt("design:type",wr.LatLngBounds)],t.prototype,"fitBounds",void 0),_n([rs("leafletMaxBounds"),Jt("design:type",wr.LatLngBounds)],t.prototype,"maxBounds",void 0),_n([rs("leafletMinZoom"),Jt("design:type",Number)],t.prototype,"minZoom",void 0),_n([rs("leafletMaxZoom"),Jt("design:type",Number)],t.prototype,"maxZoom",void 0),_n([co("leafletClick"),Jt("design:type",Object)],t.prototype,"onClick",void 0),_n([co("leafletDoubleClick"),Jt("design:type",Object)],t.prototype,"onDoubleClick",void 0),_n([co("leafletMouseDown"),Jt("design:type",Object)],t.prototype,"onMouseDown",void 0),_n([co("leafletMouseUp"),Jt("design:type",Object)],t.prototype,"onMouseUp",void 0),_n([co("leafletMouseMove"),Jt("design:type",Object)],t.prototype,"onMouseMove",void 0),_n([co("leafletMouseOver"),Jt("design:type",Object)],t.prototype,"onMouseOver",void 0),_n([co("leafletMouseOut"),Jt("design:type",Object)],t.prototype,"onMouseOut",void 0),_n([co("leafletMapMove"),Jt("design:type",Object)],t.prototype,"onMapMove",void 0),_n([co("leafletMapMoveStart"),Jt("design:type",Object)],t.prototype,"onMapMoveStart",void 0),_n([co("leafletMapMoveEnd"),Jt("design:type",Object)],t.prototype,"onMapMoveEnd",void 0),_n([co("leafletMapZoom"),Jt("design:type",Object)],t.prototype,"onMapZoom",void 0),_n([co("leafletMapZoomStart"),Jt("design:type",Object)],t.prototype,"onMapZoomStart",void 0),_n([co("leafletMapZoomEnd"),Jt("design:type",Object)],t.prototype,"onMapZoomEnd",void 0),_n([Rk("window:resize",[]),Jt("design:type",Function),Jt("design:paramtypes",[]),Jt("design:returntype",void 0)],t.prototype,"onResize",null),(t=_n([Jt("design:paramtypes",[lo,mi])],t)).\u0275fac=function(n){return new(n||t)(Je(lo),Je(mi))},t.\u0275dir=Et({type:t,selectors:[["","leaflet",""]],hostBindings:function(n,r){1&n&&Ia("resize",function(){return r.onResize()},!1,ch)},inputs:{fitBoundsOptions:["leafletFitBoundsOptions","fitBoundsOptions"],panOptions:["leafletPanOptions","panOptions"],zoomOptions:["leafletZoomOptions","zoomOptions"],zoomPanOptions:["leafletZoomPanOptions","zoomPanOptions"],options:["leafletOptions","options"],zoom:["leafletZoom","zoom"],center:["leafletCenter","center"],fitBounds:["leafletFitBounds","fitBounds"],maxBounds:["leafletMaxBounds","maxBounds"],minZoom:["leafletMinZoom","minZoom"],maxZoom:["leafletMaxZoom","maxZoom"]},outputs:{mapReady:"leafletMapReady",zoomChange:"leafletZoomChange",centerChange:"leafletCenterChange",onClick:"leafletClick",onDoubleClick:"leafletDoubleClick",onMouseDown:"leafletMouseDown",onMouseUp:"leafletMouseUp",onMouseMove:"leafletMouseMove",onMouseOver:"leafletMouseOver",onMouseOut:"leafletMouseOut",onMapMove:"leafletMapMove",onMapMoveStart:"leafletMapMoveStart",onMapMoveEnd:"leafletMapMoveEnd",onMapZoom:"leafletMapZoom",onMapZoomStart:"leafletMapZoomStart",onMapZoomEnd:"leafletMapZoomEnd"},features:[ci]}),t}(),jy=function(){function t(e){this.leafletDirective=e}return t.prototype.init=function(){},t.prototype.getMap=function(){return this.leafletDirective.getMap()},t}(),Hb=(function(){function t(e,n){this.zone=n,this.onAdd=new Ln,this.onRemove=new Ln,this.leafletDirective=new jy(e)}t.prototype.ngOnInit=function(){this.leafletDirective.init()},t.prototype.ngOnDestroy=function(){this.layer.remove()},t.prototype.ngOnChanges=function(e){var n=this;if(e.layer){var r=e.layer.previousValue,a=e.layer.currentValue;this.zone.runOutsideAngular(function(){null!=r&&r.remove(),null!=a&&(n.addLayerEventListeners(a),n.leafletDirective.getMap().addLayer(a))})}},t.prototype.addLayerEventListeners=function(e){var n=this;e.on("add",function(r){return Ho.handleEvent(n.zone,n.onAdd,r)}),e.on("remove",function(r){return Ho.handleEvent(n.zone,n.onRemove,r)})},_n([rs("leafletLayer"),Jt("design:type",wr.Layer)],t.prototype,"layer",void 0),_n([co("leafletLayerAdd"),Jt("design:type",Object)],t.prototype,"onAdd",void 0),_n([co("leafletLayerRemove"),Jt("design:type",Object)],t.prototype,"onRemove",void 0),(t=_n([Jt("design:paramtypes",[Mh,mi])],t)).\u0275fac=function(n){return new(n||t)(Je(Mh),Je(mi))},t.\u0275dir=Et({type:t,selectors:[["","leafletLayer",""]],inputs:{layer:["leafletLayer","layer"]},outputs:{onAdd:"leafletLayerAdd",onRemove:"leafletLayerRemove"},features:[ci]})}(),function(){function t(e,n,r){this.differs=n,this.zone=r,this.leafletDirective=new jy(e),this.layersDiffer=this.differs.find([]).create()}Object.defineProperty(t.prototype,"layers",{get:function(){return this.layersValue},set:function(e){this.layersValue=e,this.updateLayers()},enumerable:!0,configurable:!0}),t.prototype.ngDoCheck=function(){this.updateLayers()},t.prototype.ngOnInit=function(){this.leafletDirective.init(),this.updateLayers()},t.prototype.ngOnDestroy=function(){this.layers=[]},t.prototype.updateLayers=function(){var e=this.leafletDirective.getMap();if(null!=e&&null!=this.layersDiffer){var n=this.layersDiffer.diff(this.layersValue);null!=n&&this.zone.runOutsideAngular(function(){n.forEachRemovedItem(function(r){e.removeLayer(r.item)}),n.forEachAddedItem(function(r){e.addLayer(r.item)})})}},_n([rs("leafletLayers"),Jt("design:type",Array),Jt("design:paramtypes",[Array])],t.prototype,"layers",null),(t=_n([Jt("design:paramtypes",[Mh,gd,mi])],t)).\u0275fac=function(n){return new(n||t)(Je(Mh),Je(gd),Je(mi))},t.\u0275dir=Et({type:t,selectors:[["","leafletLayers",""]],inputs:{layers:["leafletLayers","layers"]}})}(),function(){function t(){this.layersRemoved=0,this.layersChanged=0,this.layersAdded=0}return t.prototype.changed=function(){return!(0===this.layersRemoved&&0===this.layersChanged&&0===this.layersAdded)},t}()),xM=function(){function t(e,n){this.zone=e,this.layersControlReady=n}return t.prototype.getLayersControl=function(){return this.layersControl},t.prototype.init=function(e,n){var r=this,a=e.baseLayers||{},u=e.overlays||{};return this.zone.runOutsideAngular(function(){r.layersControl=wr.control.layers(a,u,n)}),this.layersControlReady.emit(this.layersControl),this.layersControl},t.prototype.applyBaseLayerChanges=function(e){var n=new Hb;return null!=this.layersControl&&(n=this.applyChanges(e,this.layersControl.addBaseLayer)),n},t.prototype.applyOverlayChanges=function(e){var n=new Hb;return null!=this.layersControl&&(n=this.applyChanges(e,this.layersControl.addOverlay)),n},t.prototype.applyChanges=function(e,n){var r=this,a=new Hb;return null!=e&&this.zone.runOutsideAngular(function(){e.forEachChangedItem(function(u){r.layersControl.removeLayer(u.previousValue),n.call(r.layersControl,u.currentValue,u.key),a.layersChanged++}),e.forEachRemovedItem(function(u){r.layersControl.removeLayer(u.previousValue),a.layersRemoved++}),e.forEachAddedItem(function(u){n.call(r.layersControl,u.currentValue,u.key),a.layersAdded++})}),a},t}(),Gb=function(){this.baseLayers={},this.overlays={}},pV=(function(){function t(e,n,r){this.differs=n,this.zone=r,this.layersControlReady=new Ln,this.leafletDirective=new jy(e),this.controlLayers=new xM(this.zone,this.layersControlReady),this.baseLayersDiffer=this.differs.find({}).create(),this.overlaysDiffer=this.differs.find({}).create()}Object.defineProperty(t.prototype,"layersControlConfig",{get:function(){return this.layersControlConfigValue},set:function(e){null==e&&(e=new Gb),null==e.baseLayers&&(e.baseLayers={}),null==e.overlays&&(e.overlays={}),this.layersControlConfigValue=e,this.updateLayers()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var e=this;this.leafletDirective.init(),this.zone.runOutsideAngular(function(){e.controlLayers.init({},e.layersControlOptions).addTo(e.leafletDirective.getMap())}),this.updateLayers()},t.prototype.ngOnDestroy=function(){this.layersControlConfig={baseLayers:{},overlays:{}},this.controlLayers.getLayersControl().remove()},t.prototype.ngDoCheck=function(){this.updateLayers()},t.prototype.updateLayers=function(){var e=this.leafletDirective.getMap(),n=this.controlLayers.getLayersControl();if(null!=e&&null!=n){if(null!=this.baseLayersDiffer&&null!=this.layersControlConfigValue.baseLayers){var r=this.baseLayersDiffer.diff(this.layersControlConfigValue.baseLayers);this.controlLayers.applyBaseLayerChanges(r)}null!=this.overlaysDiffer&&null!=this.layersControlConfigValue.overlays&&(r=this.overlaysDiffer.diff(this.layersControlConfigValue.overlays),this.controlLayers.applyOverlayChanges(r))}},_n([rs("leafletLayersControl"),Jt("design:type",Gb),Jt("design:paramtypes",[Gb])],t.prototype,"layersControlConfig",null),_n([rs("leafletLayersControlOptions"),Jt("design:type",Object)],t.prototype,"layersControlOptions",void 0),_n([co("leafletLayersControlReady"),Jt("design:type",Object)],t.prototype,"layersControlReady",void 0),(t=_n([Jt("design:paramtypes",[Mh,ru,mi])],t)).\u0275fac=function(n){return new(n||t)(Je(Mh),Je(ru),Je(mi))},t.\u0275dir=Et({type:t,selectors:[["","leafletLayersControl",""]],inputs:{layersControlConfig:["leafletLayersControl","layersControlConfig"],layersControlOptions:["leafletLayersControlOptions","layersControlOptions"]},outputs:{layersControlReady:"leafletLayersControlReady"}})}(),function(){function t(e,n,r){this.differs=n,this.zone=r,this.layersControlReady=new Ln,this.leafletDirective=new jy(e),this.controlLayers=new xM(this.zone,this.layersControlReady),this.baseLayersDiffer=this.differs.find({}).create()}Object.defineProperty(t.prototype,"baseLayers",{get:function(){return this.baseLayersValue},set:function(e){this.baseLayersValue=e,this.updateBaseLayers()},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.baseLayers={},this.controlLayers.getLayersControl().remove()},t.prototype.ngOnInit=function(){var e=this;this.leafletDirective.init(),this.zone.runOutsideAngular(function(){e.controlLayers.init({},e.layersControlOptions).addTo(e.leafletDirective.getMap())}),this.updateBaseLayers()},t.prototype.ngDoCheck=function(){this.updateBaseLayers()},t.prototype.updateBaseLayers=function(){var e=this.leafletDirective.getMap(),n=this.controlLayers.getLayersControl();if(null!=e&&null!=n&&null!=this.baseLayersDiffer){var r=this.baseLayersDiffer.diff(this.baseLayersValue);this.controlLayers.applyBaseLayerChanges(r).changed()&&this.syncBaseLayer()}},t.prototype.syncBaseLayer=function(){var a,e=this,n=this.leafletDirective.getMap(),r=Ho.mapToArray(this.baseLayers);n.eachLayer(function(u){a=r.find(function(g){return u===g})}),null!=a?this.baseLayer=a:r.length>0&&(this.baseLayer=r[0],this.zone.runOutsideAngular(function(){e.baseLayer.addTo(n)}))},_n([rs("leafletBaseLayers"),Jt("design:type",Object),Jt("design:paramtypes",[Object])],t.prototype,"baseLayers",null),_n([rs("leafletLayersControlOptions"),Jt("design:type",Object)],t.prototype,"layersControlOptions",void 0),_n([co("leafletLayersControlReady"),Jt("design:type",Object)],t.prototype,"layersControlReady",void 0),(t=_n([Jt("design:paramtypes",[Mh,ru,mi])],t)).\u0275fac=function(n){return new(n||t)(Je(Mh),Je(ru),Je(mi))},t.\u0275dir=Et({type:t,selectors:[["","leafletBaseLayers",""]],inputs:{baseLayers:["leafletBaseLayers","baseLayers"],layersControlOptions:["leafletLayersControlOptions","layersControlOptions"]},outputs:{layersControlReady:"leafletLayersControlReady"}})}(),function(){function t(){}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t}),t.\u0275inj=Rn({}),t}());!function(){function t(e,n,r){this.type=e,this.url=n,this.options=r}t.createTileLayer=function(e){var n;switch(e.type){case"xyz":n=(0,wr.tileLayer)(e.url,e.options);break;case"wms":default:n=wr.tileLayer.wms(e.url,e.options)}return n},t.createTileLayers=function(e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t.createTileLayer(e[r]));return n},t.prototype.createTileLayer=function(){return t.createTileLayer(this)}}();const mV=function(){return["/about"]},gV=function(){return["/cv"]},_V=function(){return["/projects"]},yV=function(){return["/readme"]},vV=function(){return["/geography"]},xV=function(){return["/contact"]};let bV=(()=>{class t{constructor(n){this.router=n}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao))},t.\u0275cmp=Qi({type:t,selectors:[["app-header"]],decls:28,vars:12,consts:[[1,"navbar","navbar-expand-sm","fixed-top"],[1,"container-fluid"],["id","logo"],["src","assets/img/logo.png"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],["id","btnlist","src","assets/img/bars-solid.svg"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","text-uppercase"],[1,"nav-item"],[1,"nav-link",3,"routerLink"]],template:function(n,r){1&n&&(H(0,"nav",0),H(1,"div",1),H(2,"div",2),Fe(3,"img",3),G(),H(4,"a",4),de(5,"ALEJANDRO"),G(),H(6,"button",5),Fe(7,"img",6),G(),H(8,"div",7),H(9,"ul",8),H(10,"li",9),H(11,"a",10),de(12,"About"),G(),G(),H(13,"li",9),H(14,"a",10),de(15,"CV"),G(),G(),H(16,"li",9),H(17,"a",10),de(18,"Projects"),G(),G(),H(19,"li",9),H(20,"a",10),de(21,"Readme"),G(),G(),H(22,"li",9),H(23,"a",10),de(24,"Geography"),G(),G(),H(25,"li",9),H(26,"a",10),de(27,"Contact"),G(),G(),G(),G(),G(),G()),2&n&&(oi(11),Do("routerLink",Ss(6,mV)),oi(3),Do("routerLink",Ss(7,gV)),oi(3),Do("routerLink",Ss(8,_V)),oi(3),Do("routerLink",Ss(9,yV)),oi(3),Do("routerLink",Ss(10,vV)),oi(3),Do("routerLink",Ss(11,xV)))},directives:[lp],styles:[""]}),t})();const wV=function(){return["/home"]},CV=function(){return["/cv"]},EV=function(){return["/readme"]},TV=function(){return["/geography"]},DV=function(){return["/projects"]},SV=function(){return["/contact"]};let MV=(()=>{class t{constructor(n){this.router=n,this.anio=(new Date).getFullYear()}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Je(Ao))},t.\u0275cmp=Qi({type:t,selectors:[["app-footer"]],decls:61,vars:13,consts:[["id","footer"],[1,"container"],[1,"row","text-center","text-xs-center","text-sm-left","text-md-left"],[1,"col-sm-4","col-md-4"],[1,"list-unstyled","quick-links"],[3,"routerLink"],["href","https://www.linkedin.com/in/alejandro-ronconi","target","_blank"],["href","https://github.com/aron1984","target","_blank"],["href","https://www.instagram.com/alejoronconi/","target","_blank"],["href","https://www.artstation.com/alejoronconi","target","_blank"],["href","https://dibujando.net/alejoronconi/galeria","target","_blank"],["href","https://www.domestika.org/es/ronconialejandro","target","_blank"],[1,"row","mt-6"],[1,"col-sm-12","col-md-12","mt-2","mt-sm-2","text-center","text-white"],[1,"h6"],["href","https://github.com/aron1984","target","_blank",1,"text-green","ml-2"]],template:function(n,r){1&n&&(H(0,"section",0),H(1,"div",1),H(2,"div",2),H(3,"div",3),H(4,"h5"),de(5,"Quick links"),G(),H(6,"ul",4),H(7,"li"),H(8,"a",5),de(9,"About"),G(),G(),H(10,"li"),H(11,"a",5),de(12,"CV"),G(),G(),H(13,"li"),H(14,"a",5),de(15,"Readme"),G(),G(),H(16,"li"),H(17,"a",5),de(18,"Geography"),G(),G(),H(19,"li"),H(20,"a",5),de(21,"Projects"),G(),G(),H(22,"li"),H(23,"a",5),de(24,"Contact"),G(),G(),G(),G(),H(25,"div",3),H(26,"h5"),de(27,"Social networks"),G(),H(28,"ul",4),H(29,"li"),H(30,"a",6),de(31,"Linkedin"),G(),G(),H(32,"li"),H(33,"a",7),de(34,"GitHub"),G(),G(),H(35,"li"),H(36,"a",8),de(37,"Instagram"),G(),G(),G(),G(),H(38,"div",3),H(39,"h5"),de(40,"Galleries"),G(),H(41,"ul",4),H(42,"li"),H(43,"a",9),de(44,"Artstation"),G(),G(),H(45,"li"),H(46,"a",10),de(47,"Dibujando.net"),G(),G(),H(48,"li"),H(49,"a",11),de(50,"Domestika"),G(),G(),G(),G(),G(),Fe(51,"hr"),H(52,"div",12),H(53,"div",13),H(54,"p"),de(55,"Website developed by Alejandro Ronconi. Based on Mobile First, using the Angular Framework complementing with Bootstrap."),G(),H(56,"p",14),de(57,"Paran\xe1 - Entre Rios"),H(58,"a",15),de(59),G(),G(),G(),Fe(60,"hr"),G(),G(),G()),2&n&&(oi(8),Do("routerLink",Ss(7,wV)),oi(3),Do("routerLink",Ss(8,CV)),oi(3),Do("routerLink",Ss(9,EV)),oi(3),Do("routerLink",Ss(10,TV)),oi(3),Do("routerLink",Ss(11,DV)),oi(3),Do("routerLink",Ss(12,SV)),oi(36),fd(" ",r.anio,""))},directives:[lp],styles:[""]}),t})(),AV=(()=>{class t{constructor(){this.title="portalejo"}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Qi({type:t,selectors:[["app-root"]],decls:3,vars:0,template:function(n,r){1&n&&(Fe(0,"app-header"),Fe(1,"router-outlet"),Fe(2,"app-footer"))},directives:[bV,_b,MV],styles:[""]}),t})(),IV=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=er({type:t,bootstrap:[AV]}),t.\u0275inj=Rn({providers:[],imports:[[KF,hV,vN,qB,pV]]}),t})();(function(){if(FE)throw new Error("Cannot enable prod mode after platform setup.");OE=!1})(),WF().bootstrapModule(IV).catch(t=>console.error(t))}},qu=>{qu(qu.s=247)}]);